import{r as Z6,t as Tx,i as q6,a as Q6,b as K6,c as Y6,d as jc,e as X6,f as J6,g as e5,h as u,R as q,j as Gp,u as jd,k as t5,l as n5,s as s5,z as o5,P as r5,m as Up,n as a5,p as l5,o as i5,q as c5,v as b,L as u5,w as Rx,x as d5,B as f5,$ as h5,y as m5,A as L,C as s,D as Ae,E as Oa,U as P,G as sn,F as p5,H as O,I as na,J as g5,K as Ze,M as pt,N as Xd,O as Ve,Q as ys,S as vC,T as $o,V as Zp,W as CC,X as qp,Y as Qp,Z as Rn,_ as bs,a0 as ni,a1 as lt,a2 as Kp,a3 as rn,a4 as Zr,a5 as x5,a6 as v5,a7 as yC,a8 as C5,a9 as si,aa as Jd,ab as bC,ac as zs,ad as y5,ae as Sc,af as b5,ag as j5,ah as Bx,ai as Yp,aj as sa,ak as re,al as $,am as ot,an as fo,ao as Xp,ap as To,aq as S5,ar as js,as as w5,at as jC,au as SC,av as Nx,aw as k5,ax as I5,ay as An,az as Y,aA as jt,aB as yt,aC as Za,aD as wC,aE as M5,aF as oa,aG as oi,aH as Jp,aI as ra,aJ as A5,aK as aa,aL as Ks,aM as qe,aN as P5,aO as Ne,aP as Ee,aQ as eg,aR as la,aS as gn,aT as D5,aU as E5,aV as _5,aW as L5,aX as Fa,aY as mr,aZ as Va,a_ as pr,a$ as ri,b0 as gr,b1 as T5,b2 as Gl,b3 as R5,b4 as wc,b5 as B5,b6 as kC,b7 as N5,b8 as tg,b9 as IC,ba as MC,bb as AC,bc as z5,bd as PC,be as it,bf as O5,bg as Ot,bh as F5,bi as V5,bj as DC,bk as EC,bl as Ha,bm as H5,bn as ve,bo as zx,bp as qa,bq as mn,br as Qa,bs as _C,bt as LC,bu as ia,bv as Ul,bw as Ws,bx as Te,by as ut,bz as kc,bA as TC,bB as ef,bC as qr,bD as dd,bE as RC,bF as tf,bG as nf,bH as Gs,bI as BC,bJ as $5,bK as Dt,bL as sf,bM as of,bN as rf,bO as NC,bP as zC,bQ as Nl,bR as zr,bS as Tn,bT as W5,bU as G5,bV as U5,bW as Z5,bX as En,bY as bn,bZ as q5,b_ as Q5,b$ as K5,c0 as af,c1 as lf,c2 as Ox,c3 as Y5,c4 as fr,c5 as X5,c6 as ng,c7 as sg,c8 as OC,c9 as cf,ca as Or,cb as og,cc as rg,cd as J5,ce as Ka,cf as Fx,cg as bt,ch as Ya,ci as Xa,cj as Wo,ck as eI,cl as tI,cm as wa,cn as FC,co as Fi,cp as wl,cq as Wu,cr as Gu,cs as Cm,ct as nI,cu as ag,cv as sI,cw as oI,cx as rI,cy as aI,cz as lI,cA as VC,cB as iI,cC as ai,cD as cI,cE as uI,cF as HC,cG as $C,cH as dI,cI as WC,cJ as fI,cK as hI,cL as mI,cM as GC,cN as UC,cO as ZC,cP as qC,cQ as lg,cR as QC,cS as KC,cT as YC,cU as pI,cV as gI,cW as XC,cX as JC,cY as ey,cZ as ty,c_ as ny,c$ as sy,d0 as oy,d1 as ry,d2 as ay,d3 as ly,d4 as iy,d5 as cy,d6 as sp,d7 as op,d8 as uy,d9 as xI,da as li,db as vI,dc as CI,dd as yI,de as dy,df as ig,dg as fy,dh as bI,di as cg,dj as ls,dk as ug,dl as dg,dm as hy,dn as jI,dp as SI,dq as fg,dr as fn,ds as Vx,dt as wI,du as Ja,dv as el,dw as Nt,dx as pn,dy as kI,dz as my,dA as II,dB as py,dC as gy,dD as Ic,dE as Mc,dF as xy,dG as hg,dH as MI,dI as AI,dJ as _r,dK as PI,dL as uf,dM as vy,dN as DI,dO as EI,dP as rp,dQ as Oo,dR as Cy,dS as yy,dT as _I,dU as ii,dV as Pn,dW as Sd,dX as LI,dY as TI,dZ as RI,d_ as BI,d$ as NI,e0 as zI,e1 as OI,e2 as FI,e3 as VI,e4 as HI,e5 as $I,e6 as WI,e7 as GI,e8 as by,e9 as UI,ea as wd,eb as ZI,ec as qI,ed as Qr,ee as QI,ef as KI,eg as YI,eh as XI,ei as JI,ej as eM,ek as tM,el as nM,em as sM,en as oM,eo as rM,ep as aM,eq as lM,er as iM,es as cM,et as uM,eu as dM,ev as fM,ew as hM,ex as mM,ey as pM,ez as gM,eA as xM,eB as vM,eC as CM,eD as yM,eE as bM,eF as jM,eG as SM,eH as wM,eI as kM,eJ as IM,eK as MM,eL as AM,eM as PM,eN as DM,eO as EM,eP as Go,eQ as _M,eR as LM,eS as Ac,eT as mg,eU as jy,eV as TM,eW as RM,eX as BM,eY as NM,eZ as zM,e_ as OM,e$ as FM,f0 as Uu,f1 as VM,f2 as HM,f3 as Sy,f4 as $M,f5 as WM,f6 as pg,f7 as GM,f8 as UM,f9 as wy,fa as ZM,fb as ky,fc as qM,fd as Iy,fe as My,ff as Ay,fg as Py,fh as QM,fi as KM,fj as fd,fk as YM,fl as XM,fm as JM,fn as e8,fo as Dy,fp as t8,fq as n8,fr as s8,fs as o8,ft as Hx,fu as Ey,fv as r8,fw as a8,fx as _y,fy as l8,fz as i8,fA as c8,fB as u8,fC as df,fD as Ly,fE as ff,fF as vo,fG as d8,fH as Ty,fI as f8,fJ as h8,fK as Zu,fL as m8,fM as p8,fN as Ry,fO as g8,fP as By,fQ as x8,fR as ci,fS as v8,fT as C8,fU as y8,fV as b8,fW as j8,fX as S8,fY as w8,fZ as k8,f_ as Ys,f$ as I8,g0 as Ny,g1 as M8,g2 as A8,g3 as P8,g4 as D8,g5 as E8,g6 as lc,g7 as Ji,g8 as zy,g9 as Oy,ga as _8,gb as gg,gc as L8,gd as T8,ge as R8,gf as B8,gg as $x,gh as Wx,gi as N8,gj as z8,gk as O8,gl as F8,gm as V8,gn as H8,go as $8,gp as W8,gq as G8,gr as U8,gs as Z8,gt as Gx,gu as q8,gv as Q8,gw as K8,gx as Y8,gy as X8,gz as J8,gA as e3,gB as t3,gC as n3,gD as s3,gE as o3,gF as r3,gG as a3,gH as l3,gI as i3,gJ as c3,gK as Fy,gL as Vy,gM as u3,gN as d3,gO as Hy,gP as f3,gQ as $y,gR as h3,gS as Ux,gT as m3,gU as kd,gV as p3,gW as g3,gX as x3,gY as v3,gZ as C3,g_ as y3,g$ as b3,h0 as Zx,h1 as j3,h2 as S3,h3 as Wy,h4 as w3,h5 as k3,h6 as Gy,h7 as Uy,h8 as Zy,h9 as I3,ha as M3,hb as A3,hc as qy,hd as P3,he as xg,hf as D3,hg as E3,hh as _3,hi as ap,hj as qx,hk as Qx,hl as tl,hm as L3,hn as T3,ho as ir,hp as hf,hq as R3,hr as B3,hs as N3,ht as z3,hu as O3,hv as F3,hw as lp,hx as V3,hy as H3,hz as qu,hA as $3,hB as mf,hC as W3,hD as G3,hE as U3,hF as Qy,hG as Z3,hH as Ky,hI as q3,hJ as Q3,hK as K3,hL as Y3,hM as X3,hN as J3,hO as eA,hP as tA,hQ as nA,hR as Yy,hS as Xy,hT as ip,hU as sA,hV as Jy,hW as oA,hX as Kx,hY as vg,hZ as rA,h_ as eb,h$ as aA,i0 as Cg,i1 as pf,i2 as tb,i3 as lA,i4 as ur,i5 as iA,i6 as ui,i7 as nb,i8 as sb,i9 as cA,ia as Zi,ib as Dl,ic as uA,id as dA,ie as fA,ig as hA,ih as mA,ii as Yx,ij as Xx,ik as pA,il as gA,im as xA,io as vA,ip as Jx,iq as CA,ir as yA,is as bA,it as jA,iu as SA,iv as wA,iw as e2,ix as kA,iy as IA,iz as MA,iA as AA,iB as PA,iC as DA,iD as EA,iE as _A,iF as LA,iG as TA,iH as Pc,iI as RA,iJ as BA,iK as NA,iL as zA,iM as OA,iN as FA,iO as VA,iP as HA,iQ as $A,iR as WA,iS as GA,iT as UA,iU as dn,iV as Fr,iW as ic,iX as ob,iY as rb,iZ as Id,i_ as ZA,i$ as qA,j0 as Vi,j1 as Md,j2 as hd,j3 as yg,j4 as bg,j5 as QA,j6 as KA,j7 as YA,j8 as cc,j9 as XA,ja as jg,jb as ab,jc as JA,jd as e9,je as t9,jf as n9,jg as qi,jh as s9,ji as o9,jj as r9,jk as a9,jl as t2,jm as md,jn as l9,jo as lb,jp as kl,jq as i9,jr as c9,js as u9,jt as d9,ju as f9,jv as n2,jw as h9,jx as m9,jy as p9,jz as g9,jA as x9,jB as ib,jC as v9,jD as C9,jE as y9,jF as b9,jG as j9,jH as ym,jI as Qu,jJ as Ku,jK as El,jL as Qi,jM as Hi,jN as s2,jO as bm,jP as o2,jQ as S9,jR as cb,jS as w9,jT as k9,jU as I9,jV as M9,jW as A9,jX as P9,jY as D9,jZ as E9,j_ as _9,j$ as L9,k0 as T9,k1 as R9,k2 as B9,k3 as N9,k4 as jm,k5 as z9,k6 as O9,k7 as F9,k8 as V9,k9 as H9,ka as $9,kb as W9,kc as G9,kd as r2,ke as U9,kf as Z9,kg as q9,kh as Q9,ki as K9,kj as Y9,kk as X9,kl as J9,km as e7,kn as t7}from"./index-DN8M6F76.js";var Sm=function(){return Z6.Date.now()},n7="Expected a function",s7=Math.max,o7=Math.min;function r7(e,t,n){var o,r,a,c,d,f,m=0,h=!1,g=!1,x=!0;if(typeof e!="function")throw new TypeError(n7);t=Tx(t)||0,q6(n)&&(h=!!n.leading,g="maxWait"in n,a=g?s7(Tx(n.maxWait)||0,t):a,x="trailing"in n?!!n.trailing:x);function C(A){var N=o,W=r;return o=r=void 0,m=A,c=e.apply(W,N),c}function j(A){return m=A,d=setTimeout(I,t),h?C(A):c}function S(A){var N=A-f,W=A-m,G=t-N;return g?o7(G,a-W):G}function M(A){var N=A-f,W=A-m;return f===void 0||N>=t||N<0||g&&W>=a}function I(){var A=Sm();if(M(A))return k(A);d=setTimeout(I,S(A))}function k(A){return d=void 0,x&&o?C(A):(o=r=void 0,c)}function D(){d!==void 0&&clearTimeout(d),m=0,o=f=r=d=void 0}function T(){return d===void 0?c:k(Sm())}function E(){var A=Sm(),N=M(A);if(o=arguments,r=this,f=A,N){if(d===void 0)return j(f);if(g)return clearTimeout(d),d=setTimeout(I,t),C(f)}return d===void 0&&(d=setTimeout(I,t)),c}return E.cancel=D,E.flush=T,E}function a7(e,t){var n=-1,o=Q6(e)?Array(e.length):[];return K6(e,function(r,a,c){o[++n]=t(r,a,c)}),o}function Us(e,t){var n=jc(e)?X6:a7;return n(e,Y6(t))}var l7=Object.prototype,i7=l7.hasOwnProperty,c7=J6(function(e,t,n){i7.call(e,n)?e[n].push(t):e5(e,n,[t])});function ln(e){return e==null}const ub=({id:e,x:t,y:n,width:o,height:r,style:a,color:c,strokeColor:d,strokeWidth:f,className:m,borderRadius:h,shapeRendering:g,onClick:x,selected:C})=>{const{background:j,backgroundColor:S}=a||{},M=c||j||S;return q.createElement("rect",{className:Gp(["react-flow__minimap-node",{selected:C},m]),x:t,y:n,rx:h,ry:h,width:o,height:r,fill:M,stroke:d,strokeWidth:f,shapeRendering:g,onClick:x?I=>x(I,e):void 0})};ub.displayName="MiniMapNode";var u7=u.memo(ub);const d7=e=>e.nodeOrigin,f7=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),wm=e=>e instanceof Function?e:()=>e;function h7({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:r=2,nodeComponent:a=u7,onClick:c}){const d=jd(f7,Up),f=jd(d7),m=wm(t),h=wm(e),g=wm(n),x=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return q.createElement(q.Fragment,null,d.map(C=>{const{x:j,y:S}=t5(C,f).positionAbsolute;return q.createElement(a,{key:C.id,x:j,y:S,width:C.width,height:C.height,style:C.style,selected:C.selected,className:g(C),color:m(C),borderRadius:o,strokeColor:h(C),strokeWidth:r,shapeRendering:x,onClick:c,id:C.id})}))}var m7=u.memo(h7);const p7=200,g7=150,x7=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?i5(c5(t,e.nodeOrigin),n):n,rfId:e.rfId}},v7="react-flow__minimap-desc";function db({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:o="#e2e2e2",nodeClassName:r="",nodeBorderRadius:a=5,nodeStrokeWidth:c=2,nodeComponent:d,maskColor:f="rgb(240, 240, 240, 0.6)",maskStrokeColor:m="none",maskStrokeWidth:h=1,position:g="bottom-right",onClick:x,onNodeClick:C,pannable:j=!1,zoomable:S=!1,ariaLabel:M="React Flow mini map",inversePan:I=!1,zoomStep:k=10,offsetScale:D=5}){const T=n5(),E=u.useRef(null),{boundingRect:A,viewBB:N,rfId:W}=jd(x7,Up),G=(e==null?void 0:e.width)??p7,z=(e==null?void 0:e.height)??g7,X=A.width/G,B=A.height/z,Q=Math.max(X,B),V=Q*G,H=Q*z,me=D*Q,Ie=A.x-(V-A.width)/2-me,ye=A.y-(H-A.height)/2-me,de=V+me*2,He=H+me*2,Be=`${v7}-${W}`,ce=u.useRef(0);ce.current=Q,u.useEffect(()=>{if(E.current){const be=s5(E.current),ee=oe=>{const{transform:le,d3Selection:fe,d3Zoom:he}=T.getState();if(oe.sourceEvent.type!=="wheel"||!fe||!he)return;const ke=-oe.sourceEvent.deltaY*(oe.sourceEvent.deltaMode===1?.05:oe.sourceEvent.deltaMode?1:.002)*k,ze=le[2]*Math.pow(2,ke);he.scaleTo(fe,ze)},J=oe=>{const{transform:le,d3Selection:fe,d3Zoom:he,translateExtent:ke,width:ze,height:$e}=T.getState();if(oe.sourceEvent.type!=="mousemove"||!fe||!he)return;const Je=ce.current*Math.max(1,le[2])*(I?-1:1),gt={x:le[0]-oe.sourceEvent.movementX*Je,y:le[1]-oe.sourceEvent.movementY*Je},R=[[0,0],[ze,$e]],Z=a5.translate(gt.x,gt.y).scale(le[2]),ne=he.constrain()(Z,R,ke);he.transform(fe,ne)},F=o5().on("zoom",j?J:null).on("zoom.wheel",S?ee:null);return be.call(F),()=>{be.on("zoom",null)}}},[j,S,I,k]);const ue=x?be=>{const ee=l5(be);x(be,{x:ee[0],y:ee[1]})}:void 0,je=C?(be,ee)=>{const J=T.getState().nodeInternals.get(ee);C(be,J)}:void 0;return q.createElement(r5,{position:g,style:e,className:Gp(["react-flow__minimap",t]),"data-testid":"rf__minimap"},q.createElement("svg",{width:G,height:z,viewBox:`${Ie} ${ye} ${de} ${He}`,role:"img","aria-labelledby":Be,ref:E,onClick:ue},M&&q.createElement("title",{id:Be},M),q.createElement(m7,{onClick:je,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:a,nodeClassName:r,nodeStrokeWidth:c,nodeComponent:d}),q.createElement("path",{className:"react-flow__minimap-mask",d:`M${Ie-me},${ye-me}h${de+me*2}v${He+me*2}h${-de-me*2}z
        M${N.x},${N.y}h${N.width}v${N.height}h${-N.width}z`,fill:f,fillRule:"evenodd",stroke:m,strokeWidth:h,pointerEvents:"none"})))}db.displayName="MiniMap";var C7=u.memo(db),ho;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(ho||(ho={}));function y7({color:e,dimensions:t,lineWidth:n}){return q.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function b7({color:e,radius:t}){return q.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const j7={[ho.Dots]:"#91919a",[ho.Lines]:"#eee",[ho.Cross]:"#e2e2e2"},S7={[ho.Dots]:1,[ho.Lines]:1,[ho.Cross]:6},w7=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function fb({id:e,variant:t=ho.Dots,gap:n=20,size:o,lineWidth:r=1,offset:a=2,color:c,style:d,className:f}){const m=u.useRef(null),{transform:h,patternId:g}=jd(w7,Up),x=c||j7[t],C=o||S7[t],j=t===ho.Dots,S=t===ho.Cross,M=Array.isArray(n)?n:[n,n],I=[M[0]*h[2]||1,M[1]*h[2]||1],k=C*h[2],D=S?[k,k]:I,T=j?[k/a,k/a]:[D[0]/a,D[1]/a];return q.createElement("svg",{className:Gp(["react-flow__background",f]),style:{...d,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:m,"data-testid":"rf__background"},q.createElement("pattern",{id:g+e,x:h[0]%I[0],y:h[1]%I[1],width:I[0],height:I[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${T[0]},-${T[1]})`},j?q.createElement(b7,{color:x,radius:k/a}):q.createElement(y7,{dimensions:D,color:x,lineWidth:r})),q.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${g+e})`}))}fb.displayName="Background";var k7=u.memo(fb);const hb=e=>{const t=b(r=>r.system.consoleLogLevel),n=b(r=>r.system.shouldLogToConsole);return u.useEffect(()=>{n?(localStorage.setItem("ROARR_LOG","true"),localStorage.setItem("ROARR_FILTER",`context.logLevel:>=${u5[t]}`)):localStorage.setItem("ROARR_LOG","false"),Rx.ROARR.write=d5.createLogWriter()},[t,n]),u.useEffect(()=>{const r={...f5};h5.set(Rx.Roarr.child(r))},[]),u.useMemo(()=>m5(e),[e])};function cp(){return cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},cp.apply(this,arguments)}var mb=["shift","alt","meta","mod","ctrl"],I7={esc:"escape",return:"enter",".":"period",",":"comma","-":"slash"," ":"space","`":"backquote","#":"backslash","+":"bracketright",ShiftLeft:"shift",ShiftRight:"shift",AltLeft:"alt",AltRight:"alt",MetaLeft:"meta",MetaRight:"meta",OSLeft:"meta",OSRight:"meta",ControlLeft:"ctrl",ControlRight:"ctrl"};function Vr(e){return(I7[e]||e).trim().toLowerCase().replace(/key|digit|numpad|arrow/,"")}function M7(e){return mb.includes(e)}function km(e,t){return t===void 0&&(t=","),e.split(t)}function Im(e,t,n){t===void 0&&(t="+");var o=e.toLocaleLowerCase().split(t).map(function(c){return Vr(c)}),r={alt:o.includes("alt"),ctrl:o.includes("ctrl")||o.includes("control"),shift:o.includes("shift"),meta:o.includes("meta"),mod:o.includes("mod")},a=o.filter(function(c){return!mb.includes(c)});return cp({},r,{keys:a,description:n})}(function(){typeof document<"u"&&(document.addEventListener("keydown",function(e){e.key!==void 0&&pb([Vr(e.key),Vr(e.code)])}),document.addEventListener("keyup",function(e){e.key!==void 0&&gb([Vr(e.key),Vr(e.code)])})),typeof window<"u"&&window.addEventListener("blur",function(){Hr.clear()})})();var Hr=new Set;function Sg(e){return Array.isArray(e)}function A7(e,t){t===void 0&&(t=",");var n=Sg(e)?e:e.split(t);return n.every(function(o){return Hr.has(o.trim().toLowerCase())})}function pb(e){var t=Array.isArray(e)?e:[e];Hr.has("meta")&&Hr.forEach(function(n){return!M7(n)&&Hr.delete(n.toLowerCase())}),t.forEach(function(n){return Hr.add(n.toLowerCase())})}function gb(e){var t=Array.isArray(e)?e:[e];e==="meta"?Hr.clear():t.forEach(function(n){return Hr.delete(n.toLowerCase())})}function P7(e,t,n){(typeof n=="function"&&n(e,t)||n===!0)&&e.preventDefault()}function D7(e,t,n){return typeof n=="function"?n(e,t):n===!0||n===void 0}function E7(e){return xb(e,["input","textarea","select"])}function xb(e,t){var n=e.target;t===void 0&&(t=!1);var o=n&&n.tagName;return Sg(t)?!!(o&&t&&t.some(function(r){return r.toLowerCase()===o.toLowerCase()})):!!(o&&t&&t===!0)}function _7(e,t){return e.length===0&&t?(console.warn('A hotkey has the "scopes" option set, however no active scopes were found. If you want to use the global scopes feature, you need to wrap your app in a <HotkeysProvider>'),!0):t?e.some(function(n){return t.includes(n)})||e.includes("*"):!0}var L7=function(t,n,o){o===void 0&&(o=!1);var r=n.alt,a=n.meta,c=n.mod,d=n.shift,f=n.ctrl,m=n.keys,h=t.key,g=t.code,x=t.ctrlKey,C=t.metaKey,j=t.shiftKey,S=t.altKey,M=Vr(g),I=h.toLowerCase();if(!(m!=null&&m.includes(M))&&!(m!=null&&m.includes(I))&&!["ctrl","control","unknown","meta","alt","shift","os"].includes(M))return!1;if(!o){if(r===!S&&I!=="alt"||d===!j&&I!=="shift")return!1;if(c){if(!C&&!x)return!1}else if(a===!C&&I!=="meta"&&I!=="os"||f===!x&&I!=="ctrl"&&I!=="control")return!1}return m&&m.length===1&&(m.includes(I)||m.includes(M))?!0:m?A7(m):!m},T7=u.createContext(void 0),R7=function(){return u.useContext(T7)};function vb(e,t){return e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(e).length===Object.keys(t).length&&Object.keys(e).reduce(function(n,o){return n&&vb(e[o],t[o])},!0):e===t}var B7=u.createContext({hotkeys:[],enabledScopes:[],toggleScope:function(){},enableScope:function(){},disableScope:function(){}}),N7=function(){return u.useContext(B7)};function z7(e){var t=u.useRef(void 0);return vb(t.current,e)||(t.current=e),t.current}var a2=function(t){t.stopPropagation(),t.preventDefault(),t.stopImmediatePropagation()},O7=typeof window<"u"?u.useLayoutEffect:u.useEffect;function Re(e,t,n,o){var r=u.useRef(null),a=u.useRef(!1),c=n instanceof Array?o instanceof Array?void 0:o:n,d=Sg(e)?e.join(c==null?void 0:c.splitKey):e,f=n instanceof Array?n:o instanceof Array?o:void 0,m=u.useCallback(t,f??[]),h=u.useRef(m);f?h.current=m:h.current=t;var g=z7(c),x=N7(),C=x.enabledScopes,j=R7();return O7(function(){if(!((g==null?void 0:g.enabled)===!1||!_7(C,g==null?void 0:g.scopes))){var S=function(T,E){var A;if(E===void 0&&(E=!1),!(E7(T)&&!xb(T,g==null?void 0:g.enableOnFormTags))){if(r.current!==null){var N=r.current.getRootNode();if((N instanceof Document||N instanceof ShadowRoot)&&N.activeElement!==r.current&&!r.current.contains(N.activeElement)){a2(T);return}}(A=T.target)!=null&&A.isContentEditable&&!(g!=null&&g.enableOnContentEditable)||km(d,g==null?void 0:g.splitKey).forEach(function(W){var G,z=Im(W,g==null?void 0:g.combinationKey);if(L7(T,z,g==null?void 0:g.ignoreModifiers)||(G=z.keys)!=null&&G.includes("*")){if(g!=null&&g.ignoreEventWhen!=null&&g.ignoreEventWhen(T)||E&&a.current)return;if(P7(T,z,g==null?void 0:g.preventDefault),!D7(T,z,g==null?void 0:g.enabled)){a2(T);return}h.current(T,z),E||(a.current=!0)}})}},M=function(T){T.key!==void 0&&(pb(Vr(T.code)),((g==null?void 0:g.keydown)===void 0&&(g==null?void 0:g.keyup)!==!0||g!=null&&g.keydown)&&S(T))},I=function(T){T.key!==void 0&&(gb(Vr(T.code)),a.current=!1,g!=null&&g.keyup&&S(T,!0))},k=r.current||(c==null?void 0:c.document)||document;return k.addEventListener("keyup",I),k.addEventListener("keydown",M),j&&km(d,g==null?void 0:g.splitKey).forEach(function(D){return j.addHotkey(Im(D,g==null?void 0:g.combinationKey,g==null?void 0:g.description))}),function(){k.removeEventListener("keyup",I),k.removeEventListener("keydown",M),j&&km(d,g==null?void 0:g.splitKey).forEach(function(D){return j.removeHotkey(Im(D,g==null?void 0:g.combinationKey,g==null?void 0:g.description))})}}},[d,g,C]),r}const F7={opacity:0},V7={opacity:1,transition:{duration:.1}},H7={opacity:0,transition:{duration:.1}},$7=e=>{const{t}=L(),{dropzone:n,setIsHandlingUpload:o}=e;return Re("esc",()=>{o(!1)},[o]),s.jsxs(Ae,{initial:F7,animate:V7,exit:H7,as:Oa.div,position:"absolute",top:0,insetInlineStart:0,width:"100vw",height:"100vh",zIndex:999,backdropFilter:"blur(20px)",children:[s.jsx(P,{position:"absolute",top:0,insetInlineStart:0,w:"full",h:"full",bg:"base.900",opacity:.7,alignItems:"center",justifyContent:"center",transitionProperty:"common",transitionDuration:"0.1s"}),s.jsx(P,{position:"absolute",top:0,insetInlineStart:0,width:"full",height:"full",alignItems:"center",justifyContent:"center",p:4,children:s.jsx(P,{width:"full",height:"full",alignItems:"center",justifyContent:"center",flexDir:"column",gap:4,borderWidth:3,borderRadius:"xl",borderStyle:"dashed",color:"base.100",borderColor:"base.200",children:n.isDragAccept?s.jsx(sn,{size:"lg",children:t("gallery.dropToUpload")}):s.jsxs(s.Fragment,{children:[s.jsx(sn,{size:"lg",children:t("toast.invalidUpload")}),s.jsx(sn,{size:"md",children:t("toast.uploadFailedInvalidUploadDesc")})]})})})]},"image-upload-overlay")},W7=u.memo($7),Cb=()=>u.useCallback(()=>{p5(),localStorage.clear()},[]),G7=()=>{const e=O(),t=b(o=>o.system.toastQueue),n=na();return u.useEffect(()=>{t.forEach(o=>{n(o)}),t.length>0&&e(g5())},[e,n,t]),null},Uo=()=>{const e=O();return u.useCallback(n=>e(Ze(pt(n))),[e])},U7=u.memo(G7);var yb={exports:{}},Z7="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",q7=Z7,Q7=q7;function bb(){}function jb(){}jb.resetWarningCache=bb;var K7=function(){function e(o,r,a,c,d,f){if(f!==Q7){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:jb,resetWarningCache:bb};return n.PropTypes=n,n};yb.exports=K7();var Y7=yb.exports;const Rt=Xd(Y7);function di(e,t,n,o){function r(a){return a instanceof n?a:new n(function(c){c(a)})}return new(n||(n=Promise))(function(a,c){function d(h){try{m(o.next(h))}catch(g){c(g)}}function f(h){try{m(o.throw(h))}catch(g){c(g)}}function m(h){h.done?a(h.value):r(h.value).then(d,f)}m((o=o.apply(e,t||[])).next())})}function fi(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},o,r,a,c;return c={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function d(m){return function(h){return f([m,h])}}function f(m){if(o)throw new TypeError("Generator is already executing.");for(;c&&(c=0,m[0]&&(n=0)),n;)try{if(o=1,r&&(a=m[0]&2?r.return:m[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,m[1])).done)return a;switch(r=0,a&&(m=[m[0]&2,a.value]),m[0]){case 0:case 1:a=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,r=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!a||m[1]>a[0]&&m[1]<a[3])){n.label=m[1];break}if(m[0]===6&&n.label<a[1]){n.label=a[1],a=m;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(m);break}a[2]&&n.ops.pop(),n.trys.pop();continue}m=t.call(e,n)}catch(h){m=[6,h],r=0}finally{o=a=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}function l2(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var o=n.call(e),r,a=[],c;try{for(;(t===void 0||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(d){c={error:d}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(c)throw c.error}}return a}function i2(e,t,n){if(n||arguments.length===2)for(var o=0,r=t.length,a;o<r;o++)(a||!(o in t))&&(a||(a=Array.prototype.slice.call(t,0,o)),a[o]=t[o]);return e.concat(a||Array.prototype.slice.call(t))}var X7=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function Dc(e,t){var n=J7(e);if(typeof n.path!="string"){var o=e.webkitRelativePath;Object.defineProperty(n,"path",{value:typeof t=="string"?t:typeof o=="string"&&o.length>0?o:e.name,writable:!1,configurable:!1,enumerable:!0})}return n}function J7(e){var t=e.name,n=t&&t.lastIndexOf(".")!==-1;if(n&&!e.type){var o=t.split(".").pop().toLowerCase(),r=X7.get(o);r&&Object.defineProperty(e,"type",{value:r,writable:!1,configurable:!1,enumerable:!0})}return e}var eP=[".DS_Store","Thumbs.db"];function tP(e){return di(this,void 0,void 0,function(){return fi(this,function(t){return Ad(e)&&nP(e.dataTransfer)?[2,aP(e.dataTransfer,e.type)]:sP(e)?[2,oP(e)]:Array.isArray(e)&&e.every(function(n){return"getFile"in n&&typeof n.getFile=="function"})?[2,rP(e)]:[2,[]]})})}function nP(e){return Ad(e)}function sP(e){return Ad(e)&&Ad(e.target)}function Ad(e){return typeof e=="object"&&e!==null}function oP(e){return up(e.target.files).map(function(t){return Dc(t)})}function rP(e){return di(this,void 0,void 0,function(){var t;return fi(this,function(n){switch(n.label){case 0:return[4,Promise.all(e.map(function(o){return o.getFile()}))];case 1:return t=n.sent(),[2,t.map(function(o){return Dc(o)})]}})})}function aP(e,t){return di(this,void 0,void 0,function(){var n,o;return fi(this,function(r){switch(r.label){case 0:return e.items?(n=up(e.items).filter(function(a){return a.kind==="file"}),t!=="drop"?[2,n]:[4,Promise.all(n.map(lP))]):[3,2];case 1:return o=r.sent(),[2,c2(Sb(o))];case 2:return[2,c2(up(e.files).map(function(a){return Dc(a)}))]}})})}function c2(e){return e.filter(function(t){return eP.indexOf(t.name)===-1})}function up(e){if(e===null)return[];for(var t=[],n=0;n<e.length;n++){var o=e[n];t.push(o)}return t}function lP(e){if(typeof e.webkitGetAsEntry!="function")return u2(e);var t=e.webkitGetAsEntry();return t&&t.isDirectory?wb(t):u2(e)}function Sb(e){return e.reduce(function(t,n){return i2(i2([],l2(t),!1),l2(Array.isArray(n)?Sb(n):[n]),!1)},[])}function u2(e){var t=e.getAsFile();if(!t)return Promise.reject("".concat(e," is not a File"));var n=Dc(t);return Promise.resolve(n)}function iP(e){return di(this,void 0,void 0,function(){return fi(this,function(t){return[2,e.isDirectory?wb(e):cP(e)]})})}function wb(e){var t=e.createReader();return new Promise(function(n,o){var r=[];function a(){var c=this;t.readEntries(function(d){return di(c,void 0,void 0,function(){var f,m,h;return fi(this,function(g){switch(g.label){case 0:if(d.length)return[3,5];g.label=1;case 1:return g.trys.push([1,3,,4]),[4,Promise.all(r)];case 2:return f=g.sent(),n(f),[3,4];case 3:return m=g.sent(),o(m),[3,4];case 4:return[3,6];case 5:h=Promise.all(d.map(iP)),r.push(h),a(),g.label=6;case 6:return[2]}})})},function(d){o(d)})}a()})}function cP(e){return di(this,void 0,void 0,function(){return fi(this,function(t){return[2,new Promise(function(n,o){e.file(function(r){var a=Dc(r,e.fullPath);n(a)},function(r){o(r)})})]})})}var uP=function(e,t){if(e&&t){var n=Array.isArray(t)?t:t.split(","),o=e.name||"",r=(e.type||"").toLowerCase(),a=r.replace(/\/.*$/,"");return n.some(function(c){var d=c.trim().toLowerCase();return d.charAt(0)==="."?o.toLowerCase().endsWith(d):d.endsWith("/*")?a===d.replace(/\/.*$/,""):r===d})}return!0};function d2(e){return hP(e)||fP(e)||Ib(e)||dP()}function dP(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fP(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hP(e){if(Array.isArray(e))return dp(e)}function f2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,o)}return n}function h2(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?f2(Object(n),!0).forEach(function(o){kb(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f2(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function kb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uc(e,t){return gP(e)||pP(e,t)||Ib(e,t)||mP()}function mP(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ib(e,t){if(e){if(typeof e=="string")return dp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dp(e,t)}}function dp(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function pP(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var o=[],r=!0,a=!1,c,d;try{for(n=n.call(e);!(r=(c=n.next()).done)&&(o.push(c.value),!(t&&o.length===t));r=!0);}catch(f){a=!0,d=f}finally{try{!r&&n.return!=null&&n.return()}finally{if(a)throw d}}return o}}function gP(e){if(Array.isArray(e))return e}var xP="file-invalid-type",vP="file-too-large",CP="file-too-small",yP="too-many-files",bP=function(t){t=Array.isArray(t)&&t.length===1?t[0]:t;var n=Array.isArray(t)?"one of ".concat(t.join(", ")):t;return{code:xP,message:"File type must be ".concat(n)}},m2=function(t){return{code:vP,message:"File is larger than ".concat(t," ").concat(t===1?"byte":"bytes")}},p2=function(t){return{code:CP,message:"File is smaller than ".concat(t," ").concat(t===1?"byte":"bytes")}},jP={code:yP,message:"Too many files"};function Mb(e,t){var n=e.type==="application/x-moz-file"||uP(e,t);return[n,n?null:bP(t)]}function Ab(e,t,n){if(_a(e.size))if(_a(t)&&_a(n)){if(e.size>n)return[!1,m2(n)];if(e.size<t)return[!1,p2(t)]}else{if(_a(t)&&e.size<t)return[!1,p2(t)];if(_a(n)&&e.size>n)return[!1,m2(n)]}return[!0,null]}function _a(e){return e!=null}function SP(e){var t=e.files,n=e.accept,o=e.minSize,r=e.maxSize,a=e.multiple,c=e.maxFiles,d=e.validator;return!a&&t.length>1||a&&c>=1&&t.length>c?!1:t.every(function(f){var m=Mb(f,n),h=uc(m,1),g=h[0],x=Ab(f,o,r),C=uc(x,1),j=C[0],S=d?d(f):null;return g&&j&&!S})}function Pd(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function Yu(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(t){return t==="Files"||t==="application/x-moz-file"}):!!e.target&&!!e.target.files}function g2(e){e.preventDefault()}function wP(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function kP(e){return e.indexOf("Edge/")!==-1}function IP(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return wP(e)||kP(e)}function Mo(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(o){for(var r=arguments.length,a=new Array(r>1?r-1:0),c=1;c<r;c++)a[c-1]=arguments[c];return t.some(function(d){return!Pd(o)&&d&&d.apply(void 0,[o].concat(a)),Pd(o)})}}function MP(){return"showOpenFilePicker"in window}function AP(e){if(_a(e)){var t=Object.entries(e).filter(function(n){var o=uc(n,2),r=o[0],a=o[1],c=!0;return Pb(r)||(console.warn('Skipped "'.concat(r,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),c=!1),(!Array.isArray(a)||!a.every(Db))&&(console.warn('Skipped "'.concat(r,'" because an invalid file extension was provided.')),c=!1),c}).reduce(function(n,o){var r=uc(o,2),a=r[0],c=r[1];return h2(h2({},n),{},kb({},a,c))},{});return[{description:"Files",accept:t}]}return e}function PP(e){if(_a(e))return Object.entries(e).reduce(function(t,n){var o=uc(n,2),r=o[0],a=o[1];return[].concat(d2(t),[r],d2(a))},[]).filter(function(t){return Pb(t)||Db(t)}).join(",")}function DP(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function EP(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function Pb(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function Db(e){return/^.*\.[\w]+$/.test(e)}var _P=["children"],LP=["open"],TP=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],RP=["refKey","onChange","onClick"];function BP(e){return OP(e)||zP(e)||Eb(e)||NP()}function NP(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zP(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function OP(e){if(Array.isArray(e))return fp(e)}function Mm(e,t){return HP(e)||VP(e,t)||Eb(e,t)||FP()}function FP(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eb(e,t){if(e){if(typeof e=="string")return fp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fp(e,t)}}function fp(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function VP(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var o=[],r=!0,a=!1,c,d;try{for(n=n.call(e);!(r=(c=n.next()).done)&&(o.push(c.value),!(t&&o.length===t));r=!0);}catch(f){a=!0,d=f}finally{try{!r&&n.return!=null&&n.return()}finally{if(a)throw d}}return o}}function HP(e){if(Array.isArray(e))return e}function x2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,o)}return n}function en(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?x2(Object(n),!0).forEach(function(o){hp(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x2(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function hp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dd(e,t){if(e==null)return{};var n=$P(e,t),o,r;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)o=a[r],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function $P(e,t){if(e==null)return{};var n={},o=Object.keys(e),r,a;for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&(n[r]=e[r]);return n}var wg=u.forwardRef(function(e,t){var n=e.children,o=Dd(e,_P),r=hi(o),a=r.open,c=Dd(r,LP);return u.useImperativeHandle(t,function(){return{open:a}},[a]),q.createElement(u.Fragment,null,n(en(en({},c),{},{open:a})))});wg.displayName="Dropzone";var _b={disabled:!1,getFilesFromEvent:tP,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0,autoFocus:!1};wg.defaultProps=_b;wg.propTypes={children:Rt.func,accept:Rt.objectOf(Rt.arrayOf(Rt.string)),multiple:Rt.bool,preventDropOnDocument:Rt.bool,noClick:Rt.bool,noKeyboard:Rt.bool,noDrag:Rt.bool,noDragEventsBubbling:Rt.bool,minSize:Rt.number,maxSize:Rt.number,maxFiles:Rt.number,disabled:Rt.bool,getFilesFromEvent:Rt.func,onFileDialogCancel:Rt.func,onFileDialogOpen:Rt.func,useFsAccessApi:Rt.bool,autoFocus:Rt.bool,onDragEnter:Rt.func,onDragLeave:Rt.func,onDragOver:Rt.func,onDrop:Rt.func,onDropAccepted:Rt.func,onDropRejected:Rt.func,onError:Rt.func,validator:Rt.func};var mp={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function hi(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=en(en({},_b),e),n=t.accept,o=t.disabled,r=t.getFilesFromEvent,a=t.maxSize,c=t.minSize,d=t.multiple,f=t.maxFiles,m=t.onDragEnter,h=t.onDragLeave,g=t.onDragOver,x=t.onDrop,C=t.onDropAccepted,j=t.onDropRejected,S=t.onFileDialogCancel,M=t.onFileDialogOpen,I=t.useFsAccessApi,k=t.autoFocus,D=t.preventDropOnDocument,T=t.noClick,E=t.noKeyboard,A=t.noDrag,N=t.noDragEventsBubbling,W=t.onError,G=t.validator,z=u.useMemo(function(){return PP(n)},[n]),X=u.useMemo(function(){return AP(n)},[n]),B=u.useMemo(function(){return typeof M=="function"?M:v2},[M]),Q=u.useMemo(function(){return typeof S=="function"?S:v2},[S]),V=u.useRef(null),H=u.useRef(null),me=u.useReducer(WP,mp),Ie=Mm(me,2),ye=Ie[0],de=Ie[1],He=ye.isFocused,Be=ye.isFileDialogActive,ce=u.useRef(typeof window<"u"&&window.isSecureContext&&I&&MP()),ue=function(){!ce.current&&Be&&setTimeout(function(){if(H.current){var Ce=H.current.files;Ce.length||(de({type:"closeDialog"}),Q())}},300)};u.useEffect(function(){return window.addEventListener("focus",ue,!1),function(){window.removeEventListener("focus",ue,!1)}},[H,Be,Q,ce]);var je=u.useRef([]),be=function(Ce){V.current&&V.current.contains(Ce.target)||(Ce.preventDefault(),je.current=[])};u.useEffect(function(){return D&&(document.addEventListener("dragover",g2,!1),document.addEventListener("drop",be,!1)),function(){D&&(document.removeEventListener("dragover",g2),document.removeEventListener("drop",be))}},[V,D]),u.useEffect(function(){return!o&&k&&V.current&&V.current.focus(),function(){}},[V,k,o]);var ee=u.useCallback(function(te){W?W(te):console.error(te)},[W]),J=u.useCallback(function(te){te.preventDefault(),te.persist(),ne(te),je.current=[].concat(BP(je.current),[te.target]),Yu(te)&&Promise.resolve(r(te)).then(function(Ce){if(!(Pd(te)&&!N)){var Ue=Ce.length,tt=Ue>0&&SP({files:Ce,accept:z,minSize:c,maxSize:a,multiple:d,maxFiles:f,validator:G}),wt=Ue>0&&!tt;de({isDragAccept:tt,isDragReject:wt,isDragActive:!0,type:"setDraggedFiles"}),m&&m(te)}}).catch(function(Ce){return ee(Ce)})},[r,m,ee,N,z,c,a,d,f,G]),F=u.useCallback(function(te){te.preventDefault(),te.persist(),ne(te);var Ce=Yu(te);if(Ce&&te.dataTransfer)try{te.dataTransfer.dropEffect="copy"}catch{}return Ce&&g&&g(te),!1},[g,N]),oe=u.useCallback(function(te){te.preventDefault(),te.persist(),ne(te);var Ce=je.current.filter(function(tt){return V.current&&V.current.contains(tt)}),Ue=Ce.indexOf(te.target);Ue!==-1&&Ce.splice(Ue,1),je.current=Ce,!(Ce.length>0)&&(de({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),Yu(te)&&h&&h(te))},[V,h,N]),le=u.useCallback(function(te,Ce){var Ue=[],tt=[];te.forEach(function(wt){var Zt=Mb(wt,z),Ft=Mm(Zt,2),on=Ft[0],is=Ft[1],xn=Ab(wt,c,a),Yn=Mm(xn,2),Bn=Yn[0],Ps=Yn[1],cs=G?G(wt):null;if(on&&Bn&&!cs)Ue.push(wt);else{var us=[is,Ps];cs&&(us=us.concat(cs)),tt.push({file:wt,errors:us.filter(function(eo){return eo})})}}),(!d&&Ue.length>1||d&&f>=1&&Ue.length>f)&&(Ue.forEach(function(wt){tt.push({file:wt,errors:[jP]})}),Ue.splice(0)),de({acceptedFiles:Ue,fileRejections:tt,type:"setFiles"}),x&&x(Ue,tt,Ce),tt.length>0&&j&&j(tt,Ce),Ue.length>0&&C&&C(Ue,Ce)},[de,d,z,c,a,f,x,C,j,G]),fe=u.useCallback(function(te){te.preventDefault(),te.persist(),ne(te),je.current=[],Yu(te)&&Promise.resolve(r(te)).then(function(Ce){Pd(te)&&!N||le(Ce,te)}).catch(function(Ce){return ee(Ce)}),de({type:"reset"})},[r,le,ee,N]),he=u.useCallback(function(){if(ce.current){de({type:"openDialog"}),B();var te={multiple:d,types:X};window.showOpenFilePicker(te).then(function(Ce){return r(Ce)}).then(function(Ce){le(Ce,null),de({type:"closeDialog"})}).catch(function(Ce){DP(Ce)?(Q(Ce),de({type:"closeDialog"})):EP(Ce)?(ce.current=!1,H.current?(H.current.value=null,H.current.click()):ee(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):ee(Ce)});return}H.current&&(de({type:"openDialog"}),B(),H.current.value=null,H.current.click())},[de,B,Q,I,le,ee,X,d]),ke=u.useCallback(function(te){!V.current||!V.current.isEqualNode(te.target)||(te.key===" "||te.key==="Enter"||te.keyCode===32||te.keyCode===13)&&(te.preventDefault(),he())},[V,he]),ze=u.useCallback(function(){de({type:"focus"})},[]),$e=u.useCallback(function(){de({type:"blur"})},[]),Je=u.useCallback(function(){T||(IP()?setTimeout(he,0):he())},[T,he]),gt=function(Ce){return o?null:Ce},R=function(Ce){return E?null:gt(Ce)},Z=function(Ce){return A?null:gt(Ce)},ne=function(Ce){N&&Ce.stopPropagation()},ge=u.useMemo(function(){return function(){var te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ce=te.refKey,Ue=Ce===void 0?"ref":Ce,tt=te.role,wt=te.onKeyDown,Zt=te.onFocus,Ft=te.onBlur,on=te.onClick,is=te.onDragEnter,xn=te.onDragOver,Yn=te.onDragLeave,Bn=te.onDrop,Ps=Dd(te,TP);return en(en(hp({onKeyDown:R(Mo(wt,ke)),onFocus:R(Mo(Zt,ze)),onBlur:R(Mo(Ft,$e)),onClick:gt(Mo(on,Je)),onDragEnter:Z(Mo(is,J)),onDragOver:Z(Mo(xn,F)),onDragLeave:Z(Mo(Yn,oe)),onDrop:Z(Mo(Bn,fe)),role:typeof tt=="string"&&tt!==""?tt:"presentation"},Ue,V),!o&&!E?{tabIndex:0}:{}),Ps)}},[V,ke,ze,$e,Je,J,F,oe,fe,E,A,o]),xe=u.useCallback(function(te){te.stopPropagation()},[]),pe=u.useMemo(function(){return function(){var te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ce=te.refKey,Ue=Ce===void 0?"ref":Ce,tt=te.onChange,wt=te.onClick,Zt=Dd(te,RP),Ft=hp({accept:z,multiple:d,type:"file",style:{display:"none"},onChange:gt(Mo(tt,fe)),onClick:gt(Mo(wt,xe)),tabIndex:-1},Ue,H);return en(en({},Ft),Zt)}},[H,n,d,fe,o]);return en(en({},ye),{},{isFocused:He&&!o,getRootProps:ge,getInputProps:pe,rootRef:V,inputRef:H,open:gt(he)})}function WP(e,t){switch(t.type){case"focus":return en(en({},e),{},{isFocused:!0});case"blur":return en(en({},e),{},{isFocused:!1});case"openDialog":return en(en({},mp),{},{isFileDialogActive:!0});case"closeDialog":return en(en({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return en(en({},e),{},{isDragActive:t.isDragActive,isDragAccept:t.isDragAccept,isDragReject:t.isDragReject});case"setFiles":return en(en({},e),{},{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections});case"reset":return en({},mp);default:return e}}function v2(){}const GP={"image/png":[".png"],"image/jpeg":[".jpg",".jpeg",".png"]},UP=Ve(ys,e=>{let t={type:"TOAST"};return e==="unifiedCanvas"&&(t={type:"SET_CANVAS_INITIAL_IMAGE"}),e==="img2img"&&(t={type:"SET_INITIAL_IMAGE"}),t}),ZP=()=>{const{t:e}=L(),t=Uo(),n=b(UP),o=b(x=>x.gallery.autoAddBoardId),[r,a]=u.useState(!1),[c]=vC(),d=u.useCallback(x=>{a(!0),t({title:e("toast.uploadFailed"),description:x.errors.map(C=>C.message).join(`
`),status:"error"})},[e,t]),f=u.useCallback(async x=>{c({file:x,image_category:"user",is_intermediate:!1,postUploadAction:n,board_id:o==="none"?void 0:o})},[o,n,c]),m=u.useCallback((x,C)=>{if(C.length>1){t({title:e("toast.uploadFailed"),description:e("toast.uploadFailedInvalidUploadDesc"),status:"error"});return}C.forEach(j=>{d(j)}),x.forEach(j=>{f(j)})},[e,t,f,d]),h=u.useCallback(()=>{a(!0)},[]),g=hi({accept:GP,noClick:!0,onDrop:m,onDragOver:h,multiple:!1,noKeyboard:!0});return u.useEffect(()=>{const x=async C=>{var j,S;g.inputRef.current&&(j=C.clipboardData)!=null&&j.files&&(g.inputRef.current.files=C.clipboardData.files,(S=g.inputRef.current)==null||S.dispatchEvent(new Event("change",{bubbles:!0})))};return document.addEventListener("paste",x),()=>{document.removeEventListener("paste",x)}},[g.inputRef]),{dropzone:g,isHandlingUpload:r,setIsHandlingUpload:a}},kg=()=>{const e=b(m=>m.system.isConnected),{data:t}=$o(),[n,{isLoading:o}]=Zp(),r=O(),{t:a}=L(),c=u.useMemo(()=>t==null?void 0:t.queue.item_id,[t==null?void 0:t.queue.item_id]),d=u.useCallback(async()=>{if(c)try{await n(c).unwrap(),r(Ze({title:a("queue.cancelSucceeded"),status:"success"}))}catch{r(Ze({title:a("queue.cancelFailed"),status:"error"}))}},[c,r,a,n]),f=u.useMemo(()=>!e||ln(c),[e,c]);return{cancelQueueItem:d,isLoading:o,currentQueueItemId:c,isDisabled:f}},Ec=()=>{const{t:e}=L(),t=O(),{data:n}=$o(),o=b(f=>f.system.isConnected),[r,{isLoading:a}]=CC({fixedCacheKey:"clearQueue"}),c=u.useCallback(async()=>{if(n!=null&&n.queue.total)try{await r().unwrap(),t(Ze({title:e("queue.clearSucceeded"),status:"success"})),t(qp(void 0)),t(Qp(void 0))}catch{t(Ze({title:e("queue.clearFailed"),status:"error"}))}},[n==null?void 0:n.queue.total,r,t,e]),d=u.useMemo(()=>!o||!(n!=null&&n.queue.total),[o,n==null?void 0:n.queue.total]);return{clearQueue:c,isLoading:a,queueStatus:n,isDisabled:d}},qP=Ve([Rn,bs,ni,lt,Kp,ys],(e,t,n,o,r,a)=>{const{initialImage:c,model:d,positivePrompt:f}=t,{isConnected:m}=n,h=[];return m||h.push(rn.t("parameters.invoke.systemDisconnected")),a==="img2img"&&!c&&h.push(rn.t("parameters.invoke.noInitialImageSelected")),a==="nodes"?o.shouldValidateGraph&&(o.nodes.length||h.push(rn.t("parameters.invoke.noNodesInGraph")),o.nodes.forEach(g=>{if(!Zr(g))return;const x=o.templates[g.data.type];if(!x){h.push(rn.t("parameters.invoke.missingNodeTemplate"));return}const C=x5([g],o.edges);v5(g.data.inputs,j=>{const S=x.inputs[j.name],M=C.some(I=>I.target===g.id&&I.targetHandle===j.name);if(!S){h.push(rn.t("parameters.invoke.missingFieldTemplate"));return}if(S.required&&j.value===void 0&&!M){h.push(rn.t("parameters.invoke.missingInputForField",{nodeLabel:g.data.label||x.title,fieldLabel:j.label||S.title}));return}})})):(r.prompts.length===0&&yC(f)&&h.push(rn.t("parameters.invoke.noPrompts")),d||h.push(rn.t("parameters.invoke.noModelSelected")),C5(e).forEach((g,x)=>{g.isEnabled&&(g.model?g.model.base!==(d==null?void 0:d.base)&&h.push(rn.t("parameters.invoke.incompatibleBaseModelForControlAdapter",{number:x+1})):h.push(rn.t("parameters.invoke.noModelForControlAdapter",{number:x+1})),(!g.controlImage||si(g)&&!g.processedControlImage&&g.processorType!=="none")&&h.push(rn.t("parameters.invoke.noControlImageForControlAdapter",{number:x+1})))})),{isReady:!h.length,reasons:h}}),Ig=()=>{const{isReady:e,reasons:t}=b(qP);return{isReady:e,reasons:t}},Mg=()=>{const e=O(),t=b(ys),{isReady:n}=Ig(),[o,{isLoading:r}]=Jd({fixedCacheKey:"enqueueBatch"}),a=u.useMemo(()=>!n,[n]);return{queueBack:u.useCallback(()=>{a||e(bC({tabName:t,prepend:!1}))},[e,a,t]),isLoading:r,isDisabled:a}},cn=e=>{const t=b(c=>c.config.disabledTabs),n=b(c=>c.config.disabledFeatures),o=b(c=>c.config.disabledSDFeatures),r=u.useMemo(()=>n.includes(e)||o.includes(e)||t.includes(e),[n,o,t,e]),a=u.useMemo(()=>!(n.includes(e)||o.includes(e)||t.includes(e)),[n,o,t,e]);return{isFeatureDisabled:r,isFeatureEnabled:a}},Lb=()=>{const e=O(),t=b(ys),{isReady:n}=Ig(),[o,{isLoading:r}]=Jd({fixedCacheKey:"enqueueBatch"}),a=cn("prependQueue").isFeatureEnabled,c=u.useMemo(()=>!n||!a,[n,a]);return{queueFront:u.useCallback(()=>{c||e(bC({tabName:t,prepend:!0}))},[e,c,t]),isLoading:r,isDisabled:c}},QP=()=>{const e=O(),t=cn("modelManager").isFeatureEnabled,{queueBack:n,isDisabled:o,isLoading:r}=Mg();Re(["ctrl+enter","meta+enter"],n,{enabled:()=>!o&&!r,preventDefault:!0,enableOnFormTags:["input","textarea","select"]},[n,o,r]);const{queueFront:a,isDisabled:c,isLoading:d}=Lb();Re(["ctrl+shift+enter","meta+shift+enter"],a,{enabled:()=>!c&&!d,preventDefault:!0,enableOnFormTags:["input","textarea","select"]},[a,c,d]);const{cancelQueueItem:f,isDisabled:m,isLoading:h}=kg();Re(["shift+x"],f,{enabled:()=>!m&&!h,preventDefault:!0},[f,m,h]);const{clearQueue:g,isDisabled:x,isLoading:C}=Ec();Re(["ctrl+shift+x","meta+shift+x"],g,{enabled:()=>!x&&!C,preventDefault:!0},[g,x,C]),Re("1",()=>{e(zs("txt2img"))},[e]),Re("2",()=>{e(zs("img2img"))},[e]),Re("3",()=>{e(zs("unifiedCanvas"))},[e]),Re("4",()=>{e(zs("nodes"))},[e]),Re("5",()=>{t&&e(zs("modelManager"))},[e,t]),Re(t?"6":"5",()=>{e(zs("queue"))},[e,t])},KP=Ve(y5,e=>e.imagesToChange),YP=()=>{const e=O(),[t,n]=u.useState(),{data:o,isFetching:r}=Sc(),a=b(S=>S.changeBoardModal.isModalOpen),c=b(KP),[d]=b5(),[f]=j5(),{t:m}=L(),h=u.useMemo(()=>[{label:m("boards.uncategorized"),value:"none"}].concat((o??[]).map(S=>({label:S.board_name,value:S.board_id}))),[o,m]),g=u.useMemo(()=>h.find(S=>S.value===t),[h,t]),x=u.useCallback(()=>{e(Bx()),e(Yp(!1))},[e]),C=u.useCallback(()=>{!c.length||!t||(t==="none"?f({imageDTOs:c}):d({imageDTOs:c,board_id:t}),n(null),e(Bx()))},[d,e,c,f,t]),j=u.useCallback(S=>{S&&n(S.value)},[]);return s.jsx(sa,{isOpen:a,onClose:x,title:m("boards.changeBoard"),acceptCallback:C,acceptButtonText:m("boards.move"),cancelButtonText:m("boards.cancel"),children:s.jsxs(P,{flexDir:"column",gap:4,children:[s.jsxs(re,{children:[m("boards.movingImagesToBoard",{count:c.length}),":"]}),s.jsx($,{isDisabled:r,children:s.jsx(ot,{placeholder:m(r?"boards.loading":"boards.selectBoard"),onChange:j,value:g,options:h})})]})})},XP=u.memo(YP),JP=e=>{const{t}=L(),{imageUsage:n,topMessage:o=t("gallery.currentlyInUse"),bottomMessage:r=t("gallery.featuresWillReset")}=e;return!n||!fo(n)?null:s.jsxs(s.Fragment,{children:[s.jsx(re,{children:o}),s.jsxs(Xp,{paddingInlineStart:6,children:[n.isInitialImage&&s.jsx(To,{children:t("common.img2img")}),n.isCanvasImage&&s.jsx(To,{children:t("common.unifiedCanvas")}),n.isControlImage&&s.jsx(To,{children:t("common.controlNet")}),n.isNodesImage&&s.jsx(To,{children:t("common.nodeEditor")})]}),s.jsx(re,{children:r})]})},Tb=u.memo(JP),eD=Ve([S5,bs,js,lt,Rn,w5],(e,t,n,o,r,a)=>{const{imagesToDelete:c}=e,d=(c??[]).map(({image_name:m})=>jC(t,n,o,r,m)),f={isInitialImage:fo(d,m=>m.isInitialImage),isCanvasImage:fo(d,m=>m.isCanvasImage),isNodesImage:fo(d,m=>m.isNodesImage),isControlImage:fo(d,m=>m.isControlImage)};return{imagesToDelete:c,imagesUsage:a,imageUsageSummary:f}}),tD=()=>{const e=O(),{t}=L(),n=b(g=>g.system.shouldConfirmOnDelete),o=b(g=>g.config.canRestoreDeletedImagesFromBin),r=b(g=>g.deleteImageModal.isModalOpen),{imagesToDelete:a,imagesUsage:c,imageUsageSummary:d}=b(eD),f=u.useCallback(g=>e(SC(!g.target.checked)),[e]),m=u.useCallback(()=>{e(Nx()),e(k5(!1))},[e]),h=u.useCallback(()=>{!a.length||!c.length||(e(Nx()),e(I5({imageDTOs:a,imagesUsage:c})))},[e,a,c]);return s.jsx(sa,{title:t("gallery.deleteImage"),isOpen:r,onClose:m,cancelButtonText:t("boards.cancel"),acceptButtonText:t("controlnet.delete"),acceptCallback:h,children:s.jsxs(P,{direction:"column",gap:3,children:[s.jsx(Tb,{imageUsage:d}),s.jsx(An,{}),s.jsx(re,{children:t(o?"gallery.deleteImageBin":"gallery.deleteImagePermanent")}),s.jsx(re,{children:t("common.areYouSure")}),s.jsxs($,{children:[s.jsx(Y,{children:t("common.dontAskMeAgain")}),s.jsx(jt,{isChecked:!n,onChange:f})]})]})})},nD=u.memo(tD),Am=Za(!1),Rb=()=>{const e=yt(Am),t=u.useCallback(()=>{Am.set(!0)},[]),n=u.useCallback(()=>{Am.set(!1)},[]);return{isOpen:e,onOpen:t,onClose:n}};var Bb={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},C2=q.createContext&&q.createContext(Bb),sD=["attr","size","title"];function oD(e,t){if(e==null)return{};var n=rD(e,t),o,r;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)o=a[r],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function rD(e,t){if(e==null)return{};var n={},o=Object.keys(e),r,a;for(a=0;a<o.length;a++)r=o[a],!(t.indexOf(r)>=0)&&(n[r]=e[r]);return n}function Ed(){return Ed=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Ed.apply(this,arguments)}function y2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,o)}return n}function _d(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?y2(Object(n),!0).forEach(function(o){aD(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y2(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function aD(e,t,n){return t=lD(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lD(e){var t=iD(e,"string");return typeof t=="symbol"?t:String(t)}function iD(e,t){if(typeof e!="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nb(e){return e&&e.map((t,n)=>q.createElement(t.tag,_d({key:n},t.attr),Nb(t.child)))}function Se(e){return t=>q.createElement(cD,Ed({attr:_d({},e.attr)},t),Nb(e.child))}function cD(e){var t=n=>{var{attr:o,size:r,title:a}=e,c=oD(e,sD),d=r||n.size||"1em",f;return n.className&&(f=n.className),e.className&&(f=(f?f+" ":"")+e.className),q.createElement("svg",Ed({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,o,c,{className:f,style:_d(_d({color:e.color||n.color},n.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),a&&q.createElement("title",null,a),e.children)};return C2!==void 0?q.createElement(C2.Consumer,null,n=>t(n)):t(Bb)}function uD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M236,200a12,12,0,0,1-24,0,84.09,84.09,0,0,0-84-84H61l27.52,27.51a12,12,0,0,1-17,17l-48-48a12,12,0,0,1,0-17l48-48a12,12,0,0,1,17,17L61,92h67A108.12,108.12,0,0,1,236,200Z"},child:[]}]})(e)}function dD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M244,56v48a12,12,0,0,1-12,12H184a12,12,0,1,1,0-24H201.1l-19-17.38c-.13-.12-.26-.24-.38-.37A76,76,0,1,0,127,204h1a75.53,75.53,0,0,0,52.15-20.72,12,12,0,0,1,16.49,17.45A99.45,99.45,0,0,1,128,228h-1.37A100,100,0,1,1,198.51,57.06L220,76.72V56a12,12,0,0,1,24,0Z"},child:[]}]})(e)}function ca(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,128a100,100,0,0,1-98.66,100H128a99.39,99.39,0,0,1-68.62-27.29,12,12,0,0,1,16.48-17.45,76,76,0,1,0-1.57-109c-.13.13-.25.25-.39.37L54.89,92H72a12,12,0,0,1,0,24H24a12,12,0,0,1-12-12V56a12,12,0,0,1,24,0V76.72L57.48,57.06A100,100,0,0,1,228,128Z"},child:[]}]})(e)}function fD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,128a12,12,0,0,1-12,12H69l51.52,51.51a12,12,0,0,1-17,17l-72-72a12,12,0,0,1,0-17l72-72a12,12,0,0,1,17,17L69,116H216A12,12,0,0,1,228,128Z"},child:[]}]})(e)}function hD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M224.49,136.49l-72,72a12,12,0,0,1-17-17L187,140H40a12,12,0,0,1,0-24H187L135.51,64.48a12,12,0,0,1,17-17l72,72A12,12,0,0,1,224.49,136.49Z"},child:[]}]})(e)}function zb(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,104a12,12,0,0,1-24,0V69l-59.51,59.51a12,12,0,0,1-17-17L187,52H152a12,12,0,0,1,0-24h64a12,12,0,0,1,12,12Zm-44,24a12,12,0,0,0-12,12v64H52V84h64a12,12,0,0,0,0-24H48A20,20,0,0,0,28,80V208a20,20,0,0,0,20,20H176a20,20,0,0,0,20-20V140A12,12,0,0,0,184,128Z"},child:[]}]})(e)}function mD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M200.49,183.51a12,12,0,0,1,0,17c-1.13,1.12-28,27.51-72.49,27.51-33.71,0-59.35-17.46-76-33.86V208a12,12,0,0,1-24,0V160a12,12,0,0,1,12-12H88a12,12,0,0,1,0,24H64.12c13.1,14.32,35.08,32,63.88,32,34.63,0,55.31-20.28,55.51-20.49A12,12,0,0,1,200.49,183.51ZM216,36a12,12,0,0,0-12,12V61.86C187.35,45.46,161.71,28,128,28,83.54,28,56.64,54.39,55.51,55.51a12,12,0,0,0,17,17C72.69,72.28,93.37,52,128,52c28.8,0,50.78,17.68,63.88,32H168a12,12,0,0,0,0,24h48a12,12,0,0,0,12-12V48A12,12,0,0,0,216,36Z"},child:[]}]})(e)}function Ob(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M88,108H40A12,12,0,0,1,28,96V48a12,12,0,0,1,24,0V61.86C68.65,45.46,94.29,28,128,28c44.46,0,71.36,26.39,72.49,27.51a12,12,0,0,1-16.94,17C183.11,72.09,162,52,128,52,99,52,77.06,69.68,64,84H88a12,12,0,0,1,0,24Zm128,40H168a12,12,0,0,0,0,24h24c-13,14.32-35,32-64,32-34,0-55.11-20.09-55.55-20.52a12,12,0,0,0-16.94,17C56.64,201.61,83.54,228,128,228c33.71,0,59.35-17.46,76-33.86V208a12,12,0,0,0,24,0V160A12,12,0,0,0,216,148Z"},child:[]}]})(e)}function pD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M120.49,167.51a12,12,0,0,1,0,17l-32,32a12,12,0,0,1-17,0l-32-32a12,12,0,1,1,17-17L68,179V48a12,12,0,0,1,24,0V179l11.51-11.52A12,12,0,0,1,120.49,167.51Zm96-96-32-32a12,12,0,0,0-17,0l-32,32a12,12,0,0,0,17,17L164,77V208a12,12,0,0,0,24,0V77l11.51,11.52a12,12,0,0,0,17-17Z"},child:[]}]})(e)}function Fb(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M218.29,182.17a12,12,0,0,1-16.47,4.12L140,149.19V216a12,12,0,0,1-24,0V149.19l-61.82,37.1a12,12,0,1,1-12.35-20.58L104.68,128,41.83,90.29A12,12,0,1,1,54.18,69.71L116,106.81V40a12,12,0,0,1,24,0v66.81l61.82-37.1a12,12,0,1,1,12.35,20.58L151.32,128l62.85,37.71A12,12,0,0,1,218.29,182.17Z"},child:[]}]})(e)}function gD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M224,152a12,12,0,0,0,0-24H212V112h12a12,12,0,0,0,0-24H210.45a83.7,83.7,0,0,0-18.78-38.7l16.82-16.81a12,12,0,0,0-17-17l-18,18a83.7,83.7,0,0,0-91.1,0l-18-18a12,12,0,0,0-17,17L64.33,49.3A83.7,83.7,0,0,0,45.55,88H32a12,12,0,0,0,0,24H44v16H32a12,12,0,0,0,0,24H44a83.55,83.55,0,0,0,1.55,16H32a12,12,0,0,0,0,24H54.15a84,84,0,0,0,147.7,0H224a12,12,0,0,0,0-24H210.45A83.55,83.55,0,0,0,212,152ZM128,44a60.1,60.1,0,0,1,57.82,44H70.18A60.1,60.1,0,0,1,128,44Zm12,166.79V140a12,12,0,0,0-24,0v70.79A60.09,60.09,0,0,1,68,152V112H188v40A60.09,60.09,0,0,1,140,210.79Z"},child:[]}]})(e)}function xD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M144.49,136.49l-80,80a12,12,0,0,1-17-17L119,128,47.51,56.49a12,12,0,0,1,17-17l80,80A12,12,0,0,1,144.49,136.49Zm80-17-80-80a12,12,0,1,0-17,17L199,128l-71.52,71.51a12,12,0,0,0,17,17l80-80A12,12,0,0,0,224.49,119.51Z"},child:[]}]})(e)}function Vb(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M168.49,199.51a12,12,0,0,1-17,17l-80-80a12,12,0,0,1,0-17l80-80a12,12,0,0,1,17,17L97,128Z"},child:[]}]})(e)}function Hb(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M184.49,136.49l-80,80a12,12,0,0,1-17-17L159,128,87.51,56.49a12,12,0,1,1,17-17l80,80A12,12,0,0,1,184.49,136.49Z"},child:[]}]})(e)}function Ag(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216.49,168.49a12,12,0,0,1-17,0L128,97,56.49,168.49a12,12,0,0,1-17-17l80-80a12,12,0,0,1,17,0l80,80A12,12,0,0,1,216.49,168.49Z"},child:[]}]})(e)}function _c(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M232.49,80.49l-128,128a12,12,0,0,1-17,0l-56-56a12,12,0,1,1,17-17L96,183,215.51,63.51a12,12,0,0,1,17,17Z"},child:[]}]})(e)}function vD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M236,128a108,108,0,0,1-216,0c0-42.52,24.73-81.34,63-98.9A12,12,0,1,1,93,50.91C63.24,64.57,44,94.83,44,128a84,84,0,0,0,168,0c0-33.17-19.24-63.43-49-77.09A12,12,0,1,1,173,29.1C211.27,46.66,236,85.48,236,128Z"},child:[]}]})(e)}function CD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M71.68,97.22,34.74,128l36.94,30.78a12,12,0,1,1-15.36,18.44l-48-40a12,12,0,0,1,0-18.44l48-40A12,12,0,0,1,71.68,97.22Zm176,21.56-48-40a12,12,0,1,0-15.36,18.44L221.26,128l-36.94,30.78a12,12,0,1,0,15.36,18.44l48-40a12,12,0,0,0,0-18.44ZM164.1,28.72a12,12,0,0,0-15.38,7.18l-64,176a12,12,0,0,0,7.18,15.37A11.79,11.79,0,0,0,96,228a12,12,0,0,0,11.28-7.9l64-176A12,12,0,0,0,164.1,28.72Z"},child:[]}]})(e)}function nl(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216,28H88A12,12,0,0,0,76,40V76H40A12,12,0,0,0,28,88V216a12,12,0,0,0,12,12H168a12,12,0,0,0,12-12V180h36a12,12,0,0,0,12-12V40A12,12,0,0,0,216,28ZM156,204H52V100H156Zm48-48H180V88a12,12,0,0,0-12-12H100V52H204Z"},child:[]}]})(e)}function yD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M128,20A108,108,0,1,0,236,128,108.12,108.12,0,0,0,128,20Zm12,191.13V184a12,12,0,0,0-24,0v27.13A84.18,84.18,0,0,1,44.87,140H72a12,12,0,0,0,0-24H44.87A84.18,84.18,0,0,1,116,44.87V72a12,12,0,0,0,24,0V44.87A84.18,84.18,0,0,1,211.13,116H184a12,12,0,0,0,0,24h27.13A84.18,84.18,0,0,1,140,211.13Z"},child:[]}]})(e)}function bD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M108,60A16,16,0,1,1,92,44,16,16,0,0,1,108,60Zm56,16a16,16,0,1,0-16-16A16,16,0,0,0,164,76ZM92,112a16,16,0,1,0,16,16A16,16,0,0,0,92,112Zm72,0a16,16,0,1,0,16,16A16,16,0,0,0,164,112ZM92,180a16,16,0,1,0,16,16A16,16,0,0,0,92,180Zm72,0a16,16,0,1,0,16,16A16,16,0,0,0,164,180Z"},child:[]}]})(e)}function jD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M71.51,88.49a12,12,0,0,1,17-17L116,99V24a12,12,0,0,1,24,0V99l27.51-27.52a12,12,0,0,1,17,17l-48,48a12,12,0,0,1-17,0ZM224,116H188a12,12,0,0,0,0,24h32v56H36V140H68a12,12,0,0,0,0-24H32a20,20,0,0,0-20,20v64a20,20,0,0,0,20,20H224a20,20,0,0,0,20-20V136A20,20,0,0,0,224,116Zm-20,52a16,16,0,1,0-16,16A16,16,0,0,0,204,168Z"},child:[]}]})(e)}function Lc(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,152v56a20,20,0,0,1-20,20H48a20,20,0,0,1-20-20V152a12,12,0,0,1,24,0v52H204V152a12,12,0,0,1,24,0Zm-108.49,8.49a12,12,0,0,0,17,0l40-40a12,12,0,0,0-17-17L140,123V40a12,12,0,0,0-24,0v83L96.49,103.51a12,12,0,0,0-17,17Z"},child:[]}]})(e)}function SD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216,204H141l86.84-86.84a28,28,0,0,0,0-39.6L186.43,36.19a28,28,0,0,0-39.6,0L28.19,154.82a28,28,0,0,0,0,39.6l30.06,30.07A12,12,0,0,0,66.74,228H216a12,12,0,0,0,0-24ZM163.8,53.16a4,4,0,0,1,5.66,0l41.38,41.38a4,4,0,0,1,0,5.65L160,151l-47-47ZM71.71,204,45.16,177.45a4,4,0,0,1,0-5.65L96,121l47,47-36,36Z"},child:[]}]})(e)}function $b(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M178,78A84,84,0,1,0,78,178,84,84,0,1,0,178,78Zm42,82a60.75,60.75,0,0,1-.38,6.65l-44-44a83.31,83.31,0,0,0,4-19.34A60.09,60.09,0,0,1,220,160Zm-119.84-4.16a60.07,60.07,0,0,1,55.68-55.68A60.07,60.07,0,0,1,100.16,155.84Zm52.51-79.5a83.31,83.31,0,0,0-19.34,4l-44-44A60.75,60.75,0,0,1,96,36,60.09,60.09,0,0,1,152.67,76.34ZM64.19,45.16l46.73,46.73a85,85,0,0,0-19,19L45.16,64.19A60.45,60.45,0,0,1,64.19,45.16ZM36,96a60.75,60.75,0,0,1,.38-6.65l44,44a83.31,83.31,0,0,0-4,19.34A60.09,60.09,0,0,1,36,96Zm67.33,83.66a83.31,83.31,0,0,0,19.34-4l44,44A60.75,60.75,0,0,1,160,220,60.09,60.09,0,0,1,103.33,179.66Zm88.48,31.18-46.73-46.73a85,85,0,0,0,19-19l46.73,46.73A60.45,60.45,0,0,1,191.81,210.84Z"},child:[]}]})(e)}function Wb(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M251,123.13c-.37-.81-9.13-20.26-28.48-39.61C196.63,57.67,164,44,128,44S59.37,57.67,33.51,83.52C14.16,102.87,5.4,122.32,5,123.13a12.08,12.08,0,0,0,0,9.75c.37.82,9.13,20.26,28.49,39.61C59.37,198.34,92,212,128,212s68.63-13.66,94.48-39.51c19.36-19.35,28.12-38.79,28.49-39.61A12.08,12.08,0,0,0,251,123.13Zm-46.06,33C183.47,177.27,157.59,188,128,188s-55.47-10.73-76.91-31.88A130.36,130.36,0,0,1,29.52,128,130.45,130.45,0,0,1,51.09,99.89C72.54,78.73,98.41,68,128,68s55.46,10.73,76.91,31.89A130.36,130.36,0,0,1,226.48,128,130.45,130.45,0,0,1,204.91,156.12ZM128,84a44,44,0,1,0,44,44A44.05,44.05,0,0,0,128,84Zm0,64a20,20,0,1,1,20-20A20,20,0,0,1,128,148Z"},child:[]}]})(e)}function wD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M56.88,31.93A12,12,0,1,0,39.12,48.07l16,17.65C20.67,88.66,5.72,121.58,5,123.13a12.08,12.08,0,0,0,0,9.75c.37.82,9.13,20.26,28.49,39.61C59.37,198.34,92,212,128,212a131.34,131.34,0,0,0,51-10l20.09,22.1a12,12,0,0,0,17.76-16.14ZM128,188c-29.59,0-55.47-10.73-76.91-31.88A130.69,130.69,0,0,1,29.52,128c5.27-9.31,18.79-29.9,42-44.29l90.09,99.11A109.33,109.33,0,0,1,128,188Zm123-55.12c-.36.81-9,20-28,39.16a12,12,0,1,1-17-16.9A130.48,130.48,0,0,0,226.48,128a130.36,130.36,0,0,0-21.57-28.12C183.46,78.73,157.59,68,128,68c-3.35,0-6.7.14-10,.42a12,12,0,1,1-2-23.91c3.93-.34,8-.51,12-.51,36,0,68.63,13.67,94.49,39.52,19.35,19.35,28.11,38.8,28.48,39.61A12.08,12.08,0,0,1,251,132.88Z"},child:[]}]})(e)}function kD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,67.24a39.77,39.77,0,0,0-12.51-28.52C199.91,24,174.71,24.5,159.29,39.93L142.48,56.84a28,28,0,0,0-35.64,3.29l-9,9a20,20,0,0,0-.73,27.49L48.9,144.84A43.76,43.76,0,0,0,37,185.28l-7.5,17.19a17.66,17.66,0,0,0,3.71,19.65,19.9,19.9,0,0,0,22.15,4.19l16.31-7.13a43.88,43.88,0,0,0,39.45-12.09l48.24-48.26a20,20,0,0,0,27.47-.73l9-9a28.06,28.06,0,0,0,3.26-35.72l17.23-17.33A39.69,39.69,0,0,0,228,67.24ZM94.15,190.11a20,20,0,0,1-20,5,11.93,11.93,0,0,0-8.32.47L57,199.38,60.69,191a12,12,0,0,0,.37-8.64,19.92,19.92,0,0,1,4.81-20.55l48.2-48.22,28.28,28.3Zm105.14-111-25.37,25.52a12,12,0,0,0,0,16.95l4.88,4.89a4,4,0,0,1,0,5.66l-6.14,6.15-55-55.05,6.14-6.14a4,4,0,0,1,5.65,0L134.35,82a12,12,0,0,0,8.49,3.51h0A12,12,0,0,0,151.34,82l24.94-25.08c6.3-6.3,16.48-6.63,22.71-.74a16,16,0,0,1,.3,23Z"},child:[]}]})(e)}function Gb(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216.49,79.51l-56-56A12,12,0,0,0,152,20H56A20,20,0,0,0,36,40V216a20,20,0,0,0,20,20H200a20,20,0,0,0,20-20V88A12,12,0,0,0,216.49,79.51ZM160,57l23,23H160ZM60,212V44h76V92a12,12,0,0,0,12,12h48V212Zm104-60a12,12,0,0,1-12,12H140v12a12,12,0,0,1-24,0V164H104a12,12,0,0,1,0-24h12V128a12,12,0,0,1,24,0v12h12A12,12,0,0,1,164,152Z"},child:[]}]})(e)}function ID(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M225.15,197.71,164,95.81V44h4a12,12,0,0,0,0-24H88a12,12,0,0,0,0,24h4V95.81L30.85,197.71A20,20,0,0,0,48,228H208a20,20,0,0,0,17.15-30.29ZM140,44V99.14a12,12,0,0,0,1.71,6.17l35.13,58.54c-10.79.86-25.15-1.31-43.42-10.56-14-7.08-27.46-11.33-40.27-12.76l21.14-35.22A12,12,0,0,0,116,99.14V44ZM55.06,204,79,164.19c13-1.11,27.62,2.42,43.62,10.52,19.61,9.92,36.25,13.31,49.85,13.31A75.44,75.44,0,0,0,190.11,186l10.83,18Z"},child:[]}]})(e)}function Tc(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M222.14,77.17,178.83,33.86A19.86,19.86,0,0,0,164.69,28H48A20,20,0,0,0,28,48V208a20,20,0,0,0,20,20H208a20,20,0,0,0,20-20V91.31A19.86,19.86,0,0,0,222.14,77.17ZM164,204H92V156h72Zm40,0H188V152a20,20,0,0,0-20-20H88a20,20,0,0,0-20,20v52H52V52H163l41,41ZM164,80a12,12,0,0,1-12,12H96a12,12,0,0,1,0-24h56A12,12,0,0,1,164,80Z"},child:[]}]})(e)}function Pg(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M248.49,71.51l-32-32a12,12,0,0,0-17,17L211,68H192a77.43,77.43,0,0,0-30,7.1c-14.49,6.69-32.81,21-37.81,50.92-2.69,16.17-10.58,27.4-23.43,33.39A49.4,49.4,0,0,1,90,162.93a44,44,0,1,0,.53,24.28,74.05,74.05,0,0,0,19.2-5.54c14.52-6.45,32.91-20.66,38.09-51.7,2.58-15.48,10.48-26.49,23.49-32.75A55.13,55.13,0,0,1,192,92h19l-11.52,11.51a12,12,0,0,0,17,17l32-32A12,12,0,0,0,248.49,71.51ZM48,196a20,20,0,1,1,20-20A20,20,0,0,1,48,196Z"},child:[]}]})(e)}function MD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M248.23,112.31A20,20,0,0,0,232,104H220V88a20,20,0,0,0-20-20H132L105.34,48a20.12,20.12,0,0,0-12-4H40A20,20,0,0,0,20,64V208h0a12,12,0,0,0,12,12H211.1a12,12,0,0,0,11.33-8l28.49-81.47.06-.17A20,20,0,0,0,248.23,112.31ZM92,68l26.67,20a20.12,20.12,0,0,0,12,4H196v12H69.77a20,20,0,0,0-18.94,13.58L44,137.15V68ZM202.59,196H48.89l23.72-68H226.37Z"},child:[]}]})(e)}function Ub(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,56H160L133.33,36a20.12,20.12,0,0,0-12-4H76A20,20,0,0,0,56,52V72H36A20,20,0,0,0,16,92V204a20,20,0,0,0,20,20H188.89A19.13,19.13,0,0,0,208,204.89V184h20.89A19.13,19.13,0,0,0,248,164.89V76A20,20,0,0,0,228,56ZM184,200H40V96H80l26.67,20a20.12,20.12,0,0,0,12,4H184Zm40-40H208V116a20,20,0,0,0-20-20H120L93.33,76a20.12,20.12,0,0,0-12-4H80V56h40l26.67,20a20.12,20.12,0,0,0,12,4H224Z"},child:[]}]})(e)}function Zb(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M140,88a12,12,0,0,1,12-12h32a12,12,0,0,1,12,12v32a12,12,0,0,1-24,0V100H152A12,12,0,0,1,140,88ZM72,180h32a12,12,0,0,0,0-24H84V136a12,12,0,0,0-24,0v32A12,12,0,0,0,72,180ZM236,56V200a20,20,0,0,1-20,20H40a20,20,0,0,1-20-20V56A20,20,0,0,1,40,36H216A20,20,0,0,1,236,56Zm-24,4H44V196H212Z"},child:[]}]})(e)}function AD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M234.29,47.91A20,20,0,0,0,216,36H40A20,20,0,0,0,25.2,69.45l.12.14L92,140.75V216a20,20,0,0,0,31.1,16.64l32-21.33A20,20,0,0,0,164,194.66V140.75l66.67-71.16.12-.14A20,20,0,0,0,234.29,47.91Zm-88.88,77.58A19.93,19.93,0,0,0,140,139.17v53.35l-24,16V139.17a19.93,19.93,0,0,0-5.41-13.68L49.23,60H206.77Z"},child:[]}]})(e)}function qb(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M128,76a52,52,0,1,0,52,52A52.06,52.06,0,0,0,128,76Zm0,80a28,28,0,1,1,28-28A28,28,0,0,1,128,156Zm113.86-49.57A12,12,0,0,0,236,98.34L208.21,82.49l-.11-31.31a12,12,0,0,0-4.25-9.12,116,116,0,0,0-38-21.41,12,12,0,0,0-9.68.89L128,37.27,99.83,21.53a12,12,0,0,0-9.7-.9,116.06,116.06,0,0,0-38,21.47,12,12,0,0,0-4.24,9.1l-.14,31.34L20,98.35a12,12,0,0,0-5.85,8.11,110.7,110.7,0,0,0,0,43.11A12,12,0,0,0,20,157.66l27.82,15.85.11,31.31a12,12,0,0,0,4.25,9.12,116,116,0,0,0,38,21.41,12,12,0,0,0,9.68-.89L128,218.73l28.14,15.74a12,12,0,0,0,9.7.9,116.06,116.06,0,0,0,38-21.47,12,12,0,0,0,4.24-9.1l.14-31.34,27.81-15.81a12,12,0,0,0,5.85-8.11A110.7,110.7,0,0,0,241.86,106.43Zm-22.63,33.18-26.88,15.28a11.94,11.94,0,0,0-4.55,4.59c-.54,1-1.11,1.93-1.7,2.88a12,12,0,0,0-1.83,6.31L184.13,199a91.83,91.83,0,0,1-21.07,11.87l-27.15-15.19a12,12,0,0,0-5.86-1.53h-.29c-1.14,0-2.3,0-3.44,0a12.08,12.08,0,0,0-6.14,1.51L93,210.82A92.27,92.27,0,0,1,71.88,199l-.11-30.24a12,12,0,0,0-1.83-6.32c-.58-.94-1.16-1.91-1.7-2.88A11.92,11.92,0,0,0,63.7,155L36.8,139.63a86.53,86.53,0,0,1,0-23.24l26.88-15.28a12,12,0,0,0,4.55-4.58c.54-1,1.11-1.94,1.7-2.89a12,12,0,0,0,1.83-6.31L71.87,57A91.83,91.83,0,0,1,92.94,45.17l27.15,15.19a11.92,11.92,0,0,0,6.15,1.52c1.14,0,2.3,0,3.44,0a12.08,12.08,0,0,0,6.14-1.51L163,45.18A92.27,92.27,0,0,1,184.12,57l.11,30.24a12,12,0,0,0,1.83,6.32c.58.94,1.16,1.91,1.7,2.88A11.92,11.92,0,0,0,192.3,101l26.9,15.33A86.53,86.53,0,0,1,219.23,139.61Z"},child:[]}]})(e)}function PD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M250.18,105.17,186.71,41.25a100.11,100.11,0,0,0-141.43,0l-.13.14L31.37,55.61a12,12,0,1,0,17.24,16.7L62.32,58.16A75.68,75.68,0,0,1,77.49,46.43L119,88,25.85,181.16a20,20,0,0,0,0,28.29l20.69,20.69a20,20,0,0,0,28.28,0L168,137l1.51,1.51h0l23.65,23.66a20,20,0,0,0,28.29,0l28.69-28.7A20,20,0,0,0,250.18,105.17ZM60.68,210.34l-15-15L108,133l15,15ZM140,131l-15-15,19.51-19.51a12,12,0,0,0,0-17L102.24,37.24a75.94,75.94,0,0,1,67.47,20.95l31.44,31.67L178,113l-1.51-1.51a12,12,0,0,0-17,0Zm67.32,11.31L195,130l23.09-23.09,12.3,12.39Z"},child:[]}]})(e)}function DD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M188,76a31.85,31.85,0,0,0-11.21,2,32,32,0,0,0-48.79-11A32,32,0,0,0,76,92v16H68a32,32,0,0,0-32,32v12a92,92,0,0,0,184,0V108A32,32,0,0,0,188,76Zm8,76a68,68,0,0,1-136,0V140a8,8,0,0,1,8-8h8v20a12,12,0,0,0,24,0V92a8,8,0,0,1,16,0v28a12,12,0,0,0,24,0V92a8,8,0,0,1,16,0v28a12,12,0,0,0,24,0V108a8,8,0,0,1,16,0Z"},child:[]}]})(e)}function ED(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M184,20H72A20,20,0,0,0,52,40V76a20.1,20.1,0,0,0,8,16l48,36L60,164a20.1,20.1,0,0,0-8,16v36a20,20,0,0,0,20,20H184a20,20,0,0,0,20-20V180.36a20.13,20.13,0,0,0-7.94-16L147.9,128l48.16-36.4a20.13,20.13,0,0,0,7.94-16V40A20,20,0,0,0,184,20Zm-4,24V60H76V44Zm-52,69L89.33,84h77Zm52,99H76V182l52-39,52,39.33Z"},child:[]}]})(e)}function dc(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M144,96a16,16,0,1,1,16,16A16,16,0,0,1,144,96Zm92-40V200a20,20,0,0,1-20,20H40a20,20,0,0,1-20-20V56A20,20,0,0,1,40,36H216A20,20,0,0,1,236,56ZM44,60v79.72l33.86-33.86a20,20,0,0,1,28.28,0L147.31,147l17.18-17.17a20,20,0,0,1,28.28,0L212,149.09V60Zm0,136H162.34L92,125.66l-48,48Zm168,0V183l-33.37-33.37L164.28,164l32,32Z"},child:[]}]})(e)}function _D(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M208,28H48A20,20,0,0,0,28,48V208a20,20,0,0,0,20,20H208a20,20,0,0,0,20-20V48A20,20,0,0,0,208,28Zm-4,24v63.72L186.14,97.86a20,20,0,0,0-28.28,0L52,203.72V52ZM85.66,204,172,117.66l32,32V204ZM76,96a20,20,0,1,1,20,20A20,20,0,0,1,76,96Z"},child:[]}]})(e)}function LD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216,36H80A20,20,0,0,0,60,56V68H40A20,20,0,0,0,20,88V200a20,20,0,0,0,20,20H184a20,20,0,0,0,20-20V180h12a20,20,0,0,0,20-20V56A20,20,0,0,0,216,36ZM84,60H212v45.09l-3.23-3.23a20,20,0,0,0-28.28,0L165.31,117,130.14,81.86a20,20,0,0,0-28.28,0L84,99.72Zm96,136H44V92H60v68a20,20,0,0,0,20,20H180ZM84,156V133.66l32-32,40.83,40.83a12,12,0,0,0,17,0l20.83-20.83L212,139v17Z"},child:[]}]})(e)}function TD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M208,28H88A20,20,0,0,0,68,48V60H48A20,20,0,0,0,28,80V208a20,20,0,0,0,20,20H176a20,20,0,0,0,20-20V188h12a20,20,0,0,0,20-20V48A20,20,0,0,0,208,28ZM92,52H204v59.72l-9.86-9.86a20,20,0,0,0-28.28,0L103.72,164H92Zm80,152H52V84H68v84a20,20,0,0,0,20,20h84Zm-34.34-40L180,121.66l24,24V164ZM108,88a20,20,0,1,1,20,20A20,20,0,0,1,108,88Z"},child:[]}]})(e)}function Rc(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M108,84a16,16,0,1,1,16,16A16,16,0,0,1,108,84Zm128,44A108,108,0,1,1,128,20,108.12,108.12,0,0,1,236,128Zm-24,0a84,84,0,1,0-84,84A84.09,84.09,0,0,0,212,128Zm-72,36.68V132a20,20,0,0,0-20-20,12,12,0,0,0-4,23.32V168a20,20,0,0,0,20,20,12,12,0,0,0,4-23.32Z"},child:[]}]})(e)}function RD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M223.51,44h-191A20.51,20.51,0,0,0,12,64.49v127A20.51,20.51,0,0,0,32.49,212h191A20.51,20.51,0,0,0,244,191.51v-127A20.51,20.51,0,0,0,223.51,44ZM220,188H36V68H220ZM52,128a12,12,0,0,1,12-12H192a12,12,0,0,1,0,24H64A12,12,0,0,1,52,128Zm0-36A12,12,0,0,1,64,80H192a12,12,0,0,1,0,24H64A12,12,0,0,1,52,92Zm0,72a12,12,0,0,1,12-12h8a12,12,0,0,1,0,24H64A12,12,0,0,1,52,164Zm108,0a12,12,0,0,1-12,12H108a12,12,0,0,1,0-24h40A12,12,0,0,1,160,164Zm44,0a12,12,0,0,1-12,12h-8a12,12,0,0,1,0-24h8A12,12,0,0,1,204,164Z"},child:[]}]})(e)}function BD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M87.5,151.52l64-64a12,12,0,0,1,17,17l-64,64a12,12,0,0,1-17-17Zm131-114a60.08,60.08,0,0,0-84.87,0L103.51,67.61a12,12,0,0,0,17,17l30.07-30.06a36,36,0,0,1,50.93,50.92L171.4,135.52a12,12,0,1,0,17,17l30.08-30.06A60.09,60.09,0,0,0,218.45,37.55ZM135.52,171.4l-30.07,30.08a36,36,0,0,1-50.92-50.93l30.06-30.07a12,12,0,0,0-17-17L37.55,133.58a60,60,0,0,0,84.88,84.87l30.06-30.07a12,12,0,0,0-17-17Z"},child:[]}]})(e)}function ND(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M218.45,122.43l-30.08,30.06a12,12,0,0,1-17-17l30.08-30.07a36,36,0,0,0-50.93-50.92L120.48,84.59a12,12,0,0,1-17-17l30.07-30.06a60,60,0,0,1,84.87,84.88Zm-82.93,49-30.07,30.08a36,36,0,0,1-50.92-50.93l30.06-30.07a12,12,0,0,0-17-17L37.55,133.58a60,60,0,0,0,84.88,84.87l30.06-30.07a12,12,0,0,0-17-17Z"},child:[]}]})(e)}function zD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M208,76H100V56a28,28,0,0,1,28-28c13.51,0,25.65,9.62,28.24,22.39a12,12,0,1,0,23.52-4.78C174.87,21.5,153.1,4,128,4A52.06,52.06,0,0,0,76,56V76H48A20,20,0,0,0,28,96V208a20,20,0,0,0,20,20H208a20,20,0,0,0,20-20V96A20,20,0,0,0,208,76Zm-4,128H52V100H204Z"},child:[]}]})(e)}function OD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M156,112a12,12,0,0,1-12,12H80a12,12,0,0,1,0-24h64A12,12,0,0,1,156,112Zm76.49,120.49a12,12,0,0,1-17,0L168,185a92.12,92.12,0,1,1,17-17l47.54,47.53A12,12,0,0,1,232.49,232.49ZM112,180a68,68,0,1,0-68-68A68.08,68.08,0,0,0,112,180Z"},child:[]}]})(e)}function FD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M156,112a12,12,0,0,1-12,12H124v20a12,12,0,0,1-24,0V124H80a12,12,0,0,1,0-24h20V80a12,12,0,0,1,24,0v20h20A12,12,0,0,1,156,112Zm76.49,120.49a12,12,0,0,1-17,0L168,185a92.12,92.12,0,1,1,17-17l47.54,47.53A12,12,0,0,1,232.49,232.49ZM112,180a68,68,0,1,0-68-68A68.08,68.08,0,0,0,112,180Z"},child:[]}]})(e)}function VD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M128,60a44,44,0,1,0,44,44A44.05,44.05,0,0,0,128,60Zm0,64a20,20,0,1,1,20-20A20,20,0,0,1,128,124Zm0-112a92.1,92.1,0,0,0-92,92c0,77.36,81.64,135.4,85.12,137.83a12,12,0,0,0,13.76,0,259,259,0,0,0,42.18-39C205.15,170.57,220,136.37,220,104A92.1,92.1,0,0,0,128,12Zm31.3,174.71A249.35,249.35,0,0,1,128,216.89a249.35,249.35,0,0,1-31.3-30.18C80,167.37,60,137.31,60,104a68,68,0,0,1,136,0C196,137.31,176,167.37,159.3,186.71Z"},child:[]}]})(e)}function HD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,128a12,12,0,0,1-12,12H40a12,12,0,0,1,0-24H216A12,12,0,0,1,228,128Z"},child:[]}]})(e)}function $D(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M236,32a12,12,0,0,0-12-12c-44.78,0-90,48.54-115.9,82a64,64,0,0,0-80,62c0,12-3.1,22.71-9.23,31.76A43,43,0,0,1,9.4,206.05a11.88,11.88,0,0,0-4.91,13.38A12.07,12.07,0,0,0,16.11,228h76A64,64,0,0,0,154,148C187.49,122.05,236,76.8,236,32ZM209.62,46.39c-4,12.92-13.15,27.49-26.92,42.91-3,3.39-6.16,6.7-9.35,9.89a104.31,104.31,0,0,0-16.5-16.51c3.19-3.19,6.49-6.32,9.88-9.35C182.15,59.55,196.71,50.43,209.62,46.39ZM92.07,204H42a80.17,80.17,0,0,0,10.14-40,40,40,0,1,1,40,40Zm38.18-91.32c3.12-3.93,6.55-8.09,10.23-12.35a80.52,80.52,0,0,1,15.23,15.24c-4.26,3.68-8.42,7.11-12.35,10.23A64.43,64.43,0,0,0,130.25,112.68Z"},child:[]}]})(e)}function WD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M231.5,162.63a12,12,0,0,0-15,0C214,164.64,192,183,192,208a32,32,0,0,0,64,0C256,183,234,164.64,231.5,162.63ZM224,216a8,8,0,0,1-8-8c0-6.8,3.91-13.64,8-18.83,4.07,5.17,8,12,8,18.83A8,8,0,0,1,224,216Zm8.49-101L125,7.51a12,12,0,0,0-17,0L70.25,45.29,48.48,23.51a12,12,0,1,0-17,17L53.28,62.26,12.2,103.34a28,28,0,0,0,0,39.6L97.06,227.8a28,28,0,0,0,39.6,0L232.49,132A12,12,0,0,0,232.49,115Zm-112.8,95.83a4,4,0,0,1-5.66,0L29.17,126a4,4,0,0,1,0-5.66L70.25,79.23l21.27,21.26a36,36,0,1,0,17-17L87.23,62.26,116.52,33,207,123.48ZM124,104a12,12,0,1,1-12,12A12,12,0,0,1,124,104Z"},child:[]}]})(e)}function GD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M230.14,70.54,185.46,25.85a20,20,0,0,0-28.29,0L33.86,149.17A19.85,19.85,0,0,0,28,163.31V208a20,20,0,0,0,20,20H92.69a19.86,19.86,0,0,0,14.14-5.86L230.14,98.82a20,20,0,0,0,0-28.28ZM93,180l71-71,11,11-71,71ZM76,163,65,152l71-71,11,11ZM52,173l15.51,15.51h0L83,204H52ZM192,103,153,64l18.34-18.34,39,39Z"},child:[]}]})(e)}function Qb(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M251.62,39.65a12,12,0,0,0-11.27-11.27c-53.28-3.14-96.2,13.37-114.84,44.14-12.14,20-12.56,44.17-1.46,67.3a75.21,75.21,0,0,0-11.24,20l-9.7-9.7c7.19-16.77,6.43-34.11-2.4-48.69C86.73,78.36,54.89,66,15.55,68.28A12,12,0,0,0,4.28,79.55C2,118.89,14.36,150.73,37.45,164.71a49.76,49.76,0,0,0,26,7.27,57.54,57.54,0,0,0,22.7-4.87L108,189v27a12,12,0,0,0,24,0V186.51a51.63,51.63,0,0,1,9.49-29.95A76.81,76.81,0,0,0,173.58,164a64.92,64.92,0,0,0,33.9-9.46C238.25,135.85,254.76,92.92,251.62,39.65ZM49.88,144.18c-13.19-8-21.18-27.46-21.83-52.13,24.67.65,44.14,8.65,52.13,21.83a26,26,0,0,1,3.63,17L72.48,119.51a12,12,0,0,0-17,17l11.34,11.34A26.27,26.27,0,0,1,49.88,144.18ZM195.05,134c-10.66,6.45-23,7.67-35.81,3.76l37.25-37.24a12,12,0,0,0-17-17l-37.25,37.24C138.37,108,139.59,95.61,146,85c12.77-21.09,43-33.07,82-33C228.14,91,216.14,121.18,195.05,134Z"},child:[]}]})(e)}function Hs(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,128a12,12,0,0,1-12,12H140v76a12,12,0,0,1-24,0V140H40a12,12,0,0,1,0-24h76V40a12,12,0,0,1,24,0v76h76A12,12,0,0,1,228,128Z"},child:[]}]})(e)}function Kb(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M100,52H40A20,20,0,0,0,20,72v64a20,20,0,0,0,20,20H96v4a28,28,0,0,1-28,28,12,12,0,0,0,0,24,52.06,52.06,0,0,0,52-52V72A20,20,0,0,0,100,52Zm-4,80H44V76H96ZM216,52H156a20,20,0,0,0-20,20v64a20,20,0,0,0,20,20h56v4a28,28,0,0,1-28,28,12,12,0,0,0,0,24,52.06,52.06,0,0,0,52-52V72A20,20,0,0,0,216,52Zm-4,80H160V76h52Z"},child:[]}]})(e)}function Dg(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M238.15,70.54,185.46,17.86a20,20,0,0,0-28.29,0L17.85,157.17a20,20,0,0,0,0,28.29l52.69,52.68a20,20,0,0,0,28.29,0L238.15,98.83A20,20,0,0,0,238.15,70.54ZM84.68,218.34l-47-47L64,145l23.52,23.52a12,12,0,0,0,17-17L81,128l15-15,23.51,23.52a12,12,0,0,0,17-17L113,96l15-15,23.52,23.52a12,12,0,0,0,17-17L145,64l26.35-26.34,47,47Z"},child:[]}]})(e)}function Pm(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M240.49,103.52l-80-80A12,12,0,0,0,140,32V68.74c-25.76,3.12-53.66,15.89-76.75,35.47-29.16,24.74-47.32,56.69-51.14,90A16,16,0,0,0,39.67,207h0c10.46-11.14,47-45.74,100.33-50.42V192a12,12,0,0,0,20.48,8.48l80-80A12,12,0,0,0,240.49,103.52ZM164,163V144a12,12,0,0,0-12-12c-49,0-86.57,21.56-109.79,40.11,7.13-18.16,19.63-35.22,36.57-49.59C101.3,103.41,128.67,92,152,92a12,12,0,0,0,12-12V61l51,51Z"},child:[]}]})(e)}function UD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M240.49,175.51a12,12,0,0,1,0,17l-24,24a12,12,0,0,1-17-17L203,196h-2.09a76.17,76.17,0,0,1-61.85-31.83L97.38,105.78A52.1,52.1,0,0,0,55.06,84H32a12,12,0,0,1,0-24H55.06a76.17,76.17,0,0,1,61.85,31.83l41.71,58.39A52.1,52.1,0,0,0,200.94,172H203l-3.52-3.51a12,12,0,0,1,17-17Zm-95.62-72.62a12,12,0,0,0,16.93-1.13A52,52,0,0,1,200.94,84H203l-3.52,3.51a12,12,0,0,0,17,17l24-24a12,12,0,0,0,0-17l-24-24a12,12,0,0,0-17,17L203,60h-2.09a76,76,0,0,0-57.2,26A12,12,0,0,0,144.87,102.89Zm-33.74,50.22a12,12,0,0,0-16.93,1.13A52,52,0,0,1,55.06,172H32a12,12,0,0,0,0,24H55.06a76,76,0,0,0,57.2-26A12,12,0,0,0,111.13,153.11Z"},child:[]}]})(e)}function Yb(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M40,92H70.06a36,36,0,0,0,67.88,0H216a12,12,0,0,0,0-24H137.94a36,36,0,0,0-67.88,0H40a12,12,0,0,0,0,24Zm64-24A12,12,0,1,1,92,80,12,12,0,0,1,104,68Zm112,96H201.94a36,36,0,0,0-67.88,0H40a12,12,0,0,0,0,24h94.06a36,36,0,0,0,67.88,0H216a12,12,0,0,0,0-24Zm-48,24a12,12,0,1,1,12-12A12,12,0,0,1,168,188Z"},child:[]}]})(e)}function ZD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M234.36,170A12,12,0,0,1,230,186.37l-96,56a12,12,0,0,1-12.1,0l-96-56a12,12,0,0,1,12.09-20.74l90,52.48L218,165.63A12,12,0,0,1,234.36,170ZM218,117.63,128,170.11,38.05,117.63A12,12,0,0,0,26,138.37l96,56a12,12,0,0,0,12.1,0l96-56A12,12,0,0,0,218,117.63ZM20,80a12,12,0,0,1,6-10.37l96-56a12.06,12.06,0,0,1,12.1,0l96,56a12,12,0,0,1,0,20.74l-96,56a12,12,0,0,1-12.1,0l-96-56A12,12,0,0,1,20,80Zm35.82,0L128,122.11,200.18,80,128,37.89Z"},child:[]}]})(e)}function Eg(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M243,96.05a20,20,0,0,0-17.26-13.72l-57-4.93-22.3-53.14h0a20,20,0,0,0-36.82,0L87.29,77.4l-57,4.93A20,20,0,0,0,18.87,117.4l43.32,37.8-13,56.24A20,20,0,0,0,79,233.1l49-29.76,49,29.76a20,20,0,0,0,29.8-21.66l-13-56.24,43.32-37.8A20,20,0,0,0,243,96.05Zm-66.75,42.62a20,20,0,0,0-6.35,19.63l11.39,49.32-42.94-26.08a19.9,19.9,0,0,0-20.7,0L74.71,207.62,86.1,158.3a20,20,0,0,0-6.35-19.63L41.66,105.44,91.8,101.1a19.92,19.92,0,0,0,16.69-12.19L128,42.42l19.51,46.49A19.92,19.92,0,0,0,164.2,101.1l50.14,4.34Z"},child:[]}]})(e)}function Xs(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216,48H40a12,12,0,0,0,0,24h4V208a20,20,0,0,0,20,20H192a20,20,0,0,0,20-20V72h4a12,12,0,0,0,0-24ZM188,204H68V72H188ZM76,20A12,12,0,0,1,88,8h80a12,12,0,0,1,0,24H88A12,12,0,0,1,76,20Z"},child:[]}]})(e)}function mi(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,152v56a20,20,0,0,1-20,20H48a20,20,0,0,1-20-20V152a12,12,0,0,1,24,0v52H204V152a12,12,0,0,1,24,0ZM96.49,88.49,116,69v83a12,12,0,0,0,24,0V69l19.51,19.52a12,12,0,0,0,17-17l-40-40a12,12,0,0,0-17,0l-40,40a12,12,0,0,0,17,17Z"},child:[]}]})(e)}function gf(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M240.26,186.1,152.81,34.23h0a28.74,28.74,0,0,0-49.62,0L15.74,186.1a27.45,27.45,0,0,0,0,27.71A28.31,28.31,0,0,0,40.55,228h174.9a28.31,28.31,0,0,0,24.79-14.19A27.45,27.45,0,0,0,240.26,186.1Zm-20.8,15.7a4.46,4.46,0,0,1-4,2.2H40.55a4.46,4.46,0,0,1-4-2.2,3.56,3.56,0,0,1,0-3.73L124,46.2a4.77,4.77,0,0,1,8,0l87.44,151.87A3.56,3.56,0,0,1,219.46,201.8ZM116,136V104a12,12,0,0,1,24,0v32a12,12,0,0,1-24,0Zm28,40a16,16,0,1,1-16-16A16,16,0,0,1,144,176Z"},child:[]}]})(e)}function Xb(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M128,20A108,108,0,1,0,236,128,108.12,108.12,0,0,0,128,20Zm0,192a84,84,0,1,1,84-84A84.09,84.09,0,0,1,128,212Zm-12-80V80a12,12,0,0,1,24,0v52a12,12,0,0,1-24,0Zm28,40a16,16,0,1,1-16-16A16,16,0,0,1,144,172Z"},child:[]}]})(e)}function $n(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M208.49,191.51a12,12,0,0,1-17,17L128,145,64.49,208.49a12,12,0,0,1-17-17L111,128,47.51,64.49a12,12,0,0,1,17-17L128,111l63.51-63.52a12,12,0,0,1,17,17L145,128Z"},child:[]}]})(e)}function qD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M156,128a28,28,0,1,1-28-28A28,28,0,0,1,156,128Z"},child:[]}]})(e)}function _g(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M156,128a28,28,0,1,1-28-28A28,28,0,0,1,156,128ZM48,100a28,28,0,1,0,28,28A28,28,0,0,0,48,100Zm160,0a28,28,0,1,0,28,28A28,28,0,0,0,208,100Z"},child:[]}]})(e)}function QD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M208,32H188a4,4,0,0,0-4,4V80a16,16,0,0,1-16,16H88.27A8.17,8.17,0,0,1,80,88.53,8,8,0,0,1,88,80h76a4,4,0,0,0,4-4V36a4,4,0,0,0-4-4H91.31A15.86,15.86,0,0,0,80,36.69L36.69,80A15.86,15.86,0,0,0,32,91.31V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM128,184a32,32,0,1,1,32-32A32,32,0,0,1,128,184Z"},child:[]}]})(e)}function KD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M208,80H176V56a48,48,0,0,0-96,0V80H48A16,16,0,0,0,32,96V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V96A16,16,0,0,0,208,80ZM96,56a32,32,0,0,1,64,0V80H96Z"},child:[]}]})(e)}function Jb(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216,48V208a16,16,0,0,1-16,16H160a16,16,0,0,1-16-16V48a16,16,0,0,1,16-16h40A16,16,0,0,1,216,48ZM96,32H56A16,16,0,0,0,40,48V208a16,16,0,0,0,16,16H96a16,16,0,0,0,16-16V48A16,16,0,0,0,96,32Z"},child:[]}]})(e)}function ej(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M240,128a15.74,15.74,0,0,1-7.6,13.51L88.32,229.65a16,16,0,0,1-16.2.3A15.86,15.86,0,0,1,64,216.13V39.87a15.86,15.86,0,0,1,8.12-13.82,16,16,0,0,1,16.2.3L232.4,114.49A15.74,15.74,0,0,1,240,128Z"},child:[]}]})(e)}function Lg(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M234.5,114.38l-45.1,39.36,13.51,58.6a16,16,0,0,1-23.84,17.34l-51.11-31-51,31a16,16,0,0,1-23.84-17.34L66.61,153.8,21.5,114.38a16,16,0,0,1,9.11-28.06l59.46-5.15,23.21-55.36a15.95,15.95,0,0,1,29.44,0h0L166,81.17l59.44,5.15a16,16,0,0,1,9.11,28.06Z"},child:[]}]})(e)}function YD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M176,56H80a72,72,0,0,0,0,144h96a72,72,0,0,0,0-144Zm0,112a40,40,0,1,1,40-40A40,40,0,0,1,176,168Z"},child:[]}]})(e)}function Bc(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M224,56a8,8,0,0,1-8,8h-8V208a16,16,0,0,1-16,16H64a16,16,0,0,1-16-16V64H40a8,8,0,0,1,0-16H216A8,8,0,0,1,224,56ZM88,32h80a8,8,0,0,0,0-16H88a8,8,0,0,0,0,16Z"},child:[]}]})(e)}function XD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M200,80v32a8,8,0,0,1-16,0V88H160a8,8,0,0,1,0-16h32A8,8,0,0,1,200,80ZM96,168H72V144a8,8,0,0,0-16,0v32a8,8,0,0,0,8,8H96a8,8,0,0,0,0-16ZM232,56V200a16,16,0,0,1-16,16H40a16,16,0,0,1-16-16V56A16,16,0,0,1,40,40H216A16,16,0,0,1,232,56ZM216,200V56H40V200H216Z"},child:[]}]})(e)}function JD(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216,40H40A16,16,0,0,0,24,56V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40Zm0,16V158.75l-26.07-26.06a16,16,0,0,0-22.63,0l-20,20-44-44a16,16,0,0,0-22.62,0L40,149.37V56ZM40,172l52-52,80,80H40Zm176,28H194.63l-36-36,20-20L216,181.38V200ZM144,100a12,12,0,1,1,12,12A12,12,0,0,1,144,100Z"},child:[]}]})(e)}function eE(e){return Se({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M208,32H80A16,16,0,0,0,64,48V64H48A16,16,0,0,0,32,80V208a16,16,0,0,0,16,16H176a16,16,0,0,0,16-16V192h16a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM80,48H208v69.38l-16.7-16.7a16,16,0,0,0-22.62,0L93.37,176H80Zm96,160H48V80H64v96a16,16,0,0,0,16,16h96Zm32-32H116l64-64,28,28v36Zm-88-64A24,24,0,1,0,96,88,24,24,0,0,0,120,112Zm0-32a8,8,0,1,1-8,8A8,8,0,0,1,120,80Z"},child:[]}]})(e)}const tE={paramNegativeConditioning:{placement:"right"},clipSkip:{href:"https://support.invoke.ai/support/solutions/articles/151000178161-advanced-settings"},controlNet:{href:"https://support.invoke.ai/support/solutions/articles/151000105880"},controlNetBeginEnd:{href:"https://support.invoke.ai/support/solutions/articles/151000178148"},controlNetWeight:{href:"https://support.invoke.ai/support/solutions/articles/151000178148"},lora:{href:"https://support.invoke.ai/support/solutions/articles/151000159072"},loraWeight:{href:"https://support.invoke.ai/support/solutions/articles/151000159072-concepts-low-rank-adaptations-loras-"},compositingMaskBlur:{href:"https://support.invoke.ai/support/solutions/articles/151000158838-compositing-settings"},compositingBlurMethod:{href:"https://support.invoke.ai/support/solutions/articles/151000158838-compositing-settings"},compositingCoherenceMode:{href:"https://support.invoke.ai/support/solutions/articles/151000158838-compositing-settings"},infillMethod:{href:"https://support.invoke.ai/support/solutions/articles/151000158841-infill-and-scaling"},scaleBeforeProcessing:{href:"https://support.invoke.ai/support/solutions/articles/151000158841"},paramCFGScale:{href:"https://www.youtube.com/watch?v=1OeHEJrsTpI"},paramCFGRescaleMultiplier:{href:"https://support.invoke.ai/support/solutions/articles/151000178161-advanced-settings"},paramDenoisingStrength:{href:"https://support.invoke.ai/support/solutions/articles/151000094998-image-to-image"},paramHrf:{href:"https://support.invoke.ai/support/solutions/articles/151000096700-how-can-i-get-larger-images-what-does-upscaling-do-"},paramIterations:{href:"https://support.invoke.ai/support/solutions/articles/151000159073"},paramPositiveConditioning:{href:"https://support.invoke.ai/support/solutions/articles/151000096606-tips-on-crafting-prompts",placement:"right"},paramScheduler:{placement:"right",href:"https://www.youtube.com/watch?v=1OeHEJrsTpI"},paramSeed:{href:"https://support.invoke.ai/support/solutions/articles/151000096684-what-is-a-seed-how-do-i-use-it-to-recreate-the-same-image-"},paramModel:{placement:"right",href:"https://support.invoke.ai/support/solutions/articles/151000096601-what-is-a-model-which-should-i-use-"},paramRatio:{gutter:16},controlNetControlMode:{placement:"right",href:"https://support.invoke.ai/support/solutions/articles/151000178148"},controlNetProcessor:{placement:"right",href:"https://support.invoke.ai/support/solutions/articles/151000105880-using-controlnet"},controlNetResizeMode:{placement:"right",href:"https://support.invoke.ai/support/solutions/articles/151000178148"},paramVAE:{placement:"right",href:"https://support.invoke.ai/support/solutions/articles/151000178161-advanced-settings"},paramVAEPrecision:{placement:"right",href:"https://support.invoke.ai/support/solutions/articles/151000178161-advanced-settings"},paramUpscaleMethod:{href:"https://support.invoke.ai/support/solutions/articles/151000096700-how-can-i-get-larger-images-what-does-upscaling-do-"},refinerModel:{href:"https://support.invoke.ai/support/solutions/articles/151000178333-using-the-refiner"},refinerNegativeAestheticScore:{href:"https://support.invoke.ai/support/solutions/articles/151000178333-using-the-refiner"},refinerPositiveAestheticScore:{href:"https://support.invoke.ai/support/solutions/articles/151000178333-using-the-refiner"},refinerScheduler:{href:"https://support.invoke.ai/support/solutions/articles/151000178333-using-the-refiner"},refinerStart:{href:"https://support.invoke.ai/support/solutions/articles/151000178333-using-the-refiner"},refinerSteps:{href:"https://support.invoke.ai/support/solutions/articles/151000178333-using-the-refiner"},refinerCfgScale:{href:"https://support.invoke.ai/support/solutions/articles/151000178333-using-the-refiner"},seamlessTilingXAxis:{href:"https://support.invoke.ai/support/solutions/articles/151000178161-advanced-settings"},seamlessTilingYAxis:{href:"https://support.invoke.ai/support/solutions/articles/151000178161-advanced-settings"}},nE=1e3,sE=[{name:"preventOverflow",options:{padding:10}}],Ke=u.memo(({feature:e,children:t,inPortal:n=!0,...o})=>{const r=b(d=>d.system.shouldEnableInformationalPopovers),a=u.useMemo(()=>tE[e],[e]),c=u.useMemo(()=>wC(M5(a,["image","href","buttonLabel"]),o),[a,o]);return r?s.jsxs(oa,{isLazy:!0,closeOnBlur:!1,trigger:"hover",variant:"informational",openDelay:nE,modifiers:sE,placement:"top",...c,children:[s.jsx(oi,{children:t}),n?s.jsx(Jp,{children:s.jsx(b2,{data:a,feature:e})}):s.jsx(b2,{data:a,feature:e})]}):t});Ke.displayName="InformationalPopover";const b2=({data:e,feature:t})=>{const{t:n}=L(),o=u.useMemo(()=>n(`popovers.${t}.heading`),[t,n]),r=u.useMemo(()=>n(`popovers.${t}.paragraphs`,{returnObjects:!0})??[],[t,n]),a=u.useCallback(()=>{e!=null&&e.href&&window.open(e.href)},[e==null?void 0:e.href]);return s.jsxs(ra,{w:96,children:[s.jsx(A5,{}),s.jsx(aa,{children:s.jsxs(P,{gap:2,flexDirection:"column",alignItems:"flex-start",children:[o&&s.jsxs(s.Fragment,{children:[s.jsx(sn,{size:"sm",children:o}),s.jsx(An,{})]}),(e==null?void 0:e.image)&&s.jsxs(s.Fragment,{children:[s.jsx(Ks,{objectFit:"contain",maxW:"60%",maxH:"60%",backgroundColor:"white",src:e.image,alt:"Optional Image"}),s.jsx(An,{})]}),r.map(c=>s.jsx(re,{children:c},c)),(e==null?void 0:e.href)&&s.jsxs(s.Fragment,{children:[s.jsx(An,{}),s.jsx(qe,{pt:1,onClick:a,leftIcon:s.jsx(zb,{}),alignSelf:"flex-end",variant:"link",children:n("common.learnMore")??o})]})]})})]})},oE=()=>{const e=b(h=>h.dynamicPrompts.maxPrompts),t=b(h=>h.config.sd.dynamicPrompts.maxPrompts.sliderMin),n=b(h=>h.config.sd.dynamicPrompts.maxPrompts.sliderMax),o=b(h=>h.config.sd.dynamicPrompts.maxPrompts.numberInputMin),r=b(h=>h.config.sd.dynamicPrompts.maxPrompts.numberInputMax),a=b(h=>h.config.sd.dynamicPrompts.maxPrompts.initial),c=b(h=>!h.dynamicPrompts.combinatorial),d=O(),{t:f}=L(),m=u.useCallback(h=>{d(P5(h))},[d]);return s.jsxs($,{isDisabled:c,children:[s.jsx(Ke,{feature:"dynamicPromptsMaxPrompts",inPortal:!1,children:s.jsx(Y,{children:f("dynamicPrompts.maxPrompts")})}),s.jsx(Ne,{min:t,max:n,value:e,defaultValue:a,onChange:m,marks:!0}),s.jsx(Ee,{min:o,max:r,value:e,defaultValue:a,onChange:m})]})},rE=u.memo(oE),tj=u.memo(e=>e.image?s.jsx(eg,{w:`${e.image.width}px`,h:"auto",objectFit:"contain",aspectRatio:`${e.image.width}/${e.image.height}`}):s.jsx(P,{opacity:.7,w:"full",h:"full",alignItems:"center",justifyContent:"center",borderRadius:"base",bg:"base.900",children:s.jsx(la,{size:"xl"})}));tj.displayName="IAILoadingImageFallback";const Ut=u.memo(e=>{const{icon:t=dc,boxSize:n=16,sx:o,...r}=e,a=u.useMemo(()=>({w:"full",h:"full",alignItems:"center",justifyContent:"center",borderRadius:"base",flexDir:"column",gap:2,userSelect:"none",opacity:.7,color:"base.500",...o}),[o]);return s.jsxs(P,{sx:a,...r,children:[t&&s.jsx(gn,{as:t,boxSize:n,opacity:.7}),e.label&&s.jsx(re,{textAlign:"center",fontSize:"md",children:e.label})]})});Ut.displayName="IAINoContentFallback";const Tg=u.memo(e=>{const{sx:t,...n}=e,o=u.useMemo(()=>({w:"full",h:"full",alignItems:"center",justifyContent:"center",borderRadius:"base",flexDir:"column",gap:2,userSelect:"none",opacity:.7,color:"base.500",...t}),[t]);return s.jsxs(P,{sx:o,...n,children:[s.jsx(la,{size:"xl"}),e.label&&s.jsx(re,{textAlign:"center",children:e.label})]})});Tg.displayName="IAINoContentFallbackWithSpinner";/*!
 * OverlayScrollbars
 * Version: 2.6.1
 *
 * Copyright (c) Rene Haas | KingSora.
 * https://github.com/KingSora
 *
 * Released under the MIT license.
 */const co=(e,t)=>{const{o:n,u:o,_:r}=e;let a=n,c;const d=(h,g)=>{const x=a,C=h,j=g||(o?!o(x,C):x!==C);return(j||r)&&(a=C,c=x),[a,j,c]};return[t?h=>d(t(a,c),h):d,h=>[a,!!h,c]]},Rg=typeof window<"u",Zs=Rg?window:{},zl=Math.max,aE=Math.min,pp=Math.round,Bg=Zs.cancelAnimationFrame,Ng=Zs.requestAnimationFrame,Ld=Zs.setTimeout,gp=Zs.clearTimeout,xf=e=>typeof Zs[e]<"u"?Zs[e]:void 0,lE=xf("MutationObserver"),j2=xf("IntersectionObserver"),Td=xf("ResizeObserver"),xp=xf("ScrollTimeline"),nj=Rg&&Node.ELEMENT_NODE,{toString:iE,hasOwnProperty:Dm}=Object.prototype,cE=/^\[object (.+)\]$/,Nc=e=>e===void 0,vf=e=>e===null,uE=e=>Nc(e)||vf(e)?`${e}`:iE.call(e).replace(cE,"$1").toLowerCase(),zo=e=>typeof e=="number",Cf=e=>typeof e=="string",sj=e=>typeof e=="boolean",po=e=>typeof e=="function",go=e=>Array.isArray(e),fc=e=>typeof e=="object"&&!go(e)&&!vf(e),yf=e=>{const t=!!e&&e.length,n=zo(t)&&t>-1&&t%1==0;return go(e)||!po(e)&&n?t>0&&fc(e)?t-1 in e:!0:!1},Rd=e=>{if(!e||!fc(e)||uE(e)!=="object")return!1;let t;const n="constructor",o=e[n],r=o&&o.prototype,a=Dm.call(e,n),c=r&&Dm.call(r,"isPrototypeOf");if(o&&!a&&!c)return!1;for(t in e);return Nc(t)||Dm.call(e,t)},ec=e=>{const t=HTMLElement;return e?t?e instanceof t:e.nodeType===nj:!1},bf=e=>{const t=Element;return e?t?e instanceof t:e.nodeType===nj:!1},S2=()=>performance.now(),dE=(e,t,n,o,r)=>{let a=0;const c=S2(),d=zl(0,n),f=m=>{const h=S2(),x=h-c>=d,C=m?1:1-(zl(0,c+d-h)/d||0),j=(t-e)*(po(r)?r(C,C*d,0,1,d):C)+e,S=x||C===1;o&&o(j,C,S),a=S?0:Ng(()=>f())};return f(),m=>{Bg(a),m&&f(m)}};function Pt(e,t){if(yf(e))for(let n=0;n<e.length&&t(e[n],n,e)!==!1;n++);else e&&Pt(Object.keys(e),n=>t(e[n],n,e));return e}const jf=(e,t)=>e.indexOf(t)>=0,dr=(e,t)=>e.concat(t),$t=(e,t,n)=>(!n&&!Cf(t)&&yf(t)?Array.prototype.push.apply(e,t):e.push(t),e),sl=e=>Array.from(e||[]),oj=e=>go(e)?e:[e],vp=e=>!!e&&!e.length,w2=e=>sl(new Set(e)),qs=(e,t,n)=>{Pt(e,r=>r&&r.apply(void 0,t||[])),!n&&(e.length=0)},rj="paddingTop",aj="paddingRight",lj="paddingLeft",ij="paddingBottom",cj="marginLeft",uj="marginRight",dj="marginBottom",Sf="overflowX",wf="overflowY",Zl="width",ql="height",Ql="hidden",fj="visible",zg=(e,t,n,o)=>{if(e&&t){let r=!0;return Pt(n,a=>{const c=o?o(e[a]):e[a],d=o?o(t[a]):t[a];c!==d&&(r=!1)}),r}return!1},hj=(e,t)=>zg(e,t,["w","h"]),mj=(e,t)=>zg(e,t,["x","y"]),fE=(e,t)=>zg(e,t,["t","r","b","l"]),$s=()=>{},et=(e,...t)=>e.bind(0,...t),Rr=e=>{let t;const n=e?Ld:Ng,o=e?gp:Bg;return[r=>{o(t),t=n(r,po(e)?e():e)},()=>o(t)]},pj=(e,t)=>{let n,o,r,a=$s;const{v:c,p:d,S:f}=t||{},m=function(j){a(),gp(n),n=o=void 0,a=$s,e.apply(this,j)},h=C=>f&&o?f(o,C):C,g=()=>{a!==$s&&m(h(r)||r)},x=function(){const j=sl(arguments),S=po(c)?c():c;if(zo(S)&&S>=0){const I=po(d)?d():d,k=zo(I)&&I>=0,D=S>0?Ld:Ng,T=S>0?gp:Bg,A=h(j)||j,N=m.bind(0,A);a();const W=D(N,S);a=()=>T(W),k&&!n&&(n=Ld(g,I)),o=r=A}else m(j)};return x.m=g,x},gj=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),xr=e=>e?Object.keys(e):[],St=(e,t,n,o,r,a,c)=>{const d=[t,n,o,r,a,c];return(typeof e!="object"||vf(e))&&!po(e)&&(e={}),Pt(d,f=>{Pt(f,(m,h)=>{const g=f[h];if(e===g)return!0;const x=go(g);if(g&&Rd(g)){const C=e[h];let j=C;x&&!go(C)?j=[]:!x&&!Rd(C)&&(j={}),e[h]=St(j,g)}else e[h]=x?g.slice():g})}),e},xj=(e,t)=>Pt(St({},e),(n,o,r)=>{n===void 0?delete r[o]:t&&n&&Rd(n)&&(r[o]=xj(n,t))}),Og=e=>{for(const t in e)return!1;return!0},Cp=(e,t,n)=>zl(e,aE(t,n)),Ba=e=>sl(new Set((go(e)?e:(e||"").split(" ")).filter(t=>t))),kf=(e,t)=>e&&e.getAttribute(t),lo=(e,t,n)=>{Pt(Ba(t),o=>{e&&e.setAttribute(o,n||"")})},Do=(e,t)=>{Pt(Ba(t),n=>e&&e.removeAttribute(n))},If=(e,t)=>{const n=Ba(kf(e,t)),o=et(lo,e,t),r=(a,c)=>{const d=new Set(n);return Pt(Ba(a),f=>d[c](f)),sl(d).join(" ")};return{O:a=>o(r(a,"delete")),$:a=>o(r(a,"add")),C:a=>{const c=Ba(a);return c.reduce((d,f)=>d&&n.includes(f),c.length>0)}}},vj=(e,t,n)=>{If(e,t).O(n)},hc=(e,t,n)=>(If(e,t).$(n),et(vj,e,t,n)),pd=(e,t,n,o)=>{(o?hc:vj)(e,t,n)},hE=(e,t,n)=>If(e,t).C(n),Cj=e=>If(e,"class"),Fg=(e,t)=>{Cj(e).O(t)},Bd=(e,t)=>(Cj(e).$(t),et(Fg,e,t)),k2=Rg&&Element.prototype,yj=(e,t)=>{const n=[],o=t?bf(t)&&t:document;return o?$t(n,o.querySelectorAll(e)):n},mE=(e,t)=>{const n=t?bf(t)&&t:document;return n?n.querySelector(e):null},yp=(e,t)=>bf(e)?(k2.matches||k2.msMatchesSelector).call(e,t):!1,bp=e=>e?sl(e.childNodes):[],Kl=e=>e&&e.parentElement,_l=(e,t)=>bf(e)&&e.closest(t),pE=(e,t,n)=>{const o=_l(e,t),r=e&&mE(n,o),a=_l(r,t)===o;return o&&r?o===e||r===e||a&&_l(_l(e,n),t)!==o:!1},Kr=e=>{if(yf(e))Pt(sl(e),t=>Kr(t));else if(e){const t=Kl(e);t&&t.removeChild(e)}},bj=(e,t,n)=>{if(n&&e){let o=t,r;return yf(n)?(r=document.createDocumentFragment(),Pt(n,a=>{a===o&&(o=a.previousSibling),r.appendChild(a)})):r=n,t&&(o?o!==t&&(o=o.nextSibling):o=e.firstChild),e.insertBefore(r,o||null),()=>Kr(n)}return $s},Fs=(e,t)=>bj(e,null,t),I2=(e,t)=>bj(Kl(e),e&&e.nextSibling,t),Ol=e=>{const t=document.createElement("div");return lo(t,"class",e),t},jj=e=>{const t=Ol();return t.innerHTML=e.trim(),Pt(bp(t),n=>Kr(n))},gE=/^--/,M2=(e,t)=>e.getPropertyValue(t)||e[t]||"",Vg=e=>{const t=e||0;return isFinite(t)?t:0},Xu=e=>Vg(parseFloat(e||"")),A2=e=>`${(Vg(e)*100).toFixed(3)}%`,jp=e=>`${Vg(e)}px`;function Yl(e,t){e&&Pt(t,(n,o)=>{try{const r=e.style,a=zo(n)?jp(n):(n||"")+"";gE.test(o)?r.setProperty(o,a):r[o]=a}catch{}})}function $a(e,t,n){const o=Cf(t);let r=o?"":{};if(e){const a=Zs.getComputedStyle(e,n)||e.style;r=o?M2(a,t):t.reduce((c,d)=>(c[d]=M2(a,d),c),r)}return r}const $r=e=>$a(e,"direction")==="rtl",P2=(e,t,n)=>{const o=t?`${t}-`:"",r=n?`-${n}`:"",a=`${o}top${r}`,c=`${o}right${r}`,d=`${o}bottom${r}`,f=`${o}left${r}`,m=$a(e,[a,c,d,f]);return{t:Xu(m[a]),r:Xu(m[c]),b:Xu(m[d]),l:Xu(m[f])}},Em=(e,t)=>`translate${fc(e)?`(${e.x},${e.y})`:`${t?"X":"Y"}(${e})`}`,xE={w:0,h:0},Mf=(e,t)=>t?{w:t[`${e}Width`],h:t[`${e}Height`]}:xE,vE=e=>Mf("inner",e||Zs),tc=et(Mf,"offset"),Sj=et(Mf,"client"),Sp=et(Mf,"scroll"),Hg=e=>{const t=parseFloat($a(e,Zl))||0,n=parseFloat($a(e,ql))||0;return{w:t-pp(t),h:n-pp(n)}},Fl=e=>e.getBoundingClientRect(),wp=e=>!!(e&&(e[ql]||e[Zl])),wj=(e,t)=>{const n=wp(e);return!wp(t)&&n},D2=(e,t,n,o)=>{Pt(Ba(t),r=>{e.removeEventListener(r,n,o)})},tn=(e,t,n,o)=>{var r;const a=(r=o&&o.H)!=null?r:!0,c=o&&o.I||!1,d=o&&o.A||!1,f={passive:a,capture:c};return et(qs,Ba(t).map(m=>{const h=d?g=>{D2(e,m,h,c),n(g)}:n;return e.addEventListener(m,h,f),et(D2,e,m,h,c)}))},$g=e=>e.stopPropagation(),E2=e=>e.preventDefault(),CE={x:0,y:0},_m=e=>{const t=e&&Fl(e);return t?{x:t.left+Zs.scrollX,y:t.top+Zs.scrollY}:CE},Nd=(e,t,n)=>n?n.n?-e+0:n.i?t-e:e:e,_2=(e,t)=>[Nd(0,e,t),Nd(e,e,t)],L2=(e,t,n)=>Cp(0,1,Nd(e,t,n)/t||0),Yr=(e,t)=>{const{x:n,y:o}=zo(t)?{x:t,y:t}:t||{};zo(n)&&(e.scrollLeft=n),zo(o)&&(e.scrollTop=o)},Xl=e=>({x:e.scrollLeft,y:e.scrollTop}),T2=(e,t)=>{Pt(oj(t),e)},kp=e=>{const t=new Map,n=(a,c)=>{if(a){const d=t.get(a);T2(f=>{d&&d[f?"delete":"clear"](f)},c)}else t.forEach(d=>{d.clear()}),t.clear()},o=(a,c)=>{if(Cf(a)){const m=t.get(a)||new Set;return t.set(a,m),T2(h=>{po(h)&&m.add(h)},c),et(n,a,c)}sj(c)&&c&&n();const d=xr(a),f=[];return Pt(d,m=>{const h=a[m];h&&$t(f,o(m,h))}),et(qs,f)},r=(a,c)=>{Pt(sl(t.get(a)),d=>{c&&!vp(c)?d.apply(0,c):d()})};return o(e||{}),[o,n,r]},R2=e=>JSON.stringify(e,(t,n)=>{if(po(n))throw 0;return n}),B2=(e,t)=>e?`${t}`.split(".").reduce((n,o)=>n&&gj(n,o)?n[o]:void 0,e):void 0,yE={paddingAbsolute:!1,showNativeOverlaidScrollbars:!1,update:{elementEvents:[["img","load"]],debounce:[0,33],attributes:null,ignoreMutation:null},overflow:{x:"scroll",y:"scroll"},scrollbars:{theme:"os-theme-dark",visibility:"auto",autoHide:"never",autoHideDelay:1300,autoHideSuspend:!1,dragScroll:!0,clickScroll:!1,pointers:["mouse","touch","pen"]}},kj=(e,t)=>{const n={},o=dr(xr(t),xr(e));return Pt(o,r=>{const a=e[r],c=t[r];if(fc(a)&&fc(c))St(n[r]={},kj(a,c)),Og(n[r])&&delete n[r];else if(gj(t,r)&&c!==a){let d=!0;if(go(a)||go(c))try{R2(a)===R2(c)&&(d=!1)}catch{}d&&(n[r]=c)}}),n},N2=(e,t,n)=>o=>[B2(e,o),n||B2(t,o)!==void 0],zc="data-overlayscrollbars",Ij="os-environment",bE=`${Ij}-scrollbar-hidden`,Lm=`${zc}-initialize`,Os=zc,Mj=`${Os}-overflow-x`,Aj=`${Os}-overflow-y`,Pj="overflowVisible",jE="scrollbarPressed",Ip="updating",SE="body",Br=`${zc}-viewport`,wE="arrange",Dj="scrollbarHidden",Vl=Pj,Mp=`${zc}-padding`,kE=Vl,z2=`${zc}-content`,Wg="os-size-observer",IE=`${Wg}-appear`,ME=`${Wg}-listener`,AE="os-trinsic-observer",PE="os-theme-none",Ss="os-scrollbar",DE=`${Ss}-rtl`,EE=`${Ss}-horizontal`,_E=`${Ss}-vertical`,Ej=`${Ss}-track`,Gg=`${Ss}-handle`,LE=`${Ss}-visible`,TE=`${Ss}-cornerless`,O2=`${Ss}-interaction`,F2=`${Ss}-unusable`,Ap=`${Ss}-auto-hide`,V2=`${Ap}-hidden`,H2=`${Ss}-wheel`,RE=`${Ej}-interactive`,BE=`${Gg}-interactive`,_j={},Lj={},NE=e=>{Pt(e,t=>Pt(t,(n,o)=>{_j[o]=t[o]}))},Tj=(e,t,n)=>xr(e).map(o=>{const{static:r,instance:a}=e[o],[c,d,f]=n||[],m=n?a:r;if(m){const h=n?m(c,d,t):m(t);return(f||Lj)[o]=h}}),pi=e=>Lj[e],zE="__osOptionsValidationPlugin",OE="__osSizeObserverPlugin",FE=(e,t)=>{const{T:n}=t,[o,r]=e("showNativeOverlaidScrollbars");return[o&&n.x&&n.y,r]},zd=e=>e.indexOf(fj)===0,Rj=(e,t)=>{const{D:n}=e,o=f=>{const m=$a(n,f),g=(t?t[f]:m)==="scroll";return[m,g]},[r,a]=o(Sf),[c,d]=o(wf);return{k:{x:r,y:c},R:{x:a,y:d}}},VE=(e,t,n,o)=>{const r=t.x||t.y,a=(h,g)=>{const x=zd(h),C=x&&r?"hidden":"",j=g&&x&&h.replace(`${fj}-`,"")||C;return[g&&!x?h:"",zd(j)?"hidden":j]},[c,d]=a(n.x,t.x),[f,m]=a(n.y,t.y);return o[Sf]=d&&f?d:c,o[wf]=m&&c?m:f,Rj(e,o)},Ug="__osScrollbarsHidingPlugin",Bj="__osClickScrollPlugin",HE={[Bj]:{static:()=>(e,t,n,o,r)=>{let a=0,c=$s;const d=f=>{c=dE(f,f+o*Math.sign(n),133,(m,h,g)=>{e(m);const x=t(),C=x+o,j=r>=x&&r<=C;if(g&&!j){if(a)d(m);else{const S=Ld(()=>{d(m)},222);c=()=>{clearTimeout(S)}}a++}})};return d(0),()=>c()}}};let Tm;const $E=()=>{const e=(D,T,E,A)=>{Fs(D,T);const N=Sj(T),W=tc(T),G=Hg(E);return A&&Kr(T),{x:W.h-N.h+G.h,y:W.w-N.w+G.w}},t=D=>{let T=!1;const E=Bd(D,bE);try{T=$a(D,"scrollbar-width")==="none"||$a(D,"display","::-webkit-scrollbar")==="none"}catch{}return E(),T},n=(D,T)=>{Yl(D,{[Sf]:Ql,[wf]:Ql,direction:"rtl"}),Yr(D,{x:0});const E=_m(D),A=_m(T);Yr(D,{x:-999});const N=_m(T);return{i:E.x===A.x,n:A.x!==N.x}},{body:o}=document,a=jj(`<div class="${Ij}"><div></div></div>`)[0],c=a.firstChild,[d,,f]=kp(),[m,h]=co({o:e(o,a,c),u:mj},et(e,o,a,c,!0)),[g]=h(),x=t(a),C={x:g.x===0,y:g.y===0},j={elements:{host:null,padding:!x,viewport:D=>x&&D===D.ownerDocument.body&&D,content:!1},scrollbars:{slot:!0},cancel:{nativeScrollbarsOverlaid:!1,body:null}},S=St({},yE),M=et(St,{},S),I=et(St,{},j),k={P:g,T:C,L:x,J:!!xp,K:n(a,c),Z:et(d,"r"),G:I,tt:D=>St(j,D)&&I(),nt:M,ot:D=>St(S,D)&&M(),st:St({},j),et:St({},S)};return Do(a,"style"),Kr(a),Zs.addEventListener("resize",()=>{let D;if(!x&&(!C.x||!C.y)){const T=pi(Ug);D=!!(T?T.Y():$s)(k,m)}f("r",[D])}),k},Qs=()=>(Tm||(Tm=$E()),Tm),Zg=(e,t)=>po(t)?t.apply(0,e):t,WE=(e,t,n,o)=>{const r=Nc(o)?n:o;return Zg(e,r)||t.apply(0,e)},Nj=(e,t,n,o)=>{const r=Nc(o)?n:o,a=Zg(e,r);return!!a&&(ec(a)?a:t.apply(0,e))},GE=(e,t)=>{const{nativeScrollbarsOverlaid:n,body:o}=t||{},{T:r,L:a,G:c}=Qs(),{nativeScrollbarsOverlaid:d,body:f}=c().cancel,m=n??d,h=Nc(o)?f:o,g=(r.x||r.y)&&m,x=e&&(vf(h)?!a:h);return!!g||!!x},qg=new WeakMap,UE=(e,t)=>{qg.set(e,t)},ZE=e=>{qg.delete(e)},zj=e=>qg.get(e),qE=(e,t,n)=>{let o=!1;const r=n?new WeakMap:!1,a=()=>{o=!0},c=d=>{if(r&&n){const f=n.map(m=>{const[h,g]=m||[];return[g&&h?(d||yj)(h,e):[],g]});Pt(f,m=>Pt(m[0],h=>{const g=m[1],x=r.get(h)||[];if(e.contains(h)&&g){const j=tn(h,g,S=>{o?(j(),r.delete(h)):t(S)});r.set(h,$t(x,j))}else qs(x),r.delete(h)}))}};return c(),[a,c]},$2=(e,t,n,o)=>{let r=!1;const{ct:a,rt:c,lt:d,it:f,ut:m,ft:h}=o||{},g=pj(()=>r&&n(!0),{v:33,p:99}),[x,C]=qE(e,g,d),j=a||[],S=c||[],M=dr(j,S),I=(D,T)=>{if(!vp(T)){const E=m||$s,A=h||$s,N=[],W=[];let G=!1,z=!1;if(Pt(T,X=>{const{attributeName:B,target:Q,type:V,oldValue:H,addedNodes:me,removedNodes:Ie}=X,ye=V==="attributes",de=V==="childList",He=e===Q,Be=ye&&B,ce=Be&&kf(Q,B||"")||null,ue=Be&&H!==ce,je=jf(S,B)&&ue;if(t&&(de||!He)){const be=ye&&ue,ee=be&&f&&yp(Q,f),F=(ee?!E(Q,B,H,ce):!ye||be)&&!A(X,!!ee,e,o);Pt(me,oe=>$t(N,oe)),Pt(Ie,oe=>$t(N,oe)),z=z||F}!t&&He&&ue&&!E(Q,B,H,ce)&&($t(W,B),G=G||je)}),C(X=>w2(N).reduce((B,Q)=>($t(B,yj(X,Q)),yp(Q,X)?$t(B,Q):B),[])),t)return!D&&z&&n(!1),[!1];if(!vp(W)||G){const X=[w2(W),G];return!D&&n.apply(0,X),X}}},k=new lE(et(I,!1));return[()=>(k.observe(e,{attributes:!0,attributeOldValue:!0,attributeFilter:M,subtree:t,childList:t,characterData:t}),r=!0,()=>{r&&(x(),k.disconnect(),r=!1)}),()=>{if(r)return g.m(),I(!0,k.takeRecords())}]},Oj=(e,t,n)=>{const{_t:r,dt:a}=n||{},c=pi(OE),{K:d}=Qs(),f=et($r,e),[m]=co({o:!1,_:!0});return()=>{const h=[],x=jj(`<div class="${Wg}"><div class="${ME}"></div></div>`)[0],C=x.firstChild,j=S=>{const M=S instanceof ResizeObserverEntry,I=!M&&go(S);let k=!1,D=!1,T=!0;if(M){const[E,,A]=m(S.contentRect),N=wp(E),W=wj(E,A);D=!A||W,k=!D&&!N,T=!k}else I?[,T]=S:D=S===!0;if(r&&T){const E=I?S[0]:$r(x);Yr(x,{x:Nd(3333333,3333333,E&&d),y:3333333})}k||t({vt:I?S:void 0,ht:!I,dt:D})};if(Td){const S=new Td(M=>j(M.pop()));S.observe(C),$t(h,()=>{S.disconnect()})}else if(c){const[S,M]=c(C,j,a);$t(h,dr([Bd(x,IE),tn(x,"animationstart",S)],M))}else return $s;if(r){const[S]=co({o:void 0},f);$t(h,tn(x,"scroll",M=>{const I=S(),[k,D,T]=I;D&&(Fg(C,"ltr rtl"),Bd(C,k?"rtl":"ltr"),j([!!k,D,T])),$g(M)}))}return et(qs,$t(h,Fs(e,x)))}},QE=(e,t)=>{let n;const o=f=>f.h===0||f.isIntersecting||f.intersectionRatio>0,r=Ol(AE),[a]=co({o:!1}),c=(f,m)=>{if(f){const h=a(o(f)),[,g]=h;return g&&!m&&t(h)&&[h]}},d=(f,m)=>c(m.pop(),f);return[()=>{const f=[];if(j2)n=new j2(et(d,!1),{root:e}),n.observe(r),$t(f,()=>{n.disconnect()});else{const m=()=>{const h=tc(r);c(h)};$t(f,Oj(r,m)()),m()}return et(qs,$t(f,Fs(e,r)))},()=>n&&d(!0,n.takeRecords())]},KE=(e,t,n,o)=>{let r,a,c,d,f,m;const{L:h}=Qs(),g=`[${Os}]`,x=`[${Br}]`,C=["tabindex"],j=["wrap","cols","rows"],S=["id","class","style","open"],{gt:M,bt:I,D:k,wt:D,St:T,V:E,yt:A,Ot:N}=e,W={$t:!1,N:$r(M)},G=Qs(),z=pi(Ug),[X]=co({u:hj,o:{w:0,h:0}},()=>{const J=z&&z.M(e,t,W,G,n).W,F=A(Vl),oe=!E&&A(wE),le=oe&&Xl(k);N(Vl),E&&N(Ip,!0);const fe=oe&&J&&J()[0],he=Sp(D),ke=Sp(k),ze=Hg(k);return N(Vl,F),E&&N(Ip),fe&&fe(),Yr(k,le),{w:ke.w+he.w+ze.w,h:ke.h+he.h+ze.h}}),B=T?j:dr(S,j),Q=pj(o,{v:()=>r,p:()=>a,S(J,F){const[oe]=J,[le]=F;return[dr(xr(oe),xr(le)).reduce((fe,he)=>(fe[he]=oe[he]||le[he],fe),{})]}}),V=J=>{if(E){const F=$r(M);St(J,{Ct:m!==F}),St(W,{N:F}),m=F}},H=J=>{Pt(J||C,F=>{if(jf(C,F)){const oe=kf(I,F);Cf(oe)?lo(k,F,oe):Do(k,F)}})},me=(J,F)=>{const[oe,le]=J,fe={xt:le};return St(W,{$t:oe}),!F&&o(fe),fe},Ie=({ht:J,vt:F,dt:oe})=>{const fe=!(J&&!oe&&!F)&&h?Q:o,[he,ke]=F||[],ze={ht:J||oe,dt:oe,Ct:ke};V(ze),F&&St(W,{N:he}),fe(ze)},ye=(J,F)=>{const[,oe]=X(),le={Ht:oe};return V(le),oe&&!F&&(J?o:Q)(le),le},de=(J,F,oe)=>{const le={It:F};return V(le),F&&!oe?Q(le):E||H(J),le},{Z:He}=G,[Be,ce]=D?QE(I,me):[],ue=!E&&Oj(I,Ie,{dt:!0,_t:!0}),[je,be]=$2(I,!1,de,{rt:S,ct:dr(S,C)}),ee=E&&Td&&new Td(J=>{const F=J[J.length-1].contentRect;Ie({ht:!0,dt:wj(F,f)}),f=F});return[()=>{H(),ee&&ee.observe(I);const J=ue&&ue(),F=Be&&Be(),oe=je(),le=He(fe=>{const[,he]=X();Q({zt:fe,Ht:he})});return()=>{ee&&ee.disconnect(),J&&J(),F&&F(),d&&d(),oe(),le()}},({Et:J,At:F,Tt:oe})=>{const le={},[fe]=J("update.ignoreMutation"),[he,ke]=J("update.attributes"),[ze,$e]=J("update.elementEvents"),[Je,gt]=J("update.debounce"),R=$e||ke,Z=F||oe,ne=ge=>po(fe)&&fe(ge);if(R){c&&c(),d&&d();const[ge,xe]=$2(D||k,!0,ye,{ct:dr(B,he||[]),lt:ze,it:g,ft:(pe,te)=>{const{target:Ce,attributeName:Ue}=pe;return(!te&&Ue&&!E?pE(Ce,g,x):!1)||!!_l(Ce,`.${Ss}`)||!!ne(pe)}});d=ge(),c=xe}if(gt)if(Q.m(),go(Je)){const ge=Je[0],xe=Je[1];r=zo(ge)&&ge,a=zo(xe)&&xe}else zo(Je)?(r=Je,a=!1):(r=!1,a=!1);if(Z){const ge=be(),xe=ce&&ce(),pe=c&&c();ge&&St(le,de(ge[0],ge[1],Z)),xe&&St(le,me(xe[0],Z)),pe&&St(le,ye(pe[0],Z))}return V(le),le},W]},YE=(e,t,n,o)=>{const{G:r,K:a}=Qs(),{scrollbars:c}=r(),{slot:d}=c,{gt:f,bt:m,D:h,Dt:g,kt:x,Rt:C,V:j}=t,{scrollbars:S}=g?{}:e,{slot:M}=S||{},I=new Map,k=J=>xp&&new xp({source:x,axis:J}),D=k("x"),T=k("y"),E=Nj([f,m,h],()=>j&&C?f:m,d,M),A=(J,F)=>{if(F){const ze=J?Zl:ql,{Mt:$e,Vt:Je}=F,gt=Fl(Je)[ze],R=Fl($e)[ze];return Cp(0,1,gt/R||0)}const oe=J?"x":"y",{Lt:le,Pt:fe}=n,he=fe[oe],ke=le[oe];return Cp(0,1,he/(he+ke)||0)},N=(J,F,oe,le)=>{const fe=A(oe,J);return 1/fe*(1-fe)*(le?1-F:F)||0},W=(J,F)=>St(J,F?{clear:["left"]}:{}),G=J=>{I.forEach((F,oe)=>{(J?jf(oj(J),oe):!0)&&(Pt(F||[],fe=>{fe&&fe.cancel()}),I.delete(oe))})},z=(J,F,oe,le)=>{const fe=I.get(J)||[],he=fe.find(ke=>ke&&ke.timeline===F);he?he.effect=new KeyframeEffect(J,oe,{composite:le}):I.set(J,dr(fe,[J.animate(oe,{timeline:F,composite:le})]))},X=(J,F,oe)=>{const le=oe?Bd:Fg;Pt(J,fe=>{le(fe.Ut,F)})},B=(J,F)=>{Pt(J,oe=>{const[le,fe]=F(oe);Yl(le,fe)})},Q=(J,F)=>{B(J,oe=>{const{Vt:le}=oe;return[le,{[F?Zl:ql]:A2(A(F))}]})},V=(J,F)=>{const{Lt:oe}=n,le=F?oe.x:oe.y,fe=(he,ke,ze)=>Em(A2(N(he,L2(ke,le,ze),F,ze)),F);if(D&&T)Pt(J,he=>{const{Ut:ke,Vt:ze}=he,$e=F&&$r(ke)&&a;z(ze,F?D:T,W({transform:_2(le,$e).map(Je=>fe(he,Je,$e))},$e))});else{const he=Xl(x);B(J,ke=>{const{Vt:ze,Ut:$e}=ke;return[ze,{transform:fe(ke,F?he.x:he.y,F&&$r($e)&&a)}]})}},H=J=>j&&!C&&Kl(J)===h,me=[],Ie=[],ye=[],de=(J,F,oe)=>{const le=sj(oe),fe=le?oe:!0,he=le?!oe:!0;fe&&X(Ie,J,F),he&&X(ye,J,F)},He=()=>{Q(Ie,!0),Q(ye)},Be=()=>{V(Ie,!0),V(ye)},ce=()=>{if(j){const{Lt:J}=n,F=.5;if(D&&T)Pt(dr(ye,Ie),({Ut:oe})=>{if(H(oe)){const le=(fe,he,ke)=>{const ze=ke&&$r(oe)&&a;z(oe,fe,W({transform:_2(he-F,ze).map($e=>Em(jp($e),ke))},ze),"add")};le(D,J.x,!0),le(T,J.y)}else G(oe)});else{const oe=Xl(x),le=fe=>{const{Ut:he}=fe,ke=H(he)&&he,ze=($e,Je,gt)=>{const R=L2($e,Je,gt),Z=Je*R;return jp(gt?-Z:Z)};return[ke,{transform:ke?Em({x:ze(oe.x,J.x,$r(he)&&a),y:ze(oe.y,J.y)}):""}]};B(Ie,le),B(ye,le)}}},ue=J=>{const oe=Ol(`${Ss} ${J?EE:_E}`),le=Ol(Ej),fe=Ol(Gg),he={Ut:oe,Mt:le,Vt:fe};return $t(J?Ie:ye,he),$t(me,[Fs(oe,le),Fs(le,fe),et(Kr,oe),G,o(he,de,V,J)]),he},je=et(ue,!0),be=et(ue,!1),ee=()=>(Fs(E,Ie[0].Ut),Fs(E,ye[0].Ut),et(qs,me));return je(),be(),[{Bt:He,Nt:Be,jt:ce,Ft:de,qt:{J:D,Wt:Ie,Xt:je,Yt:et(B,Ie)},Jt:{J:T,Wt:ye,Xt:be,Yt:et(B,ye)}},ee]},XE=(e,t,n)=>{const{bt:o,kt:r,Kt:a}=t;return(c,d,f,m)=>{const{Ut:h,Mt:g,Vt:x}=c,[C,j]=Rr(333),[S,M]=Rr(),I=et(f,[c],m),k=!!r.scrollBy,D=`client${m?"X":"Y"}`,T=m?Zl:ql,E=m?"left":"top",A=m?"w":"h",N=m?"x":"y",W=X=>X.propertyName.indexOf(T)>-1,G=()=>{const X="pointerup pointerleave pointercancel lostpointercapture",B=(Q,V)=>H=>{const{Lt:me}=n,Ie=tc(g)[A]-tc(x)[A],de=V*H/Ie*me[N];Yr(r,{[N]:Q+de})};return tn(g,"pointerdown",Q=>{const V=_l(Q.target,`.${Gg}`)===x,H=V?x:g,me=e.scrollbars,{button:Ie,isPrimary:ye,pointerType:de}=Q,{pointers:He}=me;if(Ie===0&&ye&&me[V?"dragScroll":"clickScroll"]&&(He||[]).includes(de)){const ce=!V&&Q.shiftKey,ue=et(Fl,x),je=et(Fl,g),be=(R,Z)=>(R||ue())[E]-(Z||je())[E],ee=pp(Fl(r)[T])/tc(r)[A]||1,J=B(Xl(r)[N]||0,1/ee),F=Q[D],oe=ue(),le=je(),fe=oe[T],he=be(oe,le)+fe/2,ke=F-le[E],ze=V?0:ke-he,$e=R=>{qs(gt),H.releasePointerCapture(R.pointerId)},gt=[hc(o,Os,jE),tn(a,X,$e),tn(a,"selectstart",R=>E2(R),{H:!1}),tn(g,X,$e),tn(g,"pointermove",R=>{const Z=R[D]-F;(V||ce)&&J(ze+Z)})];if(H.setPointerCapture(Q.pointerId),ce)J(ze);else if(!V){const R=pi(Bj);R&&$t(gt,R(J,be,ze,fe,ke))}}})};let z=!0;return et(qs,[tn(h,"pointerenter",()=>{d(O2,!0)}),tn(h,"pointerleave pointercancel",()=>{d(O2,!1)}),tn(h,"wheel",X=>{const{deltaX:B,deltaY:Q,deltaMode:V}=X;k&&z&&V===0&&Kl(h)===o&&r.scrollBy({left:B,top:Q,behavior:"smooth"}),z=!1,d(H2,!0),C(()=>{z=!0,d(H2)}),E2(X)},{H:!1,I:!0}),tn(x,"transitionstart",X=>{if(W(X)){const B=()=>{I(),S(B)};B()}}),tn(x,"transitionend transitioncancel",X=>{W(X)&&(M(),I())}),tn(h,"mousedown",et(tn,a,"click",$g,{A:!0,I:!0}),{I:!0}),G(),j,M])}},JE=(e,t,n,o,r,a)=>{let c,d,f,m,h,g=$s,x=0;const[C,j]=Rr(),[S,M]=Rr(),[I,k]=Rr(100),[D,T]=Rr(100),[E,A]=Rr(100),[N,W]=Rr(()=>x),[G,z]=YE(e,r,o,XE(t,r,o)),{bt:X,Zt:B,Rt:Q}=r,{Ft:V,Bt:H,Nt:me,jt:Ie}=G,ye=ue=>{V(Ap,ue,!0),V(Ap,ue,!1)},de=(ue,je)=>{if(W(),ue)V(V2);else{const be=et(V,V2,!0);x>0&&!je?N(be):be()}},He=ue=>ue.pointerType==="mouse",Be=ue=>{He(ue)&&(m=d,m&&de(!0))},ce=[k,W,T,A,M,j,()=>g(),tn(X,"pointerover",Be,{A:!0}),tn(X,"pointerenter",Be),tn(X,"pointerleave",ue=>{He(ue)&&(m=!1,d&&de(!1))}),tn(X,"pointermove",ue=>{He(ue)&&c&&C(()=>{k(),de(!0),D(()=>{c&&de(!1)})})}),tn(B,"scroll",ue=>{S(()=>{me(),f&&de(!0),I(()=>{f&&!m&&de(!1)})}),a(ue),Ie()})];return[()=>et(qs,$t(ce,z())),({Et:ue,Tt:je,Gt:be,Qt:ee})=>{const{tn:J,nn:F,sn:oe}=ee||{},{Ct:le,dt:fe}=be||{},{N:he}=n,{T:ke}=Qs(),{k:ze,en:$e}=o,[Je,gt]=ue("showNativeOverlaidScrollbars"),[R,Z]=ue("scrollbars.theme"),[ne,ge]=ue("scrollbars.visibility"),[xe,pe]=ue("scrollbars.autoHide"),[te,Ce]=ue("scrollbars.autoHideSuspend"),[Ue]=ue("scrollbars.autoHideDelay"),[tt,wt]=ue("scrollbars.dragScroll"),[Zt,Ft]=ue("scrollbars.clickScroll"),[on,is]=ue("overflow"),xn=fe&&!je,Yn=$e.x||$e.y,Bn=J||F||le||je,Ps=oe||ge||is,cs=Je&&ke.x&&ke.y,us=(eo,br,Kc)=>{const Yc=eo.includes("scroll")&&(ne==="visible"||ne==="auto"&&br==="scroll");return V(LE,Yc,Kc),Yc};if(x=Ue,xn&&(te&&Yn?(ye(!1),g(),E(()=>{g=tn(B,"scroll",et(ye,!0),{A:!0})})):ye(!0)),gt&&V(PE,cs),Z&&(V(h),V(R,!0),h=R),Ce&&!te&&ye(!0),pe&&(c=xe==="move",d=xe==="leave",f=xe!=="never",de(!f,!0)),wt&&V(BE,tt),Ft&&V(RE,Zt),Ps){const eo=us(on.x,ze.x,!0),br=us(on.y,ze.y,!1);V(TE,!(eo&&br))}Bn&&(H(),me(),Ie(),V(F2,!$e.x,!0),V(F2,!$e.y,!1),V(DE,he&&!Q))},{},G]},e_=e=>{const t=Qs(),{G:n,L:o}=t,{elements:r}=n(),{host:a,padding:c,viewport:d,content:f}=r,m=ec(e),h=m?{}:e,{elements:g}=h,{host:x,padding:C,viewport:j,content:S}=g||{},M=m?e:h.target,I=yp(M,"textarea"),k=M.ownerDocument,D=k.documentElement,T=M===k.body,E=k.defaultView,A=()=>k.activeElement,N=ge=>{ge&&ge.focus&&ge.focus()},W=et(WE,[M]),G=et(Nj,[M]),z=et(Zg,[M]),X=et(Ol,""),B=et(W,X,d),Q=et(G,X,f),V=B(j),H=V===M,me=H&&T,Ie=!H&&Q(S),ye=!H&&ec(V)&&V===Ie,de=ye&&!!z(f),He=de?B():V,Be=de?Ie:Q(),ue=me?D:ye?He:V,je=I?W(X,a,x):M,be=me?ue:je,ee=ye?Be:Ie,J={gt:M,bt:be,D:ue,cn:!H&&G(X,c,C),wt:ee,kt:me?D:ue,Zt:me?k:ue,rn:T?D:M,ln:E,Kt:k,St:I,Rt:T,Dt:m,V:H,an:ye,yt:ge=>hE(ue,H?Os:Br,ge),Ot:(ge,xe)=>pd(ue,H?Os:Br,ge,xe)},F=xr(J).reduce((ge,xe)=>{const pe=J[xe];return $t(ge,pe&&ec(pe)&&!Kl(pe)?pe:!1)},[]),oe=ge=>ge?jf(F,ge):null,{gt:le,bt:fe,cn:he,D:ke,wt:ze}=J,$e=[()=>{Do(fe,[Os,Lm]),Do(le,Lm),T&&Do(D,[Lm,Os])}],Je=I&&oe(fe);let gt=I?le:bp([ze,ke,he,fe,le].find(ge=>oe(ge)===!1));const R=me?le:ze||ke,Z=et(qs,$e);return[J,()=>{const ge=A(),xe=Ce=>{Fs(Kl(Ce),bp(Ce)),Kr(Ce)},pe=Ce=>Ce?tn(Ce,"focusin focusout focus blur",Ue=>{$g(Ue),Ue.stopImmediatePropagation()},{I:!0,H:!1}):$s,te=pe(ge);if(lo(fe,Os,H?"viewport":"host"),lo(he,Mp,""),lo(ze,z2,""),H||(lo(ke,Br,""),T&&hc(D,Os,SE)),Je&&(I2(le,fe),$t($e,()=>{I2(fe,le),Kr(fe)})),Fs(R,gt),Fs(fe,he),Fs(he||fe,!H&&ke),Fs(ke,ze),$t($e,[te,()=>{const Ce=A(),Ue=pe(Ce);Do(he,Mp),Do(ze,z2),Do(ke,[Mj,Aj,Br]),oe(ze)&&xe(ze),oe(ke)&&xe(ke),oe(he)&&xe(he),N(Ce),Ue()}]),o&&!H&&(hc(ke,Br,Dj),$t($e,et(Do,ke,Br))),!H&&E.top===E&&ge===M){const Ce="tabindex",Ue=kf(ke,Ce);lo(ke,Ce,"-1"),N(ke);const tt=()=>Ue?lo(ke,Ce,Ue):Do(ke,Ce),wt=tn(k,"pointerdown keydown",()=>{tt(),wt()});$t($e,[tt,wt])}else N(ge);return te(),gt=0,Z},Z]},t_=({wt:e})=>({Gt:t,un:n,Tt:o})=>{const{xt:r}=t||{},{$t:a}=n;e&&(r||o)&&Yl(e,{[ql]:a&&"100%"})},n_=({bt:e,cn:t,D:n,V:o},r)=>{const[a,c]=co({u:fE,o:P2()},et(P2,e,"padding",""));return({Et:d,Gt:f,un:m,Tt:h})=>{let[g,x]=c(h);const{L:C}=Qs(),{ht:j,Ht:S,Ct:M}=f||{},{N:I}=m,[k,D]=d("paddingAbsolute");(j||x||(h||S))&&([g,x]=a(h));const E=!o&&(D||M||x);if(E){const A=!k||!t&&!C,N=g.r+g.l,W=g.t+g.b,G={[uj]:A&&!I?-N:0,[dj]:A?-W:0,[cj]:A&&I?-N:0,top:A?-g.t:0,right:A?I?-g.r:"auto":0,left:A?I?"auto":-g.l:0,[Zl]:A&&`calc(100% + ${N}px)`},z={[rj]:A?g.t:0,[aj]:A?g.r:0,[ij]:A?g.b:0,[lj]:A?g.l:0};Yl(t||n,G),Yl(n,z),St(r,{cn:g,fn:!A,j:t?z:St({},G,z)})}return{_n:E}}},s_=(e,t)=>{const n=Qs(),{bt:o,cn:r,D:a,V:c,Ot:d,Rt:f,ln:m}=e,{L:h}=n,g=f&&c,x=et(zl,0),C={u:hj,o:{w:0,h:0}},j={u:mj,o:{x:Ql,y:Ql}},S=(z,X)=>{const B=Zs.devicePixelRatio%1!==0?1:0,Q={w:x(z.w-X.w),h:x(z.h-X.h)};return{w:Q.w>B?Q.w:0,h:Q.h>B?Q.h:0}},[M,I]=co(C,et(Hg,a)),[k,D]=co(C,et(Sp,a)),[T,E]=co(C),[A,N]=co(C),[W]=co(j),G=pi(Ug);return({Et:z,Gt:X,un:B,Tt:Q},{_n:V})=>{const{ht:H,Ht:me,Ct:Ie,zt:ye}=X||{},de=G&&G.M(e,t,B,n,z),{q:He,W:Be,X:ce}=de||{},[ue,je]=FE(z,n),[be,ee]=z("overflow"),J=H||V||me||Ie||ye||je,F=zd(be.x),oe=zd(be.y),le=F||oe;let fe=I(Q),he=D(Q),ke=E(Q),ze=N(Q),$e;if(je&&h&&d(Dj,!ue),J){le&&d(Vl,!1);const[Zt,Ft]=Be?Be($e):[],[on,is]=fe=M(Q),[xn,Yn]=he=k(Q),Bn=Sj(a),Ps=xn,cs=Bn;Zt&&Zt(),(Yn||is||je)&&Ft&&!ue&&He&&He(Ft,xn,on);const us=vE(m),eo={w:x(zl(xn.w,Ps.w)+on.w),h:x(zl(xn.h,Ps.h)+on.h)},br={w:x((g?us.w:cs.w+x(Bn.w-xn.w))+on.w),h:x((g?us.h:cs.h+x(Bn.h-xn.h))+on.h)};ze=A(br),ke=T(S(eo,br),Q)}const[Je,gt]=ze,[R,Z]=ke,[ne,ge]=he,[xe,pe]=fe,te={x:R.w>0,y:R.h>0},Ce=F&&oe&&(te.x||te.y)||F&&te.x&&!te.y||oe&&te.y&&!te.x;if(V||Ie||ye||pe||ge||gt||Z||ee||je||J){const Zt={},Ft=VE(e,te,be,Zt);ce&&ce(Ft,B,!!He&&He(Ft,ne,xe),Zt),c?(lo(o,Mj,Zt[Sf]),lo(o,Aj,Zt[wf])):Yl(a,Zt)}pd(o,Os,Pj,Ce),pd(r,Mp,kE,Ce),c||pd(a,Br,Vl,le);const[tt,wt]=W(Rj(e).k);return St(t,{k:tt,Pt:{x:Je.w,y:Je.h},Lt:{x:R.w,y:R.h},en:te}),{sn:wt,tn:gt,nn:Z}}},o_=e=>{const[t,n,o]=e_(e),r={cn:{t:0,r:0,b:0,l:0},fn:!1,j:{[uj]:0,[dj]:0,[cj]:0,[rj]:0,[aj]:0,[ij]:0,[lj]:0},Pt:{x:0,y:0},Lt:{x:0,y:0},k:{x:Ql,y:Ql},en:{x:!1,y:!1}},{gt:a,D:c,V:d}=t,{L:f,T:m}=Qs(),h=!f&&(m.x||m.y),g=[t_(t),n_(t,r),s_(t,r)];return[n,x=>{const C={},S=h&&Xl(c),M=d?hc(c,Os,Ip):$s;return Pt(g,I=>{St(C,I(x,C)||{})}),M(),Yr(c,S),!d&&Yr(a,0),C},r,t,o]},r_=(e,t,n,o)=>{const r=N2(t,{}),[a,c,d,f,m]=o_(e),[h,g,x]=KE(f,d,r,k=>{I({},k)}),[C,j,,S]=JE(e,t,x,d,f,o),M=k=>xr(k).some(D=>!!k[D]),I=(k,D)=>{const{dn:T,Tt:E,At:A,vn:N}=k,W=T||{},G=!!E,z={Et:N2(t,W,G),dn:W,Tt:G};if(N)return j(z),!1;const X=D||g(St({},z,{At:A})),B=c(St({},z,{un:x,Gt:X}));j(St({},z,{Gt:X,Qt:B}));const Q=M(X),V=M(B),H=Q||V||!Og(W)||G;return H&&n(k,{Gt:X,Qt:B}),H};return[()=>{const{rn:k,D}=f,T=Xl(k),E=[h(),a(),C()];return Yr(D,T),et(qs,E)},I,()=>({hn:x,pn:d}),{gn:f,bn:S},m]},Ro=(e,t,n)=>{const{nt:o}=Qs(),r=ec(e),a=r?e:e.target,c=zj(a);if(t&&!c){let d=!1;const f=[],m={},h=z=>{const X=xj(z,!0),B=pi(zE);return B?B(X,!0):X},g=St({},o(),h(t)),[x,C,j]=kp(),[S,M,I]=kp(n),k=(z,X)=>{I(z,X),j(z,X)},[D,T,E,A,N]=r_(e,g,({dn:z,Tt:X},{Gt:B,Qt:Q})=>{const{ht:V,Ct:H,xt:me,Ht:Ie,It:ye,dt:de}=B,{tn:He,nn:Be,sn:ce}=Q;k("updated",[G,{updateHints:{sizeChanged:!!V,directionChanged:!!H,heightIntrinsicChanged:!!me,overflowEdgeChanged:!!He,overflowAmountChanged:!!Be,overflowStyleChanged:!!ce,contentMutation:!!Ie,hostMutation:!!ye,appear:!!de},changedOptions:z||{},force:!!X}])},z=>k("scroll",[G,z])),W=z=>{ZE(a),qs(f),d=!0,k("destroyed",[G,z]),C(),M()},G={options(z,X){if(z){const B=X?o():{},Q=kj(g,St(B,h(z)));Og(Q)||(St(g,Q),T({dn:Q}))}return St({},g)},on:S,off:(z,X)=>{z&&X&&M(z,X)},state(){const{hn:z,pn:X}=E(),{N:B}=z,{Pt:Q,Lt:V,k:H,en:me,cn:Ie,fn:ye}=X;return St({},{overflowEdge:Q,overflowAmount:V,overflowStyle:H,hasOverflow:me,padding:Ie,paddingAbsolute:ye,directionRTL:B,destroyed:d})},elements(){const{gt:z,bt:X,cn:B,D:Q,wt:V,kt:H,Zt:me}=A.gn,{qt:Ie,Jt:ye}=A.bn,de=Be=>{const{Vt:ce,Mt:ue,Ut:je}=Be;return{scrollbar:je,track:ue,handle:ce}},He=Be=>{const{Wt:ce,Xt:ue}=Be,je=de(ce[0]);return St({},je,{clone:()=>{const be=de(ue());return T({vn:!0}),be}})};return St({},{target:z,host:X,padding:B||Q,viewport:Q,content:V||Q,scrollOffsetElement:H,scrollEventElement:me,scrollbarHorizontal:He(Ie),scrollbarVertical:He(ye)})},update:z=>T({Tt:z,At:!0}),destroy:et(W,!1),plugin:z=>m[xr(z)[0]]};return $t(f,[N]),UE(a,G),Tj(_j,Ro,[G,x,m]),GE(A.gn.Rt,!r&&e.cancel)?(W(!0),G):($t(f,D()),k("initialized",[G]),G.update(!0),G)}return c};Ro.plugin=e=>{const t=go(e),n=t?e:[e],o=n.map(r=>Tj(r,Ro)[0]);return NE(n),t?o:o[0]};Ro.valid=e=>{const t=e&&e.elements,n=po(t)&&t();return Rd(n)&&!!zj(n.target)};Ro.env=()=>{const{P:e,T:t,L:n,K:o,J:r,st:a,et:c,G:d,tt:f,nt:m,ot:h}=Qs();return St({},{scrollbarsSize:e,scrollbarsOverlaid:t,scrollbarsHiding:n,rtlScrollBehavior:o,scrollTimeline:r,staticDefaultInitialization:a,staticDefaultOptions:c,getDefaultInitialization:d,setDefaultInitialization:f,getDefaultOptions:m,setDefaultOptions:h})};Ro.plugin(HE);const Oc={defer:!0,options:{scrollbars:{visibility:"auto",autoHide:"scroll",autoHideDelay:1300,theme:"os-theme-dark",clickScroll:!0},overflow:{x:"hidden"}}},Fj=(e="hidden",t="scroll")=>{const n=D5(Oc);return wC(n,{options:{overflow:{y:t,x:e}}}),n},a_=()=>{if(typeof window>"u"){const m=()=>{};return[m,m]}let e,t;const n=window,o=typeof n.requestIdleCallback=="function",r=n.requestAnimationFrame,a=n.cancelAnimationFrame,c=o?n.requestIdleCallback:r,d=o?n.cancelIdleCallback:a,f=()=>{d(e),a(t)};return[(m,h)=>{f(),e=c(o?()=>{f(),t=r(m)}:m,typeof h=="object"?h:{timeout:2233})},f]},Qg=e=>{const{options:t,events:n,defer:o}=e||{},[r,a]=u.useMemo(a_,[]),c=u.useRef(null),d=u.useRef(o),f=u.useRef(t),m=u.useRef(n);return u.useEffect(()=>{d.current=o},[o]),u.useEffect(()=>{const{current:h}=c;f.current=t,Ro.valid(h)&&h.options(t||{},!0)},[t]),u.useEffect(()=>{const{current:h}=c;m.current=n,Ro.valid(h)&&h.on(n||{},!0)},[n]),u.useEffect(()=>()=>{var h;a(),(h=c.current)==null||h.destroy()},[]),u.useMemo(()=>[h=>{const g=c.current;if(Ro.valid(g))return;const x=d.current,C=f.current||{},j=m.current||{},S=()=>c.current=Ro(h,C,j);x?r(S,x):S()},()=>c.current],[])},l_=(e,t)=>{const{element:n="div",options:o,events:r,defer:a,children:c,...d}=e,f=n,m=u.useRef(null),h=u.useRef(null),[g,x]=Qg({options:o,events:r,defer:a});return u.useEffect(()=>{const{current:C}=m,{current:j}=h;return C&&j&&g({target:C,elements:{viewport:j,content:j}}),()=>{var S;return(S=x())==null?void 0:S.destroy()}},[g,n]),u.useImperativeHandle(t,()=>({osInstance:x,getElement:()=>m.current}),[]),q.createElement(f,{"data-overlayscrollbars-initialize":"",ref:m,...d},q.createElement("div",{"data-overlayscrollbars-contents":"",ref:h},c))},Af=u.forwardRef(l_),i_={height:"100%",width:"100%"},c_=({children:e,maxHeight:t,overflowX:n="hidden",overflowY:o="scroll"})=>{const r=u.useMemo(()=>Fj(n,o).options,[n,o]);return s.jsx(P,{w:"full",h:"full",maxHeight:t,position:"relative",children:s.jsx(Ae,{position:"absolute",top:0,left:0,right:0,bottom:0,children:s.jsx(Af,{defer:!0,style:i_,options:r,children:e})})})},Wn=u.memo(c_),u_=Ve(Kp,e=>e.prompts),d_={"&::marker":{color:"base.500"}},f_=()=>{const{t:e}=L(),t=b(c=>c.dynamicPrompts.parsingError),n=b(c=>c.dynamicPrompts.isError),o=b(c=>c.dynamicPrompts.isLoading),r=b(u_),a=u.useMemo(()=>{let c=`${e("dynamicPrompts.promptsPreview")} (${r.length})`;return t&&(c+=` - ${t}`),c},[t,r.length,e]);return n?s.jsx(P,{w:"full",h:"full",layerStyle:"second",alignItems:"center",justifyContent:"center",p:8,children:s.jsx(Ut,{icon:Xb,label:"Problem generating prompts"})}):s.jsxs($,{orientation:"vertical",w:"full",h:"full",isInvalid:!!(t||n),children:[s.jsx(Ke,{feature:"dynamicPrompts",inPortal:!1,children:s.jsx(Y,{children:a})}),s.jsxs(P,{w:"full",h:"full",pos:"relative",layerStyle:"first",p:4,borderRadius:"base",children:[s.jsx(Wn,{children:s.jsx(E5,{stylePosition:"inside",ms:0,children:r.map((c,d)=>s.jsx(To,{fontSize:"sm",sx:d_,children:s.jsx(re,{as:"span",children:c})},`${c}.${d}`))})}),o&&s.jsx(P,{pos:"absolute",w:"full",h:"full",top:0,insetInlineStart:0,layerStyle:"second",opacity:.7,alignItems:"center",justifyContent:"center",children:s.jsx(la,{})})]})]})},h_=u.memo(f_),m_=()=>{const e=O(),{t}=L(),n=b(c=>c.dynamicPrompts.seedBehaviour),o=u.useMemo(()=>[{value:"PER_ITERATION",label:t("dynamicPrompts.seedBehaviour.perIterationLabel"),description:t("dynamicPrompts.seedBehaviour.perIterationDesc")},{value:"PER_PROMPT",label:t("dynamicPrompts.seedBehaviour.perPromptLabel"),description:t("dynamicPrompts.seedBehaviour.perPromptDesc")}],[t]),r=u.useCallback(c=>{_5(c==null?void 0:c.value)&&e(L5(c.value))},[e]),a=u.useMemo(()=>o.find(c=>c.value===n),[o,n]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"dynamicPromptsSeedBehaviour",inPortal:!1,children:s.jsx(Y,{children:t("dynamicPrompts.seedBehaviour.label")})}),s.jsx(ot,{value:a,options:o,onChange:r})]})},p_=u.memo(m_),Vj=u.memo(()=>{const{t:e}=L(),{isOpen:t,onClose:n}=Rb();return s.jsxs(Fa,{isOpen:t,onClose:n,isCentered:!0,children:[s.jsx(mr,{}),s.jsxs(Va,{w:"80vw",h:"80vh",maxW:"unset",maxH:"unset",children:[s.jsx(pr,{children:e("dynamicPrompts.dynamicPrompts")}),s.jsx(ri,{}),s.jsxs(gr,{as:P,flexDir:"column",gap:4,w:"full",h:"full",pb:4,children:[s.jsxs(P,{gap:4,children:[s.jsx(p_,{}),s.jsx(rE,{})]}),s.jsx(h_,{})]})]})]})});Vj.displayName="DynamicPromptsModal";const Zo=e=>()=>{const t=T5(void 0);return[u.useMemo(()=>t.data?R5.selectAll(t.data).filter(e):Gl,[t]),t]},Pf=Zo(wc),g_=Zo(B5),Kg=Zo(kC),x_=Zo(N5),Df=Zo(tg),Yg=Zo(IC),Xg=Zo(MC),Jg=Zo(AC),Hj=Zo(z5),Ef=Zo(PC),Pp="starterModels",v_=()=>{const{t:e}=L(),t=cn("starterModels").isFeatureEnabled,[n,o]=u.useState(!1),[r,{data:a}]=Pf(),c=na();u.useEffect(()=>{c.isActive(Pp)||a&&r.length===0&&!n&&t&&c({id:Pp,title:e("modelManager.noModelsInstalled"),description:s.jsx(C_,{}),status:"info",isClosable:!0,duration:null,onCloseComplete:()=>o(!0)})},[a,n,t,r.length,e,c])},C_=()=>{const{t:e}=L(),t=O(),n=na(),o=u.useCallback(()=>{t(zs("modelManager")),n.close(Pp)},[t,n]);return s.jsxs(re,{fontSize:"md",children:[e("modelManager.noModelsInstalledDesc1")," ",s.jsxs(qe,{onClick:o,variant:"link",color:"base.50",flexGrow:0,children:[e("modelManager.modelManager"),"."]})]})},y_=it(ni,e=>e.language);function b_(e){return Se({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M15.4565 9.67491L15.3144 9.53285C14.6661 8.90783 13.8549 8.43357 12.9235 8.18399C10.0168 7.40515 7.22541 9.05261 6.43185 12.0142C6.38901 12.1741 6.36574 12.3536 6.3285 12.805C6.17423 14.675 5.73449 16.0696 4.5286 17.4841C6.78847 18.3726 9.46572 18.9984 11.5016 18.9984C13.9702 18.9984 16.1644 17.3393 16.8126 14.9201C17.3306 12.9868 16.7513 11.018 15.4565 9.67491ZM13.2886 6.21289L18.2278 2.3713C18.6259 2.06168 19.1922 2.09694 19.5488 2.45355L22.543 5.44774C22.8997 5.80435 22.9349 6.3707 22.6253 6.76879L18.7847 11.7067C19.0778 12.895 19.0836 14.1719 18.7444 15.4377C17.8463 18.7896 14.8142 20.9984 11.5016 20.9984C8 20.9984 3.5 19.4966 1 17.9966C4.97978 14.9966 4.04722 13.1864 4.5 11.4966C5.55843 7.54646 9.34224 5.23923 13.2886 6.21289ZM16.7015 8.09149C16.7673 8.15494 16.8319 8.21952 16.8952 8.2852L18.0297 9.41972L20.5046 6.23774L18.7589 4.49198L15.5769 6.96685L16.7015 8.09149Z"},child:[]}]})(e)}function j_(e){return Se({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M5 5V19H19V5H5ZM4 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3ZM9.86885 15L9.04918 17H6.83333L11 7H13L17.1667 17H14.9508L14.1311 15H9.86885ZM10.6885 13H13.3115L12 9.8L10.6885 13Z"},child:[]}]})(e)}function S_(e){return Se({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M5 11H19V5H5V11ZM21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3H20C20.5523 3 21 3.44772 21 4ZM19 13H5V19H19V13ZM7 15H10V17H7V15ZM7 7H10V9H7V7Z"},child:[]}]})(e)}function w_(e){return Se({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M8 4H21V6H8V4ZM3 3.5H6V6.5H3V3.5ZM3 10.5H6V13.5H3V10.5ZM3 17.5H6V20.5H3V17.5ZM8 11H21V13H8V11ZM8 18H21V20H8V18Z"},child:[]}]})(e)}function k_(e){return Se({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M19.3034 5.33716C17.9344 4.71103 16.4805 4.2547 14.9629 4C14.7719 4.32899 14.5596 4.77471 14.411 5.12492C12.7969 4.89144 11.1944 4.89144 9.60255 5.12492C9.45397 4.77471 9.2311 4.32899 9.05068 4C7.52251 4.2547 6.06861 4.71103 4.70915 5.33716C1.96053 9.39111 1.21766 13.3495 1.5891 17.2549C3.41443 18.5815 5.17612 19.388 6.90701 19.9187C7.33151 19.3456 7.71356 18.73 8.04255 18.0827C7.41641 17.8492 6.82211 17.5627 6.24904 17.2231C6.39762 17.117 6.5462 17.0003 6.68416 16.8835C10.1438 18.4648 13.8911 18.4648 17.3082 16.8835C17.4568 17.0003 17.5948 17.117 17.7434 17.2231C17.1703 17.5627 16.576 17.8492 15.9499 18.0827C16.2789 18.73 16.6609 19.3456 17.0854 19.9187C18.8152 19.388 20.5875 18.5815 22.4033 17.2549C22.8596 12.7341 21.6806 8.80747 19.3034 5.33716ZM8.5201 14.8459C7.48007 14.8459 6.63107 13.9014 6.63107 12.7447C6.63107 11.5879 7.45884 10.6434 8.5201 10.6434C9.57071 10.6434 10.4303 11.5879 10.4091 12.7447C10.4091 13.9014 9.57071 14.8459 8.5201 14.8459ZM15.4936 14.8459C14.4535 14.8459 13.6034 13.9014 13.6034 12.7447C13.6034 11.5879 14.4323 10.6434 15.4936 10.6434C16.5442 10.6434 17.4038 11.5879 17.3825 12.7447C17.3825 13.9014 16.5548 14.8459 15.4936 14.8459Z"},child:[]}]})(e)}function I_(e){return Se({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12.001 2C6.47598 2 2.00098 6.475 2.00098 12C2.00098 16.425 4.86348 20.1625 8.83848 21.4875C9.33848 21.575 9.52598 21.275 9.52598 21.0125C9.52598 20.775 9.51348 19.9875 9.51348 19.15C7.00098 19.6125 6.35098 18.5375 6.15098 17.975C6.03848 17.6875 5.55098 16.8 5.12598 16.5625C4.77598 16.375 4.27598 15.9125 5.11348 15.9C5.90098 15.8875 6.46348 16.625 6.65098 16.925C7.55098 18.4375 8.98848 18.0125 9.56348 17.75C9.65098 17.1 9.91348 16.6625 10.201 16.4125C7.97598 16.1625 5.65098 15.3 5.65098 11.475C5.65098 10.3875 6.03848 9.4875 6.67598 8.7875C6.57598 8.5375 6.22598 7.5125 6.77598 6.1375C6.77598 6.1375 7.61348 5.875 9.52598 7.1625C10.326 6.9375 11.176 6.825 12.026 6.825C12.876 6.825 13.726 6.9375 14.526 7.1625C16.4385 5.8625 17.276 6.1375 17.276 6.1375C17.826 7.5125 17.476 8.5375 17.376 8.7875C18.0135 9.4875 18.401 10.375 18.401 11.475C18.401 15.3125 16.0635 16.1625 13.8385 16.4125C14.201 16.725 14.5135 17.325 14.5135 18.2625C14.5135 19.6 14.501 20.675 14.501 21.0125C14.501 21.275 14.6885 21.5875 15.1885 21.4875C19.259 20.1133 21.9999 16.2963 22.001 12C22.001 6.475 17.526 2 12.001 2Z"},child:[]}]})(e)}function M_(e){return Se({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M5 11.1005L7 9.1005L12.5 14.6005L16 11.1005L19 14.1005V5H5V11.1005ZM5 13.9289V19H8.1005L11.0858 16.0147L7 11.9289L5 13.9289ZM10.9289 19H19V16.9289L16 13.9289L10.9289 19ZM4 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3ZM15.5 10C14.6716 10 14 9.32843 14 8.5C14 7.67157 14.6716 7 15.5 7C16.3284 7 17 7.67157 17 8.5C17 9.32843 16.3284 10 15.5 10Z"},child:[]}]})(e)}function $j(e){return Se({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M22 18V20H2V18H22ZM2 3.5L10 8.5L2 13.5V3.5ZM22 11V13H12V11H22ZM22 4V6H12V4H22Z"},child:[]}]})(e)}function A_(e){return Se({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 1L21.5 6.5V17.5L12 23L2.5 17.5V6.5L12 1ZM4.5 7.65311V7.65788L12 12V20.689L19.5 16.3469V7.65311L12 3.311L4.5 7.65311Z"},child:[]}]})(e)}function P_(e){return Se({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M5.33409 4.54491C6.3494 3.63637 7.55145 2.9322 8.87555 2.49707C9.60856 3.4128 10.7358 3.99928 12 3.99928C13.2642 3.99928 14.3914 3.4128 15.1245 2.49707C16.4486 2.9322 17.6506 3.63637 18.6659 4.54491C18.2405 5.637 18.2966 6.90531 18.9282 7.99928C19.5602 9.09388 20.6314 9.77679 21.7906 9.95392C21.9279 10.6142 22 11.2983 22 11.9993C22 12.7002 21.9279 13.3844 21.7906 14.0446C20.6314 14.2218 19.5602 14.9047 18.9282 15.9993C18.2966 17.0932 18.2405 18.3616 18.6659 19.4536C17.6506 20.3622 16.4486 21.0664 15.1245 21.5015C14.3914 20.5858 13.2642 19.9993 12 19.9993C10.7358 19.9993 9.60856 20.5858 8.87555 21.5015C7.55145 21.0664 6.3494 20.3622 5.33409 19.4536C5.75952 18.3616 5.7034 17.0932 5.0718 15.9993C4.43983 14.9047 3.36862 14.2218 2.20935 14.0446C2.07212 13.3844 2 12.7002 2 11.9993C2 11.2983 2.07212 10.6142 2.20935 9.95392C3.36862 9.77679 4.43983 9.09388 5.0718 7.99928C5.7034 6.90531 5.75952 5.637 5.33409 4.54491ZM13.5 14.5974C14.9349 13.7689 15.4265 11.9342 14.5981 10.4993C13.7696 9.0644 11.9349 8.57277 10.5 9.4012C9.06512 10.2296 8.5735 12.0644 9.40192 13.4993C10.2304 14.9342 12.0651 15.4258 13.5 14.5974Z"},child:[]}]})(e)}function Wj(e){return Se({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M2 11.9998C2 11.1353 2.1097 10.2964 2.31595 9.49631C3.40622 9.55283 4.48848 9.01015 5.0718 7.99982C5.65467 6.99025 5.58406 5.78271 4.99121 4.86701C6.18354 3.69529 7.66832 2.82022 9.32603 2.36133C9.8222 3.33385 10.8333 3.99982 12 3.99982C13.1667 3.99982 14.1778 3.33385 14.674 2.36133C16.3317 2.82022 17.8165 3.69529 19.0088 4.86701C18.4159 5.78271 18.3453 6.99025 18.9282 7.99982C19.5115 9.01015 20.5938 9.55283 21.6841 9.49631C21.8903 10.2964 22 11.1353 22 11.9998C22 12.8643 21.8903 13.7032 21.6841 14.5033C20.5938 14.4468 19.5115 14.9895 18.9282 15.9998C18.3453 17.0094 18.4159 18.2169 19.0088 19.1326C17.8165 20.3043 16.3317 21.1794 14.674 21.6383C14.1778 20.6658 13.1667 19.9998 12 19.9998C10.8333 19.9998 9.8222 20.6658 9.32603 21.6383C7.66832 21.1794 6.18354 20.3043 4.99121 19.1326C5.58406 18.2169 5.65467 17.0094 5.0718 15.9998C4.48848 14.9895 3.40622 14.4468 2.31595 14.5033C2.1097 13.7032 2 12.8643 2 11.9998ZM6.80385 14.9998C7.43395 16.0912 7.61458 17.3459 7.36818 18.5236C7.77597 18.8138 8.21005 19.0652 8.66489 19.2741C9.56176 18.4712 10.7392 17.9998 12 17.9998C13.2608 17.9998 14.4382 18.4712 15.3351 19.2741C15.7899 19.0652 16.224 18.8138 16.6318 18.5236C16.3854 17.3459 16.566 16.0912 17.1962 14.9998C17.8262 13.9085 18.8225 13.1248 19.9655 12.7493C19.9884 12.5015 20 12.2516 20 11.9998C20 11.7481 19.9884 11.4981 19.9655 11.2504C18.8225 10.8749 17.8262 10.0912 17.1962 8.99982C16.566 7.90845 16.3854 6.65378 16.6318 5.47605C16.224 5.18588 15.7899 4.93447 15.3351 4.72552C14.4382 5.52844 13.2608 5.99982 12 5.99982C10.7392 5.99982 9.56176 5.52844 8.66489 4.72552C8.21005 4.93447 7.77597 5.18588 7.36818 5.47605C7.61458 6.65378 7.43395 7.90845 6.80385 8.99982C6.17376 10.0912 5.17754 10.8749 4.03451 11.2504C4.01157 11.4981 4 11.7481 4 11.9998C4 12.2516 4.01157 12.5015 4.03451 12.7493C5.17754 13.1248 6.17376 13.9085 6.80385 14.9998ZM12 14.9998C10.3431 14.9998 9 13.6567 9 11.9998C9 10.343 10.3431 8.99982 12 8.99982C13.6569 8.99982 15 10.343 15 11.9998C15 13.6567 13.6569 14.9998 12 14.9998ZM12 12.9998C12.5523 12.9998 13 12.5521 13 11.9998C13 11.4475 12.5523 10.9998 12 10.9998C11.4477 10.9998 11 11.4475 11 11.9998C11 12.5521 11.4477 12.9998 12 12.9998Z"},child:[]}]})(e)}function D_(e){return Se({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M17.0007 1.20801 18.3195 3.68083 20.7923 4.99968 18.3195 6.31852 17.0007 8.79134 15.6818 6.31852 13.209 4.99968 15.6818 3.68083 17.0007 1.20801ZM8.00065 4.33301 10.6673 9.33301 15.6673 11.9997 10.6673 14.6663 8.00065 19.6663 5.33398 14.6663.333984 11.9997 5.33398 9.33301 8.00065 4.33301ZM19.6673 16.333 18.0007 13.208 16.334 16.333 13.209 17.9997 16.334 19.6663 18.0007 22.7913 19.6673 19.6663 22.7923 17.9997 19.6673 16.333Z"},child:[]}]})(e)}function _f(e){return Se({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M14 4.4375C15.3462 4.4375 16.4375 3.34619 16.4375 2H17.5625C17.5625 3.34619 18.6538 4.4375 20 4.4375V5.5625C18.6538 5.5625 17.5625 6.65381 17.5625 8H16.4375C16.4375 6.65381 15.3462 5.5625 14 5.5625V4.4375ZM1 11C4.31371 11 7 8.31371 7 5H9C9 8.31371 11.6863 11 15 11V13C11.6863 13 9 15.6863 9 19H7C7 15.6863 4.31371 13 1 13V11ZM17.25 14C17.25 15.7949 15.7949 17.25 14 17.25V18.75C15.7949 18.75 17.25 20.2051 17.25 22H18.75C18.75 20.2051 20.2051 18.75 22 18.75V17.25C20.2051 17.25 18.75 15.7949 18.75 14H17.25Z"},child:[]}]})(e)}const E_=e=>{const{boardToDelete:t,setBoardToDelete:n}=e,{t:o}=L(),r=b(k=>k.config.canRestoreDeletedImagesFromBin),{currentData:a,isFetching:c}=O5((t==null?void 0:t.board_id)??Ot),d=u.useMemo(()=>Ve([bs,js,lt,Rn],(k,D,T,E)=>{const A=(a??[]).map(W=>jC(k,D,T,E,W));return{isInitialImage:fo(A,W=>W.isInitialImage),isCanvasImage:fo(A,W=>W.isCanvasImage),isNodesImage:fo(A,W=>W.isNodesImage),isControlImage:fo(A,W=>W.isControlImage)}}),[a]),[f,{isLoading:m}]=F5(),[h,{isLoading:g}]=V5(),x=b(d),C=u.useCallback(()=>{t&&(f(t.board_id),n(void 0))},[t,f,n]),j=u.useCallback(()=>{t&&(h(t.board_id),n(void 0))},[t,h,n]),S=u.useCallback(()=>{n(void 0)},[n]),M=u.useRef(null),I=u.useMemo(()=>g||m||c,[g,m,c]);return t?s.jsx(DC,{isOpen:!!t,onClose:S,leastDestructiveRef:M,isCentered:!0,children:s.jsx(mr,{children:s.jsxs(EC,{children:[s.jsxs(pr,{fontSize:"lg",fontWeight:"bold",children:[o("controlnet.delete")," ",t.board_name]}),s.jsx(gr,{children:s.jsxs(P,{direction:"column",gap:3,children:[c?s.jsx(eg,{children:s.jsx(P,{w:"full",h:32})}):s.jsx(Tb,{imageUsage:x,topMessage:o("boards.topMessage"),bottomMessage:o("boards.bottomMessage")}),s.jsx(re,{children:o("boards.deletedBoardsCannotbeRestored")}),s.jsx(re,{children:o(r?"gallery.deleteImageBin":"gallery.deleteImagePermanent")})]})}),s.jsx(Ha,{children:s.jsxs(P,{w:"full",gap:2,justifyContent:"end",children:[s.jsx(qe,{ref:M,onClick:S,children:o("boards.cancel")}),s.jsx(qe,{colorScheme:"warning",isLoading:I,onClick:C,children:o("boards.deleteBoardOnly")}),s.jsx(qe,{colorScheme:"error",isLoading:I,onClick:j,children:o("boards.deleteBoardAndImages")})]})})]})})}):null},__=u.memo(E_),L_=()=>{const{t:e}=L(),[t,{isLoading:n}]=H5(),o=e("boards.myBoard"),r=u.useCallback(()=>{t(o)},[t,o]);return s.jsx(ve,{icon:s.jsx(Hs,{}),isLoading:n,tooltip:e("boards.addBoard"),"aria-label":e("boards.addBoard"),onClick:r,size:"sm","data-testid":"add-board-button"})},T_=u.memo(L_),R_=()=>{const e=O(),t=b(d=>d.gallery.boardSearchText),{t:n}=L(),o=u.useCallback(d=>{e(zx(d))},[e]),r=u.useCallback(()=>{e(zx(""))},[e]),a=u.useCallback(d=>{d.key==="Escape"&&r()},[r]),c=u.useCallback(d=>{o(d.target.value)},[o]);return s.jsxs(qa,{children:[s.jsx(mn,{placeholder:n("boards.searchBoard"),value:t,onKeyDown:a,onChange:c,"data-testid":"board-search-input"}),t&&t.length&&s.jsx(Qa,{h:"full",pe:2,children:s.jsx(ve,{onClick:r,size:"sm",variant:"link","aria-label":n("boards.clearSearch"),icon:s.jsx($n,{})})})]})},B_=u.memo(R_);function Gj(e){return _C(e)}function N_(e){return LC(e)}const Uj=(e,t)=>{if(!e||!(t!=null&&t.data.current))return!1;const{actionType:n}=e,{payloadType:o}=t.data.current;if(e.id===t.data.current.id)return!1;switch(n){case"SET_CURRENT_IMAGE":return o==="IMAGE_DTO";case"SET_INITIAL_IMAGE":return o==="IMAGE_DTO";case"SET_CONTROL_ADAPTER_IMAGE":return o==="IMAGE_DTO";case"SET_CANVAS_INITIAL_IMAGE":return o==="IMAGE_DTO";case"SET_NODES_IMAGE":return o==="IMAGE_DTO";case"ADD_TO_BOARD":{if(!["IMAGE_DTO","GALLERY_SELECTION"].includes(o))return!1;if(o==="IMAGE_DTO"){const{imageDTO:a}=t.data.current.payload,c=a.board_id??"none",d=e.context.boardId;return c!==d}if(o==="GALLERY_SELECTION"){const a=t.data.current.payload.boardId,c=e.context.boardId;return a!==c}return!1}case"REMOVE_FROM_BOARD":{if(!["IMAGE_DTO","GALLERY_SELECTION"].includes(o))return!1;if(o==="IMAGE_DTO"){const{imageDTO:a}=t.data.current.payload;return(a.board_id??"none")!=="none"}return o==="GALLERY_SELECTION"?t.data.current.payload.boardId!=="none":!1}default:return!1}},z_={opacity:0},O_={opacity:1,transition:{duration:.1}},F_={opacity:0,transition:{duration:.1}},V_=e=>{const{t}=L(),{isOver:n,label:o=t("gallery.drop")}=e,r=u.useRef(ia());return s.jsx(Oa.div,{initial:z_,animate:O_,exit:F_,children:s.jsxs(P,{position:"absolute",top:0,insetInlineStart:0,w:"full",h:"full",children:[s.jsx(P,{position:"absolute",top:0,insetInlineStart:0,w:"full",h:"full",bg:"base.900",opacity:.7,borderRadius:"base",alignItems:"center",justifyContent:"center",transitionProperty:"common",transitionDuration:"0.1s"}),s.jsx(P,{position:"absolute",top:.5,insetInlineStart:.5,insetInlineEnd:.5,bottom:.5,opacity:1,borderWidth:2,borderColor:n?"base.50":"base.300",borderRadius:"lg",borderStyle:"dashed",transitionProperty:"common",transitionDuration:"0.1s",alignItems:"center",justifyContent:"center",children:s.jsx(Ae,{fontSize:"2xl",fontWeight:"semibold",transform:n?"scale(1.1)":"scale(1)",color:n?"base.50":"base.300",transitionProperty:"common",transitionDuration:"0.1s",children:o})})]})},r.current)},Zj=u.memo(V_),H_=e=>{const{dropLabel:t,data:n,disabled:o}=e,r=u.useRef(ia()),{isOver:a,setNodeRef:c,active:d}=Gj({id:r.current,disabled:o,data:n});return s.jsx(Ae,{ref:c,position:"absolute",top:0,insetInlineStart:0,w:"full",h:"full",pointerEvents:d?"auto":"none",children:s.jsx(Ul,{children:Uj(n,d)&&s.jsx(Zj,{isOver:a,label:t})})})},e0=u.memo(H_),$_=({isSelected:e,isHovered:t})=>{const n=u.useMemo(()=>{if(e&&t)return"hoverSelected";if(e&&!t)return"selected";if(!e&&t)return"hoverUnselected"},[t,e]);return s.jsx(Ae,{className:"selection-box",position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,borderRadius:"base",opacity:e?1:.7,transitionProperty:"common",transitionDuration:"0.1s",pointerEvents:"none",shadow:n})},t0=u.memo($_),W_=()=>{const{t:e}=L();return s.jsx(P,{position:"absolute",insetInlineEnd:0,top:0,p:1,children:s.jsx(Ws,{variant:"solid",bg:"invokeBlue.400",children:e("common.auto")})})},qj=u.memo(W_),Lf=e=>{const{boardName:t}=Sc(void 0,{selectFromResult:({data:n})=>{const o=n==null?void 0:n.find(a=>a.board_id===e);return{boardName:(o==null?void 0:o.board_name)||Te("boards.uncategorized")}}});return t},G_=({board:e,setBoardToDelete:t})=>{const{t:n}=L(),o=u.useCallback(()=>{t&&t(e)},[e,t]);return s.jsx(s.Fragment,{children:s.jsx(ut,{color:"error.300",icon:s.jsx(Xs,{}),onClick:o,children:n("boards.deleteBoard")})})},U_=u.memo(G_),Z_=({board:e,board_id:t,setBoardToDelete:n,children:o})=>{const{t:r}=L(),a=O(),c=b(S=>S.gallery.autoAssignBoardOnClick),d=u.useMemo(()=>it(kc,S=>e&&e.board_id===S.autoAddBoardId),[e]),f=b(d),m=Lf(t),h=cn("bulkDownload").isFeatureEnabled,[g]=TC(),x=u.useCallback(()=>{a(ef(t))},[t,a]),C=u.useCallback(()=>{g({image_names:[],board_id:t})},[t,g]),j=u.useCallback(()=>s.jsx(qr,{visibility:"visible",children:s.jsxs(dd,{title:m,children:[s.jsx(ut,{icon:s.jsx(Hs,{}),isDisabled:f||c,onClick:x,children:r("boards.menuItemAutoAdd")}),h&&s.jsx(ut,{icon:s.jsx(jD,{}),onClickCapture:C,children:r("boards.downloadBoard")}),e&&s.jsx(U_,{board:e,setBoardToDelete:n})]})}),[c,e,m,C,x,h,f,n,r]);return s.jsx(RC,{renderMenu:j,children:o})},Qj=u.memo(Z_),q_={p:0,_focusVisible:{p:0,textAlign:"center"}},Q_=({board:e,isSelected:t,setBoardToDelete:n})=>{const o=O(),r=b(z=>z.gallery.autoAssignBoardOnClick),a=u.useMemo(()=>it(kc,z=>e.board_id===z.autoAddBoardId),[e.board_id]),c=b(a),[d,f]=u.useState(!1),m=u.useCallback(()=>{f(!0)},[]),h=u.useCallback(()=>{f(!1)},[]),{data:g}=tf(e.board_id),{data:x}=nf(e.board_id),C=u.useMemo(()=>{if(!((g==null?void 0:g.total)===void 0||(x==null?void 0:x.total)===void 0))return`${g.total} image${g.total===1?"":"s"}, ${x.total} asset${x.total===1?"":"s"}`},[x,g]),{currentData:j}=Gs(e.cover_image_name??Ot),{board_name:S,board_id:M}=e,[I,k]=u.useState(S),D=u.useCallback(()=>{o(BC({boardId:M})),r&&o(ef(M))},[M,r,o]),[T,{isLoading:E}]=$5(),A=u.useMemo(()=>({id:M,actionType:"ADD_TO_BOARD",context:{boardId:M}}),[M]),N=u.useCallback(async z=>{if(!z.trim()){k(S);return}if(z!==S)try{const{board_name:X}=await T({board_id:M,changes:{board_name:z}}).unwrap();k(X)}catch{k(S)}},[M,S,T]),W=u.useCallback(z=>{k(z)},[]),{t:G}=L();return s.jsx(Ae,{w:"full",h:"full",userSelect:"none",children:s.jsx(P,{onMouseOver:m,onMouseOut:h,position:"relative",justifyContent:"center",alignItems:"center",aspectRatio:"1/1",w:"full",h:"full",children:s.jsx(Qj,{board:e,board_id:M,setBoardToDelete:n,children:z=>s.jsx(Dt,{label:C,openDelay:1e3,children:s.jsxs(P,{ref:z,onClick:D,w:"full",h:"full",position:"relative",justifyContent:"center",alignItems:"center",borderRadius:"base",cursor:"pointer",bg:"base.800",children:[j!=null&&j.thumbnail_url?s.jsx(Ks,{src:j==null?void 0:j.thumbnail_url,draggable:!1,objectFit:"cover",w:"full",h:"full",maxH:"full",borderRadius:"base",borderBottomRadius:"lg"}):s.jsx(P,{w:"full",h:"full",justifyContent:"center",alignItems:"center",children:s.jsx(gn,{boxSize:14,as:eE,mt:-6,opacity:.7,color:"base.500"})}),c&&s.jsx(qj,{}),s.jsx(t0,{isSelected:t,isHovered:d}),s.jsx(P,{position:"absolute",bottom:0,left:0,p:1,justifyContent:"center",alignItems:"center",w:"full",maxW:"full",borderBottomRadius:"base",bg:t?"invokeBlue.400":"base.600",color:t?"base.800":"base.100",lineHeight:"short",fontSize:"xs",children:s.jsxs(sf,{value:I,isDisabled:E,submitOnBlur:!0,onChange:W,onSubmit:N,w:"full",children:[s.jsx(of,{p:0,fontWeight:t?"bold":"normal",textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",noOfLines:1,color:"inherit"}),s.jsx(rf,{sx:q_})]})}),s.jsx(e0,{data:A,dropLabel:s.jsx(re,{fontSize:"md",children:G("unifiedCanvas.move")})})]})})})})})},K_=u.memo(Q_),Kj=u.memo(({isSelected:e})=>{const t=O(),n=b(S=>S.gallery.autoAddBoardId),o=b(S=>S.gallery.autoAssignBoardOnClick),r=Lf("none"),a=u.useCallback(()=>{t(BC({boardId:"none"})),o&&t(ef("none"))},[t,o]),[c,d]=u.useState(!1),{data:f}=tf("none"),{data:m}=nf("none"),h=u.useMemo(()=>{if(!((f==null?void 0:f.total)===void 0||(m==null?void 0:m.total)===void 0))return`${f.total} image${f.total===1?"":"s"}, ${m.total} asset${m.total===1?"":"s"}`},[m,f]),g=u.useCallback(()=>{d(!0)},[]),x=u.useCallback(()=>{d(!1)},[]),C=u.useMemo(()=>({id:"no_board",actionType:"REMOVE_FROM_BOARD"}),[]),{t:j}=L();return s.jsx(Ae,{w:"full",h:"full",userSelect:"none",children:s.jsx(P,{onMouseOver:g,onMouseOut:x,position:"relative",justifyContent:"center",alignItems:"center",aspectRatio:"1/1",borderRadius:"base",w:"full",h:"full",children:s.jsx(Qj,{board_id:"none",children:S=>s.jsx(Dt,{label:h,openDelay:1e3,children:s.jsxs(P,{ref:S,onClick:a,w:"full",h:"full",position:"relative",justifyContent:"center",alignItems:"center",borderRadius:"base",cursor:"pointer",bg:"base.800",children:[s.jsx(P,{w:"full",h:"full",justifyContent:"center",alignItems:"center",children:s.jsx(Ks,{src:NC,alt:"invoke-ai-logo",opacity:.7,mixBlendMode:"overlay",mt:-6,w:16,h:16,minW:16,minH:16,userSelect:"none"})}),n==="none"&&s.jsx(qj,{}),s.jsx(P,{position:"absolute",bottom:0,left:0,p:1,justifyContent:"center",alignItems:"center",w:"full",maxW:"full",borderBottomRadius:"base",bg:e?"invokeBlue.400":"base.600",color:e?"base.800":"base.100",lineHeight:"short",fontSize:"xs",fontWeight:e?"bold":"normal",children:r}),s.jsx(t0,{isSelected:e,isHovered:c}),s.jsx(e0,{data:C,dropLabel:s.jsx(re,{fontSize:"md",children:j("unifiedCanvas.move")})})]})})})})})});Kj.displayName="HoverableBoard";const Y_=u.memo(Kj),X_={height:"100%",width:"100%"},J_=e=>{const{isOpen:t}=e,n=b(f=>f.gallery.selectedBoardId),o=b(f=>f.gallery.boardSearchText),{data:r}=Sc(),a=o?r==null?void 0:r.filter(f=>f.board_name.toLowerCase().includes(o.toLowerCase())):r,[c,d]=u.useState();return s.jsxs(s.Fragment,{children:[s.jsx(zC,{in:t,animateOpacity:!0,children:s.jsxs(P,{layerStyle:"first",flexDir:"column",gap:2,p:2,mt:2,borderRadius:"base",children:[s.jsxs(P,{gap:2,alignItems:"center",children:[s.jsx(B_,{}),s.jsx(T_,{})]}),s.jsx(Af,{defer:!0,style:X_,options:Oc.options,children:s.jsxs(Nl,{className:"list-container","data-testid":"boards-list",gridTemplateColumns:"repeat(auto-fill, minmax(90px, 1fr))",maxH:346,children:[s.jsx(zr,{p:1.5,"data-testid":"no-board",children:s.jsx(Y_,{isSelected:n==="none"})}),a&&a.map((f,m)=>s.jsx(zr,{p:1.5,"data-testid":`board-${m}`,children:s.jsx(K_,{board:f,isSelected:n===f.board_id,setBoardToDelete:d})},f.board_id))]})})]})}),s.jsx(__,{boardToDelete:c,setBoardToDelete:d})]})},eL=u.memo(J_),tL=e=>{const{isOpen:t,onToggle:n}=e,o=b(c=>c.gallery.selectedBoardId),r=Lf(o),a=u.useMemo(()=>r.length>20?`${r.substring(0,20)}...`:r,[r]);return s.jsxs(P,{as:qe,onClick:n,size:"sm",position:"relative",gap:2,w:"full",justifyContent:"center",alignItems:"center",px:2,children:[s.jsx(Tn,{}),a,s.jsx(Tn,{}),s.jsx(gn,{as:Ag,boxSize:4,transform:t?"rotate(0deg)":"rotate(180deg)",transitionProperty:"common",transitionDuration:"normal"})]})},nL=u.memo(tL),sL=()=>{const e=O(),{t}=L(),n=b(m=>m.gallery.autoAddBoardId),o=b(m=>m.gallery.autoAssignBoardOnClick),{options:r,hasBoards:a}=Sc(void 0,{selectFromResult:({data:m})=>{const h=[{label:t("controlnet.none"),value:"none"}].concat((m??[]).map(({board_id:g,board_name:x})=>({label:x,value:g})));return{options:h,hasBoards:h.length>1}}}),c=u.useCallback(m=>{m&&e(ef(m.value))},[e]),d=u.useMemo(()=>r.find(m=>m.value===n),[r,n]),f=u.useCallback(()=>t("boards.noMatching"),[t]);return s.jsxs($,{isDisabled:!a||o,children:[s.jsx(Y,{children:t("boards.autoAddBoard")}),s.jsx(ot,{value:d,options:r,onChange:c,placeholder:t("boards.selectBoard"),noOptionsMessage:f})]})},oL=u.memo(sL),rL={flexGrow:1},aL=()=>{const e=O(),{t}=L(),n=b(h=>h.gallery.galleryImageMinimumWidth),o=b(h=>h.gallery.shouldAutoSwitch),r=b(h=>h.gallery.autoAssignBoardOnClick),a=b(h=>h.gallery.alwaysShowImageSizeBadge),c=u.useCallback(h=>{e(W5(h))},[e]),d=u.useCallback(h=>{e(G5(h.target.checked))},[e]),f=u.useCallback(h=>e(U5(h.target.checked)),[e]),m=u.useCallback(h=>e(Z5(h.target.checked)),[e]);return s.jsxs(oa,{isLazy:!0,children:[s.jsx(oi,{children:s.jsx(ve,{tooltip:t("gallery.gallerySettings"),"aria-label":t("gallery.gallerySettings"),size:"sm",icon:s.jsx(P_,{})})}),s.jsx(ra,{children:s.jsx(aa,{children:s.jsxs(P,{direction:"column",gap:2,children:[s.jsxs($,{children:[s.jsx(Y,{children:t("gallery.galleryImageSize")}),s.jsx(Ne,{value:n,onChange:c,min:45,max:256,defaultValue:90})]}),s.jsxs(En,{formLabelProps:rL,children:[s.jsxs($,{children:[s.jsx(Y,{children:t("gallery.autoSwitchNewImages")}),s.jsx(jt,{isChecked:o,onChange:d})]}),s.jsxs($,{children:[s.jsx(Y,{children:t("gallery.autoAssignBoardOnClick")}),s.jsx(bn,{isChecked:r,onChange:f})]}),s.jsxs($,{children:[s.jsx(Y,{children:t("gallery.alwaysShowImageSizeBadge")}),s.jsx(bn,{isChecked:a,onChange:m})]})]}),s.jsx(oL,{})]})})})]})},lL=u.memo(aL),Od=Za({}),ws=it(js,e=>e.batchIds.length>0||e.layerState.stagingArea.images.length>0),Tf=()=>{const e=O(),t=b(h=>h.gallery.galleryView),n=b(q5),o=Q5(n),r=b(h=>h.gallery.selectedBoardId),{data:a}=nf(r),{data:c}=tf(r),d=u.useMemo(()=>t==="images"?c==null?void 0:c.total:a==null?void 0:a.total,[a==null?void 0:a.total,t,c==null?void 0:c.total]),f=u.useMemo(()=>!d||!o.data?!1:o.data.ids.length<d,[o.data,d]),m=u.useCallback(()=>{e(K5())},[e]);return{areMoreImagesAvailable:f,handleLoadMoreImages:m,queryResult:o}},Yj=e=>`gallery-image-${e}`,Xj="image-item-container",iL=af((e,t)=>s.jsx(Ae,{className:"item-container",ref:t,p:1.5,"data-testid":Xj,children:e.children})),cL=u.memo(iL),Jj="image-list-container",uL=af((e,t)=>{const n=b(o=>o.gallery.galleryImageMinimumWidth);return s.jsx(Nl,{...e,className:"list-container",ref:t,gridTemplateColumns:`repeat(auto-fill, minmax(${n}px, 1fr))`,"data-testid":Jj,children:e.children})}),dL=u.memo(uL),eS=(e,t)=>e.top>=t.top&&e.bottom<=t.bottom&&e.left>=t.left&&e.right<=t.right,tS=(e,t)=>e>(t.endIndex-t.startIndex)/2+t.startIndex?"end":"start",n0=()=>{var o,r;const e=((o=document.querySelector(`[data-testid="${Xj}"]`))==null?void 0:o.getBoundingClientRect().width)??1,t=((r=document.querySelector(`[data-testid="${Jj}"]`))==null?void 0:r.getBoundingClientRect().width)??0;return Math.round(t/e)},fL=(e,t)=>{var m,h,g;const n=Od.get(),o=(m=n.virtuosoRangeRef)==null?void 0:m.current,r=(h=n.rootRef)==null?void 0:h.current,a=(g=n.virtuosoRef)==null?void 0:g.current;if(!o||!a||!r)return;const c=document.querySelector(`[data-testid="${Yj(e)}"]`),d=c==null?void 0:c.getBoundingClientRect(),f=r.getBoundingClientRect();(!d||!eS(d,f))&&a.scrollToIndex({index:t,align:tS(t,o)})},hL=(e,t)=>{const n=fr(t-1,0,e.length-1),o=e[n];return{index:n,image:o}},mL=(e,t)=>{const n=fr(t+1,0,e.length-1),o=e[n];return{index:n,image:o}},pL=(e,t)=>{const n=n0(),r=t<n?t:fr(t-n,0,e.length-1),a=e[r];return{index:r,image:a}},gL=(e,t)=>{const n=n0(),r=t<e.length-n?fr(t+n,0,e.length-1):t,a=e[r];return{index:r,image:a}},xL={left:hL,right:mL,up:pL,down:gL},nS=()=>{const e=O(),t=b(lf),{queryResult:{data:n}}=Tf(),o=u.useMemo(()=>(n==null?void 0:n.ids.length)??0,[n==null?void 0:n.ids.length]),r=u.useMemo(()=>!n||!t?0:Ox.selectAll(n).findIndex(C=>C.image_name===t.image_name),[t,n]),a=u.useCallback(C=>{if(!n)return;const{index:j,image:S}=xL[C](Ox.selectAll(n),r);!S||j===r||(e(Y5(S)),fL(S.image_name,j))},[e,r,n]),c=u.useMemo(()=>r===0,[r]),d=u.useMemo(()=>r===o-1,[r,o]),f=u.useMemo(()=>{const C=n0();return r+C<o},[r,o]),m=u.useCallback(()=>{a("left")},[a]),h=u.useCallback(()=>{a("right")},[a]),g=u.useCallback(()=>{a("up")},[a]),x=u.useCallback(()=>{a("down")},[a]);return{handleLeftImage:m,handleRightImage:h,handleUpImage:g,handleDownImage:x,isOnFirstImage:c,isOnLastImage:d,areImagesBelowCurrent:f}},vL=()=>{const e=b(ys),t=b(ws),n=u.useMemo(()=>e!=="unifiedCanvas"||!t,[e,t]),{areMoreImagesAvailable:o,handleLoadMoreImages:r,queryResult:{isFetching:a}}=Tf(),{handleLeftImage:c,handleRightImage:d,handleUpImage:f,handleDownImage:m,isOnLastImage:h,areImagesBelowCurrent:g}=nS();Re("left",()=>{n&&c()},[c,n]),Re("right",()=>{if(n){if(h&&o&&!a){r();return}h||d()}},[h,o,r,a,d,n]),Re("up",()=>{f()},{preventDefault:!0},[f]),Re("down",()=>{if(!g&&o&&!a){r();return}m()},{preventDefault:!0},[g,o,r,a,m])},Rf=0,ua=1,gi=2,sS=4;function oS(e,t){return n=>e(t(n))}function CL(e,t){return t(e)}function rS(e,t){return n=>e(t,n)}function W2(e,t){return()=>e(t)}function Bf(e,t){return t(e),e}function Yt(...e){return e}function yL(e){e()}function G2(e){return()=>e}function bL(...e){return()=>{e.map(yL)}}function s0(e){return e!==void 0}function xi(){}function _t(e,t){return e(ua,t)}function dt(e,t){e(Rf,t)}function o0(e){e(gi)}function Hn(e){return e(sS)}function Qe(e,t){return _t(e,rS(t,Rf))}function Fo(e,t){const n=e(ua,o=>{n(),t(o)});return n}function Ct(){const e=[];return(t,n)=>{switch(t){case gi:e.splice(0,e.length);return;case ua:return e.push(n),()=>{const o=e.indexOf(n);o>-1&&e.splice(o,1)};case Rf:e.slice().forEach(o=>{o(n)});return;default:throw new Error(`unrecognized action ${t}`)}}}function De(e){let t=e;const n=Ct();return(o,r)=>{switch(o){case ua:r(t);break;case Rf:t=r;break;case sS:return t}return n(o,r)}}function jL(e){let t,n;const o=()=>t&&t();return function(r,a){switch(r){case ua:return a?n===a?void 0:(o(),n=a,t=_t(e,a),t):(o(),xi);case gi:o(),n=null;return;default:throw new Error(`unrecognized action ${r}`)}}}function vs(e){return Bf(Ct(),t=>Qe(e,t))}function qn(e,t){return Bf(De(t),n=>Qe(e,n))}function SL(...e){return t=>e.reduceRight(CL,t)}function we(e,...t){const n=SL(...t);return(o,r)=>{switch(o){case ua:return _t(e,n(r));case gi:o0(e);return}}}function aS(e,t){return e===t}function Kt(e=aS){let t;return n=>o=>{e(t,o)||(t=o,n(o))}}function nt(e){return t=>n=>{e(n)&&t(n)}}function Ge(e){return t=>oS(t,e)}function Eo(e){return t=>()=>t(e)}function Bo(e,t){return n=>o=>n(t=e(t,o))}function Jl(e){return t=>n=>{e>0?e--:t(n)}}function Wr(e){let t=null,n;return o=>r=>{t=r,!n&&(n=setTimeout(()=>{n=void 0,o(t)},e))}}function U2(e){let t,n;return o=>r=>{t=r,n&&clearTimeout(n),n=setTimeout(()=>{o(t)},e)}}function mt(...e){const t=new Array(e.length);let n=0,o=null;const r=Math.pow(2,e.length)-1;return e.forEach((a,c)=>{const d=Math.pow(2,c);_t(a,f=>{const m=n;n=n|d,t[c]=f,m!==r&&n===r&&o&&(o(),o=null)})}),a=>c=>{const d=()=>a([c].concat(t));n===r?d():o=d}}function Z2(...e){return function(t,n){switch(t){case ua:return bL(...e.map(o=>_t(o,n)));case gi:return;default:throw new Error(`unrecognized action ${t}`)}}}function st(e,t=aS){return we(e,Kt(t))}function Dn(...e){const t=Ct(),n=new Array(e.length);let o=0;const r=Math.pow(2,e.length)-1;return e.forEach((a,c)=>{const d=Math.pow(2,c);_t(a,f=>{n[c]=f,o=o|d,o===r&&dt(t,n)})}),function(a,c){switch(a){case ua:return o===r&&c(n),_t(t,c);case gi:return o0(t);default:throw new Error(`unrecognized action ${a}`)}}}function Lt(e,t=[],{singleton:n}={singleton:!0}){return{id:wL(),constructor:e,dependencies:t,singleton:n}}const wL=()=>Symbol();function kL(e){const t=new Map,n=({id:o,constructor:r,dependencies:a,singleton:c})=>{if(c&&t.has(o))return t.get(o);const d=r(a.map(f=>n(f)));return c&&t.set(o,d),d};return n(e)}function IL(e,t){const n={},o={};let r=0;const a=e.length;for(;r<a;)o[e[r]]=1,r+=1;for(const c in t)o.hasOwnProperty(c)||(n[c]=t[c]);return n}const Ju=typeof document<"u"?q.useLayoutEffect:q.useEffect;function lS(e,t,n){const o=Object.keys(t.required||{}),r=Object.keys(t.optional||{}),a=Object.keys(t.methods||{}),c=Object.keys(t.events||{}),d=q.createContext({});function f(I,k){I.propsReady&&dt(I.propsReady,!1);for(const D of o){const T=I[t.required[D]];dt(T,k[D])}for(const D of r)if(D in k){const T=I[t.optional[D]];dt(T,k[D])}I.propsReady&&dt(I.propsReady,!0)}function m(I){return a.reduce((k,D)=>(k[D]=T=>{const E=I[t.methods[D]];dt(E,T)},k),{})}function h(I){return c.reduce((k,D)=>(k[D]=jL(I[t.events[D]]),k),{})}const g=q.forwardRef((I,k)=>{const{children:D,...T}=I,[E]=q.useState(()=>Bf(kL(e),N=>f(N,T))),[A]=q.useState(W2(h,E));return Ju(()=>{for(const N of c)N in T&&_t(A[N],T[N]);return()=>{Object.values(A).map(o0)}},[T,A,E]),Ju(()=>{f(E,T)}),q.useImperativeHandle(k,G2(m(E))),q.createElement(d.Provider,{value:E},n?q.createElement(n,IL([...o,...r,...c],T),D):D)}),x=I=>q.useCallback(rS(dt,q.useContext(d)[I]),[I]),C=I=>{const D=q.useContext(d)[I],T=q.useCallback(E=>_t(D,E),[D]);return q.useSyncExternalStore(T,()=>Hn(D),()=>Hn(D))},j=I=>{const D=q.useContext(d)[I],[T,E]=q.useState(W2(Hn,D));return Ju(()=>_t(D,A=>{A!==T&&E(G2(A))}),[D,T]),T},S=q.version.startsWith("18")?C:j;return{Component:g,usePublisher:x,useEmitterValue:S,useEmitter:(I,k)=>{const T=q.useContext(d)[I];Ju(()=>_t(T,k),[k,T])}}}const ML=typeof document<"u"?q.useLayoutEffect:q.useEffect,AL=ML;var Cs=(e=>(e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR",e))(Cs||{});const PL={0:"debug",1:"log",2:"warn",3:"error"},DL=()=>typeof globalThis>"u"?window:globalThis,da=Lt(()=>{const e=De(3);return{log:De((n,o,r=1)=>{var a;const c=(a=DL().VIRTUOSO_LOG_LEVEL)!=null?a:Hn(e);r>=c&&console[PL[r]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",n,o)}),logLevel:e}},[],{singleton:!0});function r0(e,t=!0){const n=q.useRef(null);let o=r=>{};if(typeof ResizeObserver<"u"){const r=q.useMemo(()=>new ResizeObserver(a=>{const c=a[0].target;c.offsetParent!==null&&e(c)}),[e]);o=a=>{a&&t?(r.observe(a),n.current=a):(n.current&&r.unobserve(n.current),n.current=null)}}return{ref:n,callbackRef:o}}function ol(e,t=!0){return r0(e,t).callbackRef}function EL(e,t,n,o,r,a,c){const d=q.useCallback(f=>{const m=_L(f.children,t,"offsetHeight",r);let h=f.parentElement;for(;!h.dataset.virtuosoScroller;)h=h.parentElement;const g=h.lastElementChild.dataset.viewportType==="window",x=c?c.scrollTop:g?window.pageYOffset||document.documentElement.scrollTop:h.scrollTop,C=c?c.scrollHeight:g?document.documentElement.scrollHeight:h.scrollHeight,j=c?c.offsetHeight:g?window.innerHeight:h.offsetHeight;o({scrollTop:Math.max(x,0),scrollHeight:C,viewportHeight:j}),a==null||a(LL("row-gap",getComputedStyle(f).rowGap,r)),m!==null&&e(m)},[e,t,r,a,c,o]);return r0(d,n)}function _L(e,t,n,o){const r=e.length;if(r===0)return null;const a=[];for(let c=0;c<r;c++){const d=e.item(c);if(!d||d.dataset.index===void 0)continue;const f=parseInt(d.dataset.index),m=parseFloat(d.dataset.knownSize),h=t(d,n);if(h===0&&o("Zero-sized element, this should not happen",{child:d},Cs.ERROR),h===m)continue;const g=a[a.length-1];a.length===0||g.size!==h||g.endIndex!==f-1?a.push({startIndex:f,endIndex:f,size:h}):a[a.length-1].endIndex++}return a}function LL(e,t,n){return t!=="normal"&&!(t!=null&&t.endsWith("px"))&&n(`${e} was not resolved to pixel value correctly`,t,Cs.WARN),t==="normal"?0:parseInt(t??"0",10)}function Xr(e,t){return Math.round(e.getBoundingClientRect()[t])}function iS(e,t){return Math.abs(e-t)<1.01}function cS(e,t,n,o=xi,r){const a=q.useRef(null),c=q.useRef(null),d=q.useRef(null),f=q.useCallback(g=>{const x=g.target,C=x===window||x===document,j=C?window.pageYOffset||document.documentElement.scrollTop:x.scrollTop,S=C?document.documentElement.scrollHeight:x.scrollHeight,M=C?window.innerHeight:x.offsetHeight,I=()=>{e({scrollTop:Math.max(j,0),scrollHeight:S,viewportHeight:M})};g.suppressFlushSync?I():X5.flushSync(I),c.current!==null&&(j===c.current||j<=0||j===S-M)&&(c.current=null,t(!0),d.current&&(clearTimeout(d.current),d.current=null))},[e,t]);q.useEffect(()=>{const g=r||a.current;return o(r||a.current),f({target:g,suppressFlushSync:!0}),g.addEventListener("scroll",f,{passive:!0}),()=>{o(null),g.removeEventListener("scroll",f)}},[a,f,n,o,r]);function m(g){const x=a.current;if(!x||"offsetHeight"in x&&x.offsetHeight===0)return;const C=g.behavior==="smooth";let j,S,M;x===window?(S=Math.max(Xr(document.documentElement,"height"),document.documentElement.scrollHeight),j=window.innerHeight,M=document.documentElement.scrollTop):(S=x.scrollHeight,j=Xr(x,"height"),M=x.scrollTop);const I=S-j;if(g.top=Math.ceil(Math.max(Math.min(I,g.top),0)),iS(j,S)||g.top===M){e({scrollTop:M,scrollHeight:S,viewportHeight:j}),C&&t(!0);return}C?(c.current=g.top,d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{d.current=null,c.current=null,t(!0)},1e3)):c.current=null,x.scrollTo(g)}function h(g){a.current.scrollBy(g)}return{scrollerRef:a,scrollByCallback:h,scrollToCallback:m}}const Kn=Lt(()=>{const e=Ct(),t=Ct(),n=De(0),o=Ct(),r=De(0),a=Ct(),c=Ct(),d=De(0),f=De(0),m=De(0),h=De(0),g=Ct(),x=Ct(),C=De(!1);return Qe(we(e,Ge(({scrollTop:j})=>j)),t),Qe(we(e,Ge(({scrollHeight:j})=>j)),c),Qe(t,r),{scrollContainerState:e,scrollTop:t,viewportHeight:a,headerHeight:d,fixedHeaderHeight:f,fixedFooterHeight:m,footerHeight:h,scrollHeight:c,smoothScrollTargetReached:o,scrollTo:g,scrollBy:x,statefulScrollTop:r,deviation:n,scrollingInProgress:C}},[],{singleton:!0}),mc={lvl:0};function uS(e,t,n,o=mc,r=mc){return{k:e,v:t,lvl:n,l:o,r}}function zt(e){return e===mc}function Hl(){return mc}function Dp(e,t){if(zt(e))return mc;const{k:n,l:o,r}=e;if(t===n){if(zt(o))return r;if(zt(r))return o;{const[a,c]=dS(o);return gd(jn(e,{k:a,v:c,l:fS(o)}))}}else return t<n?gd(jn(e,{l:Dp(o,t)})):gd(jn(e,{r:Dp(r,t)}))}function pc(e,t){if(!zt(e))return t===e.k?e.v:t<e.k?pc(e.l,t):pc(e.r,t)}function xo(e,t,n="k"){if(zt(e))return[-1/0,void 0];if(Number(e[n])===t)return[e.k,e.v];if(Number(e[n])<t){const o=xo(e.r,t,n);return o[0]===-1/0?[e.k,e.v]:o}return xo(e.l,t,n)}function xs(e,t,n){return zt(e)?uS(t,n,1):t===e.k?jn(e,{k:t,v:n}):t<e.k?q2(jn(e,{l:xs(e.l,t,n)})):q2(jn(e,{r:xs(e.r,t,n)}))}function Ep(e,t,n){if(zt(e))return[];const{k:o,v:r,l:a,r:c}=e;let d=[];return o>t&&(d=d.concat(Ep(a,t,n))),o>=t&&o<=n&&d.push({k:o,v:r}),o<=n&&(d=d.concat(Ep(c,t,n))),d}function La(e){return zt(e)?[]:[...La(e.l),{k:e.k,v:e.v},...La(e.r)]}function dS(e){return zt(e.r)?[e.k,e.v]:dS(e.r)}function fS(e){return zt(e.r)?e.l:gd(jn(e,{r:fS(e.r)}))}function jn(e,t){return uS(t.k!==void 0?t.k:e.k,t.v!==void 0?t.v:e.v,t.lvl!==void 0?t.lvl:e.lvl,t.l!==void 0?t.l:e.l,t.r!==void 0?t.r:e.r)}function Rm(e){return zt(e)||e.lvl>e.r.lvl}function q2(e){return _p(mS(e))}function gd(e){const{l:t,r:n,lvl:o}=e;if(n.lvl>=o-1&&t.lvl>=o-1)return e;if(o>n.lvl+1){if(Rm(t))return mS(jn(e,{lvl:o-1}));if(!zt(t)&&!zt(t.r))return jn(t.r,{l:jn(t,{r:t.r.l}),r:jn(e,{l:t.r.r,lvl:o-1}),lvl:o});throw new Error("Unexpected empty nodes")}else{if(Rm(e))return _p(jn(e,{lvl:o-1}));if(!zt(n)&&!zt(n.l)){const r=n.l,a=Rm(r)?n.lvl-1:n.lvl;return jn(r,{l:jn(e,{r:r.l,lvl:o-1}),r:_p(jn(n,{l:r.r,lvl:a})),lvl:r.lvl+1})}else throw new Error("Unexpected empty nodes")}}function Nf(e,t,n){if(zt(e))return[];const o=xo(e,t)[0];return TL(Ep(e,o,n))}function hS(e,t){const n=e.length;if(n===0)return[];let{index:o,value:r}=t(e[0]);const a=[];for(let c=1;c<n;c++){const{index:d,value:f}=t(e[c]);a.push({start:o,end:d-1,value:r}),o=d,r=f}return a.push({start:o,end:1/0,value:r}),a}function TL(e){return hS(e,({k:t,v:n})=>({index:t,value:n}))}function _p(e){const{r:t,lvl:n}=e;return!zt(t)&&!zt(t.r)&&t.lvl===n&&t.r.lvl===n?jn(t,{l:jn(e,{r:t.l}),lvl:n+1}):e}function mS(e){const{l:t}=e;return!zt(t)&&t.lvl===e.lvl?jn(t,{r:jn(e,{l:t.r})}):e}function Fd(e,t,n,o=0){let r=e.length-1;for(;o<=r;){const a=Math.floor((o+r)/2),c=e[a],d=n(c,t);if(d===0)return a;if(d===-1){if(r-o<2)return a-1;r=a-1}else{if(r===o)return a;o=a+1}}throw new Error(`Failed binary finding record in array - ${e.join(",")}, searched for ${t}`)}function pS(e,t,n){return e[Fd(e,t,n)]}function RL(e,t,n,o){const r=Fd(e,t,o),a=Fd(e,n,o,r);return e.slice(r,a+1)}const a0=Lt(()=>({recalcInProgress:De(!1)}),[],{singleton:!0});function BL(e){const{size:t,startIndex:n,endIndex:o}=e;return r=>r.start===n&&(r.end===o||r.end===1/0)&&r.value===t}function Q2(e,t){let n=0,o=0;for(;n<e;)n+=t[o+1]-t[o]-1,o++;return o-(n===e?0:1)}function NL(e,t){let n=zt(e)?0:1/0;for(const o of t){const{size:r,startIndex:a,endIndex:c}=o;if(n=Math.min(n,a),zt(e)){e=xs(e,0,r);continue}const d=Nf(e,a-1,c+1);if(d.some(BL(o)))continue;let f=!1,m=!1;for(const{start:h,end:g,value:x}of d)f?(c>=h||r===x)&&(e=Dp(e,h)):(m=x!==r,f=!0),g>c&&c>=h&&x!==r&&(e=xs(e,c+1,x));m&&(e=xs(e,a,r))}return[e,n]}function zL(){return{offsetTree:[],sizeTree:Hl(),groupOffsetTree:Hl(),lastIndex:0,lastOffset:0,lastSize:0,groupIndices:[]}}function l0({index:e},t){return t===e?0:t<e?-1:1}function OL({offset:e},t){return t===e?0:t<e?-1:1}function FL(e){return{index:e.index,value:e}}function VL(e,t,n,o=0){return o>0&&(t=Math.max(t,pS(e,o,l0).offset)),hS(RL(e,t,n,OL),FL)}function Lp(e,t,n,o){let r=e,a=0,c=0,d=0,f=0;if(t!==0){f=Fd(r,t-1,l0),d=r[f].offset;const h=xo(n,t-1);a=h[0],c=h[1],r.length&&r[f].size===xo(n,t)[1]&&(f-=1),r=r.slice(0,f+1)}else r=[];for(const{start:m,value:h}of Nf(n,t,1/0)){const g=m-a,x=g*c+d+g*o;r.push({offset:x,size:h,index:m}),a=m,d=x,c=h}return{offsetTree:r,lastIndex:a,lastOffset:d,lastSize:c}}function HL(e,[t,n,o,r]){t.length>0&&o("received item sizes",t,Cs.DEBUG);const a=e.sizeTree;let c=a,d=0;if(n.length>0&&zt(a)&&t.length===2){const x=t[0].size,C=t[1].size;c=n.reduce((j,S)=>xs(xs(j,S,x),S+1,C),c)}else[c,d]=NL(c,t);if(c===a)return e;const{offsetTree:f,lastIndex:m,lastSize:h,lastOffset:g}=Lp(e.offsetTree,d,c,r);return{sizeTree:c,offsetTree:f,lastIndex:m,lastOffset:g,lastSize:h,groupOffsetTree:n.reduce((x,C)=>xs(x,C,gc(C,f,r)),Hl()),groupIndices:n}}function gc(e,t,n){if(t.length===0)return 0;const{offset:o,index:r,size:a}=pS(t,e,l0),c=e-r,d=a*c+(c-1)*n+o;return d>0?d+n:d}function $L(e){return typeof e.groupIndex<"u"}function gS(e,t,n){if($L(e))return t.groupIndices[e.groupIndex]+1;{const o=e.index==="LAST"?n:e.index;let r=xS(o,t);return r=Math.max(0,r,Math.min(n,r)),r}}function xS(e,t){if(!zf(t))return e;let n=0;for(;t.groupIndices[n]<=e+n;)n++;return e+n}function zf(e){return!zt(e.groupOffsetTree)}function WL(e){return La(e).map(({k:t,v:n},o,r)=>{const a=r[o+1],c=a?a.k-1:1/0;return{startIndex:t,endIndex:c,size:n}})}const GL={offsetHeight:"height",offsetWidth:"width"},qo=Lt(([{log:e},{recalcInProgress:t}])=>{const n=Ct(),o=Ct(),r=qn(o,0),a=Ct(),c=Ct(),d=De(0),f=De([]),m=De(void 0),h=De(void 0),g=De((E,A)=>Xr(E,GL[A])),x=De(void 0),C=De(0),j=zL(),S=qn(we(n,mt(f,e,C),Bo(HL,j),Kt()),j),M=qn(we(f,Kt(),Bo((E,A)=>({prev:E.current,current:A}),{prev:[],current:[]}),Ge(({prev:E})=>E)),[]);Qe(we(f,nt(E=>E.length>0),mt(S,C),Ge(([E,A,N])=>{const W=E.reduce((G,z,X)=>xs(G,z,gc(z,A.offsetTree,N)||X),Hl());return{...A,groupIndices:E,groupOffsetTree:W}})),S),Qe(we(o,mt(S),nt(([E,{lastIndex:A}])=>E<A),Ge(([E,{lastIndex:A,lastSize:N}])=>[{startIndex:E,endIndex:A,size:N}])),n),Qe(m,h);const I=qn(we(m,Ge(E=>E===void 0)),!0);Qe(we(h,nt(E=>E!==void 0&&zt(Hn(S).sizeTree)),Ge(E=>[{startIndex:0,endIndex:0,size:E}])),n);const k=vs(we(n,mt(S),Bo(({sizes:E},[A,N])=>({changed:N!==E,sizes:N}),{changed:!1,sizes:j}),Ge(E=>E.changed)));_t(we(d,Bo((E,A)=>({diff:E.prev-A,prev:A}),{diff:0,prev:0}),Ge(E=>E.diff)),E=>{const{groupIndices:A}=Hn(S);if(E>0)dt(t,!0),dt(a,E+Q2(E,A));else if(E<0){const N=Hn(M);N.length>0&&(E-=Q2(-E,N)),dt(c,E)}}),_t(we(d,mt(e)),([E,A])=>{E<0&&A("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:d},Cs.ERROR)});const D=vs(a);Qe(we(a,mt(S),Ge(([E,A])=>{const N=A.groupIndices.length>0,W=[],G=A.lastSize;if(N){const z=pc(A.sizeTree,0);let X=0,B=0;for(;X<E;){const H=A.groupIndices[B],me=A.groupIndices.length===B+1?1/0:A.groupIndices[B+1]-H-1;W.push({startIndex:H,endIndex:H,size:z}),W.push({startIndex:H+1,endIndex:H+1+me-1,size:G}),B++,X+=me+1}const Q=La(A.sizeTree);return X!==E&&Q.shift(),Q.reduce((H,{k:me,v:Ie})=>{let ye=H.ranges;return H.prevSize!==0&&(ye=[...H.ranges,{startIndex:H.prevIndex,endIndex:me+E-1,size:H.prevSize}]),{ranges:ye,prevIndex:me+E,prevSize:Ie}},{ranges:W,prevIndex:E,prevSize:0}).ranges}return La(A.sizeTree).reduce((z,{k:X,v:B})=>({ranges:[...z.ranges,{startIndex:z.prevIndex,endIndex:X+E-1,size:z.prevSize}],prevIndex:X+E,prevSize:B}),{ranges:[],prevIndex:0,prevSize:G}).ranges})),n);const T=vs(we(c,mt(S,C),Ge(([E,{offsetTree:A},N])=>{const W=-E;return gc(W,A,N)})));return Qe(we(c,mt(S,C),Ge(([E,A,N])=>{if(A.groupIndices.length>0){if(zt(A.sizeTree))return A;let G=Hl();const z=Hn(M);let X=0,B=0,Q=0;for(;X<-E;){Q=z[B];const H=z[B+1]-Q-1;B++,X+=H+1}if(G=La(A.sizeTree).reduce((H,{k:me,v:Ie})=>xs(H,Math.max(0,me+E),Ie),G),X!==-E){const H=pc(A.sizeTree,Q);G=xs(G,0,H);const me=xo(A.sizeTree,-E+1)[1];G=xs(G,1,me)}return{...A,sizeTree:G,...Lp(A.offsetTree,0,G,N)}}else{const G=La(A.sizeTree).reduce((z,{k:X,v:B})=>xs(z,Math.max(0,X+E),B),Hl());return{...A,sizeTree:G,...Lp(A.offsetTree,0,G,N)}}})),S),{data:x,totalCount:o,sizeRanges:n,groupIndices:f,defaultItemSize:h,fixedItemSize:m,unshiftWith:a,shiftWith:c,shiftWithOffset:T,beforeUnshiftWith:D,firstItemIndex:d,gap:C,sizes:S,listRefresh:k,statefulTotalCount:r,trackItemSizes:I,itemSize:g}},Yt(da,a0),{singleton:!0}),UL=typeof document<"u"&&"scrollBehavior"in document.documentElement.style;function vS(e){const t=typeof e=="number"?{index:e}:e;return t.align||(t.align="start"),(!t.behavior||!UL)&&(t.behavior="auto"),t.offset||(t.offset=0),t}const Fc=Lt(([{sizes:e,totalCount:t,listRefresh:n,gap:o},{scrollingInProgress:r,viewportHeight:a,scrollTo:c,smoothScrollTargetReached:d,headerHeight:f,footerHeight:m,fixedHeaderHeight:h,fixedFooterHeight:g},{log:x}])=>{const C=Ct(),j=Ct(),S=De(0);let M=null,I=null,k=null;function D(){M&&(M(),M=null),k&&(k(),k=null),I&&(clearTimeout(I),I=null),dt(r,!1)}return Qe(we(C,mt(e,a,t,S,f,m,x),mt(o,h,g),Ge(([[T,E,A,N,W,G,z,X],B,Q,V])=>{const H=vS(T),{align:me,behavior:Ie,offset:ye}=H,de=N-1,He=gS(H,E,de);let Be=gc(He,E.offsetTree,B)+G;me==="end"?(Be+=Q+xo(E.sizeTree,He)[1]-A+V,He===de&&(Be+=z)):me==="center"?Be+=(Q+xo(E.sizeTree,He)[1]-A+V)/2:Be-=W,ye&&(Be+=ye);const ce=ue=>{D(),ue?(X("retrying to scroll to",{location:T},Cs.DEBUG),dt(C,T)):(dt(j,!0),X("list did not change, scroll successful",{},Cs.DEBUG))};if(D(),Ie==="smooth"){let ue=!1;k=_t(n,je=>{ue=ue||je}),M=Fo(d,()=>{ce(ue)})}else M=Fo(we(n,ZL(150)),ce);return I=setTimeout(()=>{D()},1200),dt(r,!0),X("scrolling from index to",{index:He,top:Be,behavior:Ie},Cs.DEBUG),{top:Be,behavior:Ie}})),c),{scrollToIndex:C,scrollTargetReached:j,topListHeight:S}},Yt(qo,Kn,da),{singleton:!0});function ZL(e){return t=>{const n=setTimeout(()=>{t(!1)},e);return o=>{o&&(t(!0),clearTimeout(n))}}}const xc="up",nc="down",qL="none",QL={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollTop:0,viewportHeight:0,scrollHeight:0}},KL=0,Vc=Lt(([{scrollContainerState:e,scrollTop:t,viewportHeight:n,headerHeight:o,footerHeight:r,scrollBy:a}])=>{const c=De(!1),d=De(!0),f=Ct(),m=Ct(),h=De(4),g=De(KL),x=qn(we(Z2(we(st(t),Jl(1),Eo(!0)),we(st(t),Jl(1),Eo(!1),U2(100))),Kt()),!1),C=qn(we(Z2(we(a,Eo(!0)),we(a,Eo(!1),U2(200))),Kt()),!1);Qe(we(Dn(st(t),st(g)),Ge(([k,D])=>k<=D),Kt()),d),Qe(we(d,Wr(50)),m);const j=vs(we(Dn(e,st(n),st(o),st(r),st(h)),Bo((k,[{scrollTop:D,scrollHeight:T},E,A,N,W])=>{const G=D+E-T>-W,z={viewportHeight:E,scrollTop:D,scrollHeight:T};if(G){let B,Q;return D>k.state.scrollTop?(B="SCROLLED_DOWN",Q=k.state.scrollTop-D):(B="SIZE_DECREASED",Q=k.state.scrollTop-D||k.scrollTopDelta),{atBottom:!0,state:z,atBottomBecause:B,scrollTopDelta:Q}}let X;return z.scrollHeight>k.state.scrollHeight?X="SIZE_INCREASED":E<k.state.viewportHeight?X="VIEWPORT_HEIGHT_DECREASING":D<k.state.scrollTop?X="SCROLLING_UPWARDS":X="NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",{atBottom:!1,notAtBottomBecause:X,state:z}},QL),Kt((k,D)=>k&&k.atBottom===D.atBottom))),S=qn(we(e,Bo((k,{scrollTop:D,scrollHeight:T,viewportHeight:E})=>{if(iS(k.scrollHeight,T))return{scrollTop:D,scrollHeight:T,jump:0,changed:!1};{const A=T-(D+E)<1;return k.scrollTop!==D&&A?{scrollHeight:T,scrollTop:D,jump:k.scrollTop-D,changed:!0}:{scrollHeight:T,scrollTop:D,jump:0,changed:!0}}},{scrollHeight:0,jump:0,scrollTop:0,changed:!1}),nt(k=>k.changed),Ge(k=>k.jump)),0);Qe(we(j,Ge(k=>k.atBottom)),c),Qe(we(c,Wr(50)),f);const M=De(nc);Qe(we(e,Ge(({scrollTop:k})=>k),Kt(),Bo((k,D)=>Hn(C)?{direction:k.direction,prevScrollTop:D}:{direction:D<k.prevScrollTop?xc:nc,prevScrollTop:D},{direction:nc,prevScrollTop:0}),Ge(k=>k.direction)),M),Qe(we(e,Wr(50),Eo(qL)),M);const I=De(0);return Qe(we(x,nt(k=>!k),Eo(0)),I),Qe(we(t,Wr(100),mt(x),nt(([k,D])=>!!D),Bo(([k,D],[T])=>[D,T],[0,0]),Ge(([k,D])=>D-k)),I),{isScrolling:x,isAtTop:d,isAtBottom:c,atBottomState:j,atTopStateChange:m,atBottomStateChange:f,scrollDirection:M,atBottomThreshold:h,atTopThreshold:g,scrollVelocity:I,lastJumpDueToItemResize:S}},Yt(Kn)),fa=Lt(([{log:e}])=>{const t=De(!1),n=vs(we(t,nt(o=>o),Kt()));return _t(t,o=>{o&&Hn(e)("props updated",{},Cs.DEBUG)}),{propsReady:t,didMount:n}},Yt(da),{singleton:!0});function i0(e,t){e==0?t():requestAnimationFrame(()=>i0(e-1,t))}function c0(e,t){const n=t-1;return typeof e=="number"?e:e.index==="LAST"?n:e.index}const Hc=Lt(([{sizes:e,listRefresh:t,defaultItemSize:n},{scrollTop:o},{scrollToIndex:r,scrollTargetReached:a},{didMount:c}])=>{const d=De(!0),f=De(0),m=De(!0);return Qe(we(c,mt(f),nt(([h,g])=>!!g),Eo(!1)),d),Qe(we(c,mt(f),nt(([h,g])=>!!g),Eo(!1)),m),_t(we(Dn(t,c),mt(d,e,n,m),nt(([[,h],g,{sizeTree:x},C,j])=>h&&(!zt(x)||s0(C))&&!g&&!j),mt(f)),([,h])=>{Fo(a,()=>{dt(m,!0)}),i0(3,()=>{Fo(o,()=>{dt(d,!0)}),dt(r,h)})}),{scrolledToInitialItem:d,initialTopMostItemIndex:f,initialItemFinalLocationReached:m}},Yt(qo,Kn,Fc,fa),{singleton:!0});function K2(e){return e?e==="smooth"?"smooth":"auto":!1}const YL=(e,t)=>typeof e=="function"?K2(e(t)):t&&K2(e),XL=Lt(([{totalCount:e,listRefresh:t},{isAtBottom:n,atBottomState:o},{scrollToIndex:r},{scrolledToInitialItem:a},{propsReady:c,didMount:d},{log:f},{scrollingInProgress:m}])=>{const h=De(!1),g=Ct();let x=null;function C(S){dt(r,{index:"LAST",align:"end",behavior:S})}_t(we(Dn(we(st(e),Jl(1)),d),mt(st(h),n,a,m),Ge(([[S,M],I,k,D,T])=>{let E=M&&D,A="auto";return E&&(A=YL(I,k||T),E=E&&!!A),{totalCount:S,shouldFollow:E,followOutputBehavior:A}}),nt(({shouldFollow:S})=>S)),({totalCount:S,followOutputBehavior:M})=>{x&&(x(),x=null),x=Fo(t,()=>{Hn(f)("following output to ",{totalCount:S},Cs.DEBUG),C(M),x=null})});function j(S){const M=Fo(o,I=>{S&&!I.atBottom&&I.notAtBottomBecause==="SIZE_INCREASED"&&!x&&(Hn(f)("scrolling to bottom due to increased size",{},Cs.DEBUG),C("auto"))});setTimeout(M,100)}return _t(we(Dn(st(h),e,c),nt(([S,,M])=>S&&M),Bo(({value:S},[,M])=>({refreshed:S===M,value:M}),{refreshed:!1,value:0}),nt(({refreshed:S})=>S),mt(h,e)),([,S])=>{Hn(a)&&j(S!==!1)}),_t(g,()=>{j(Hn(h)!==!1)}),_t(Dn(st(h),o),([S,M])=>{S&&!M.atBottom&&M.notAtBottomBecause==="VIEWPORT_HEIGHT_DECREASING"&&C("auto")}),{followOutput:h,autoscrollToBottom:g}},Yt(qo,Vc,Fc,Hc,fa,da,Kn));function JL(e){return e.reduce((t,n)=>(t.groupIndices.push(t.totalCount),t.totalCount+=n+1,t),{totalCount:0,groupIndices:[]})}const CS=Lt(([{totalCount:e,groupIndices:t,sizes:n},{scrollTop:o,headerHeight:r}])=>{const a=Ct(),c=Ct(),d=vs(we(a,Ge(JL)));return Qe(we(d,Ge(f=>f.totalCount)),e),Qe(we(d,Ge(f=>f.groupIndices)),t),Qe(we(Dn(o,n,r),nt(([f,m])=>zf(m)),Ge(([f,m,h])=>xo(m.groupOffsetTree,Math.max(f-h,0),"v")[0]),Kt(),Ge(f=>[f])),c),{groupCounts:a,topItemsIndexes:c}},Yt(qo,Kn));function vc(e,t){return!!(e&&e[0]===t[0]&&e[1]===t[1])}function yS(e,t){return!!(e&&e.startIndex===t.startIndex&&e.endIndex===t.endIndex)}const Vd="top",Hd="bottom",Y2="none";function X2(e,t,n){return typeof e=="number"?n===xc&&t===Vd||n===nc&&t===Hd?e:0:n===xc?t===Vd?e.main:e.reverse:t===Hd?e.main:e.reverse}function J2(e,t){return typeof e=="number"?e:e[t]||0}const u0=Lt(([{scrollTop:e,viewportHeight:t,deviation:n,headerHeight:o,fixedHeaderHeight:r}])=>{const a=Ct(),c=De(0),d=De(0),f=De(0),m=qn(we(Dn(st(e),st(t),st(o),st(a,vc),st(f),st(c),st(r),st(n),st(d)),Ge(([h,g,x,[C,j],S,M,I,k,D])=>{const T=h-k,E=M+I,A=Math.max(x-T,0);let N=Y2;const W=J2(D,Vd),G=J2(D,Hd);return C-=k,C+=x+I,j+=x+I,j-=k,C>h+E-W&&(N=xc),j<h-A+g+G&&(N=nc),N!==Y2?[Math.max(T-x-X2(S,Vd,N)-W,0),T-A-I+g+X2(S,Hd,N)+G]:null}),nt(h=>h!=null),Kt(vc)),[0,0]);return{listBoundary:a,overscan:f,topListHeight:c,increaseViewportBy:d,visibleRange:m}},Yt(Kn),{singleton:!0});function eT(e,t,n){if(zf(t)){const o=xS(e,t);return[{index:xo(t.groupOffsetTree,o)[0],size:0,offset:0},{index:o,size:0,offset:0,data:n&&n[0]}]}return[{index:e,size:0,offset:0,data:n&&n[0]}]}const Bm={items:[],topItems:[],offsetTop:0,offsetBottom:0,top:0,bottom:0,topListHeight:0,totalCount:0,firstItemIndex:0};function ev(e,t,n){if(e.length===0)return[];if(!zf(t))return e.map(m=>({...m,index:m.index+n,originalIndex:m.index}));const o=e[0].index,r=e[e.length-1].index,a=[],c=Nf(t.groupOffsetTree,o,r);let d,f=0;for(const m of e){(!d||d.end<m.index)&&(d=c.shift(),f=t.groupIndices.indexOf(d.start));let h;m.index===d.start?h={type:"group",index:f}:h={index:m.index-(f+1)+n,groupIndex:f},a.push({...h,size:m.size,offset:m.offset,originalIndex:m.index,data:m.data})}return a}function xd(e,t,n,o,r,a){const{lastSize:c,lastOffset:d,lastIndex:f}=r;let m=0,h=0;if(e.length>0){m=e[0].offset;const S=e[e.length-1];h=S.offset+S.size}const g=n-f,x=d+g*c+(g-1)*o,C=m,j=x-h;return{items:ev(e,r,a),topItems:ev(t,r,a),topListHeight:t.reduce((S,M)=>M.size+S,0),offsetTop:m,offsetBottom:j,top:C,bottom:h,totalCount:n,firstItemIndex:a}}function bS(e,t,n,o,r,a){let c=0;if(n.groupIndices.length>0)for(const h of n.groupIndices){if(h-c>=e)break;c++}const d=e+c,f=c0(t,d),m=Array.from({length:d}).map((h,g)=>({index:g+f,size:0,offset:0,data:a[g+f]}));return xd(m,[],d,r,n,o)}const rl=Lt(([{sizes:e,totalCount:t,data:n,firstItemIndex:o,gap:r},a,{visibleRange:c,listBoundary:d,topListHeight:f},{scrolledToInitialItem:m,initialTopMostItemIndex:h},{topListHeight:g},x,{didMount:C},{recalcInProgress:j}])=>{const S=De([]),M=De(0),I=Ct();Qe(a.topItemsIndexes,S);const k=qn(we(Dn(C,j,st(c,vc),st(t),st(e),st(h),m,st(S),st(o),st(r),n),nt(([A,N,,W,,,,,,,G])=>{const z=G&&G.length!==W;return A&&!N&&!z}),Ge(([,,[A,N],W,G,z,X,B,Q,V,H])=>{const me=G,{sizeTree:Ie,offsetTree:ye}=me,de=Hn(M);if(W===0)return{...Bm,totalCount:W};if(A===0&&N===0)return de===0?{...Bm,totalCount:W}:bS(de,z,G,Q,V,H||[]);if(zt(Ie))return de>0?null:xd(eT(c0(z,W),me,H),[],W,V,me,Q);const He=[];if(B.length>0){const be=B[0],ee=B[B.length-1];let J=0;for(const F of Nf(Ie,be,ee)){const oe=F.value,le=Math.max(F.start,be),fe=Math.min(F.end,ee);for(let he=le;he<=fe;he++)He.push({index:he,size:oe,offset:J,data:H&&H[he]}),J+=oe}}if(!X)return xd([],He,W,V,me,Q);const Be=B.length>0?B[B.length-1]+1:0,ce=VL(ye,A,N,Be);if(ce.length===0)return null;const ue=W-1,je=Bf([],be=>{for(const ee of ce){const J=ee.value;let F=J.offset,oe=ee.start;const le=J.size;if(J.offset<A){oe+=Math.floor((A-J.offset+V)/(le+V));const he=oe-ee.start;F+=he*le+he*V}oe<Be&&(F+=(Be-oe)*le,oe=Be);const fe=Math.min(ee.end,ue);for(let he=oe;he<=fe&&!(F>=N);he++)be.push({index:he,size:le,offset:F,data:H&&H[he]}),F+=le+V}});return xd(je,He,W,V,me,Q)}),nt(A=>A!==null),Kt()),Bm);Qe(we(n,nt(s0),Ge(A=>A==null?void 0:A.length)),t),Qe(we(k,Ge(A=>A.topListHeight)),g),Qe(g,f),Qe(we(k,Ge(A=>[A.top,A.bottom])),d),Qe(we(k,Ge(A=>A.items)),I);const D=vs(we(k,nt(({items:A})=>A.length>0),mt(t,n),nt(([{items:A},N])=>A[A.length-1].originalIndex===N-1),Ge(([,A,N])=>[A-1,N]),Kt(vc),Ge(([A])=>A))),T=vs(we(k,Wr(200),nt(({items:A,topItems:N})=>A.length>0&&A[0].originalIndex===N.length),Ge(({items:A})=>A[0].index),Kt())),E=vs(we(k,nt(({items:A})=>A.length>0),Ge(({items:A})=>{let N=0,W=A.length-1;for(;A[N].type==="group"&&N<W;)N++;for(;A[W].type==="group"&&W>N;)W--;return{startIndex:A[N].index,endIndex:A[W].index}}),Kt(yS)));return{listState:k,topItemsIndexes:S,endReached:D,startReached:T,rangeChanged:E,itemsRendered:I,initialItemCount:M,...x}},Yt(qo,CS,u0,Hc,Fc,Vc,fa,a0),{singleton:!0}),tT=Lt(([{sizes:e,firstItemIndex:t,data:n,gap:o},{initialTopMostItemIndex:r},{initialItemCount:a,listState:c},{didMount:d}])=>(Qe(we(d,mt(a),nt(([,f])=>f!==0),mt(r,e,t,o,n),Ge(([[,f],m,h,g,x,C=[]])=>bS(f,m,h,g,x,C))),c),{}),Yt(qo,Hc,rl,fa),{singleton:!0}),jS=Lt(([{scrollVelocity:e}])=>{const t=De(!1),n=Ct(),o=De(!1);return Qe(we(e,mt(o,t,n),nt(([r,a])=>!!a),Ge(([r,a,c,d])=>{const{exit:f,enter:m}=a;if(c){if(f(r,d))return!1}else if(m(r,d))return!0;return c}),Kt()),t),_t(we(Dn(t,e,n),mt(o)),([[r,a,c],d])=>r&&d&&d.change&&d.change(a,c)),{isSeeking:t,scrollSeekConfiguration:o,scrollVelocity:e,scrollSeekRangeChanged:n}},Yt(Vc),{singleton:!0}),nT=Lt(([{topItemsIndexes:e}])=>{const t=De(0);return Qe(we(t,nt(n=>n>0),Ge(n=>Array.from({length:n}).map((o,r)=>r))),e),{topItemCount:t}},Yt(rl)),SS=Lt(([{footerHeight:e,headerHeight:t,fixedHeaderHeight:n,fixedFooterHeight:o},{listState:r}])=>{const a=Ct(),c=qn(we(Dn(e,o,t,n,r),Ge(([d,f,m,h,g])=>d+f+m+h+g.offsetBottom+g.bottom)),0);return Qe(st(c),a),{totalListHeight:c,totalListHeightChanged:a}},Yt(Kn,rl),{singleton:!0});function wS(e){let t=!1,n;return()=>(t||(t=!0,n=e()),n)}const sT=wS(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),oT=Lt(([{scrollBy:e,scrollTop:t,deviation:n,scrollingInProgress:o},{isScrolling:r,isAtBottom:a,scrollDirection:c,lastJumpDueToItemResize:d},{listState:f},{beforeUnshiftWith:m,shiftWithOffset:h,sizes:g,gap:x},{log:C},{recalcInProgress:j}])=>{const S=vs(we(f,mt(d),Bo(([,I,k,D],[{items:T,totalCount:E,bottom:A,offsetBottom:N},W])=>{const G=A+N;let z=0;return k===E&&I.length>0&&T.length>0&&(T[0].originalIndex===0&&I[0].originalIndex===0||(z=G-D,z!==0&&(z+=W))),[z,T,E,G]},[0,[],0,0]),nt(([I])=>I!==0),mt(t,c,o,a,C,j),nt(([,I,k,D,,,T])=>!T&&!D&&I!==0&&k===xc),Ge(([[I],,,,,k])=>(k("Upward scrolling compensation",{amount:I},Cs.DEBUG),I))));function M(I){I>0?(dt(e,{top:-I,behavior:"auto"}),dt(n,0)):(dt(n,0),dt(e,{top:-I,behavior:"auto"}))}return _t(we(S,mt(n,r)),([I,k,D])=>{D&&sT()?dt(n,k-I):M(-I)}),_t(we(Dn(qn(r,!1),n,j),nt(([I,k,D])=>!I&&!D&&k!==0),Ge(([I,k])=>k),Wr(1)),M),Qe(we(h,Ge(I=>({top:-I}))),e),_t(we(m,mt(g,x),Ge(([I,{lastSize:k,groupIndices:D,sizeTree:T},E])=>{function A(N){return N*(k+E)}if(D.length===0)return A(I);{let N=0;const W=pc(T,0);let G=0,z=0;for(;G<I;){G++,N+=W;let X=D.length===z+1?1/0:D[z+1]-D[z]-1;G+X>I&&(N-=W,X=I-G+1),G+=X,N+=A(X),z++}return N}})),I=>{dt(n,I),requestAnimationFrame(()=>{dt(e,{top:I}),requestAnimationFrame(()=>{dt(n,0),dt(j,!1)})})}),{deviation:n}},Yt(Kn,Vc,rl,qo,da,a0)),rT=Lt(([{didMount:e},{scrollTo:t},{listState:n}])=>{const o=De(0);return _t(we(e,mt(o),nt(([,r])=>r!==0),Ge(([,r])=>({top:r}))),r=>{Fo(we(n,Jl(1),nt(a=>a.items.length>1)),()=>{requestAnimationFrame(()=>{dt(t,r)})})}),{initialScrollTop:o}},Yt(fa,Kn,rl),{singleton:!0}),aT=Lt(([{viewportHeight:e},{totalListHeight:t}])=>{const n=De(!1),o=qn(we(Dn(n,e,t),nt(([r])=>r),Ge(([,r,a])=>Math.max(0,r-a)),Wr(0),Kt()),0);return{alignToBottom:n,paddingTopAddition:o}},Yt(Kn,SS),{singleton:!0}),d0=Lt(([{scrollTo:e,scrollContainerState:t}])=>{const n=Ct(),o=Ct(),r=Ct(),a=De(!1),c=De(void 0);return Qe(we(Dn(n,o),Ge(([{viewportHeight:d,scrollTop:f,scrollHeight:m},{offsetTop:h}])=>({scrollTop:Math.max(0,f-h),scrollHeight:m,viewportHeight:d}))),t),Qe(we(e,mt(o),Ge(([d,{offsetTop:f}])=>({...d,top:d.top+f}))),r),{useWindowScroll:a,customScrollParent:c,windowScrollContainerState:n,windowViewportRect:o,windowScrollTo:r}},Yt(Kn)),lT=({itemTop:e,itemBottom:t,viewportTop:n,viewportBottom:o,locationParams:{behavior:r,align:a,...c}})=>e<n?{...c,behavior:r,align:a??"start"}:t>o?{...c,behavior:r,align:a??"end"}:null,iT=Lt(([{sizes:e,totalCount:t,gap:n},{scrollTop:o,viewportHeight:r,headerHeight:a,fixedHeaderHeight:c,fixedFooterHeight:d,scrollingInProgress:f},{scrollToIndex:m}])=>{const h=Ct();return Qe(we(h,mt(e,r,t,a,c,d,o),mt(n),Ge(([[g,x,C,j,S,M,I,k],D])=>{const{done:T,behavior:E,align:A,calculateViewLocation:N=lT,...W}=g,G=gS(g,x,j-1),z=gc(G,x.offsetTree,D)+S+M,X=z+xo(x.sizeTree,G)[1],B=k+M,Q=k+C-I,V=N({itemTop:z,itemBottom:X,viewportTop:B,viewportBottom:Q,locationParams:{behavior:E,align:A,...W}});return V?T&&Fo(we(f,nt(H=>H===!1),Jl(Hn(f)?1:2)),T):T&&T(),V}),nt(g=>g!==null)),m),{scrollIntoView:h}},Yt(qo,Kn,Fc,rl,da),{singleton:!0}),cT=Lt(([{sizes:e,sizeRanges:t},{scrollTop:n},{initialTopMostItemIndex:o},{didMount:r},{useWindowScroll:a,windowScrollContainerState:c,windowViewportRect:d}])=>{const f=Ct(),m=De(void 0),h=De(null),g=De(null);return Qe(c,h),Qe(d,g),_t(we(f,mt(e,n,a,h,g)),([x,C,j,S,M,I])=>{const k=WL(C.sizeTree);S&&M!==null&&I!==null&&(j=M.scrollTop-I.offsetTop),x({ranges:k,scrollTop:j})}),Qe(we(m,nt(s0),Ge(uT)),o),Qe(we(r,mt(m),nt(([,x])=>x!==void 0),Kt(),Ge(([,x])=>x.ranges)),t),{getState:f,restoreStateFrom:m}},Yt(qo,Kn,Hc,fa,d0));function uT(e){return{offset:e.scrollTop,index:0,align:"start"}}const dT=Lt(([e,t,n,o,r,a,c,d,f,m])=>({...e,...t,...n,...o,...r,...a,...c,...d,...f,...m}),Yt(u0,tT,fa,jS,SS,rT,aT,d0,iT,da)),fT=Lt(([{totalCount:e,sizeRanges:t,fixedItemSize:n,defaultItemSize:o,trackItemSizes:r,itemSize:a,data:c,firstItemIndex:d,groupIndices:f,statefulTotalCount:m,gap:h,sizes:g},{initialTopMostItemIndex:x,scrolledToInitialItem:C,initialItemFinalLocationReached:j},S,M,I,{listState:k,topItemsIndexes:D,...T},{scrollToIndex:E},A,{topItemCount:N},{groupCounts:W},G])=>(Qe(T.rangeChanged,G.scrollSeekRangeChanged),Qe(we(G.windowViewportRect,Ge(z=>z.visibleHeight)),S.viewportHeight),{totalCount:e,data:c,firstItemIndex:d,sizeRanges:t,initialTopMostItemIndex:x,scrolledToInitialItem:C,initialItemFinalLocationReached:j,topItemsIndexes:D,topItemCount:N,groupCounts:W,fixedItemHeight:n,defaultItemHeight:o,gap:h,...I,statefulTotalCount:m,listState:k,scrollToIndex:E,trackItemSizes:r,itemSize:a,groupIndices:f,...T,...G,...S,sizes:g,...M}),Yt(qo,Hc,Kn,cT,XL,rl,Fc,oT,nT,CS,dT)),Nm="-webkit-sticky",tv="sticky",kS=wS(()=>{if(typeof document>"u")return tv;const e=document.createElement("div");return e.style.position=Nm,e.style.position===Nm?Nm:tv});function IS(e,t){const n=q.useRef(null),o=q.useCallback(d=>{if(d===null||!d.offsetParent)return;const f=d.getBoundingClientRect(),m=f.width;let h,g;if(t){const x=t.getBoundingClientRect(),C=f.top-x.top;h=x.height-Math.max(0,C),g=C+t.scrollTop}else h=window.innerHeight-Math.max(0,f.top),g=f.top+window.pageYOffset;n.current={offsetTop:g,visibleHeight:h,visibleWidth:m},e(n.current)},[e,t]),{callbackRef:r,ref:a}=r0(o),c=q.useCallback(()=>{o(a.current)},[o,a]);return q.useEffect(()=>{if(t){t.addEventListener("scroll",c);const d=new ResizeObserver(c);return d.observe(t),()=>{t.removeEventListener("scroll",c),d.unobserve(t)}}else return window.addEventListener("scroll",c),window.addEventListener("resize",c),()=>{window.removeEventListener("scroll",c),window.removeEventListener("resize",c)}},[c,t]),r}const MS=q.createContext(void 0),AS=q.createContext(void 0);function PS(e){return e}const hT=Lt(()=>{const e=De(f=>`Item ${f}`),t=De(null),n=De(f=>`Group ${f}`),o=De({}),r=De(PS),a=De("div"),c=De(xi),d=(f,m=null)=>qn(we(o,Ge(h=>h[f]),Kt()),m);return{context:t,itemContent:e,groupContent:n,components:o,computeItemKey:r,headerFooterTag:a,scrollerRef:c,FooterComponent:d("Footer"),HeaderComponent:d("Header"),TopItemListComponent:d("TopItemList"),ListComponent:d("List","div"),ItemComponent:d("Item","div"),GroupComponent:d("Group","div"),ScrollerComponent:d("Scroller","div"),EmptyPlaceholder:d("EmptyPlaceholder"),ScrollSeekPlaceholder:d("ScrollSeekPlaceholder")}}),mT=Lt(([e,t])=>({...e,...t}),Yt(fT,hT)),pT=({height:e})=>q.createElement("div",{style:{height:e}}),gT={position:kS(),zIndex:1,overflowAnchor:"none"},xT={overflowAnchor:"none"},nv=q.memo(function({showTopList:t=!1}){const n=xt("listState"),o=Vs("sizeRanges"),r=xt("useWindowScroll"),a=xt("customScrollParent"),c=Vs("windowScrollContainerState"),d=Vs("scrollContainerState"),f=a||r?c:d,m=xt("itemContent"),h=xt("context"),g=xt("groupContent"),x=xt("trackItemSizes"),C=xt("itemSize"),j=xt("log"),S=Vs("gap"),{callbackRef:M}=EL(o,C,x,t?xi:f,j,S,a),[I,k]=q.useState(0);f0("deviation",V=>{I!==V&&k(V)});const D=xt("EmptyPlaceholder"),T=xt("ScrollSeekPlaceholder")||pT,E=xt("ListComponent"),A=xt("ItemComponent"),N=xt("GroupComponent"),W=xt("computeItemKey"),G=xt("isSeeking"),z=xt("groupIndices").length>0,X=xt("alignToBottom"),B=xt("initialItemFinalLocationReached"),Q=t?{}:{boxSizing:"border-box",paddingTop:n.offsetTop,paddingBottom:n.offsetBottom,marginTop:I!==0?I:X?"auto":0,...B?{}:{visibility:"hidden"}};return!t&&n.totalCount===0&&D?q.createElement(D,Zn(D,h)):q.createElement(E,{...Zn(E,h),ref:M,style:Q,"data-test-id":t?"virtuoso-top-item-list":"virtuoso-item-list"},(t?n.topItems:n.items).map(V=>{const H=V.originalIndex,me=W(H+n.firstItemIndex,V.data,h);return G?q.createElement(T,{...Zn(T,h),key:me,index:V.index,height:V.size,type:V.type||"item",...V.type==="group"?{}:{groupIndex:V.groupIndex}}):V.type==="group"?q.createElement(N,{...Zn(N,h),key:me,"data-index":H,"data-known-size":V.size,"data-item-index":V.index,style:gT},g(V.index,h)):q.createElement(A,{...Zn(A,h),...yT(A,V.data),key:me,"data-index":H,"data-known-size":V.size,"data-item-index":V.index,"data-item-group-index":V.groupIndex,style:xT},z?m(V.index,V.groupIndex,V.data,h):m(V.index,V.data,h))}))}),vT={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},Of=e=>({width:"100%",height:"100%",position:"absolute",top:0,...e?{display:"flex",flexDirection:"column"}:{}}),CT={width:"100%",position:kS(),top:0,zIndex:1};function Zn(e,t){if(typeof e!="string")return{context:t}}function yT(e,t){return{item:typeof e=="string"?void 0:t}}const bT=q.memo(function(){const t=xt("HeaderComponent"),n=Vs("headerHeight"),o=xt("headerFooterTag"),r=ol(c=>n(Xr(c,"height"))),a=xt("context");return t?q.createElement(o,{ref:r},q.createElement(t,Zn(t,a))):null}),jT=q.memo(function(){const t=xt("FooterComponent"),n=Vs("footerHeight"),o=xt("headerFooterTag"),r=ol(c=>n(Xr(c,"height"))),a=xt("context");return t?q.createElement(o,{ref:r},q.createElement(t,Zn(t,a))):null});function DS({usePublisher:e,useEmitter:t,useEmitterValue:n}){return q.memo(function({style:a,children:c,...d}){const f=e("scrollContainerState"),m=n("ScrollerComponent"),h=e("smoothScrollTargetReached"),g=n("scrollerRef"),x=n("context"),{scrollerRef:C,scrollByCallback:j,scrollToCallback:S}=cS(f,h,m,g);return t("scrollTo",S),t("scrollBy",j),q.createElement(m,{ref:C,style:{...vT,...a},"data-test-id":"virtuoso-scroller","data-virtuoso-scroller":!0,tabIndex:0,...d,...Zn(m,x)},c)})}function ES({usePublisher:e,useEmitter:t,useEmitterValue:n}){return q.memo(function({style:a,children:c,...d}){const f=e("windowScrollContainerState"),m=n("ScrollerComponent"),h=e("smoothScrollTargetReached"),g=n("totalListHeight"),x=n("deviation"),C=n("customScrollParent"),j=n("context"),{scrollerRef:S,scrollByCallback:M,scrollToCallback:I}=cS(f,h,m,xi,C);return AL(()=>(S.current=C||window,()=>{S.current=null}),[S,C]),t("windowScrollTo",I),t("scrollBy",M),q.createElement(m,{style:{position:"relative",...a,...g!==0?{height:g+x}:{}},"data-virtuoso-scroller":!0,...d,...Zn(m,j)},c)})}const ST=({children:e})=>{const t=q.useContext(MS),n=Vs("viewportHeight"),o=Vs("fixedItemHeight"),r=xt("alignToBottom"),a=ol(oS(n,c=>Xr(c,"height")));return q.useEffect(()=>{t&&(n(t.viewportHeight),o(t.itemHeight))},[t,n,o]),q.createElement("div",{style:Of(r),ref:a,"data-viewport-type":"element"},e)},wT=({children:e})=>{const t=q.useContext(MS),n=Vs("windowViewportRect"),o=Vs("fixedItemHeight"),r=xt("customScrollParent"),a=IS(n,r),c=xt("alignToBottom");return q.useEffect(()=>{t&&(o(t.itemHeight),n({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:100}))},[t,n,o]),q.createElement("div",{ref:a,style:Of(c),"data-viewport-type":"window"},e)},kT=({children:e})=>{const t=xt("TopItemListComponent")||"div",n=xt("headerHeight"),o={...CT,marginTop:`${n}px`},r=xt("context");return q.createElement(t,{style:o,...Zn(t,r)},e)},IT=q.memo(function(t){const n=xt("useWindowScroll"),o=xt("topItemsIndexes").length>0,r=xt("customScrollParent"),a=r||n?PT:AT,c=r||n?wT:ST;return q.createElement(a,{...t},o&&q.createElement(kT,null,q.createElement(nv,{showTopList:!0})),q.createElement(c,null,q.createElement(bT,null),q.createElement(nv,null),q.createElement(jT,null)))}),{Component:MT,usePublisher:Vs,useEmitterValue:xt,useEmitter:f0}=lS(mT,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},IT),AT=DS({usePublisher:Vs,useEmitterValue:xt,useEmitter:f0}),PT=ES({usePublisher:Vs,useEmitterValue:xt,useEmitter:f0}),DT=MT,sv={items:[],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},ET={items:[{index:0}],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},{round:ov,ceil:rv,floor:$d,min:zm,max:sc}=Math;function _T(e){return{...ET,items:e}}function av(e,t,n){return Array.from({length:t-e+1}).map((o,r)=>{const a=n===null?null:n[r+e];return{index:r+e,data:a}})}function LT(e,t){return e&&e.column===t.column&&e.row===t.row}function ed(e,t){return e&&e.width===t.width&&e.height===t.height}const TT=Lt(([{overscan:e,visibleRange:t,listBoundary:n},{scrollTop:o,viewportHeight:r,scrollBy:a,scrollTo:c,smoothScrollTargetReached:d,scrollContainerState:f,footerHeight:m,headerHeight:h},g,x,{propsReady:C,didMount:j},{windowViewportRect:S,useWindowScroll:M,customScrollParent:I,windowScrollContainerState:k,windowScrollTo:D},T])=>{const E=De(0),A=De(0),N=De(sv),W=De({height:0,width:0}),G=De({height:0,width:0}),z=Ct(),X=Ct(),B=De(0),Q=De(null),V=De({row:0,column:0}),H=Ct(),me=Ct(),Ie=De(!1),ye=De(0),de=De(!0),He=De(!1);_t(we(j,mt(ye),nt(([ee,J])=>!!J)),()=>{dt(de,!1),dt(A,0)}),_t(we(Dn(j,de,G,W,ye,He),nt(([ee,J,F,oe,,le])=>ee&&!J&&F.height!==0&&oe.height!==0&&!le)),([,,,,ee])=>{dt(He,!0),i0(1,()=>{dt(z,ee)}),Fo(we(o),()=>{dt(n,[0,0]),dt(de,!0)})}),Qe(we(me,nt(ee=>ee!=null&&ee.scrollTop>0),Eo(0)),A),_t(we(j,mt(me),nt(([,ee])=>ee!=null)),([,ee])=>{ee&&(dt(W,ee.viewport),dt(G,ee==null?void 0:ee.item),dt(V,ee.gap),ee.scrollTop>0&&(dt(Ie,!0),Fo(we(o,Jl(1)),J=>{dt(Ie,!1)}),dt(c,{top:ee.scrollTop})))}),Qe(we(W,Ge(({height:ee})=>ee)),r),Qe(we(Dn(st(W,ed),st(G,ed),st(V,(ee,J)=>ee&&ee.column===J.column&&ee.row===J.row),st(o)),Ge(([ee,J,F,oe])=>({viewport:ee,item:J,gap:F,scrollTop:oe}))),H),Qe(we(Dn(st(E),t,st(V,LT),st(G,ed),st(W,ed),st(Q),st(A),st(Ie),st(de),st(ye)),nt(([,,,,,,,ee])=>!ee),Ge(([ee,[J,F],oe,le,fe,he,ke,,ze,$e])=>{const{row:Je,column:gt}=oe,{height:R,width:Z}=le,{width:ne}=fe;if(ke===0&&(ee===0||ne===0))return sv;if(Z===0){const Ft=c0($e,ee),on=Ft===0?Math.max(ke-1,0):Ft;return _T(av(Ft,on,he))}const ge=_S(ne,Z,gt);let xe,pe;ze?J===0&&F===0&&ke>0?(xe=0,pe=ke-1):(xe=ge*$d((J+Je)/(R+Je)),pe=ge*rv((F+Je)/(R+Je))-1,pe=zm(ee-1,sc(pe,ge-1)),xe=zm(pe,sc(0,xe))):(xe=0,pe=-1);const te=av(xe,pe,he),{top:Ce,bottom:Ue}=lv(fe,oe,le,te),tt=rv(ee/ge),Zt=tt*R+(tt-1)*Je-Ue;return{items:te,offsetTop:Ce,offsetBottom:Zt,top:Ce,bottom:Ue,itemHeight:R,itemWidth:Z}})),N),Qe(we(Q,nt(ee=>ee!==null),Ge(ee=>ee.length)),E),Qe(we(Dn(W,G,N,V),nt(([ee,J,{items:F}])=>F.length>0&&J.height!==0&&ee.height!==0),Ge(([ee,J,{items:F},oe])=>{const{top:le,bottom:fe}=lv(ee,oe,J,F);return[le,fe]}),Kt(vc)),n);const Be=De(!1);Qe(we(o,mt(Be),Ge(([ee,J])=>J||ee!==0)),Be);const ce=vs(we(st(N),nt(({items:ee})=>ee.length>0),mt(E,Be),nt(([{items:ee},J,F])=>F&&ee[ee.length-1].index===J-1),Ge(([,ee])=>ee-1),Kt())),ue=vs(we(st(N),nt(({items:ee})=>ee.length>0&&ee[0].index===0),Eo(0),Kt())),je=vs(we(st(N),mt(Ie),nt(([{items:ee},J])=>ee.length>0&&!J),Ge(([{items:ee}])=>({startIndex:ee[0].index,endIndex:ee[ee.length-1].index})),Kt(yS),Wr(0)));Qe(je,x.scrollSeekRangeChanged),Qe(we(z,mt(W,G,E,V),Ge(([ee,J,F,oe,le])=>{const fe=vS(ee),{align:he,behavior:ke,offset:ze}=fe;let $e=fe.index;$e==="LAST"&&($e=oe-1),$e=sc(0,$e,zm(oe-1,$e));let Je=Tp(J,le,F,$e);return he==="end"?Je=ov(Je-J.height+F.height):he==="center"&&(Je=ov(Je-J.height/2+F.height/2)),ze&&(Je+=ze),{top:Je,behavior:ke}})),c);const be=qn(we(N,Ge(ee=>ee.offsetBottom+ee.bottom)),0);return Qe(we(S,Ge(ee=>({width:ee.visibleWidth,height:ee.visibleHeight}))),W),{data:Q,totalCount:E,viewportDimensions:W,itemDimensions:G,scrollTop:o,scrollHeight:X,overscan:e,scrollBy:a,scrollTo:c,scrollToIndex:z,smoothScrollTargetReached:d,windowViewportRect:S,windowScrollTo:D,useWindowScroll:M,customScrollParent:I,windowScrollContainerState:k,deviation:B,scrollContainerState:f,footerHeight:m,headerHeight:h,initialItemCount:A,gap:V,restoreStateFrom:me,...x,initialTopMostItemIndex:ye,gridState:N,totalListHeight:be,...g,startReached:ue,endReached:ce,rangeChanged:je,stateChanged:H,propsReady:C,stateRestoreInProgress:Ie,...T}},Yt(u0,Kn,Vc,jS,fa,d0,da));function lv(e,t,n,o){const{height:r}=n;if(r===void 0||o.length===0)return{top:0,bottom:0};const a=Tp(e,t,n,o[0].index),c=Tp(e,t,n,o[o.length-1].index)+r;return{top:a,bottom:c}}function Tp(e,t,n,o){const r=_S(e.width,n.width,t.column),a=$d(o/r),c=a*n.height+sc(0,a-1)*t.row;return c>0?c+t.row:c}function _S(e,t,n){return sc(1,$d((e+n)/($d(t)+n)))}const RT=Lt(()=>{const e=De(m=>`Item ${m}`),t=De({}),n=De(null),o=De("virtuoso-grid-item"),r=De("virtuoso-grid-list"),a=De(PS),c=De("div"),d=De(xi),f=(m,h=null)=>qn(we(t,Ge(g=>g[m]),Kt()),h);return{context:n,itemContent:e,components:t,computeItemKey:a,itemClassName:o,listClassName:r,headerFooterTag:c,scrollerRef:d,FooterComponent:f("Footer"),HeaderComponent:f("Header"),ListComponent:f("List","div"),ItemComponent:f("Item","div"),ScrollerComponent:f("Scroller","div"),ScrollSeekPlaceholder:f("ScrollSeekPlaceholder","div")}}),BT=Lt(([e,t])=>({...e,...t}),Yt(TT,RT)),NT=q.memo(function(){const t=nn("gridState"),n=nn("listClassName"),o=nn("itemClassName"),r=nn("itemContent"),a=nn("computeItemKey"),c=nn("isSeeking"),d=mo("scrollHeight"),f=nn("ItemComponent"),m=nn("ListComponent"),h=nn("ScrollSeekPlaceholder"),g=nn("context"),x=mo("itemDimensions"),C=mo("gap"),j=nn("log"),S=nn("stateRestoreInProgress"),M=ol(I=>{const k=I.parentElement.parentElement.scrollHeight;d(k);const D=I.firstChild;if(D){const{width:T,height:E}=D.getBoundingClientRect();x({width:T,height:E})}C({row:iv("row-gap",getComputedStyle(I).rowGap,j),column:iv("column-gap",getComputedStyle(I).columnGap,j)})});return S?null:q.createElement(m,{ref:M,className:n,...Zn(m,g),style:{paddingTop:t.offsetTop,paddingBottom:t.offsetBottom},"data-test-id":"virtuoso-item-list"},t.items.map(I=>{const k=a(I.index,I.data,g);return c?q.createElement(h,{key:k,...Zn(h,g),index:I.index,height:t.itemHeight,width:t.itemWidth}):q.createElement(f,{...Zn(f,g),className:o,"data-index":I.index,key:k},r(I.index,I.data,g))}))}),zT=q.memo(function(){const t=nn("HeaderComponent"),n=mo("headerHeight"),o=nn("headerFooterTag"),r=ol(c=>n(Xr(c,"height"))),a=nn("context");return t?q.createElement(o,{ref:r},q.createElement(t,Zn(t,a))):null}),OT=q.memo(function(){const t=nn("FooterComponent"),n=mo("footerHeight"),o=nn("headerFooterTag"),r=ol(c=>n(Xr(c,"height"))),a=nn("context");return t?q.createElement(o,{ref:r},q.createElement(t,Zn(t,a))):null}),FT=({children:e})=>{const t=q.useContext(AS),n=mo("itemDimensions"),o=mo("viewportDimensions"),r=ol(a=>{o(a.getBoundingClientRect())});return q.useEffect(()=>{t&&(o({height:t.viewportHeight,width:t.viewportWidth}),n({height:t.itemHeight,width:t.itemWidth}))},[t,o,n]),q.createElement("div",{style:Of(!1),ref:r},e)},VT=({children:e})=>{const t=q.useContext(AS),n=mo("windowViewportRect"),o=mo("itemDimensions"),r=nn("customScrollParent"),a=IS(n,r);return q.useEffect(()=>{t&&(o({height:t.itemHeight,width:t.itemWidth}),n({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:t.viewportWidth}))},[t,n,o]),q.createElement("div",{ref:a,style:Of(!1)},e)},HT=q.memo(function({...t}){const n=nn("useWindowScroll"),o=nn("customScrollParent"),r=o||n?GT:WT,a=o||n?VT:FT;return q.createElement(r,{...t},q.createElement(a,null,q.createElement(zT,null),q.createElement(NT,null),q.createElement(OT,null)))}),{Component:$T,usePublisher:mo,useEmitterValue:nn,useEmitter:LS}=lS(BT,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged"}},HT),WT=DS({usePublisher:mo,useEmitterValue:nn,useEmitter:LS}),GT=ES({usePublisher:mo,useEmitterValue:nn,useEmitter:LS});function iv(e,t,n){return t!=="normal"&&!(t!=null&&t.endsWith("px"))&&n(`${e} was not resolved to pixel value correctly`,t,Cs.WARN),t==="normal"?0:parseInt(t??"0",10)}const UT=$T,ZT=e=>{const t=b(a=>a.gallery.galleryView),{data:n}=tf(e),{data:o}=nf(e),r=u.useMemo(()=>t==="images"?n==null?void 0:n.total:o==null?void 0:o.total,[t,o,n]);return{totalImages:n,totalAssets:o,currentViewTotal:r}},qT=({imageDTO:e})=>s.jsx(P,{pointerEvents:"none",flexDirection:"column",position:"absolute",top:0,insetInlineStart:0,p:2,alignItems:"flex-start",gap:2,children:s.jsxs(Ws,{variant:"solid",colorScheme:"base",children:[e.width," × ",e.height]})}),QT=u.memo(qT),h0=({postUploadAction:e,isDisabled:t})=>{const n=b(f=>f.gallery.autoAddBoardId),[o]=vC(),r=u.useCallback(f=>{const m=f[0];m&&o({file:m,image_category:"user",is_intermediate:!1,postUploadAction:e??{type:"TOAST"},board_id:n==="none"?void 0:n})},[n,e,o]),{getRootProps:a,getInputProps:c,open:d}=hi({accept:{"image/png":[".png"],"image/jpeg":[".jpg",".jpeg",".png"]},onDropAccepted:r,disabled:t,noDrag:!0,multiple:!1});return{getUploadButtonProps:a,getUploadInputProps:c,openUploader:d}},KT=()=>{const{t:e}=L(),t=O(),n=b(S=>S.gallery.selection),o=yt(og),r=cn("bulkDownload").isFeatureEnabled,[a]=ng(),[c]=sg(),[d]=TC(),f=u.useCallback(()=>{t(OC(n)),t(Yp(!0))},[t,n]),m=u.useCallback(()=>{t(cf(n))},[t,n]),h=u.useCallback(()=>{a({imageDTOs:n})},[a,n]),g=u.useCallback(()=>{c({imageDTOs:n})},[c,n]),x=u.useCallback(()=>{d({image_names:n.map(S=>S.image_name)})},[n,d]),C=u.useMemo(()=>n.every(S=>S.starred),[n]),j=u.useMemo(()=>n.every(S=>!S.starred),[n]);return s.jsxs(s.Fragment,{children:[C&&s.jsx(ut,{icon:o?o.on.icon:s.jsx(Eg,{}),onClickCapture:g,children:o?o.off.text:"Unstar All"}),(j||!C&&!j)&&s.jsx(ut,{icon:o?o.on.icon:s.jsx(Lg,{}),onClickCapture:h,children:o?o.on.text:"Star All"}),r&&s.jsx(ut,{icon:s.jsx(Lc,{}),onClickCapture:x,children:e("gallery.downloadSelection")}),s.jsx(ut,{icon:s.jsx(Ub,{}),onClickCapture:f,children:e("boards.changeBoard")}),s.jsx(Or,{}),s.jsx(ut,{color:"error.300",icon:s.jsx(Xs,{}),onClickCapture:m,children:e("gallery.deleteSelection")})]})},YT=u.memo(KT),XT=()=>u.useCallback(async t=>new Promise(n=>{const o=new Image;o.onload=()=>{const r=document.createElement("canvas");r.width=o.width,r.height=o.height;const a=r.getContext("2d");a&&(a.drawImage(o,0,0),n(new Promise(c=>{r.toBlob(function(d){c(d)},"image/png")})))},o.crossOrigin=rg.get()?"use-credentials":"anonymous",o.src=t}),[]),TS=()=>{const e=Uo(),{t}=L(),n=XT(),o=u.useMemo(()=>!!navigator.clipboard&&!!window.ClipboardItem,[]),r=u.useCallback(async a=>{o||e({title:t("toast.problemCopyingImage"),description:"Your browser doesn't support the Clipboard API.",status:"error",duration:2500,isClosable:!0});try{const c=await n(a);if(!c)throw new Error("Unable to create Blob");J5(c),e({title:t("toast.imageCopied"),status:"success",duration:2500,isClosable:!0})}catch(c){e({title:t("toast.problemCopyingImage"),description:String(c),status:"error",duration:2500,isClosable:!0})}},[n,o,t,e]);return{isClipboardAPIAvailable:o,copyImageToClipboard:r}},JT=Ka("gallery/sentImageToCanvas"),RS=Ka("gallery/sentImageToImg2Img"),eR=Ka("gallery/imageDownloaded"),tR=()=>{const e=Uo(),{t}=L(),n=O(),o=yt(rg);return{downloadImage:u.useCallback(async(a,c)=>{try{const d=o?{headers:{Authorization:`Bearer ${o}`}}:{},f=await fetch(a,d).then(g=>g.blob());if(!f)throw new Error("Unable to create Blob");const m=window.URL.createObjectURL(f),h=document.createElement("a");h.style.display="none",h.href=m,h.download=c,document.body.appendChild(h),h.click(),window.URL.revokeObjectURL(m),n(eR())}catch(d){e({title:t("toast.problemDownloadingImage"),description:String(d),status:"error",duration:2500,isClosable:!0})}},[t,e,n,o])}},nR=e=>Object.keys(e),Qo=(e,t)=>{var o;if(!e)throw new Fx(t||"Missing base");const n=(o=bt().getState().generation.model)==null?void 0:o.base;if(n&&e!==n)throw new Fx(t||`Incompatible base models: ${e} and ${n}`)},sR=e=>(Qo("sdxl","Refiner incompatible with currently-selected model"),new Promise(t=>t(e))),oR=e=>(Qo(e.base,"VAE incompatible with currently-selected model"),new Promise(t=>t(e))),rR=e=>(Qo(e.model.base,"LoRA incompatible with currently-selected model"),new Promise(t=>t(e))),aR=e=>{const t=[];return e.forEach(n=>{try{Qo(n.model.base,"LoRA incompatible with currently-selected model"),t.push(n)}catch{}}),new Promise(n=>n(t))},lR=e=>{var t;return Qo((t=e.model)==null?void 0:t.base,"ControlNet incompatible with currently-selected model"),new Promise(n=>n(e))},iR=e=>{const t=[];return e.forEach(n=>{var o;try{Qo((o=n.model)==null?void 0:o.base,"ControlNet incompatible with currently-selected model"),t.push(n)}catch{}}),new Promise(n=>n(t))},cR=e=>{var t;return Qo((t=e.model)==null?void 0:t.base,"T2I Adapter incompatible with currently-selected model"),new Promise(n=>n(e))},uR=e=>{const t=[];return e.forEach(n=>{var o;try{Qo((o=n.model)==null?void 0:o.base,"T2I Adapter incompatible with currently-selected model"),t.push(n)}catch{}}),new Promise(n=>n(t))},dR=e=>{var t;return Qo((t=e.model)==null?void 0:t.base,"IP Adapter incompatible with currently-selected model"),new Promise(n=>n(e))},fR=e=>{const t=[];return e.forEach(n=>{var o;try{Qo((o=n.model)==null?void 0:o.base,"IP Adapter incompatible with currently-selected model"),t.push(n)}catch{}}),new Promise(n=>n(t))},Ao={refinerModel:sR,vaeModel:oR,lora:rR,loras:aR,controlNet:lR,controlNets:iR,t2iAdapter:cR,t2iAdapters:uR,ipAdapter:dR,ipAdapters:fR},Il=Symbol("pending"),Ea=Symbol("failed");class hR extends Error{constructor(t){super(t),this.name=this.constructor.name}}const Ye=(e,t,n=o=>!0)=>new Promise((o,r)=>{const a=nI(e,t);n(a)&&o(a),r(new hR(`Property ${t} is not of expected type`))}),mR=e=>Ye(e,"created_by",ag),pR=e=>Ye(e,"generation_mode",ag),gR=e=>Ye(e,"positive_prompt",sI),xR=e=>Ye(e,"negative_prompt",oI),vR=e=>Ye(e,"positive_style_prompt",rI),CR=e=>Ye(e,"negative_style_prompt",aI),yR=e=>Ye(e,"seed",lI),bR=e=>Ye(e,"cfg_scale",VC),jR=e=>Ye(e,"cfg_rescale_multiplier",iI),SR=e=>Ye(e,"scheduler",ai),wR=e=>Ye(e,"width",cI),kR=e=>Ye(e,"height",uI),IR=e=>Ye(e,"steps",HC),MR=e=>Ye(e,"strength",$C),AR=e=>Ye(e,"hrf_enabled",dI),PR=e=>Ye(e,"hrf_strength",$C),DR=e=>Ye(e,"hrf_method",WC),ER=e=>Ye(e,"refiner_steps",HC),_R=e=>Ye(e,"refiner_cfg_scale",VC),LR=e=>Ye(e,"refiner_scheduler",ai),TR=e=>Ye(e,"refiner_positive_aesthetic_score",fI),RR=e=>Ye(e,"refiner_negative_aesthetic_score",hI),BR=e=>Ye(e,"refiner_start",mI),NR=async e=>{const t=await Ye(e,"model",void 0),n=await Ya(t,"main"),o=await Xa(n,wc);return Wo.parse(o)},zR=async e=>{const t=await Ye(e,"refiner_model",void 0),n=await Ya(t,"main"),o=await Xa(n,kC);return Wo.parse(o)},OR=async e=>{const t=await Ye(e,"vae",void 0),n=await Ya(t,"vae"),o=await Xa(n,PC);return Wo.parse(o)},BS=async e=>{const t=await Ye(e,"lora",void 0),n=await Ye(e,"model",void 0),o=await Ye(e,"weight",void 0),r=await Ya(n??t,"lora"),a=await Xa(r,tg);return{model:Wo.parse(a),weight:eI(o)?o:tI.weight,isEnabled:!0}},FR=async e=>{const t=await Ye(e,"loras",jc);return(await Promise.allSettled(t.map(r=>BS(r)))).filter(r=>r.status==="fulfilled").map(r=>r.value)},NS=async e=>{const t=await Ye(e,"control_model"),n=await Ya(t,"controlnet"),o=await Xa(n,IC),r=wa.shape.image.nullish().catch(null).parse(await Ye(e,"image")),a=wa.shape.image.nullish().catch(null).parse(await Ye(e,"processed_image")),c=wa.shape.control_weight.nullish().catch(null).parse(await Ye(e,"control_weight")),d=wa.shape.begin_step_percent.nullish().catch(null).parse(await Ye(e,"begin_step_percent")),f=wa.shape.end_step_percent.nullish().catch(null).parse(await Ye(e,"end_step_percent")),m=wa.shape.control_mode.nullish().catch(null).parse(await Ye(e,"control_mode")),h=wa.shape.resize_mode.nullish().catch(null).parse(await Ye(e,"resize_mode")),{processorType:g,processorNode:x}=FC(o);return{type:"controlnet",isEnabled:!0,model:Wo.parse(o),weight:typeof c=="number"?c:Fi.weight,beginStepPct:d??Fi.beginStepPct,endStepPct:f??Fi.endStepPct,controlMode:m??Fi.controlMode,resizeMode:h??Fi.resizeMode,controlImage:(r==null?void 0:r.image_name)??null,processedControlImage:(a==null?void 0:a.image_name)??null,processorType:g,processorNode:x,shouldAutoConfig:!0,id:ia()}},VR=async e=>{const t=await Ye(e,"controlnets",jc);return(await Promise.allSettled(t.map(r=>NS(r)))).filter(r=>r.status==="fulfilled").map(r=>r.value)},zS=async e=>{const t=await Ye(e,"t2i_adapter_model"),n=await Ya(t,"t2i_adapter"),o=await Xa(n,MC),r=wl.shape.image.nullish().catch(null).parse(await Ye(e,"image")),a=wl.shape.image.nullish().catch(null).parse(await Ye(e,"processed_image")),c=wl.shape.weight.nullish().catch(null).parse(await Ye(e,"weight")),d=wl.shape.begin_step_percent.nullish().catch(null).parse(await Ye(e,"begin_step_percent")),f=wl.shape.end_step_percent.nullish().catch(null).parse(await Ye(e,"end_step_percent")),m=wl.shape.resize_mode.nullish().catch(null).parse(await Ye(e,"resize_mode")),{processorType:h,processorNode:g}=FC(o);return{type:"t2i_adapter",isEnabled:!0,model:Wo.parse(o),weight:typeof c=="number"?c:Wu.weight,beginStepPct:d??Wu.beginStepPct,endStepPct:f??Wu.endStepPct,resizeMode:m??Wu.resizeMode,controlImage:(r==null?void 0:r.image_name)??null,processedControlImage:(a==null?void 0:a.image_name)??null,processorType:h,processorNode:g,shouldAutoConfig:!0,id:ia()}},HR=async e=>{const t=await Ye(e,"t2iAdapters",jc);return(await Promise.allSettled(t.map(r=>zS(r)))).filter(r=>r.status==="fulfilled").map(r=>r.value)},OS=async e=>{const t=await Ye(e,"ip_adapter_model"),n=await Ya(t,"ip_adapter"),o=await Xa(n,AC),r=Gu.shape.image.nullish().catch(null).parse(await Ye(e,"image")),a=Gu.shape.weight.nullish().catch(null).parse(await Ye(e,"weight")),c=Gu.shape.begin_step_percent.nullish().catch(null).parse(await Ye(e,"begin_step_percent")),d=Gu.shape.end_step_percent.nullish().catch(null).parse(await Ye(e,"end_step_percent"));return{id:ia(),type:"ip_adapter",isEnabled:!0,model:Wo.parse(o),controlImage:(r==null?void 0:r.image_name)??null,weight:a??Cm.weight,beginStepPct:c??Cm.beginStepPct,endStepPct:d??Cm.endStepPct}},$R=async e=>{const t=await Ye(e,"ipAdapters",jc);return(await Promise.allSettled(t.map(r=>OS(r)))).filter(r=>r.status==="fulfilled").map(r=>r.value)},vt={createdBy:mR,generationMode:pR,positivePrompt:gR,negativePrompt:xR,sdxlPositiveStylePrompt:vR,sdxlNegativeStylePrompt:CR,seed:yR,cfgScale:bR,cfgRescaleMultiplier:jR,scheduler:SR,width:wR,height:kR,steps:IR,strength:MR,hrfEnabled:AR,hrfStrength:PR,hrfMethod:DR,refinerSteps:ER,refinerCFGScale:_R,refinerScheduler:LR,refinerPositiveAestheticScore:TR,refinerNegativeAestheticScore:RR,refinerStart:BR,mainModel:NR,refinerModel:zR,vaeModel:OR,lora:BS,loras:FR,controlNet:NS,controlNets:VR,t2iAdapter:zS,t2iAdapters:HR,ipAdapter:OS,ipAdapters:$R},WR=e=>{bt().dispatch(GC(e))},GR=e=>{bt().dispatch(UC(e))},UR=e=>{bt().dispatch(ZC(e))},ZR=e=>{bt().dispatch(qC(e))},qR=e=>{bt().dispatch(lg(e))},QR=e=>{bt().dispatch(QC(e))},KR=e=>{bt().dispatch(KC(e))},YR=e=>{bt().dispatch(YC(e))},XR=e=>{bt().dispatch(pI(e))},JR=e=>{bt().dispatch(gI(e))},eB=e=>{bt().dispatch(XC(e))},tB=e=>{bt().dispatch(JC(e))},nB=e=>{bt().dispatch(ey(e))},sB=e=>{bt().dispatch(ty(e))},oB=e=>{bt().dispatch(ny(e))},rB=e=>{bt().dispatch(sy(e))},aB=e=>{bt().dispatch(oy(e))},lB=e=>{bt().dispatch(ry(e))},iB=e=>{bt().dispatch(ay(e))},cB=e=>{bt().dispatch(ly(e))},uB=e=>{bt().dispatch(iy(e))},dB=e=>{bt().dispatch(cy(e))},fB=e=>{bt().dispatch(sp(e))},hB=e=>{if(!e){bt().dispatch(op(null));return}bt().dispatch(op(e))},mB=e=>{bt().dispatch(uy(e))},pB=e=>{if(!e.length)return;const{dispatch:t}=bt();t(xI()),e.forEach(n=>{t(uy(n))})},gB=e=>{bt().dispatch(li(e))},xB=e=>{if(!e.length)return;const{dispatch:t}=bt();t(vI()),e.forEach(n=>{t(li(n))})},vB=e=>{bt().dispatch(li(e))},CB=e=>{if(!e.length)return;const{dispatch:t}=bt();t(CI()),e.forEach(n=>{t(li(n))})},yB=e=>{bt().dispatch(li(e))},bB=e=>{if(!e.length)return;const{dispatch:t}=bt();t(yI()),e.forEach(n=>{t(li(n))})},At={positivePrompt:WR,negativePrompt:GR,sdxlPositiveStylePrompt:UR,sdxlNegativeStylePrompt:ZR,seed:qR,cfgScale:QR,cfgRescaleMultiplier:KR,scheduler:YR,width:XR,height:JR,steps:eB,strength:tB,hrfEnabled:nB,hrfStrength:sB,hrfMethod:oB,refinerSteps:rB,refinerCFGScale:aB,refinerScheduler:lB,refinerPositiveAestheticScore:iB,refinerNegativeAestheticScore:cB,refinerStart:uB,model:dB,refinerModel:fB,vae:hB,lora:mB,loras:pB,controlNets:xB,controlNet:gB,t2iAdapters:CB,t2iAdapter:vB,ipAdapters:bB,ipAdapter:yB},Om=async e=>{try{const t=await ig(e.key);return`${t.name} (${t.base.toUpperCase()})`}catch{return`${e.key} (${e.base.toUpperCase()})`}},jB=async e=>{try{const t=await ig(e.model.key);return`${t.name} (${t.base.toUpperCase()}) - ${e.weight}`}catch{return`${e.model.key} (${e.model.base.toUpperCase()}) - ${e.weight}`}},Fm=async e=>{try{const t=await ig(e.model.key??"none");return`${t.name} (${t.base.toUpperCase()}) - ${e.weight}`}catch{return`${e.model.key} (${e.model.base.toUpperCase()}) - ${e.weight}`}},al=(e,t)=>{dy({title:Te("toast.parameterSet",{parameter:e}),description:t,status:"info",duration:2500,isClosable:!0})},Ff=(e,t)=>{dy({title:Te("toast.parameterNotSet",{parameter:e}),description:t,status:"warning",duration:2500,isClosable:!0})},SB=e=>async(t,n=!1)=>{try{const o=await e.parser(t);return n&&al(e.getLabel()),o}catch(o){throw n&&Ff(e.getLabel(),o.message),o}},wB=e=>async(t,n=!1)=>{try{const o=await e.itemParser(t);return n&&al(e.getLabel()),o}catch(o){throw n&&Ff(e.getLabel(),o.message),o}},kB=e=>async(t,n=!1)=>{try{e.validator&&await e.validator(t),await e.recaller(t),n&&al(e.getLabel())}catch(o){throw n&&Ff(e.getLabel(),o.message),o}},IB=e=>async(t,n=!1)=>{try{e.itemValidator&&await e.itemValidator(t),await e.itemRecaller(t),n&&al(e.getLabel())}catch(o){throw n&&Ff(e.getLabel(),o.message),o}},cv=e=>new Promise(t=>t(String(e))),Et=({getLabel:e,parser:t,itemParser:n,recaller:o,itemRecaller:r,validator:a,itemValidator:c,renderValue:d,renderItemValue:f})=>({parse:SB({parser:t,getLabel:e}),parseItem:n?wB({itemParser:n,getLabel:e}):void 0,recall:o?kB({recaller:o,validator:a,getLabel:e}):void 0,recallItem:r?IB({itemRecaller:r,itemValidator:c,getLabel:e}):void 0,getLabel:e,renderValue:d??cv,renderItemValue:f??cv}),Fe={createdBy:Et({getLabel:()=>Te("metadata.createdBy"),parser:vt.createdBy}),generationMode:Et({getLabel:()=>Te("metadata.generationMode"),parser:vt.generationMode}),cfgRescaleMultiplier:Et({getLabel:()=>Te("metadata.cfgRescaleMultiplier"),parser:vt.cfgRescaleMultiplier,recaller:At.cfgRescaleMultiplier}),cfgScale:Et({getLabel:()=>Te("metadata.cfgScale"),parser:vt.cfgScale,recaller:At.cfgScale}),height:Et({getLabel:()=>Te("metadata.height"),parser:vt.height,recaller:At.height}),negativePrompt:Et({getLabel:()=>Te("metadata.negativePrompt"),parser:vt.negativePrompt,recaller:At.negativePrompt}),positivePrompt:Et({getLabel:()=>Te("metadata.positivePrompt"),parser:vt.positivePrompt,recaller:At.positivePrompt}),scheduler:Et({getLabel:()=>Te("metadata.scheduler"),parser:vt.scheduler,recaller:At.scheduler}),sdxlNegativeStylePrompt:Et({getLabel:()=>Te("sdxl.negStylePrompt"),parser:vt.sdxlNegativeStylePrompt,recaller:At.sdxlNegativeStylePrompt}),sdxlPositiveStylePrompt:Et({getLabel:()=>Te("sdxl.posStylePrompt"),parser:vt.sdxlPositiveStylePrompt,recaller:At.sdxlPositiveStylePrompt}),seed:Et({getLabel:()=>Te("metadata.seed"),parser:vt.seed,recaller:At.seed}),steps:Et({getLabel:()=>Te("metadata.steps"),parser:vt.steps,recaller:At.steps}),strength:Et({getLabel:()=>Te("metadata.strength"),parser:vt.strength,recaller:At.strength}),width:Et({getLabel:()=>Te("metadata.width"),parser:vt.width,recaller:At.width}),hrfEnabled:Et({getLabel:()=>Te("hrf.metadata.enabled"),parser:vt.hrfEnabled,recaller:At.hrfEnabled}),hrfMethod:Et({getLabel:()=>Te("hrf.metadata.method"),parser:vt.hrfMethod,recaller:At.hrfMethod}),hrfStrength:Et({getLabel:()=>Te("hrf.metadata.strength"),parser:vt.hrfStrength,recaller:At.hrfStrength}),refinerCFGScale:Et({getLabel:()=>Te("sdxl.cfgScale"),parser:vt.refinerCFGScale,recaller:At.refinerCFGScale}),refinerModel:Et({getLabel:()=>Te("sdxl.refinermodel"),parser:vt.refinerModel,recaller:At.refinerModel,validator:Ao.refinerModel,renderValue:Om}),refinerNegativeAestheticScore:Et({getLabel:()=>Te("sdxl.posAestheticScore"),parser:vt.refinerNegativeAestheticScore,recaller:At.refinerNegativeAestheticScore}),refinerPositiveAestheticScore:Et({getLabel:()=>Te("sdxl.negAestheticScore"),parser:vt.refinerPositiveAestheticScore,recaller:At.refinerPositiveAestheticScore}),refinerScheduler:Et({getLabel:()=>Te("sdxl.scheduler"),parser:vt.refinerScheduler,recaller:At.refinerScheduler}),refinerStart:Et({getLabel:()=>Te("sdxl.refinerStart"),parser:vt.refinerStart,recaller:At.refinerStart}),refinerSteps:Et({getLabel:()=>Te("sdxl.refinerSteps"),parser:vt.refinerSteps,recaller:At.refinerSteps}),model:Et({getLabel:()=>Te("metadata.model"),parser:vt.mainModel,recaller:At.model,renderValue:Om}),vae:Et({getLabel:()=>Te("metadata.vae"),parser:vt.vaeModel,recaller:At.vae,renderValue:Om,validator:Ao.vaeModel}),controlNets:Et({getLabel:()=>Te("common.controlNet"),parser:vt.controlNets,itemParser:vt.controlNet,recaller:At.controlNets,itemRecaller:At.controlNet,validator:Ao.controlNets,itemValidator:Ao.controlNet,renderItemValue:Fm}),ipAdapters:Et({getLabel:()=>Te("common.ipAdapter"),parser:vt.ipAdapters,itemParser:vt.ipAdapter,recaller:At.ipAdapters,itemRecaller:At.ipAdapter,validator:Ao.ipAdapters,itemValidator:Ao.ipAdapter,renderItemValue:Fm}),loras:Et({getLabel:()=>Te("models.lora"),parser:vt.loras,itemParser:vt.lora,recaller:At.loras,itemRecaller:At.lora,validator:Ao.loras,itemValidator:Ao.lora,renderItemValue:jB}),t2iAdapters:Et({getLabel:()=>Te("common.t2iAdapter"),parser:vt.t2iAdapters,itemParser:vt.t2iAdapter,recaller:At.t2iAdapters,itemRecaller:At.t2iAdapter,validator:Ao.t2iAdapters,itemValidator:Ao.t2iAdapter,renderItemValue:Fm})},MB=async e=>{(await Promise.allSettled([Fe.positivePrompt.parse(e).then(n=>{var o;Fe.positivePrompt.recall&&((o=Fe.positivePrompt)==null||o.recall(n))}),Fe.negativePrompt.parse(e).then(n=>{var o;Fe.negativePrompt.recall&&((o=Fe.negativePrompt)==null||o.recall(n))}),Fe.sdxlPositiveStylePrompt.parse(e).then(n=>{var o;Fe.sdxlPositiveStylePrompt.recall&&((o=Fe.sdxlPositiveStylePrompt)==null||o.recall(n))}),Fe.sdxlNegativeStylePrompt.parse(e).then(n=>{var o;Fe.sdxlNegativeStylePrompt.recall&&((o=Fe.sdxlNegativeStylePrompt)==null||o.recall(n))})])).some(n=>n.status==="fulfilled")&&al(Te("metadata.allPrompts"))},FS=async e=>{(await Promise.allSettled([Fe.width.parse(e).then(n=>{var o;Fe.width.recall&&((o=Fe.width)==null||o.recall(n))}),Fe.height.parse(e).then(n=>{var o;Fe.height.recall&&((o=Fe.height)==null||o.recall(n))})])).some(n=>n.status==="fulfilled")&&al(Te("metadata.imageDimensions"))},Rp=async(e,t=[])=>{(await Promise.allSettled(nR(Fe).filter(o=>!t.includes(o)).map(o=>{const{parse:r,recall:a}=Fe[o];return r(e).then(c=>{a&&a(c)})}))).some(o=>o.status==="fulfilled")&&al(Te("toast.parametersSet"))};function AB(e,t,n){var o=this,r=u.useRef(null),a=u.useRef(0),c=u.useRef(null),d=u.useRef([]),f=u.useRef(),m=u.useRef(),h=u.useRef(e),g=u.useRef(!0);h.current=e;var x=typeof window<"u",C=!t&&t!==0&&x;if(typeof e!="function")throw new TypeError("Expected a function");t=+t||0;var j=!!(n=n||{}).leading,S=!("trailing"in n)||!!n.trailing,M="maxWait"in n,I="debounceOnServer"in n&&!!n.debounceOnServer,k=M?Math.max(+n.maxWait||0,t):null;u.useEffect(function(){return g.current=!0,function(){g.current=!1}},[]);var D=u.useMemo(function(){var T=function(z){var X=d.current,B=f.current;return d.current=f.current=null,a.current=z,m.current=h.current.apply(B,X)},E=function(z,X){C&&cancelAnimationFrame(c.current),c.current=C?requestAnimationFrame(z):setTimeout(z,X)},A=function(z){if(!g.current)return!1;var X=z-r.current;return!r.current||X>=t||X<0||M&&z-a.current>=k},N=function(z){return c.current=null,S&&d.current?T(z):(d.current=f.current=null,m.current)},W=function z(){var X=Date.now();if(A(X))return N(X);if(g.current){var B=t-(X-r.current),Q=M?Math.min(B,k-(X-a.current)):B;E(z,Q)}},G=function(){if(x||I){var z=Date.now(),X=A(z);if(d.current=[].slice.call(arguments),f.current=o,r.current=z,X){if(!c.current&&g.current)return a.current=r.current,E(W,t),j?T(r.current):m.current;if(M)return E(W,t),T(r.current)}return c.current||E(W,t),m.current}};return G.cancel=function(){c.current&&(C?cancelAnimationFrame(c.current):clearTimeout(c.current)),a.current=0,d.current=r.current=f.current=c.current=null},G.isPending=function(){return!!c.current},G.flush=function(){return c.current?N(Date.now()):m.current},G},[j,M,t,k,S,C,x,I]);return D}function PB(e,t){return e===t}function DB(e,t){return t}function m0(e,t,n){var o=n&&n.equalityFn||PB,r=u.useReducer(DB,e),a=r[0],c=r[1],d=AB(u.useCallback(function(m){return c(m)},[c]),t,n),f=u.useRef(e);return o(f.current,e)||(d(e),f.current=e),[a,d]}const VS=e=>{const t=b(a=>a.config.metadataFetchDebounce??300),[n]=m0(e,t),{data:o,isLoading:r}=fy(n??Ot);return{metadata:o,isLoading:r}},HS=e=>{const{metadata:t,isLoading:n}=VS(e),[o,r]=u.useState(!1),[a,c]=u.useState(!1),[d,f]=u.useState(!1);u.useEffect(()=>{(async()=>{if(t){r(!0);try{await Fe.seed.parse(t),c(!0)}catch{c(!1)}(await Promise.allSettled([Fe.positivePrompt.parse(t),Fe.negativePrompt.parse(t),Fe.sdxlPositiveStylePrompt.parse(t),Fe.sdxlNegativeStylePrompt.parse(t)])).some(S=>S.status==="fulfilled")?f(!0):f(!1)}else r(!1),c(!1),f(!1)})()},[t]);const m=u.useCallback(()=>{Rp(t)},[t]),h=u.useCallback(()=>{Rp(t,["seed"])},[t]),g=u.useCallback(()=>{Fe.seed.parse(t).then(C=>{Fe.seed.recall&&Fe.seed.recall(C)})},[t]),x=u.useCallback(()=>{MB(t)},[t]);return{recallAll:m,remix:h,recallSeed:g,recallPrompts:x,hasMetadata:o,hasSeed:a,hasPrompts:d,isLoadingMetadata:n}},$S=({onSuccess:e,onError:t})=>{const n=O(),o=Uo(),{t:r}=L(),[a,c]=bI();return{getAndLoadEmbeddedWorkflow:u.useCallback(async f=>{try{const m=await a(f);n(cg({workflow:m.data,asCopy:!0})),e&&e()}catch{o({title:r("toast.problemRetrievingWorkflow"),status:"error"}),t&&t()}},[a,n,e,o,r,t]),getAndLoadEmbeddedWorkflowResult:c}},EB=e=>{const{imageDTO:t}=e,n=b(ls),o=O(),{t:r}=L(),a=Uo(),c=cn("unifiedCanvas").isFeatureEnabled,d=yt(og),{downloadImage:f}=tR(),{recallAll:m,remix:h,recallSeed:g,recallPrompts:x,hasMetadata:C,hasSeed:j,hasPrompts:S,isLoadingMetadata:M}=HS(t==null?void 0:t.image_name),{getAndLoadEmbeddedWorkflow:I,getAndLoadEmbeddedWorkflowResult:k}=$S({}),D=u.useCallback(()=>{I(t.image_name)},[I,t.image_name]),[T]=ng(),[E]=sg(),{isClipboardAPIAvailable:A,copyImageToClipboard:N}=TS(),W=u.useCallback(()=>{t&&o(cf([t]))},[o,t]),G=u.useCallback(()=>{o(RS()),o(ug(t))},[o,t]),z=u.useCallback(()=>{o(JT()),dg.flushSync(()=>{o(zs("unifiedCanvas"))}),o(hy(t,n)),a({title:r("toast.sentToUnifiedCanvas"),status:"success",duration:2500,isClosable:!0})},[o,t,r,a,n]),X=u.useCallback(()=>{o(OC([t])),o(Yp(!0))},[o,t]),B=u.useCallback(()=>{N(t.image_url)},[N,t.image_url]),Q=u.useCallback(()=>{t&&T({imageDTOs:[t]})},[T,t]),V=u.useCallback(()=>{t&&E({imageDTOs:[t]})},[E,t]),H=u.useCallback(()=>{f(t.image_url,t.image_name)},[f,t.image_name,t.image_url]);return s.jsxs(s.Fragment,{children:[s.jsx(ut,{as:"a",href:t.image_url,target:"_blank",icon:s.jsx(Pm,{}),children:r("common.openInNewTab")}),A&&s.jsx(ut,{icon:s.jsx(nl,{}),onClickCapture:B,children:r("parameters.copyImage")}),s.jsx(ut,{icon:s.jsx(Lc,{}),onClickCapture:H,children:r("parameters.downloadImage")}),s.jsx(Or,{}),s.jsx(ut,{icon:k.isLoading?s.jsx($i,{}):s.jsx(Pg,{}),onClickCapture:D,isDisabled:!t.has_workflow,children:r("nodes.loadWorkflow")}),s.jsx(ut,{icon:M?s.jsx($i,{}):s.jsx(Ob,{}),onClickCapture:h,isDisabled:M||!C,children:r("parameters.remixImage")}),s.jsx(ut,{icon:M?s.jsx($i,{}):s.jsx(Kb,{}),onClickCapture:x,isDisabled:M||!S,children:r("parameters.usePrompt")}),s.jsx(ut,{icon:M?s.jsx($i,{}):s.jsx(Qb,{}),onClickCapture:g,isDisabled:M||!j,children:r("parameters.useSeed")}),s.jsx(ut,{icon:M?s.jsx($i,{}):s.jsx(Fb,{}),onClickCapture:m,isDisabled:M||!C,children:r("parameters.useAll")}),s.jsx(Or,{}),s.jsx(ut,{icon:s.jsx(Pm,{}),onClickCapture:G,id:"send-to-img2img",children:r("parameters.sendToImg2Img")}),c&&s.jsx(ut,{icon:s.jsx(Pm,{}),onClickCapture:z,id:"send-to-canvas",children:r("parameters.sendToUnifiedCanvas")}),s.jsx(Or,{}),s.jsx(ut,{icon:s.jsx(Ub,{}),onClickCapture:X,children:r("boards.changeBoard")}),t.starred?s.jsx(ut,{icon:d?d.off.icon:s.jsx(Lg,{}),onClickCapture:V,children:d?d.off.text:r("gallery.unstarImage")}):s.jsx(ut,{icon:d?d.on.icon:s.jsx(Eg,{}),onClickCapture:Q,children:d?d.on.text:r("gallery.starImage")}),s.jsx(Or,{}),s.jsx(ut,{color:"error.300",icon:s.jsx(Xs,{}),onClickCapture:W,children:r("gallery.deleteImage")})]})},WS=u.memo(EB),$i=()=>s.jsx(P,{w:"14px",alignItems:"center",justifyContent:"center",children:s.jsx(la,{size:"xs"})}),_B=({imageDTO:e,children:t})=>{const n=b(r=>r.gallery.selection.length),o=u.useCallback(()=>e?n>1?s.jsx(qr,{visibility:"visible",children:s.jsx(YT,{})}):s.jsx(qr,{visibility:"visible",children:s.jsx(WS,{imageDTO:e})}):null,[e,n]);return s.jsx(RC,{renderMenu:o,children:t})},LB=u.memo(_B),TB=e=>{const{data:t,disabled:n,...o}=e,r=u.useRef(ia()),{attributes:a,listeners:c,setNodeRef:d}=N_({id:r.current,disabled:n,data:t});return s.jsx(Ae,{ref:d,position:"absolute",w:"full",h:"full",top:0,insetInlineStart:0,...a,...c,...o})},RB=u.memo(TB),BB=s.jsx(gn,{as:mi,boxSize:16}),NB=s.jsx(Ut,{icon:dc}),zB=e=>{const{imageDTO:t,onError:n,onClick:o,withMetadataOverlay:r=!1,isDropDisabled:a=!1,isDragDisabled:c=!1,isUploadDisabled:d=!1,minSize:f=24,postUploadAction:m,imageSx:h,fitContainer:g=!1,droppableData:x,draggableData:C,dropLabel:j,isSelected:S=!1,thumbnail:M=!1,noContentFallback:I=NB,uploadElement:k=BB,useThumbailFallback:D,withHoverOverlay:T=!1,children:E,onMouseOver:A,onMouseOut:N,dataTestId:W}=e,[G,z]=u.useState(!1),X=u.useCallback(me=>{A&&A(me),z(!0)},[A]),B=u.useCallback(me=>{N&&N(me),z(!1)},[N]),{getUploadButtonProps:Q,getUploadInputProps:V}=h0({postUploadAction:m,isDisabled:d}),H=u.useMemo(()=>{const me={minH:f,w:"full",h:"full",alignItems:"center",justifyContent:"center",borderRadius:"base",transitionProperty:"common",transitionDuration:"0.1s",color:"base.500"};return d||Object.assign(me,{cursor:"pointer",bg:"base.700",_hover:{bg:"base.650",color:"base.300"}}),me},[d,f]);return s.jsx(LB,{imageDTO:t,children:me=>s.jsxs(P,{ref:me,onMouseOver:X,onMouseOut:B,width:"full",height:"full",alignItems:"center",justifyContent:"center",position:"relative",minW:f||void 0,minH:f||void 0,userSelect:"none",cursor:c||!t?"default":"pointer",children:[t&&s.jsxs(P,{w:"full",h:"full",position:g?"absolute":"relative",alignItems:"center",justifyContent:"center",children:[s.jsx(Ks,{src:M?t.thumbnail_url:t.image_url,fallbackStrategy:"beforeLoadOrError",fallbackSrc:D?t.thumbnail_url:void 0,fallback:D?void 0:s.jsx(tj,{image:t}),onError:n,draggable:!1,w:t.width,objectFit:"contain",maxW:"full",maxH:"full",borderRadius:"base",sx:h,"data-testid":W}),r&&s.jsx(QT,{imageDTO:t}),s.jsx(t0,{isSelected:S,isHovered:T?G:!1})]}),!t&&!d&&s.jsx(s.Fragment,{children:s.jsxs(P,{sx:H,...Q(),children:[s.jsx("input",{...V()}),k]})}),!t&&d&&I,t&&!c&&s.jsx(RB,{data:C,disabled:c||!t,onClick:o}),E,!a&&s.jsx(e0,{data:x,disabled:a,dropLabel:j})]})})},Jr=u.memo(zB),OB=e=>{const{onClick:t,tooltip:n,icon:o,styleOverrides:r}=e,a=u.useMemo(()=>({position:"absolute",top:1,insetInlineEnd:1,p:0,minW:0,svg:{transitionProperty:"common",transitionDuration:"normal",fill:"base.100",_hover:{fill:"base.50"},filter:"drop-shadow(0px 0px 0.1rem var(--invoke-colors-base-800))"},...r}),[r]);return s.jsx(ve,{onClick:t,"aria-label":n,tooltip:n,icon:o,size:"sm",variant:"link",sx:a,"data-testid":n})},$l=u.memo(OB),FB={position:"relative",height:"full",width:"full","::before":{content:"''",display:"block",pt:"100%"}},VB=()=>s.jsx(eg,{sx:FB,children:s.jsx(Ae,{position:"absolute",top:0,insetInlineStart:0,height:"full",width:"full"})}),HB=u.memo(VB),$B=e=>{const t=O(),n=b(d=>d.gallery.selection.length>1),o=u.useMemo(()=>it(kc,d=>d.selection.some(f=>f.image_name===(e==null?void 0:e.image_name))),[e==null?void 0:e.image_name]),r=b(o),a=cn("multiselect").isFeatureEnabled,c=u.useCallback(d=>{if(e){if(!a){t(jI([e]));return}t(SI({imageDTO:e,shiftKey:d.shiftKey,ctrlKey:d.ctrlKey,metaKey:d.metaKey}))}},[t,e,a]);return{areMultiplesSelected:n,isSelected:r,handleClick:c}},WB=(e,t,n)=>{const o=u.useRef(null);return u.useEffect(()=>{var h,g,x,C;if(!e||n)return;const r=Od.get(),a=(h=r.virtuosoRangeRef)==null?void 0:h.current,c=(g=r.rootRef)==null?void 0:g.current,d=(x=r.virtuosoRef)==null?void 0:x.current;if(!a||!d||!c)return;const f=(C=o.current)==null?void 0:C.getBoundingClientRect(),m=c.getBoundingClientRect();(!f||!eS(f,m))&&d.scrollToIndex({index:t,align:tS(t,a)})},[e,t,n]),o},GB={w:"full",h:"full"},UB={bottom:2,top:"auto"},ZB={containerType:"inline-size"},qB={"@container (max-width: 80px)":{"&":{display:"none"}}},QB=e=>{const t=O(),{imageName:n}=e,{currentData:o}=Gs(n),r=fg(),{t:a}=L(),c=b(G=>G.gallery.selectedBoardId),d=b(G=>G.gallery.alwaysShowImageSizeBadge),{handleClick:f,isSelected:m,areMultiplesSelected:h}=$B(o),g=yt(og),x=WB(m,e.index,h),C=u.useCallback(G=>{G.stopPropagation(),o&&t(cf([o]))},[t,o]),j=u.useMemo(()=>{if(h)return{id:"gallery-image",payloadType:"GALLERY_SELECTION",payload:{boardId:c}};if(o)return{id:"gallery-image",payloadType:"IMAGE_DTO",payload:{imageDTO:o}}},[o,c,h]),[S]=ng(),[M]=sg(),I=u.useCallback(()=>{o&&(o.starred&&M({imageDTOs:[o]}),o.starred||S({imageDTOs:[o]}))},[S,M,o]),[k,D]=u.useState(!1),T=u.useCallback(()=>{D(!0)},[]),E=u.useCallback(()=>{D(!1)},[]),A=u.useMemo(()=>{if(o!=null&&o.starred)return g?g.on.icon:s.jsx(Lg,{size:"20"});if(!(o!=null&&o.starred)&&k)return g?g.off.icon:s.jsx(Eg,{size:"20"})},[o==null?void 0:o.starred,k,g]),N=u.useMemo(()=>o!=null&&o.starred?g?g.off.text:"Unstar":o!=null&&o.starred?"":g?g.on.text:"Star",[o==null?void 0:o.starred,g]),W=u.useMemo(()=>Yj(o==null?void 0:o.image_name),[o==null?void 0:o.image_name]);return o?s.jsx(Ae,{w:"full",h:"full",className:"gallerygrid-image","data-testid":W,sx:ZB,children:s.jsx(P,{ref:x,userSelect:"none",position:"relative",justifyContent:"center",alignItems:"center",aspectRatio:"1/1",children:s.jsx(Jr,{onClick:f,imageDTO:o,draggableData:j,isSelected:m,minSize:0,imageSx:GB,isDropDisabled:!0,isUploadDisabled:!0,thumbnail:!0,withHoverOverlay:!0,onMouseOver:T,onMouseOut:E,children:s.jsxs(s.Fragment,{children:[(k||d)&&s.jsx(re,{position:"absolute",background:"base.900",color:"base.50",fontSize:"sm",fontWeight:"semibold",bottom:0,left:0,opacity:.7,px:2,lineHeight:1.25,borderTopEndRadius:"base",borderBottomStartRadius:"base",sx:qB,pointerEvents:"none",children:`${o.width}x${o.height}`}),s.jsx($l,{onClick:I,icon:A,tooltip:N}),k&&r&&s.jsx($l,{onClick:C,icon:s.jsx(Bc,{size:"16px"}),tooltip:a("gallery.deleteImage"),styleOverrides:UB})]})})})}):s.jsx(HB,{})},KB=u.memo(QB),YB={Item:cL,List:dL},XB={height:"100%"},JB=()=>{const{t:e}=L(),t=u.useRef(null),[n,o]=u.useState(null),[r,a]=Qg(Oc),c=b(k=>k.gallery.selectedBoardId),{currentViewTotal:d}=ZT(c),f=u.useRef(null),m=u.useRef(null),{areMoreImagesAvailable:h,handleLoadMoreImages:g,queryResult:{currentData:x,isFetching:C,isSuccess:j,isError:S}}=Tf();vL();const M=u.useCallback((k,D)=>s.jsx(KB,{index:k,imageName:D},D),[]);u.useEffect(()=>{const{current:k}=t;return n&&k&&r({target:k,elements:{viewport:n}}),()=>{var D;return(D=a())==null?void 0:D.destroy()}},[n,r,a]);const I=u.useCallback(k=>{f.current=k},[]);return u.useEffect(()=>(Od.set({rootRef:t,virtuosoRangeRef:f,virtuosoRef:m}),()=>{Od.set({})}),[]),x?j&&(x==null?void 0:x.ids.length)===0?s.jsx(P,{w:"full",h:"full",alignItems:"center",justifyContent:"center",children:s.jsx(Ut,{label:e("gallery.noImagesInGallery"),icon:dc})}):j&&x?s.jsxs(s.Fragment,{children:[s.jsx(Ae,{ref:t,"data-overlayscrollbars":"",h:"100%",id:"gallery-grid",children:s.jsx(UT,{style:XB,data:x.ids,endReached:g,components:YB,scrollerRef:o,itemContent:M,ref:m,rangeChanged:I,overscan:10})}),s.jsx(qe,{onClick:g,isDisabled:!h,isLoading:C,loadingText:e("gallery.loading"),flexShrink:0,children:`${e("accessibility.loadMore")} (${x.ids.length} / ${d})`})]}):S?s.jsx(Ae,{w:"full",h:"full",children:s.jsx(Ut,{label:e("gallery.unableToLoad"),icon:Xb})}):null:s.jsx(P,{w:"full",h:"full",alignItems:"center",justifyContent:"center",children:s.jsx(Ut,{label:e("gallery.loading"),icon:dc})})},eN=u.memo(JB),tN=()=>{const{t:e}=L(),t=u.useRef(null),n=u.useRef(null),o=b(h=>h.gallery.galleryView),r=O(),a=yt(kI),{isOpen:c,onToggle:d}=fn({defaultIsOpen:!0}),f=u.useCallback(()=>{r(Vx("images"))},[r]),m=u.useCallback(()=>{r(Vx("assets"))},[r]);return s.jsxs(wI,{layerStyle:"first",flexDirection:"column",h:"full",w:"full",borderRadius:"base",p:2,children:[a,s.jsxs(Ae,{w:"full",children:[s.jsxs(P,{ref:t,alignItems:"center",justifyContent:"space-between",gap:2,children:[s.jsx(nL,{isOpen:c,onToggle:d}),s.jsx(lL,{})]}),s.jsx(Ae,{children:s.jsx(eL,{isOpen:c})})]}),s.jsxs(P,{ref:n,direction:"column",gap:2,h:"full",w:"full",children:[s.jsx(P,{alignItems:"center",justifyContent:"space-between",gap:2,children:s.jsx(Ja,{index:o==="images"?0:1,variant:"unstyled",size:"sm",w:"full",children:s.jsx(el,{children:s.jsxs(Nt,{w:"full",children:[s.jsx(pn,{as:qe,size:"sm",isChecked:o==="images",onClick:f,w:"full",leftIcon:s.jsx(LD,{size:"16px"}),"data-testid":"images-tab",children:e("parameters.images")}),s.jsx(pn,{as:qe,size:"sm",isChecked:o==="assets",onClick:m,w:"full",leftIcon:s.jsx(S_,{size:"16px"}),"data-testid":"assets-tab",children:e("gallery.assets")})]})})})}),s.jsx(eN,{})]})]})},nN=u.memo(tN),sN=({disclosure:e})=>{const{t}=L(),{clearQueue:n}=Ec();return s.jsxs(sa,{isOpen:e.isOpen,onClose:e.onClose,title:t("queue.clearTooltip"),acceptCallback:n,acceptButtonText:t("queue.clear"),children:[s.jsx(re,{children:t("queue.clearQueueAlertDialog")}),s.jsx("br",{}),s.jsx(re,{children:t("queue.clearQueueAlertDialog2")})]})},Vf=u.memo(sN),GS=({onOpen:e,...t})=>{const{t:n}=L(),{isLoading:o,isDisabled:r}=Ec();return s.jsx(ve,{isDisabled:r,isLoading:o,"aria-label":n("queue.clear"),tooltip:n("queue.clearTooltip"),icon:s.jsx(Xs,{size:"16px"}),colorScheme:"error",onClick:e,"data-testid":n("queue.clear"),...t})},oN=e=>{const{t}=L(),{cancelQueueItem:n,isLoading:o,isDisabled:r}=kg();return s.jsx(ve,{isDisabled:r,isLoading:o,"aria-label":t("queue.cancel"),tooltip:t("queue.cancelTooltip"),icon:s.jsx($n,{size:"16px"}),colorScheme:"error",onClick:n,"data-testid":t("queue.cancel"),...e})},rN=e=>{const t=fg(),n=fn();return s.jsxs(s.Fragment,{children:[t?s.jsx(GS,{...e,onOpen:n.onOpen}):s.jsx(oN,{...e}),s.jsx(Vf,{disclosure:n})]})};function aN(e){return Se({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M848 359.3H627.7L825.8 109c4.1-5.3.4-13-6.3-13H436c-2.8 0-5.5 1.5-6.9 4L170 547.5c-3.1 5.3.7 12 6.9 12h174.4l-89.4 357.6c-1.9 7.8 7.5 13.3 13.3 7.7L853.5 373c5.2-4.9 1.7-13.7-5.5-13.7z"},child:[]}]})(e)}const lN=it(bs,Kp,(e,t)=>yC(e.positivePrompt)?t.prompts.length:1),Hf=u.memo(({prepend:e=!1})=>{const{t}=L(),{isReady:n,reasons:o}=Ig(),r=b(x=>x.dynamicPrompts.isLoading),a=b(lN),c=b(x=>x.generation.iterations),d=b(x=>x.gallery.autoAddBoardId),f=Lf(d),[m,{isLoading:h}]=Jd({fixedCacheKey:"enqueueBatch"}),g=u.useMemo(()=>t(h?"queue.enqueueing":r?"dynamicPrompts.loading":n?e?"queue.queueFront":"queue.queueBack":"queue.notReady"),[h,r,n,e,t]);return s.jsxs(P,{flexDir:"column",gap:1,children:[s.jsx(re,{fontWeight:"semibold",children:g}),s.jsx(re,{children:t("queue.queueCountPrediction",{promptsCount:a,iterations:c,count:Math.min(a*c,1e4)})}),o.length>0&&s.jsxs(s.Fragment,{children:[s.jsx(An,{opacity:.2,borderColor:"base.900"}),s.jsx(Xp,{children:o.map((x,C)=>s.jsx(To,{children:s.jsx(re,{children:x})},`${x}.${C}`))})]}),s.jsx(An,{opacity:.2,borderColor:"base.900"}),s.jsxs(re,{fontStyle:"oblique 10deg",children:[t("parameters.invoke.addingImagesTo")," ",s.jsx(re,{as:"span",fontWeight:"semibold",children:f||t("boards.uncategorized")})]})]})});Hf.displayName="QueueButtonTooltip";const iN=()=>{const{t:e}=L(),{queueFront:t,isLoading:n,isDisabled:o}=Lb();return s.jsx(ve,{"aria-label":e("queue.queueFront"),isDisabled:o,isLoading:n,onClick:t,tooltip:s.jsx(Hf,{prepend:!0}),icon:s.jsx(aN,{}),size:"lg"})},cN=u.memo(iN),uN=it(ni,e=>{var t;return(((t=e.denoiseProgress)==null?void 0:t.percentage)??0)*100}),dN=()=>{const{t:e}=L(),{data:t}=$o(),n=b(a=>a.system.isConnected),o=b(a=>!!a.system.denoiseProgress),r=b(uN);return s.jsx(my,{value:r,"aria-label":e("accessibility.invokeProgressBar"),isIndeterminate:n&&!!(t!=null&&t.queue.in_progress)&&!o,h:2,w:"full",colorScheme:"invokeBlue"})},fN=u.memo(dN),US=u.memo(()=>{const e=b(a=>a.generation.iterations),t=b(a=>a.config.sd.iterations.coarseStep),n=b(a=>a.config.sd.iterations.fineStep),o=O(),r=u.useCallback(a=>{o(II(a))},[o]);return s.jsx(Ke,{feature:"paramIterations",children:s.jsx(Ee,{step:t,fineStep:n,min:1,max:999,onChange:r,value:e,defaultValue:1,pos:"absolute",insetInlineEnd:0,h:"full",ps:0,w:"72px",flexShrink:0,variant:"iterations"})})});US.displayName="QueueIterationsNumberInput";const uv="Invoke",ZS=u.memo(()=>{const{queueBack:e,isLoading:t,isDisabled:n}=Mg(),o=b(r=>r.dynamicPrompts.isLoading);return s.jsxs(P,{pos:"relative",flexGrow:1,minW:"240px",children:[s.jsx(US,{}),s.jsxs(qe,{onClick:e,isLoading:t||o,loadingText:uv,isDisabled:n,rightIcon:s.jsx(D_,{}),tooltip:s.jsx(Hf,{}),variant:"solid",zIndex:1,colorScheme:"invokeYellow",size:"lg",w:"calc(100% - 60px)",flexShrink:0,justifyContent:"space-between",spinnerPlacement:"end",children:[s.jsx("span",{children:uv}),s.jsx(Tn,{})]})]})});ZS.displayName="InvokeQueueBackButton";const qS=()=>{const e=O(),{t}=L(),n=b(m=>m.system.isConnected),{data:o}=$o(),[r,{isLoading:a}]=py({fixedCacheKey:"pauseProcessor"}),c=u.useMemo(()=>!!(o!=null&&o.processor.is_started),[o==null?void 0:o.processor.is_started]),d=u.useCallback(async()=>{if(c)try{await r().unwrap(),e(Ze({title:t("queue.pauseSucceeded"),status:"success"}))}catch{e(Ze({title:t("queue.pauseFailed"),status:"error"}))}},[c,r,e,t]),f=u.useMemo(()=>!n||!c,[n,c]);return{pauseProcessor:d,isLoading:a,isStarted:c,isDisabled:f}},QS=()=>{const e=O(),t=b(m=>m.system.isConnected),{data:n}=$o(),{t:o}=L(),[r,{isLoading:a}]=gy({fixedCacheKey:"resumeProcessor"}),c=u.useMemo(()=>!!(n!=null&&n.processor.is_started),[n==null?void 0:n.processor.is_started]),d=u.useCallback(async()=>{if(!c)try{await r().unwrap(),e(Ze({title:o("queue.resumeSucceeded"),status:"success"}))}catch{e(Ze({title:o("queue.resumeFailed"),status:"error"}))}},[c,r,e,o]),f=u.useMemo(()=>!t||c,[t,c]);return{resumeProcessor:d,isLoading:a,isStarted:c,isDisabled:f}},KS=u.memo(()=>{const{isOpen:e,onOpen:t,onClose:n}=fn(),o=O(),{t:r}=L(),a=fn(),c=cn("pauseQueue").isFeatureEnabled,d=cn("resumeQueue").isFeatureEnabled,{queueSize:f}=$o(void 0,{selectFromResult:k=>({queueSize:k.data?k.data.queue.pending+k.data.queue.in_progress:0})}),{isLoading:m,isDisabled:h}=Ec(),{resumeProcessor:g,isLoading:x,isDisabled:C}=QS(),{pauseProcessor:j,isLoading:S,isDisabled:M}=qS(),I=u.useCallback(()=>{o(zs("queue"))},[o]);return s.jsxs(Ae,{pos:"relative",children:[s.jsx(Vf,{disclosure:a}),s.jsxs(Ic,{isOpen:e,onOpen:t,onClose:n,placement:"bottom-end",children:[s.jsx(Mc,{as:ve,"aria-label":"Queue Actions Menu",icon:s.jsx(w_,{})}),s.jsxs(qr,{children:[s.jsx(ut,{isDestructive:!0,icon:s.jsx(Xs,{size:"16px"}),onClick:a.onOpen,isLoading:m,isDisabled:h,children:r("queue.clearTooltip")}),d&&s.jsx(ut,{icon:s.jsx(ej,{size:"14px"}),onClick:g,isLoading:x,isDisabled:C,children:r("queue.resumeTooltip")}),c&&s.jsx(ut,{icon:s.jsx(Jb,{size:"14px"}),onClick:j,isLoading:S,isDisabled:M,children:r("queue.pauseTooltip")}),s.jsx(Or,{}),s.jsx(ut,{icon:s.jsx($j,{}),onClick:I,children:r("queue.openQueue")})]})]}),f>0&&s.jsx(Ws,{pos:"absolute",insetInlineStart:-3,insetBlockStart:-1.5,colorScheme:"invokeYellow",zIndex:"docked",children:f})]})});KS.displayName="QueueActionsMenuButton";const hN=()=>{const e=cn("prependQueue").isFeatureEnabled;return s.jsxs(P,{w:"full",position:"relative",borderRadius:"base",gap:2,pt:2,flexDir:"column",children:[s.jsxs(Nt,{size:"lg",isAttached:!1,children:[e&&s.jsx(cN,{}),s.jsx(ZS,{}),s.jsx(Tn,{}),s.jsx(KS,{}),s.jsx(rN,{})]}),s.jsx(fN,{})]})},YS=u.memo(hN),{createElement:ei,createContext:mN,createRef:kJ,forwardRef:XS,useCallback:hs,useContext:JS,useEffect:Na,useImperativeHandle:ew,useLayoutEffect:pN,useMemo:gN,useRef:as,useState:oc}=xy,dv=xy.useId,xN=pN,$f=mN(null);$f.displayName="PanelGroupContext";const za=xN,vN=typeof dv=="function"?dv:()=>null;let CN=0;function p0(e=null){const t=vN(),n=as(e||t||null);return n.current===null&&(n.current=""+CN++),e??n.current}function tw({children:e,className:t="",collapsedSize:n,collapsible:o,defaultSize:r,forwardedRef:a,id:c,maxSize:d,minSize:f,onCollapse:m,onExpand:h,onResize:g,order:x,style:C,tagName:j="div",...S}){const M=JS($f);if(M===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:I,expandPanel:k,getPanelSize:D,getPanelStyle:T,groupId:E,isPanelCollapsed:A,reevaluatePanelConstraints:N,registerPanel:W,resizePanel:G,unregisterPanel:z}=M,X=p0(c),B=as({callbacks:{onCollapse:m,onExpand:h,onResize:g},constraints:{collapsedSize:n,collapsible:o,defaultSize:r,maxSize:d,minSize:f},id:X,idIsFromProps:c!==void 0,order:x});as({didLogMissingDefaultSizeWarning:!1}),za(()=>{const{callbacks:V,constraints:H}=B.current,me={...H};B.current.id=X,B.current.idIsFromProps=c!==void 0,B.current.order=x,V.onCollapse=m,V.onExpand=h,V.onResize=g,H.collapsedSize=n,H.collapsible=o,H.defaultSize=r,H.maxSize=d,H.minSize=f,(me.collapsedSize!==H.collapsedSize||me.collapsible!==H.collapsible||me.maxSize!==H.maxSize||me.minSize!==H.minSize)&&N(B.current,me)}),za(()=>{const V=B.current;return W(V),()=>{z(V)}},[x,X,W,z]),ew(a,()=>({collapse:()=>{I(B.current)},expand:()=>{k(B.current)},getId(){return X},getSize(){return D(B.current)},isCollapsed(){return A(B.current)},isExpanded(){return!A(B.current)},resize:V=>{G(B.current,V)}}),[I,k,D,A,X,G]);const Q=T(B.current,r);return ei(j,{...S,children:e,className:t,id:c,style:{...Q,...C},"data-panel":"","data-panel-collapsible":o||void 0,"data-panel-group-id":E,"data-panel-id":X,"data-panel-size":parseFloat(""+Q.flexGrow).toFixed(1)})}const Ur=XS((e,t)=>ei(tw,{...e,forwardedRef:t}));tw.displayName="Panel";Ur.displayName="forwardRef(Panel)";let Bp=null,Ta=null;function yN(e,t){if(t){const n=(t&aw)!==0,o=(t&lw)!==0,r=(t&iw)!==0,a=(t&cw)!==0;if(n)return r?"se-resize":a?"ne-resize":"e-resize";if(o)return r?"sw-resize":a?"nw-resize":"w-resize";if(r)return"s-resize";if(a)return"n-resize"}switch(e){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function bN(){Ta!==null&&(document.head.removeChild(Ta),Bp=null,Ta=null)}function Vm(e,t){const n=yN(e,t);Bp!==n&&(Bp=n,Ta===null&&(Ta=document.createElement("style"),document.head.appendChild(Ta)),Ta.innerHTML=`*{cursor: ${n}!important;}`)}function nw(e){return e.type==="keydown"}function sw(e){return e.type.startsWith("mouse")}function ow(e){return e.type.startsWith("touch")}function Wf(e){if(sw(e))return{x:e.clientX,y:e.clientY};if(ow(e)){const t=e.touches[0];if(t&&t.clientX&&t.clientY)return{x:t.clientX,y:t.clientY}}return{x:1/0,y:1/0}}function jN(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function SN(e,t,n){return n?e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y:e.x<=t.x+t.width&&e.x+e.width>=t.x&&e.y<=t.y+t.height&&e.y+e.height>=t.y}function wN(e,t){if(e===t)throw new Error("Cannot compare node with itself");const n={a:mv(e),b:mv(t)};let o;for(;n.a.at(-1)===n.b.at(-1);)e=n.a.pop(),t=n.b.pop(),o=e;ht(o,"Stacking order can only be calculated for elements with a common ancestor");const r={a:hv(fv(n.a)),b:hv(fv(n.b))};if(r.a===r.b){const a=o.childNodes,c={a:n.a.at(-1),b:n.b.at(-1)};let d=a.length;for(;d--;){const f=a[d];if(f===c.a)return 1;if(f===c.b)return-1}}return Math.sign(r.a-r.b)}const kN=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function IN(e){var t;const n=getComputedStyle((t=rw(e))!==null&&t!==void 0?t:e).display;return n==="flex"||n==="inline-flex"}function MN(e){const t=getComputedStyle(e);return!!(t.position==="fixed"||t.zIndex!=="auto"&&(t.position!=="static"||IN(e))||+t.opacity<1||"transform"in t&&t.transform!=="none"||"webkitTransform"in t&&t.webkitTransform!=="none"||"mixBlendMode"in t&&t.mixBlendMode!=="normal"||"filter"in t&&t.filter!=="none"||"webkitFilter"in t&&t.webkitFilter!=="none"||"isolation"in t&&t.isolation==="isolate"||kN.test(t.willChange)||t.webkitOverflowScrolling==="touch")}function fv(e){let t=e.length;for(;t--;){const n=e[t];if(ht(n,"Missing node"),MN(n))return n}return null}function hv(e){return e&&Number(getComputedStyle(e).zIndex)||0}function mv(e){const t=[];for(;e;)t.push(e),e=rw(e);return t}function rw(e){const{parentNode:t}=e;return t&&t instanceof ShadowRoot?t.host:t}const aw=1,lw=2,iw=4,cw=8,AN=jN()==="coarse";let ea=[],Gf=!1,Nr=new Map,Uf=new Map;const Cc=new Set;function PN(e,t,n,o,r){var a;const{ownerDocument:c}=t,d={direction:n,element:t,hitAreaMargins:o,setResizeHandlerState:r},f=(a=Nr.get(c))!==null&&a!==void 0?a:0;return Nr.set(c,f+1),Cc.add(d),Wd(),function(){var h;Uf.delete(e),Cc.delete(d);const g=(h=Nr.get(c))!==null&&h!==void 0?h:1;Nr.set(c,g-1),Wd(),g===1&&Nr.delete(c)}}function td(e){const{target:t}=e,{x:n,y:o}=Wf(e);Gf=!0,g0({target:t,x:n,y:o}),Wd(),ea.length>0&&(x0("down",e),e.preventDefault())}function Lr(e){const{x:t,y:n}=Wf(e);if(!Gf){const{target:o}=e;g0({target:o,x:t,y:n})}x0("move",e),uw(),ea.length>0&&e.preventDefault()}function Tr(e){const{target:t}=e,{x:n,y:o}=Wf(e);Uf.clear(),Gf=!1,ea.length>0&&e.preventDefault(),x0("up",e),g0({target:t,x:n,y:o}),uw(),Wd()}function g0({target:e,x:t,y:n}){ea.splice(0);let o=null;e instanceof HTMLElement&&(o=e),Cc.forEach(r=>{const{element:a,hitAreaMargins:c}=r,d=a.getBoundingClientRect(),{bottom:f,left:m,right:h,top:g}=d,x=AN?c.coarse:c.fine;if(t>=m-x&&t<=h+x&&n>=g-x&&n<=f+x){if(o!==null&&a!==o&&!a.contains(o)&&!o.contains(a)&&wN(o,a)>0){let j=o,S=!1;for(;j&&!j.contains(a);){if(SN(j.getBoundingClientRect(),d,!0)){S=!0;break}j=j.parentElement}if(S)return}ea.push(r)}})}function Hm(e,t){Uf.set(e,t)}function uw(){let e=!1,t=!1;ea.forEach(o=>{const{direction:r}=o;r==="horizontal"?e=!0:t=!0});let n=0;Uf.forEach(o=>{n|=o}),e&&t?Vm("intersection",n):e?Vm("horizontal",n):t?Vm("vertical",n):bN()}function Wd(){Nr.forEach((e,t)=>{const{body:n}=t;n.removeEventListener("contextmenu",Tr),n.removeEventListener("mousedown",td),n.removeEventListener("mouseleave",Lr),n.removeEventListener("mousemove",Lr),n.removeEventListener("touchmove",Lr),n.removeEventListener("touchstart",td)}),window.removeEventListener("mouseup",Tr),window.removeEventListener("touchcancel",Tr),window.removeEventListener("touchend",Tr),Cc.size>0&&(Gf?(ea.length>0&&Nr.forEach((e,t)=>{const{body:n}=t;e>0&&(n.addEventListener("contextmenu",Tr),n.addEventListener("mouseleave",Lr),n.addEventListener("mousemove",Lr),n.addEventListener("touchmove",Lr,{passive:!1}))}),window.addEventListener("mouseup",Tr),window.addEventListener("touchcancel",Tr),window.addEventListener("touchend",Tr)):Nr.forEach((e,t)=>{const{body:n}=t;e>0&&(n.addEventListener("mousedown",td),n.addEventListener("mousemove",Lr),n.addEventListener("touchmove",Lr,{passive:!1}),n.addEventListener("touchstart",td))}))}function x0(e,t){Cc.forEach(n=>{const{setResizeHandlerState:o}=n,r=ea.includes(n);o(e,r,t)})}function ht(e,t){if(!e)throw console.error(t),Error(t)}const v0=10;function Wa(e,t,n=v0){return e.toFixed(n)===t.toFixed(n)?0:e>t?1:-1}function cr(e,t,n=v0){return Wa(e,t,n)===0}function gs(e,t,n){return Wa(e,t,n)===0}function DN(e,t,n){if(e.length!==t.length)return!1;for(let o=0;o<e.length;o++){const r=e[o],a=t[o];if(!gs(r,a,n))return!1}return!0}function Ll({panelConstraints:e,panelIndex:t,size:n}){const o=e[t];ht(o!=null,`Panel constraints not found for index ${t}`);let{collapsedSize:r=0,collapsible:a,maxSize:c=100,minSize:d=0}=o;if(Wa(n,d)<0)if(a){const f=(r+d)/2;Wa(n,f)<0?n=r:n=d}else n=d;return n=Math.min(c,n),n=parseFloat(n.toFixed(v0)),n}function Ki({delta:e,initialLayout:t,panelConstraints:n,pivotIndices:o,prevLayout:r,trigger:a}){if(gs(e,0))return t;const c=[...t],[d,f]=o;ht(d!=null,"Invalid first pivot index"),ht(f!=null,"Invalid second pivot index");let m=0;if(a==="keyboard"){{const g=e<0?f:d,x=n[g];ht(x,`Panel constraints not found for index ${g}`);const{collapsedSize:C=0,collapsible:j,minSize:S=0}=x;if(j){const M=t[g];if(ht(M!=null,`Previous layout not found for panel index ${g}`),gs(M,C)){const I=S-M;Wa(I,Math.abs(e))>0&&(e=e<0?0-I:I)}}}{const g=e<0?d:f,x=n[g];ht(x,`No panel constraints found for index ${g}`);const{collapsedSize:C=0,collapsible:j,minSize:S=0}=x;if(j){const M=t[g];if(ht(M!=null,`Previous layout not found for panel index ${g}`),gs(M,S)){const I=M-C;Wa(I,Math.abs(e))>0&&(e=e<0?0-I:I)}}}}{const g=e<0?1:-1;let x=e<0?f:d,C=0;for(;;){const S=t[x];ht(S!=null,`Previous layout not found for panel index ${x}`);const I=Ll({panelConstraints:n,panelIndex:x,size:100})-S;if(C+=I,x+=g,x<0||x>=n.length)break}const j=Math.min(Math.abs(e),Math.abs(C));e=e<0?0-j:j}{let x=e<0?d:f;for(;x>=0&&x<n.length;){const C=Math.abs(e)-Math.abs(m),j=t[x];ht(j!=null,`Previous layout not found for panel index ${x}`);const S=j-C,M=Ll({panelConstraints:n,panelIndex:x,size:S});if(!gs(j,M)&&(m+=j-M,c[x]=M,m.toFixed(3).localeCompare(Math.abs(e).toFixed(3),void 0,{numeric:!0})>=0))break;e<0?x--:x++}}if(DN(r,c))return r;{const g=e<0?f:d,x=t[g];ht(x!=null,`Previous layout not found for panel index ${g}`);const C=x+m,j=Ll({panelConstraints:n,panelIndex:g,size:C});if(c[g]=j,!gs(j,C)){let S=C-j,I=e<0?f:d;for(;I>=0&&I<n.length;){const k=c[I];ht(k!=null,`Previous layout not found for panel index ${I}`);const D=k+S,T=Ll({panelConstraints:n,panelIndex:I,size:D});if(gs(k,T)||(S-=T-k,c[I]=T),gs(S,0))break;e>0?I--:I++}}}const h=c.reduce((g,x)=>x+g,0);return gs(h,100)?c:r}function EN({layout:e,panelsArray:t,pivotIndices:n}){let o=0,r=100,a=0,c=0;const d=n[0];ht(d!=null,"No pivot index found"),t.forEach((g,x)=>{const{constraints:C}=g,{maxSize:j=100,minSize:S=0}=C;x===d?(o=S,r=j):(a+=S,c+=j)});const f=Math.min(r,100-a),m=Math.max(o,100-c),h=e[d];return{valueMax:f,valueMin:m,valueNow:h}}function Ga(e,t=document){return Array.from(t.querySelectorAll(`[data-panel-resize-handle-id][data-panel-group-id="${e}"]`))}function dw(e,t,n=document){const r=Ga(e,n).findIndex(a=>a.getAttribute("data-panel-resize-handle-id")===t);return r??null}function fw(e,t,n){const o=dw(e,t,n);return o!=null?[o,o+1]:[-1,-1]}function Zf(e,t=document){var n;if(t instanceof HTMLElement&&(t==null||(n=t.dataset)===null||n===void 0?void 0:n.panelGroupId)==e)return t;const o=t.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return o||null}function qf(e,t=document){const n=t.querySelector(`[data-panel-resize-handle-id="${e}"]`);return n||null}function _N(e,t,n,o=document){var r,a,c,d;const f=qf(t,o),m=Ga(e,o),h=f?m.indexOf(f):-1,g=(r=(a=n[h])===null||a===void 0?void 0:a.id)!==null&&r!==void 0?r:null,x=(c=(d=n[h+1])===null||d===void 0?void 0:d.id)!==null&&c!==void 0?c:null;return[g,x]}function LN({committedValuesRef:e,eagerValuesRef:t,groupId:n,layout:o,panelDataArray:r,panelGroupElement:a,setLayout:c}){as({didWarnAboutMissingResizeHandle:!1}),za(()=>{if(!a)return;const d=Ga(n,a);for(let f=0;f<r.length-1;f++){const{valueMax:m,valueMin:h,valueNow:g}=EN({layout:o,panelsArray:r,pivotIndices:[f,f+1]}),x=d[f];if(x!=null){const C=r[f];ht(C,`No panel data found for index "${f}"`),x.setAttribute("aria-controls",C.id),x.setAttribute("aria-valuemax",""+Math.round(m)),x.setAttribute("aria-valuemin",""+Math.round(h)),x.setAttribute("aria-valuenow",g!=null?""+Math.round(g):"")}}return()=>{d.forEach((f,m)=>{f.removeAttribute("aria-controls"),f.removeAttribute("aria-valuemax"),f.removeAttribute("aria-valuemin"),f.removeAttribute("aria-valuenow")})}},[n,o,r,a]),Na(()=>{if(!a)return;const d=t.current;ht(d,"Eager values not found");const{panelDataArray:f}=d,m=Zf(n,a);ht(m!=null,`No group found for id "${n}"`);const h=Ga(n,a);ht(h,`No resize handles found for group id "${n}"`);const g=h.map(x=>{const C=x.getAttribute("data-panel-resize-handle-id");ht(C,"Resize handle element has no handle id attribute");const[j,S]=_N(n,C,f,a);if(j==null||S==null)return()=>{};const M=I=>{if(!I.defaultPrevented)switch(I.key){case"Enter":{I.preventDefault();const k=f.findIndex(D=>D.id===j);if(k>=0){const D=f[k];ht(D,`No panel data found for index ${k}`);const T=o[k],{collapsedSize:E=0,collapsible:A,minSize:N=0}=D.constraints;if(T!=null&&A){const W=Ki({delta:gs(T,E)?N-E:E-T,initialLayout:o,panelConstraints:f.map(G=>G.constraints),pivotIndices:fw(n,C,a),prevLayout:o,trigger:"keyboard"});o!==W&&c(W)}}break}}};return x.addEventListener("keydown",M),()=>{x.removeEventListener("keydown",M)}});return()=>{g.forEach(x=>x())}},[a,e,t,n,o,r,c])}function pv(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function hw(e,t){const n=e==="horizontal",{x:o,y:r}=Wf(t);return n?o:r}function TN(e,t,n,o,r){const a=n==="horizontal",c=qf(t,r);ht(c,`No resize handle element found for id "${t}"`);const d=c.getAttribute("data-panel-group-id");ht(d,"Resize handle element has no group id attribute");let{initialCursorPosition:f}=o;const m=hw(n,e),h=Zf(d,r);ht(h,`No group element found for id "${d}"`);const g=h.getBoundingClientRect(),x=a?g.width:g.height;return(m-f)/x*100}function RN(e,t,n,o,r,a){if(nw(e)){const c=n==="horizontal";let d=0;e.shiftKey?d=100:r!=null?d=r:d=10;let f=0;switch(e.key){case"ArrowDown":f=c?0:d;break;case"ArrowLeft":f=c?-d:0;break;case"ArrowRight":f=c?d:0;break;case"ArrowUp":f=c?0:-d;break;case"End":f=100;break;case"Home":f=-100;break}return f}else return o==null?0:TN(e,t,n,o,a)}function BN({panelDataArray:e}){const t=Array(e.length),n=e.map(a=>a.constraints);let o=0,r=100;for(let a=0;a<e.length;a++){const c=n[a];ht(c,`Panel constraints not found for index ${a}`);const{defaultSize:d}=c;d!=null&&(o++,t[a]=d,r-=d)}for(let a=0;a<e.length;a++){const c=n[a];ht(c,`Panel constraints not found for index ${a}`);const{defaultSize:d}=c;if(d!=null)continue;const f=e.length-o,m=r/f;o++,t[a]=m,r-=m}return t}function Ml(e,t,n){t.forEach((o,r)=>{const a=e[r];ht(a,`Panel data not found for index ${r}`);const{callbacks:c,constraints:d,id:f}=a,{collapsedSize:m=0,collapsible:h}=d,g=n[f];if(g==null||o!==g){n[f]=o;const{onCollapse:x,onExpand:C,onResize:j}=c;j&&j(o,g),h&&(x||C)&&(C&&(g==null||cr(g,m))&&!cr(o,m)&&C(),x&&(g==null||!cr(g,m))&&cr(o,m)&&x())}})}function nd(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function NN({defaultSize:e,dragState:t,layout:n,panelData:o,panelIndex:r,precision:a=3}){const c=n[r];let d;return c==null?d=e!=null?e.toFixed(a):"1":o.length===1?d="1":d=c.toFixed(a),{flexBasis:0,flexGrow:d,flexShrink:1,overflow:"hidden",pointerEvents:t!==null?"none":void 0}}function zN(e,t=10){let n=null;return(...r)=>{n!==null&&clearTimeout(n),n=setTimeout(()=>{e(...r)},t)}}function gv(e){try{if(typeof localStorage<"u")e.getItem=t=>localStorage.getItem(t),e.setItem=(t,n)=>{localStorage.setItem(t,n)};else throw new Error("localStorage not supported in this environment")}catch(t){console.error(t),e.getItem=()=>null,e.setItem=()=>{}}}function mw(e){return`react-resizable-panels:${e}`}function pw(e){return e.map(t=>{const{constraints:n,id:o,idIsFromProps:r,order:a}=t;return r?o:a?`${a}:${JSON.stringify(n)}`:JSON.stringify(n)}).sort((t,n)=>t.localeCompare(n)).join(",")}function gw(e,t){try{const n=mw(e),o=t.getItem(n);if(o){const r=JSON.parse(o);if(typeof r=="object"&&r!=null)return r}}catch{}return null}function ON(e,t,n){var o,r;const a=(o=gw(e,n))!==null&&o!==void 0?o:{},c=pw(t);return(r=a[c])!==null&&r!==void 0?r:null}function FN(e,t,n,o,r){var a;const c=mw(e),d=pw(t),f=(a=gw(e,r))!==null&&a!==void 0?a:{};f[d]={expandToSizes:Object.fromEntries(n.entries()),layout:o};try{r.setItem(c,JSON.stringify(f))}catch(m){console.error(m)}}function xv({layout:e,panelConstraints:t}){const n=[...e],o=n.reduce((a,c)=>a+c,0);if(n.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${n.map(a=>`${a}%`).join(", ")}`);if(!gs(o,100))for(let a=0;a<t.length;a++){const c=n[a];ht(c!=null,`No layout data found for index ${a}`);const d=100/o*c;n[a]=d}let r=0;for(let a=0;a<t.length;a++){const c=n[a];ht(c!=null,`No layout data found for index ${a}`);const d=Ll({panelConstraints:t,panelIndex:a,size:c});c!=d&&(r+=c-d,n[a]=d)}if(!gs(r,0))for(let a=0;a<t.length;a++){const c=n[a];ht(c!=null,`No layout data found for index ${a}`);const d=c+r,f=Ll({panelConstraints:t,panelIndex:a,size:d});if(c!==f&&(r-=f-c,n[a]=f,gs(r,0)))break}return n}const VN=100,Yi={getItem:e=>(gv(Yi),Yi.getItem(e)),setItem:(e,t)=>{gv(Yi),Yi.setItem(e,t)}},vv={};function xw({autoSaveId:e=null,children:t,className:n="",direction:o,forwardedRef:r,id:a=null,onLayout:c=null,keyboardResizeBy:d=null,storage:f=Yi,style:m,tagName:h="div",...g}){const x=p0(a),C=as(null),[j,S]=oc(null),[M,I]=oc([]),k=as({}),D=as(new Map),T=as(0),E=as({autoSaveId:e,direction:o,dragState:j,id:x,keyboardResizeBy:d,onLayout:c,storage:f}),A=as({layout:M,panelDataArray:[],panelDataArrayChanged:!1});as({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),ew(r,()=>({getId:()=>E.current.id,getLayout:()=>{const{layout:ce}=A.current;return ce},setLayout:ce=>{const{onLayout:ue}=E.current,{layout:je,panelDataArray:be}=A.current,ee=xv({layout:ce,panelConstraints:be.map(J=>J.constraints)});pv(je,ee)||(I(ee),A.current.layout=ee,ue&&ue(ee),Ml(be,ee,k.current))}}),[]),za(()=>{E.current.autoSaveId=e,E.current.direction=o,E.current.dragState=j,E.current.id=x,E.current.onLayout=c,E.current.storage=f}),LN({committedValuesRef:E,eagerValuesRef:A,groupId:x,layout:M,panelDataArray:A.current.panelDataArray,setLayout:I,panelGroupElement:C.current}),Na(()=>{const{panelDataArray:ce}=A.current;if(e){if(M.length===0||M.length!==ce.length)return;let ue=vv[e];ue==null&&(ue=zN(FN,VN),vv[e]=ue);const je=[...ce],be=new Map(D.current);ue(e,je,be,M,f)}},[e,M,f]),Na(()=>{});const N=hs(ce=>{const{onLayout:ue}=E.current,{layout:je,panelDataArray:be}=A.current;if(ce.constraints.collapsible){const ee=be.map(le=>le.constraints),{collapsedSize:J=0,panelSize:F,pivotIndices:oe}=ka(be,ce,je);if(ht(F!=null,`Panel size not found for panel "${ce.id}"`),!cr(F,J)){D.current.set(ce.id,F);const fe=Pl(be,ce)===be.length-1?F-J:J-F,he=Ki({delta:fe,initialLayout:je,panelConstraints:ee,pivotIndices:oe,prevLayout:je,trigger:"imperative-api"});nd(je,he)||(I(he),A.current.layout=he,ue&&ue(he),Ml(be,he,k.current))}}},[]),W=hs(ce=>{const{onLayout:ue}=E.current,{layout:je,panelDataArray:be}=A.current;if(ce.constraints.collapsible){const ee=be.map(fe=>fe.constraints),{collapsedSize:J=0,panelSize:F=0,minSize:oe=0,pivotIndices:le}=ka(be,ce,je);if(cr(F,J)){const fe=D.current.get(ce.id),he=fe!=null&&fe>=oe?fe:oe,ze=Pl(be,ce)===be.length-1?F-he:he-F,$e=Ki({delta:ze,initialLayout:je,panelConstraints:ee,pivotIndices:le,prevLayout:je,trigger:"imperative-api"});nd(je,$e)||(I($e),A.current.layout=$e,ue&&ue($e),Ml(be,$e,k.current))}}},[]),G=hs(ce=>{const{layout:ue,panelDataArray:je}=A.current,{panelSize:be}=ka(je,ce,ue);return ht(be!=null,`Panel size not found for panel "${ce.id}"`),be},[]),z=hs((ce,ue)=>{const{panelDataArray:je}=A.current,be=Pl(je,ce);return NN({defaultSize:ue,dragState:j,layout:M,panelData:je,panelIndex:be})},[j,M]),X=hs(ce=>{const{layout:ue,panelDataArray:je}=A.current,{collapsedSize:be=0,collapsible:ee,panelSize:J}=ka(je,ce,ue);return ht(J!=null,`Panel size not found for panel "${ce.id}"`),ee===!0&&cr(J,be)},[]),B=hs(ce=>{const{layout:ue,panelDataArray:je}=A.current,{collapsedSize:be=0,collapsible:ee,panelSize:J}=ka(je,ce,ue);return ht(J!=null,`Panel size not found for panel "${ce.id}"`),!ee||Wa(J,be)>0},[]),Q=hs(ce=>{const{panelDataArray:ue}=A.current;ue.push(ce),ue.sort((je,be)=>{const ee=je.order,J=be.order;return ee==null&&J==null?0:ee==null?-1:J==null?1:ee-J}),A.current.panelDataArrayChanged=!0},[]);za(()=>{if(A.current.panelDataArrayChanged){A.current.panelDataArrayChanged=!1;const{autoSaveId:ce,onLayout:ue,storage:je}=E.current,{layout:be,panelDataArray:ee}=A.current;let J=null;if(ce){const oe=ON(ce,ee,je);oe&&(D.current=new Map(Object.entries(oe.expandToSizes)),J=oe.layout)}J==null&&(J=BN({panelDataArray:ee}));const F=xv({layout:J,panelConstraints:ee.map(oe=>oe.constraints)});pv(be,F)||(I(F),A.current.layout=F,ue&&ue(F),Ml(ee,F,k.current))}}),za(()=>{const ce=A.current;return()=>{ce.layout=[]}},[]);const V=hs(ce=>function(je){je.preventDefault();const be=C.current;if(!be)return()=>null;const{direction:ee,dragState:J,id:F,keyboardResizeBy:oe,onLayout:le}=E.current,{layout:fe,panelDataArray:he}=A.current,{initialLayout:ke}=J??{},ze=fw(F,ce,be);let $e=RN(je,ce,ee,J,oe,be);if($e===0)return;const Je=ee==="horizontal";document.dir==="rtl"&&Je&&($e=-$e);const gt=he.map(ne=>ne.constraints),R=Ki({delta:$e,initialLayout:ke??fe,panelConstraints:gt,pivotIndices:ze,prevLayout:fe,trigger:nw(je)?"keyboard":"mouse-or-touch"}),Z=!nd(fe,R);(sw(je)||ow(je))&&T.current!=$e&&(T.current=$e,Z?Hm(ce,0):Je?Hm(ce,$e<0?aw:lw):Hm(ce,$e<0?iw:cw)),Z&&(I(R),A.current.layout=R,le&&le(R),Ml(he,R,k.current))},[]),H=hs((ce,ue)=>{const{onLayout:je}=E.current,{layout:be,panelDataArray:ee}=A.current,J=ee.map(ke=>ke.constraints),{panelSize:F,pivotIndices:oe}=ka(ee,ce,be);ht(F!=null,`Panel size not found for panel "${ce.id}"`);const fe=Pl(ee,ce)===ee.length-1?F-ue:ue-F,he=Ki({delta:fe,initialLayout:be,panelConstraints:J,pivotIndices:oe,prevLayout:be,trigger:"imperative-api"});nd(be,he)||(I(he),A.current.layout=he,je&&je(he),Ml(ee,he,k.current))},[]),me=hs((ce,ue)=>{const{layout:je,panelDataArray:be}=A.current,{collapsedSize:ee=0,collapsible:J}=ue,{collapsedSize:F=0,collapsible:oe,maxSize:le=100,minSize:fe=0}=ce.constraints,{panelSize:he}=ka(be,ce,je);he!=null&&(J&&oe&&cr(he,ee)?cr(ee,F)||H(ce,F):he<fe?H(ce,fe):he>le&&H(ce,le))},[H]),Ie=hs((ce,ue)=>{const{direction:je}=E.current,{layout:be}=A.current;if(!C.current)return;const ee=qf(ce,C.current);ht(ee,`Drag handle element not found for id "${ce}"`);const J=hw(je,ue);S({dragHandleId:ce,dragHandleRect:ee.getBoundingClientRect(),initialCursorPosition:J,initialLayout:be})},[]),ye=hs(()=>{S(null)},[]),de=hs(ce=>{const{panelDataArray:ue}=A.current,je=Pl(ue,ce);je>=0&&(ue.splice(je,1),delete k.current[ce.id],A.current.panelDataArrayChanged=!0)},[]),He=gN(()=>({collapsePanel:N,direction:o,dragState:j,expandPanel:W,getPanelSize:G,getPanelStyle:z,groupId:x,isPanelCollapsed:X,isPanelExpanded:B,reevaluatePanelConstraints:me,registerPanel:Q,registerResizeHandle:V,resizePanel:H,startDragging:Ie,stopDragging:ye,unregisterPanel:de,panelGroupElement:C.current}),[N,j,o,W,G,z,x,X,B,me,Q,V,H,Ie,ye,de]),Be={display:"flex",flexDirection:o==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return ei($f.Provider,{value:He},ei(h,{...g,children:t,className:n,id:a,ref:C,style:{...Be,...m},"data-panel-group":"","data-panel-group-direction":o,"data-panel-group-id":x}))}const Qf=XS((e,t)=>ei(xw,{...e,forwardedRef:t}));xw.displayName="PanelGroup";Qf.displayName="forwardRef(PanelGroup)";function Pl(e,t){return e.findIndex(n=>n===t||n.id===t.id)}function ka(e,t,n){const o=Pl(e,t),a=o===e.length-1?[o-1,o]:[o,o+1],c=n[o];return{...t.constraints,panelSize:c,pivotIndices:a}}function HN({disabled:e,handleId:t,resizeHandler:n,panelGroupElement:o}){Na(()=>{if(e||n==null||o==null)return;const r=qf(t,o);if(r==null)return;const a=c=>{if(!c.defaultPrevented)switch(c.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{c.preventDefault(),n(c);break}case"F6":{c.preventDefault();const d=r.getAttribute("data-panel-group-id");ht(d,`No group element found for id "${d}"`);const f=Ga(d,o),m=dw(d,t,o);ht(m!==null,`No resize element found for id "${t}"`);const h=c.shiftKey?m>0?m-1:f.length-1:m+1<f.length?m+1:0;f[h].focus();break}}};return r.addEventListener("keydown",a),()=>{r.removeEventListener("keydown",a)}},[o,e,t,n])}function vw({children:e=null,className:t="",disabled:n=!1,hitAreaMargins:o,id:r,onDragging:a,style:c={},tabIndex:d=0,tagName:f="div",...m}){const h=as(null),g=as({onDragging:a});Na(()=>{g.current.onDragging=a});const x=JS($f);if(x===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:C,groupId:j,registerResizeHandle:S,startDragging:M,stopDragging:I,panelGroupElement:k}=x,D=p0(r),[T,E]=oc("inactive"),[A,N]=oc(!1),[W,G]=oc(null),z=as({state:T});return za(()=>{z.current.state=T}),Na(()=>{if(n)G(null);else{const B=S(D);G(()=>B)}},[n,D,S]),Na(()=>{var B,Q;if(n||W==null)return;const V=h.current;ht(V,"Element ref not attached");const H=(me,Ie,ye)=>{if(Ie)switch(me){case"down":{E("drag"),M(D,ye);const{onDragging:de}=g.current;de&&de(!0);break}case"move":{const{state:de}=z.current;de!=="drag"&&E("hover"),W(ye);break}case"up":{E("hover"),I();const{onDragging:de}=g.current;de&&de(!1);break}}else E("inactive")};return PN(D,V,C,{coarse:(B=o==null?void 0:o.coarse)!==null&&B!==void 0?B:15,fine:(Q=o==null?void 0:o.fine)!==null&&Q!==void 0?Q:5},H)},[C,n,o,S,D,W,M,I]),HN({disabled:n,handleId:D,resizeHandler:W,panelGroupElement:k}),ei(f,{...m,children:e,className:t,id:r,onBlur:()=>N(!1),onFocus:()=>N(!0),ref:h,role:"separator",style:{...{touchAction:"none",userSelect:"none"},...c},tabIndex:d,"data-panel-group-direction":C,"data-panel-group-id":j,"data-resize-handle":"","data-resize-handle-active":T==="drag"?"pointer":A?"keyboard":void 0,"data-resize-handle-state":T,"data-panel-resize-handle-enabled":!n,"data-panel-resize-handle-id":D})}vw.displayName="PanelResizeHandle";const $N=hg(vw),WN=e=>{const{orientation:t,...n}=e;return s.jsx($N,{...n,children:s.jsxs(P,{sx:GN,"data-orientation":t,children:[s.jsx(Ae,{className:"resize-handle-inner","data-orientation":t}),s.jsx(Ae,{className:"resize-handle-drag-handle","data-orientation":t})]})})},Gd=u.memo(WN),GN={display:"flex",pos:"relative",'&[data-orientation="horizontal"]':{w:"full",h:5},'&[data-orientation="vertical"]':{w:5,h:"full"},alignItems:"center",justifyContent:"center",div:{bg:"base.800"},_hover:{div:{bg:"base.700"}},_active:{div:{bg:"base.600"}},transitionProperty:"common",transitionDuration:"normal",".resize-handle-inner":{'&[data-orientation="horizontal"]':{w:"calc(100% - 1rem)",h:"2px"},'&[data-orientation="vertical"]':{w:"2px",h:"calc(100% - 1rem)"},borderRadius:"base",transitionProperty:"inherit",transitionDuration:"inherit"},".resize-handle-drag-handle":{pos:"absolute",borderRadius:"1px",transitionProperty:"inherit",transitionDuration:"inherit",'&[data-orientation="horizontal"]':{w:"30px",h:"6px",insetInlineStart:"50%",transform:"translate(-50%, 0)"},'&[data-orientation="vertical"]':{w:"6px",h:"30px",insetBlockStart:"50%",transform:"translate(0, -50%)"}}},C0=()=>{const e=O(),t=b(r=>r.ui.panels),n=u.useCallback(r=>t[r]??"",[t]),o=u.useCallback((r,a)=>{e(MI({name:r,value:a}))},[e]);return{getItem:n,setItem:o}},Cw=u.createContext(null);var UN=/d{1,4}|D{3,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|W{1,2}|[LlopSZN]|"[^"]*"|'[^']*'/g,ZN=/\b(?:[A-Z]{1,3}[A-Z][TC])(?:[-+]\d{4})?|((?:Australian )?(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time)\b/g,qN=/[^-+\dA-Z]/g;function sd(e,t,n,o){if(arguments.length===1&&typeof e=="string"&&!/\d/.test(e)&&(t=e,e=void 0),e=e||e===0?e:new Date,e instanceof Date||(e=new Date(e)),isNaN(e))throw TypeError("Invalid date");t=String(Tl[t]||t||Tl.default);var r=t.slice(0,4);(r==="UTC:"||r==="GMT:")&&(t=t.slice(4),n=!0,r==="GMT:"&&(o=!0));var a=function(){return n?"getUTC":"get"},c=function(){return e[a()+"Date"]()},d=function(){return e[a()+"Day"]()},f=function(){return e[a()+"Month"]()},m=function(){return e[a()+"FullYear"]()},h=function(){return e[a()+"Hours"]()},g=function(){return e[a()+"Minutes"]()},x=function(){return e[a()+"Seconds"]()},C=function(){return e[a()+"Milliseconds"]()},j=function(){return n?0:e.getTimezoneOffset()},S=function(){return QN(e)},M=function(){return KN(e)},I={d:function(){return c()},dd:function(){return ms(c())},ddd:function(){return os.dayNames[d()]},DDD:function(){return Cv({y:m(),m:f(),d:c(),_:a(),dayName:os.dayNames[d()],short:!0})},dddd:function(){return os.dayNames[d()+7]},DDDD:function(){return Cv({y:m(),m:f(),d:c(),_:a(),dayName:os.dayNames[d()+7]})},m:function(){return f()+1},mm:function(){return ms(f()+1)},mmm:function(){return os.monthNames[f()]},mmmm:function(){return os.monthNames[f()+12]},yy:function(){return String(m()).slice(2)},yyyy:function(){return ms(m(),4)},h:function(){return h()%12||12},hh:function(){return ms(h()%12||12)},H:function(){return h()},HH:function(){return ms(h())},M:function(){return g()},MM:function(){return ms(g())},s:function(){return x()},ss:function(){return ms(x())},l:function(){return ms(C(),3)},L:function(){return ms(Math.floor(C()/10))},t:function(){return h()<12?os.timeNames[0]:os.timeNames[1]},tt:function(){return h()<12?os.timeNames[2]:os.timeNames[3]},T:function(){return h()<12?os.timeNames[4]:os.timeNames[5]},TT:function(){return h()<12?os.timeNames[6]:os.timeNames[7]},Z:function(){return o?"GMT":n?"UTC":YN(e)},o:function(){return(j()>0?"-":"+")+ms(Math.floor(Math.abs(j())/60)*100+Math.abs(j())%60,4)},p:function(){return(j()>0?"-":"+")+ms(Math.floor(Math.abs(j())/60),2)+":"+ms(Math.floor(Math.abs(j())%60),2)},S:function(){return["th","st","nd","rd"][c()%10>3?0:(c()%100-c()%10!=10)*c()%10]},W:function(){return S()},WW:function(){return ms(S())},N:function(){return M()}};return t.replace(UN,function(k){return k in I?I[k]():k.slice(1,k.length-1)})}var Tl={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",paddedShortDate:"mm/dd/yyyy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},os={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},ms=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return String(t).padStart(n,"0")},Cv=function(t){var n=t.y,o=t.m,r=t.d,a=t._,c=t.dayName,d=t.short,f=d===void 0?!1:d,m=new Date,h=new Date;h.setDate(h[a+"Date"]()-1);var g=new Date;g.setDate(g[a+"Date"]()+1);var x=function(){return m[a+"Date"]()},C=function(){return m[a+"Month"]()},j=function(){return m[a+"FullYear"]()},S=function(){return h[a+"Date"]()},M=function(){return h[a+"Month"]()},I=function(){return h[a+"FullYear"]()},k=function(){return g[a+"Date"]()},D=function(){return g[a+"Month"]()},T=function(){return g[a+"FullYear"]()};return j()===n&&C()===o&&x()===r?f?"Tdy":"Today":I()===n&&M()===o&&S()===r?f?"Ysd":"Yesterday":T()===n&&D()===o&&k()===r?f?"Tmw":"Tomorrow":c},QN=function(t){var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());n.setDate(n.getDate()-(n.getDay()+6)%7+3);var o=new Date(n.getFullYear(),0,4);o.setDate(o.getDate()-(o.getDay()+6)%7+3);var r=n.getTimezoneOffset()-o.getTimezoneOffset();n.setHours(n.getHours()-r);var a=(n-o)/(864e5*7);return 1+Math.floor(a)},KN=function(t){var n=t.getDay();return n===0&&(n=7),n},YN=function(t){return(String(t).match(ZN)||[""]).pop().replace(qN,"").replace(/GMT\+0000/g,"UTC")};const y0=()=>{const e=u.useContext(Cw);if(!e)throw new Error("useWorkflowLibraryContext must be used within a WorkflowLibraryContext.Provider");return e},Wi=(e="")=>PI(`workflows/${e}`),Ua=AI.injectEndpoints({endpoints:e=>({getWorkflow:e.query({query:t=>Wi(`i/${t}`),providesTags:(t,n,o)=>[{type:"Workflow",id:o},"FetchOnReconnect"],onQueryStarted:async(t,n)=>{const{dispatch:o,queryFulfilled:r}=n;try{await r,o(Ua.util.invalidateTags([{type:"WorkflowsRecent",id:_r}]))}catch{}}}),deleteWorkflow:e.mutation({query:t=>({url:Wi(`i/${t}`),method:"DELETE"}),invalidatesTags:(t,n,o)=>[{type:"Workflow",id:_r},{type:"Workflow",id:o},{type:"WorkflowsRecent",id:_r}]}),createWorkflow:e.mutation({query:t=>({url:Wi(),method:"POST",body:{workflow:t}}),invalidatesTags:[{type:"Workflow",id:_r},{type:"WorkflowsRecent",id:_r}]}),updateWorkflow:e.mutation({query:t=>({url:Wi(`i/${t.id}`),method:"PATCH",body:{workflow:t}}),invalidatesTags:(t,n,o)=>[{type:"WorkflowsRecent",id:_r},{type:"Workflow",id:_r},{type:"Workflow",id:o.id}]}),listWorkflows:e.query({query:t=>({url:Wi(),params:t}),providesTags:["FetchOnReconnect",{type:"Workflow",id:_r}]})})}),{useLazyGetWorkflowQuery:XN,useCreateWorkflowMutation:yw,useDeleteWorkflowMutation:JN,useUpdateWorkflowMutation:ez,useListWorkflowsQuery:tz}=Ua,nz=({onSuccess:e,onError:t})=>{const n=Uo(),o=na(),{t:r}=L(),[a,c]=JN();return{deleteWorkflow:u.useCallback(async f=>{try{await a(f).unwrap(),n({title:r("toast.workflowDeleted")}),e&&e()}catch{o.isActive(`auth-error-toast-${Ua.endpoints.deleteWorkflow.name}`)||n({title:r("toast.problemDeletingWorkflow"),status:"error"}),t&&t()}},[a,n,r,e,t,o]),deleteWorkflowResult:c}},sz=({onSuccess:e,onError:t})=>{const n=O(),o=Uo(),r=na(),{t:a}=L(),[c,d]=XN();return{getAndLoadWorkflow:u.useCallback(async m=>{try{const h=await c(m).unwrap();n(cg({workflow:h.workflow,asCopy:!1})),e&&e()}catch{r.isActive(`auth-error-toast-${Ua.endpoints.getWorkflow.name}`)||o({title:a("toast.problemRetrievingWorkflow"),status:"error"}),t&&t()}},[c,n,e,o,a,t,r]),getAndLoadWorkflowResult:d}},oz=({workflowDTO:e})=>{const{t}=L(),n=b(g=>g.workflow.id),{onClose:o}=y0(),{deleteWorkflow:r,deleteWorkflowResult:a}=nz({}),{getAndLoadWorkflow:c,getAndLoadWorkflowResult:d}=sz({onSuccess:o}),f=u.useCallback(()=>{r(e.workflow_id)},[r,e.workflow_id]),m=u.useCallback(()=>{c(e.workflow_id)},[c,e.workflow_id]),h=u.useMemo(()=>n===e.workflow_id,[n,e.workflow_id]);return s.jsx(P,{w:"full",p:2,borderRadius:"base",_hover:{bg:"base.750"},children:s.jsxs(P,{w:"full",alignItems:"center",gap:2,h:12,children:[s.jsxs(P,{flexDir:"column",flexGrow:1,h:"full",children:[s.jsxs(P,{alignItems:"center",w:"full",h:"50%",children:[s.jsx(sn,{size:"sm",noOfLines:1,variant:h?"invokeBlue":void 0,children:e.name||t("workflows.unnamedWorkflow")}),s.jsx(Tn,{}),e.category!=="default"&&s.jsxs(re,{fontSize:"sm",variant:"subtext",flexShrink:0,noOfLines:1,children:[t("common.updated"),": ",sd(e.updated_at,Tl.shortDate)," ",sd(e.updated_at,Tl.shortTime)]})]}),s.jsxs(P,{alignItems:"center",w:"full",h:"50%",children:[e.description?s.jsx(re,{fontSize:"sm",noOfLines:1,children:e.description}):s.jsx(re,{fontSize:"sm",variant:"subtext",fontStyle:"italic",noOfLines:1,children:t("workflows.noDescription")}),s.jsx(Tn,{}),e.category!=="default"&&s.jsxs(re,{fontSize:"sm",variant:"subtext",flexShrink:0,noOfLines:1,children:[t("common.created"),": ",sd(e.created_at,Tl.shortDate)," ",sd(e.created_at,Tl.shortTime)]})]})]}),s.jsx(qe,{flexShrink:0,isDisabled:h,onClick:m,isLoading:d.isLoading,"aria-label":t("workflows.openWorkflow"),children:t("common.load")}),e.category!=="default"&&s.jsx(qe,{flexShrink:0,colorScheme:"error",isDisabled:h,onClick:f,isLoading:a.isLoading,"aria-label":t("workflows.deleteWorkflow"),children:t("common.delete")})]})},e.workflow_id)},rz=u.memo(oz),Ia=7,az=({page:e,setPage:t,data:n})=>{const{t:o}=L(),r=u.useCallback(()=>{t(d=>Math.max(d-1,0))},[t]),a=u.useCallback(()=>{t(d=>Math.min(d+1,n.pages-1))},[n.pages,t]),c=u.useMemo(()=>{const d=[];let f=n.pages>Ia?Math.max(0,e-Math.floor(Ia/2)):0;const m=n.pages>Ia?Math.min(n.pages,f+Ia):n.pages;m-f<Ia&&n.pages>Ia&&(f=m-Ia);for(let h=f;h<m;h++)d.push({page:h,onClick:()=>t(h)});return d},[n.pages,e,t]);return s.jsxs(Nt,{children:[s.jsx(ve,{variant:"ghost",onClick:r,isDisabled:e===0,"aria-label":o("common.prevPage"),icon:s.jsx(Vb,{})}),c.map(d=>s.jsx(qe,{w:10,isDisabled:n.pages===1,onClick:d.page===e?void 0:d.onClick,variant:d.page===e?"solid":"ghost",transitionDuration:"0s",children:d.page+1},d.page)),s.jsx(ve,{variant:"ghost",onClick:a,isDisabled:e===n.pages-1,"aria-label":o("common.nextPage"),icon:s.jsx(Hb,{})})]})},lz=u.memo(az),iz=Ka("workflowLibrary/workflowDownloaded"),cz=Ka("workflowLibrary/workflowLoadedFromFile"),uz=Ka("workflowLibrary/newWorkflowSaved"),dz=Ka("workflowLibrary/workflowUpdated"),bw=({resetRef:e,onSuccess:t})=>{const n=O(),o=hb("nodes"),{t:r}=L();return u.useCallback(c=>{var f;if(!c)return;const d=new FileReader;d.onload=async()=>{const m=d.result;try{const h=JSON.parse(String(m));n(cg({workflow:h,asCopy:!0})),n(cz()),t&&t()}catch{o.error(r("nodes.unableToLoadWorkflow")),n(Ze(pt({title:r("nodes.unableToLoadWorkflow"),status:"error"}))),d.abort()}},d.readAsText(c),(f=e.current)==null||f.call(e)},[n,o,e,r,t])},fz=()=>{const{t:e}=L(),t=u.useRef(null),{onClose:n}=y0(),o=bw({resetRef:t,onSuccess:n}),r=u.useCallback(d=>{d[0]&&o(d[0])},[o]),{getInputProps:a,getRootProps:c}=hi({accept:{"application/json":[".json"]},onDropAccepted:r,noDrag:!0,multiple:!1});return s.jsxs(s.Fragment,{children:[s.jsx(qe,{"aria-label":e("workflows.uploadWorkflow"),tooltip:e("workflows.uploadWorkflow"),leftIcon:s.jsx(mi,{}),...c(),pointerEvents:"auto",children:e("workflows.uploadWorkflow")}),s.jsx("input",{...a()})]})},hz=u.memo(fz),yv=10,mz=uf.enum(["opened_at","created_at","updated_at","name"]),pz=e=>mz.safeParse(e).success,gz=uf.enum(["ASC","DESC"]),xz=e=>gz.safeParse(e).success,vz=()=>{var V;const{t:e}=L(),t=yt(vy),[n,o]=u.useState("user"),[r,a]=u.useState(0),[c,d]=u.useState(""),f=yt(DI),m=u.useMemo(()=>[{value:"opened_at",label:e("workflows.opened")},{value:"created_at",label:e("workflows.created")},{value:"updated_at",label:e("workflows.updated")},{value:"name",label:e("workflows.name")}],[e]),h=u.useMemo(()=>[{value:"ASC",label:e("workflows.ascending")},{value:"DESC",label:e("workflows.descending")}],[e]),g=u.useMemo(()=>f?m.filter(H=>H.value!=="opened_at"):m,[f,m]),[x,C]=u.useState((V=g[0])==null?void 0:V.value),[j,S]=u.useState("DESC"),[M]=m0(c,500),I=u.useMemo(()=>n!=="default"?{page:r,per_page:yv,order_by:x,direction:j,category:n,query:M}:{page:r,per_page:yv,order_by:"name",direction:"ASC",category:n,query:M},[n,M,j,x,r]),{data:k,isLoading:D,isError:T,isFetching:E}=tz(I),A=u.useCallback(H=>{!pz(H==null?void 0:H.value)||H.value===x||(C(H.value),a(0))},[x]),N=u.useMemo(()=>g.find(H=>H.value===x),[x,g]),W=u.useCallback(H=>{!xz(H==null?void 0:H.value)||H.value===j||(S(H.value),a(0))},[j]),G=u.useMemo(()=>h.find(H=>H.value===j),[j,h]),z=u.useCallback(()=>{d(""),a(0)},[]),X=u.useCallback(H=>{H.key==="Escape"&&(z(),H.preventDefault(),a(0))},[z]),B=u.useCallback(H=>{d(H.target.value),a(0)},[]),Q=u.useCallback(H=>{o(H),a(0)},[]);return s.jsxs(s.Fragment,{children:[s.jsxs(P,{gap:4,alignItems:"center",h:16,flexShrink:0,flexGrow:0,justifyContent:"space-between",children:[s.jsx(Nt,{alignSelf:"flex-end",children:t.map(H=>s.jsx(qe,{variant:n===H?void 0:"ghost",onClick:Q.bind(null,H),isChecked:n===H,children:e(`workflows.${H}Workflows`)},H))}),n!=="default"&&s.jsxs(s.Fragment,{children:[s.jsxs($,{isDisabled:E,sx:{flexDir:"column",alignItems:"flex-start",gap:1,maxW:56},children:[s.jsx(Y,{children:e("common.orderBy")}),s.jsx(ot,{value:N,options:g,onChange:A})]}),s.jsxs($,{isDisabled:E,sx:{flexDir:"column",alignItems:"flex-start",gap:1,maxW:56},children:[s.jsx(Y,{children:e("common.direction")}),s.jsx(ot,{value:G,options:h,onChange:W})]})]}),s.jsxs(qa,{w:"20rem",alignSelf:"flex-end",children:[s.jsx(mn,{placeholder:e("workflows.searchWorkflows"),value:c,onKeyDown:X,onChange:B,"data-testid":"workflow-search-input",minW:64}),c.trim().length&&s.jsx(Qa,{h:"full",pe:2,children:s.jsx(ve,{onClick:z,size:"sm",variant:"link","aria-label":e("workflows.clearWorkflowSearchFilter"),icon:s.jsx($n,{})})})]})]}),s.jsx(An,{}),D?s.jsx(Tg,{label:e("workflows.loading")}):!k||T?s.jsx(Ut,{label:e("workflows.problemLoading")}):k.items.length?s.jsx(Wn,{children:s.jsx(P,{w:"full",h:"full",flexDir:"column",children:k.items.map(H=>s.jsx(rz,{workflowDTO:H},H.workflow_id))})}):s.jsx(Ut,{label:e("workflows.noWorkflows")}),s.jsx(An,{}),s.jsxs(P,{w:"full",children:[s.jsx(Ae,{flex:"1",children:s.jsx(hz,{})}),s.jsx(Ae,{flex:"1",textAlign:"center",children:k&&s.jsx(lz,{data:k,page:r,setPage:a})}),s.jsx(Ae,{flex:"1"})]})]})},Cz=u.memo(vz),yz=e=>s.jsx(P,{w:"full",h:"full",flexDir:"column",layerStyle:"second",py:2,px:4,gap:2,borderRadius:"base",children:e.children}),bz=u.memo(yz),jz=()=>s.jsx(bz,{children:s.jsx(Cz,{})}),Sz=u.memo(jz),wz=()=>{const{t:e}=L(),{isOpen:t,onClose:n}=y0();return s.jsxs(Fa,{isOpen:t,onClose:n,isCentered:!0,children:[s.jsx(mr,{}),s.jsxs(Va,{w:"80%",h:"80%",minW:"unset",minH:"unset",maxW:"1200px",maxH:"664px",children:[s.jsx(pr,{children:e("workflows.workflowLibrary")}),s.jsx(ri,{}),s.jsx(gr,{children:s.jsx(Sz,{})}),s.jsx(Ha,{})]})]})},kz=u.memo(wz),Iz=()=>{const{t:e}=L(),t=fn();return s.jsxs(Cw.Provider,{value:t,children:[s.jsx(ve,{"aria-label":e("workflows.workflowLibrary"),tooltip:e("workflows.workflowLibrary"),icon:s.jsx(MD,{}),onClick:t.onOpen,pointerEvents:"auto"}),s.jsx(kz,{})]})},Mz=u.memo(Iz),Az=Fj("scroll","scroll").options,Pz=e=>{const{label:t,data:n,fileName:o,withDownload:r=!0,withCopy:a=!0}=e,c=u.useMemo(()=>ag(n)?n:JSON.stringify(n,null,2),[n]),d=u.useCallback(()=>{navigator.clipboard.writeText(c)},[c]),f=u.useCallback(()=>{const h=new Blob([c]),g=document.createElement("a");g.href=URL.createObjectURL(h),g.download=`${o||t}.json`,document.body.appendChild(g),g.click(),g.remove()},[c,t,o]),{t:m}=L();return s.jsxs(P,{layerStyle:"second",borderRadius:"base",flexGrow:1,w:"full",h:"full",position:"relative",children:[s.jsx(Ae,{position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"auto",p:4,fontSize:"sm",children:s.jsx(Af,{defer:!0,style:Dz,options:Az,children:s.jsx("pre",{children:c})})}),s.jsxs(P,{position:"absolute",top:0,insetInlineEnd:0,p:2,children:[r&&s.jsx(Dt,{label:`${m("gallery.download")} ${t} JSON`,children:s.jsx(ve,{"aria-label":`${m("gallery.download")} ${t} JSON`,icon:s.jsx(Lc,{size:16}),variant:"ghost",opacity:.7,onClick:f})}),a&&s.jsx(Dt,{label:`${m("gallery.copy")} ${t} JSON`,children:s.jsx(ve,{"aria-label":`${m("gallery.copy")} ${t} JSON`,icon:s.jsx(nl,{size:16}),variant:"ghost",opacity:.7,onClick:d})})]})]})},ta=u.memo(Pz),Dz={height:"100%",width:"100%"},Ez=Ve(lt,e=>{const t=e.selectedNodes[e.selectedNodes.length-1],n=e.nodes.find(o=>o.id===t);return{data:n==null?void 0:n.data}}),_z=()=>{const{t:e}=L(),{data:t}=b(Ez);return t?s.jsx(ta,{data:t,label:"Node Data"}):s.jsx(Ut,{label:e("nodes.noNodeSelected"),icon:null})},Lz=u.memo(_z),b0=(e,t)=>{const n=e.nodes.find(o=>o.id===t);return Zr(n)?n:null},ll=(e,t)=>{var n;return((n=b0(e,t))==null?void 0:n.data)??null},Ko=(e,t)=>{const n=b0(e,t);return n?e.templates[n.data.type]??null:null},jw=(e,t,n)=>{const o=ll(e,t);return(o==null?void 0:o.inputs[n])??null},Kf=(e,t,n)=>{const o=Ko(e,t);return(o==null?void 0:o.inputs[n])??null},$c=(e,t,n)=>{const o=Ko(e,t);return(o==null?void 0:o.outputs[n])??null},Sw=e=>{const t=u.useMemo(()=>Ve(lt,o=>ll(o,e)),[e]);return b(t)},Tz=({nodeId:e})=>{const t=O(),n=Sw(e),{t:o}=L(),r=u.useCallback(a=>{t(EI({nodeId:e,notes:a.target.value}))},[t,e]);return rp(n)?s.jsxs($,{orientation:"vertical",h:"full",children:[s.jsx(Y,{children:o("nodes.notes")}),s.jsx(Oo,{value:n==null?void 0:n.notes,onChange:r,rows:10,resize:"none"})]}):null},Rz=u.memo(Tz),ww=e=>{const t=u.useMemo(()=>Ve(lt,o=>{const r=b0(o,e),a=Ko(o,e);return!r||!a?!1:Cy(r,a)}),[e]);return b(t)},kw=e=>{const t=u.useMemo(()=>it(lt,o=>{var r;return((r=ll(o,e))==null?void 0:r.label)??null}),[e]);return b(t)},Iw=e=>{const t=u.useMemo(()=>it(lt,o=>{var r;return((r=Ko(o,e))==null?void 0:r.title)??null}),[e]);return b(t)},Bz=({nodeId:e,title:t})=>{const n=O(),o=kw(e),r=Iw(e),{t:a}=L(),[c,d]=u.useState(""),f=u.useCallback(async h=>{n(yy({nodeId:e,label:h})),d(o||t||r||a("nodes.problemSettingTitle"))},[n,e,t,r,o,a]),m=u.useCallback(h=>{d(h)},[]);return u.useEffect(()=>{d(o||t||r||a("nodes.problemSettingTitle"))},[o,r,t,a]),s.jsx(P,{w:"full",alignItems:"center",justifyContent:"center",children:s.jsxs(sf,{as:P,value:c,onChange:m,onSubmit:f,w:"full",fontWeight:"semibold",children:[s.jsx(of,{noOfLines:1}),s.jsx(rf,{className:"nodrag"})]})})},Nz=u.memo(Bz),zz=Ve(lt,e=>{const t=e.selectedNodes[e.selectedNodes.length-1],n=e.nodes.find(r=>r.id===t),o=n?e.templates[n.data.type]:void 0;if(!(!Zr(n)||!o))return{nodeId:n.data.id,nodeVersion:n.data.version,templateTitle:o.title}}),Oz=()=>{const e=b(zz),{t}=L();return e?s.jsx(Mw,{nodeId:e.nodeId,nodeVersion:e.nodeVersion,templateTitle:e.templateTitle}):s.jsx(Ut,{label:t("nodes.noNodeSelected"),icon:null})},Fz=u.memo(Oz),Mw=u.memo(e=>{const{t}=L(),n=ww(e.nodeId);return s.jsx(Ae,{position:"relative",w:"full",h:"full",children:s.jsx(Wn,{children:s.jsxs(P,{flexDir:"column",position:"relative",w:"full",h:"full",p:1,gap:2,children:[s.jsx(Nz,{nodeId:e.nodeId}),s.jsxs(_I,{children:[s.jsxs($,{children:[s.jsx(Y,{children:t("nodes.nodeType")}),s.jsx(re,{fontSize:"sm",fontWeight:"semibold",children:e.templateTitle})]}),s.jsxs($,{isInvalid:n,children:[s.jsx(Y,{children:t("nodes.nodeVersion")}),s.jsx(re,{fontSize:"sm",fontWeight:"semibold",children:e.nodeVersion})]})]}),s.jsx(Rz,{nodeId:e.nodeId})]})})})});Mw.displayName="Content";const Vz=({output:e})=>{const{image:t}=e,{data:n}=Gs(t.image_name);return s.jsx(Jr,{imageDTO:n})},Hz=u.memo(Vz),$z=Ve(lt,e=>{const t=e.selectedNodes[e.selectedNodes.length-1],n=e.nodes.find(a=>a.id===t),o=n?e.templates[n.data.type]:void 0,r=e.nodeExecutionStates[t??"__UNKNOWN_NODE__"];if(!(!Zr(n)||!r||!o))return{outputs:r.outputs,outputType:o.outputType}}),Wz=()=>{const e=b($z),{t}=L();return e?e.outputs.length===0?s.jsx(Ut,{label:t("nodes.noOutputRecorded"),icon:null}):s.jsx(Ae,{position:"relative",w:"full",h:"full",children:s.jsx(Wn,{children:s.jsx(P,{position:"relative",flexDir:"column",alignItems:"flex-start",p:1,gap:2,h:"full",w:"full",children:e.outputType==="image_output"?e.outputs.map((n,o)=>s.jsx(Hz,{output:n},Uz(n,o))):s.jsx(ta,{data:e.outputs,label:t("nodes.nodeOutputs")})})})}):s.jsx(Ut,{label:t("nodes.noNodeSelected"),icon:null})},Gz=u.memo(Wz),Uz=(e,t)=>`${e.type}-${t}`,Zz=Ve(lt,e=>{const t=e.selectedNodes[e.selectedNodes.length-1],n=e.nodes.find(r=>r.id===t);return{template:n?e.templates[n.data.type]:void 0}}),qz=()=>{const{template:e}=b(Zz),{t}=L();return e?s.jsx(ta,{data:e,label:t("nodes.nodeTemplate")}):s.jsx(Ut,{label:t("nodes.noNodeSelected"),icon:null})},Qz=u.memo(qz),Kz=()=>{const{t:e}=L();return s.jsx(P,{layerStyle:"first",flexDir:"column",w:"full",h:"full",borderRadius:"base",p:2,gap:2,children:s.jsxs(Ja,{variant:"line",display:"flex",flexDir:"column",w:"full",h:"full",children:[s.jsxs(el,{children:[s.jsx(pn,{children:e("common.details")}),s.jsx(pn,{children:e("common.outputs")}),s.jsx(pn,{children:e("common.data")}),s.jsx(pn,{children:e("common.template")})]}),s.jsxs(ii,{children:[s.jsx(Pn,{children:s.jsx(Fz,{})}),s.jsx(Pn,{children:s.jsx(Gz,{})}),s.jsx(Pn,{children:s.jsx(Lz,{})}),s.jsx(Pn,{children:s.jsx(Qz,{})})]})]})})},Yz=u.memo(Kz),Xz=()=>{const{t:e}=L(),t=O(),n=u.useCallback(()=>{t(Sd("edit"))},[t]);return s.jsx(P,{sx:{w:"full",h:"full",userSelect:"none"},children:s.jsxs(P,{sx:{alignItems:"center",justifyContent:"center",borderRadius:"base",flexDir:"column",gap:5,maxW:"230px",margin:"0 auto"},children:[s.jsx(Ks,{src:NC,alt:"invoke-ai-logo",opacity:.2,mixBlendMode:"overlay",w:16,h:16,minW:16,minH:16,userSelect:"none"}),s.jsx(re,{textAlign:"center",fontSize:"md",children:e("nodes.noFieldsViewMode")}),s.jsx(qe,{colorScheme:"invokeBlue",onClick:n,children:e("nodes.edit")})]})})},j0=(e,t)=>{const n=u.useMemo(()=>Ve(lt,r=>jw(r,e,t)),[t,e]);return b(n)},Jz=(e,t,n)=>{const o=u.useMemo(()=>Ve(lt,a=>n==="inputs"?Kf(a,e,t):$c(a,e,t)),[t,n,e]);return b(o)},Aw=e=>{const{t}=L();return u.useMemo(()=>{if(!e)return"";const{name:o}=e;return e.isCollection?t("nodes.collectionFieldType",{name:o}):e.isCollectionOrScalar?t("nodes.collectionOrScalarFieldType",{name:o}):o},[e,t])},eO=({nodeId:e,fieldName:t,kind:n})=>{const o=j0(e,t),r=Jz(e,t,n),a=LI(r),c=Aw(r==null?void 0:r.type),{t:d}=L(),f=u.useMemo(()=>TI(o)?o.label&&(r!=null&&r.title)?`${o.label} (${r.title})`:o.label&&!r?o.label:!o.label&&r?r.title:d("nodes.unknownField"):(r==null?void 0:r.title)||d("nodes.unknownField"),[o,r,d]);return s.jsxs(P,{flexDir:"column",children:[s.jsx(re,{fontWeight:"semibold",children:f}),r&&s.jsx(re,{opacity:.7,fontStyle:"oblique 5deg",children:r.description}),c&&s.jsxs(re,{children:[d("parameters.type"),": ",c]}),a&&s.jsxs(re,{children:[d("common.input"),": ",RI(r.input)]})]})},Yf=u.memo(eO),Pw=(e,t)=>{const n=u.useMemo(()=>Ve(lt,r=>Kf(r,e,t)),[t,e]);return b(n)},tO=e=>{const{nodeId:t,field:n}=e,o=O(),{t:r}=L(),{options:a,hasBoards:c}=Sc(void 0,{selectFromResult:({data:h})=>{const g=[{label:"None",value:"none"}].concat((h??[]).map(({board_id:x,board_name:C})=>({label:C,value:x})));return{options:g,hasBoards:g.length>1}}}),d=u.useCallback(h=>{h&&o(BI({nodeId:t,fieldName:n.name,value:h.value!=="none"?{board_id:h.value}:void 0}))},[o,n.name,t]),f=u.useMemo(()=>a.find(h=>{var g;return h.value===((g=n.value)==null?void 0:g.board_id)}),[a,n.value]),m=u.useCallback(()=>r("boards.noMatching"),[r]);return s.jsx($,{className:"nowheel nodrag",isDisabled:!c,children:s.jsx(ot,{value:f,options:a,onChange:d,placeholder:r("boards.selectBoard"),noOptionsMessage:m})})},nO=u.memo(tO),sO=e=>{const{nodeId:t,field:n}=e,o=O(),r=u.useCallback(a=>{o(NI({nodeId:t,fieldName:n.name,value:a.target.checked}))},[o,n.name,t]);return s.jsx(jt,{className:"nodrag",onChange:r,isChecked:n.value})},oO=u.memo(sO);function rO(e,t=!1){const n=(16777216+(e.r<<16)+(e.g<<8)+e.b).toString(16).slice(1),o=Math.round(e.a*255).toString(16).padStart(2,"0");return t?`#${n}${o}`:`#${n}`}function aO(e,t){e=e.replace(/^#/,"");const n=parseInt(e.substring(0,2),16),o=parseInt(e.substring(2,4),16),r=parseInt(e.substring(4,6),16);return{r:n,g:o,b:r,a:t}}const hr=e=>`var(--invoke-colors-${e.split(".").join("-")})`;function vi(){return(vi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function Xf(e,t){if(e==null)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t.indexOf(n=a[o])>=0||(r[n]=e[n]);return r}function yc(e){var t=u.useRef(e),n=u.useRef(function(o){t.current&&t.current(o)});return t.current=e,n.current}var ti=function(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=1),e>n?n:e<t?t:e},rc=function(e){return"touches"in e},Np=function(e){return e&&e.ownerDocument.defaultView||self},bv=function(e,t,n){var o=e.getBoundingClientRect(),r=rc(t)?function(a,c){for(var d=0;d<a.length;d++)if(a[d].identifier===c)return a[d];return a[0]}(t.touches,n):t;return{left:ti((r.pageX-(o.left+Np(e).pageXOffset))/o.width),top:ti((r.pageY-(o.top+Np(e).pageYOffset))/o.height)}},jv=function(e){!rc(e)&&e.preventDefault()},S0=q.memo(function(e){var t=e.onMove,n=e.onKey,o=Xf(e,["onMove","onKey"]),r=u.useRef(null),a=yc(t),c=yc(n),d=u.useRef(null),f=u.useRef(!1),m=u.useMemo(function(){var C=function(M){jv(M),(rc(M)?M.touches.length>0:M.buttons>0)&&r.current?a(bv(r.current,M,d.current)):S(!1)},j=function(){return S(!1)};function S(M){var I=f.current,k=Np(r.current),D=M?k.addEventListener:k.removeEventListener;D(I?"touchmove":"mousemove",C),D(I?"touchend":"mouseup",j)}return[function(M){var I=M.nativeEvent,k=r.current;if(k&&(jv(I),!function(T,E){return E&&!rc(T)}(I,f.current)&&k)){if(rc(I)){f.current=!0;var D=I.changedTouches||[];D.length&&(d.current=D[0].identifier)}k.focus(),a(bv(k,I,d.current)),S(!0)}},function(M){var I=M.which||M.keyCode;I<37||I>40||(M.preventDefault(),c({left:I===39?.05:I===37?-.05:0,top:I===40?.05:I===38?-.05:0}))},S]},[c,a]),h=m[0],g=m[1],x=m[2];return u.useEffect(function(){return x},[x]),q.createElement("div",vi({},o,{onTouchStart:h,onMouseDown:h,className:"react-colorful__interactive",ref:r,onKeyDown:g,tabIndex:0,role:"slider"}))}),Jf=function(e){return e.filter(Boolean).join(" ")},w0=function(e){var t=e.color,n=e.left,o=e.top,r=o===void 0?.5:o,a=Jf(["react-colorful__pointer",e.className]);return q.createElement("div",{className:a,style:{top:100*r+"%",left:100*n+"%"}},q.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:t}}))},Qn=function(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=Math.pow(10,t)),Math.round(n*e)/n},Dw=function(e){var t=e.s,n=e.v,o=e.a,r=(200-t)*n/100;return{h:Qn(e.h),s:Qn(r>0&&r<200?t*n/100/(r<=100?r:200-r)*100:0),l:Qn(r/2),a:Qn(o,2)}},zp=function(e){var t=Dw(e);return"hsl("+t.h+", "+t.s+"%, "+t.l+"%)"},$m=function(e){var t=Dw(e);return"hsla("+t.h+", "+t.s+"%, "+t.l+"%, "+t.a+")"},lO=function(e){var t=e.h,n=e.s,o=e.v,r=e.a;t=t/360*6,n/=100,o/=100;var a=Math.floor(t),c=o*(1-n),d=o*(1-(t-a)*n),f=o*(1-(1-t+a)*n),m=a%6;return{r:Qn(255*[o,d,c,c,f,o][m]),g:Qn(255*[f,o,o,d,c,c][m]),b:Qn(255*[c,c,f,o,o,d][m]),a:Qn(r,2)}},iO=function(e){var t=e.r,n=e.g,o=e.b,r=e.a,a=Math.max(t,n,o),c=a-Math.min(t,n,o),d=c?a===t?(n-o)/c:a===n?2+(o-t)/c:4+(t-n)/c:0;return{h:Qn(60*(d<0?d+6:d)),s:Qn(a?c/a*100:0),v:Qn(a/255*100),a:r}},cO=q.memo(function(e){var t=e.hue,n=e.onChange,o=Jf(["react-colorful__hue",e.className]);return q.createElement("div",{className:o},q.createElement(S0,{onMove:function(r){n({h:360*r.left})},onKey:function(r){n({h:ti(t+360*r.left,0,360)})},"aria-label":"Hue","aria-valuenow":Qn(t),"aria-valuemax":"360","aria-valuemin":"0"},q.createElement(w0,{className:"react-colorful__hue-pointer",left:t/360,color:zp({h:t,s:100,v:100,a:1})})))}),uO=q.memo(function(e){var t=e.hsva,n=e.onChange,o={backgroundColor:zp({h:t.h,s:100,v:100,a:1})};return q.createElement("div",{className:"react-colorful__saturation",style:o},q.createElement(S0,{onMove:function(r){n({s:100*r.left,v:100-100*r.top})},onKey:function(r){n({s:ti(t.s+100*r.left,0,100),v:ti(t.v-100*r.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+Qn(t.s)+"%, Brightness "+Qn(t.v)+"%"},q.createElement(w0,{className:"react-colorful__saturation-pointer",top:1-t.v/100,left:t.s/100,color:zp(t)})))}),Ew=function(e,t){if(e===t)return!0;for(var n in e)if(e[n]!==t[n])return!1;return!0};function dO(e,t,n){var o=yc(n),r=u.useState(function(){return e.toHsva(t)}),a=r[0],c=r[1],d=u.useRef({color:t,hsva:a});u.useEffect(function(){if(!e.equal(t,d.current.color)){var m=e.toHsva(t);d.current={hsva:m,color:t},c(m)}},[t,e]),u.useEffect(function(){var m;Ew(a,d.current.hsva)||e.equal(m=e.fromHsva(a),d.current.color)||(d.current={hsva:a,color:m},o(m))},[a,e,o]);var f=u.useCallback(function(m){c(function(h){return Object.assign({},h,m)})},[]);return[a,f]}var fO=typeof window<"u"?u.useLayoutEffect:u.useEffect,hO=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},Sv=new Map,mO=function(e){fO(function(){var t=e.current?e.current.ownerDocument:document;if(t!==void 0&&!Sv.has(t)){var n=t.createElement("style");n.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,Sv.set(t,n);var o=hO();o&&n.setAttribute("nonce",o),t.head.appendChild(n)}},[])},pO=function(e){var t=e.className,n=e.hsva,o=e.onChange,r={backgroundImage:"linear-gradient(90deg, "+$m(Object.assign({},n,{a:0}))+", "+$m(Object.assign({},n,{a:1}))+")"},a=Jf(["react-colorful__alpha",t]),c=Qn(100*n.a);return q.createElement("div",{className:a},q.createElement("div",{className:"react-colorful__alpha-gradient",style:r}),q.createElement(S0,{onMove:function(d){o({a:d.left})},onKey:function(d){o({a:ti(n.a+d.left)})},"aria-label":"Alpha","aria-valuetext":c+"%","aria-valuenow":c,"aria-valuemin":"0","aria-valuemax":"100"},q.createElement(w0,{className:"react-colorful__alpha-pointer",left:n.a,color:$m(n)})))},gO=function(e){var t=e.className,n=e.colorModel,o=e.color,r=o===void 0?n.defaultColor:o,a=e.onChange,c=Xf(e,["className","colorModel","color","onChange"]),d=u.useRef(null);mO(d);var f=dO(n,r,a),m=f[0],h=f[1],g=Jf(["react-colorful",t]);return q.createElement("div",vi({},c,{ref:d,className:g}),q.createElement(uO,{hsva:m,onChange:h}),q.createElement(cO,{hue:m.h,onChange:h}),q.createElement(pO,{hsva:m,onChange:h,className:"react-colorful__last-control"}))},xO={defaultColor:{r:0,g:0,b:0,a:1},toHsva:iO,fromHsva:lO,equal:Ew},_w=function(e){return q.createElement(gO,vi({},e,{colorModel:xO}))},vO=/^#?([0-9A-F]{3,8})$/i,CO=function(e){var t=e.color,n=t===void 0?"":t,o=e.onChange,r=e.onBlur,a=e.escape,c=e.validate,d=e.format,f=e.process,m=Xf(e,["color","onChange","onBlur","escape","validate","format","process"]),h=u.useState(function(){return a(n)}),g=h[0],x=h[1],C=yc(o),j=yc(r),S=u.useCallback(function(I){var k=a(I.target.value);x(k),c(k)&&C(f?f(k):k)},[a,f,c,C]),M=u.useCallback(function(I){c(I.target.value)||x(a(n)),j(I)},[n,a,c,j]);return u.useEffect(function(){x(a(n))},[n,a]),q.createElement("input",vi({},m,{value:d?d(g):g,spellCheck:"false",onChange:S,onBlur:M}))},wv=function(e){return"#"+e},yO=function(e){var t=e.prefixed,n=e.alpha,o=Xf(e,["prefixed","alpha"]),r=u.useCallback(function(c){return c.replace(/([^0-9A-F]+)/gi,"").substring(0,n?8:6)},[n]),a=u.useCallback(function(c){return function(d,f){var m=vO.exec(d),h=m?m[1].length:0;return h===3||h===6||!!f&&h===4||!!f&&h===8}(c,n)},[n]);return q.createElement(CO,vi({},o,{escape:r,format:t?wv:void 0,process:wv,validate:a}))};const bO={r:0,g:0,b:0,a:255},jO=e=>{const{nodeId:t,field:n}=e,o=O(),r=u.useMemo(()=>{if(!n.value)return bO;const{r:c,g:d,b:f,a:m}=n.value;return{r:c,g:d,b:f,a:m/255}},[n.value]),a=u.useCallback(c=>{typeof c=="string"&&(c=aO(c,1));const{r:d,g:f,b:m,a:h}=c,g=Math.round(h*255);o(zI({nodeId:t,fieldName:n.name,value:{r:d,g:f,b:m,a:g}}))},[o,n.name,t]);return s.jsxs(Ae,{sx:{display:"flex",flexDirection:"column",gap:2},children:[s.jsx(yO,{style:{background:hr("base.700"),color:hr("base.100"),fontSize:12,paddingInlineStart:10,borderRadius:4,paddingBlock:4,outline:"none"},className:"nodrag",color:rO(r,!0),onChange:a,prefixed:!0,alpha:!0}),s.jsx(_w,{className:"nodrag",color:r,onChange:a,style:{width:"100%"}})]})},SO=u.memo(jO),Js=e=>{const{t}=L(),n=b(C=>{var j;return((j=C.generation.model)==null?void 0:j.base)??"sdxl"}),{modelConfigs:o,selectedModel:r,getIsDisabled:a,onChange:c,isLoading:d}=e,f=u.useMemo(()=>{if(!o)return[];const C=c7(o,"base"),j=OI(C,(S,M,I)=>(S.push({label:I,options:M.map(k=>({label:k.name,value:k.key,isDisabled:a?a(k):!1}))}),S),[]);return j.sort(S=>S.label===n?-1:1),j},[a,o,n]),m=u.useMemo(()=>f.flatMap(C=>C.options).find(C=>r?C.value===r.key:!1)??null,[f,r]),h=u.useCallback(C=>{if(!C){c(null);return}const j=o.find(S=>S.key===C.value);if(!j){c(null);return}c(j)},[o,c]),g=u.useMemo(()=>d?t("common.loading"):f.length===0?t("models.noModelsAvailable"):t("models.selectModel"),[d,f,t]),x=u.useCallback(()=>t("models.noMatchingModels"),[t]);return{options:f,value:m,onChange:h,placeholder:g,noOptionsMessage:x}},wO=e=>{const{nodeId:t,field:n}=e,o=O(),[r,{isLoading:a}]=Yg(),c=u.useCallback(x=>{x&&o(FI({nodeId:t,fieldName:n.name,value:x}))},[o,n.name,t]),{options:d,value:f,onChange:m,placeholder:h,noOptionsMessage:g}=Js({modelConfigs:r,onChange:c,selectedModel:n.value,isLoading:a});return s.jsx(Dt,{label:f==null?void 0:f.description,children:s.jsx($,{className:"nowheel nodrag",isInvalid:!f,children:s.jsx(ot,{value:f,placeholder:h,options:d,onChange:m,noOptionsMessage:g})})})},kO=u.memo(wO),IO=e=>{const{nodeId:t,field:n,fieldTemplate:o}=e,r=O(),a=u.useCallback(c=>{r(VI({nodeId:t,fieldName:n.name,value:c.target.value}))},[r,n.name,t]);return s.jsx(HI,{className:"nowheel nodrag",onChange:a,value:n.value,children:o.options.map(c=>s.jsx("option",{value:c,children:o.ui_choice_labels?o.ui_choice_labels[c]:c},c))})},MO=u.memo(IO),AO=e=>{var g;const{nodeId:t,field:n}=e,o=O(),r=b(x=>x.system.isConnected),{currentData:a,isError:c}=Gs(((g=n.value)==null?void 0:g.image_name)??Ot),d=u.useCallback(()=>{o($I({nodeId:t,fieldName:n.name,value:void 0}))},[o,n.name,t]),f=u.useMemo(()=>{if(a)return{id:`node-${t}-${n.name}`,payloadType:"IMAGE_DTO",payload:{imageDTO:a}}},[n.name,a,t]),m=u.useMemo(()=>({id:`node-${t}-${n.name}`,actionType:"SET_NODES_IMAGE",context:{nodeId:t,fieldName:n.name}}),[n.name,t]),h=u.useMemo(()=>({type:"SET_NODES_IMAGE",nodeId:t,fieldName:n.name}),[t,n.name]);return u.useEffect(()=>{r&&c&&d()},[d,r,c]),s.jsx(P,{className:"nodrag",w:"full",h:"full",alignItems:"center",justifyContent:"center",children:s.jsx(Jr,{imageDTO:a,droppableData:m,draggableData:f,postUploadAction:h,useThumbailFallback:!0,uploadElement:s.jsx(Lw,{}),dropLabel:s.jsx(Tw,{}),minSize:8,children:s.jsx($l,{onClick:d,icon:a?s.jsx(ca,{}):void 0,tooltip:"Reset Image"})})})},PO=u.memo(AO),Lw=u.memo(()=>{const{t:e}=L();return s.jsx(re,{fontSize:16,fontWeight:"semibold",children:e("gallery.dropOrUpload")})});Lw.displayName="UploadElement";const Tw=u.memo(()=>{const{t:e}=L();return s.jsx(re,{fontSize:16,fontWeight:"semibold",children:e("gallery.drop")})});Tw.displayName="DropLabel";const DO=e=>{const{nodeId:t,field:n}=e,o=O(),[r,{isLoading:a}]=Jg(),c=u.useCallback(h=>{h&&o(WI({nodeId:t,fieldName:n.name,value:h}))},[o,n.name,t]),{options:d,value:f,onChange:m}=Js({modelConfigs:r,onChange:c,selectedModel:n.value,isLoading:a});return s.jsx(Dt,{label:f==null?void 0:f.description,children:s.jsx($,{className:"nowheel nodrag",isInvalid:!f,children:s.jsx(ot,{value:f,placeholder:"Pick one",options:d,onChange:m})})})},EO=u.memo(DO),_O=e=>{const{nodeId:t,field:n}=e,o=O(),[r,{isLoading:a}]=Df(),c=u.useCallback(x=>{x&&o(GI({nodeId:t,fieldName:n.name,value:x}))},[o,n.name,t]),{options:d,value:f,onChange:m,placeholder:h,noOptionsMessage:g}=Js({modelConfigs:r,onChange:c,selectedModel:n.value,isLoading:a});return s.jsx($,{className:"nowheel nodrag",isInvalid:!f,isDisabled:!d.length,children:s.jsx(ot,{value:f,placeholder:h,noOptionsMessage:g,options:d,onChange:m})})},LO=u.memo(_O),TO=e=>{const{nodeId:t,field:n}=e,o=O(),[r,{isLoading:a}]=g_(),c=u.useCallback(x=>{x&&o(by({nodeId:t,fieldName:n.name,value:x}))},[o,n.name,t]),{options:d,value:f,onChange:m,placeholder:h,noOptionsMessage:g}=Js({modelConfigs:r,onChange:c,isLoading:a,selectedModel:n.value});return s.jsx(P,{w:"full",alignItems:"center",gap:2,children:s.jsx($,{className:"nowheel nodrag",isDisabled:!d.length,isInvalid:!f,children:s.jsx(ot,{value:f,placeholder:h,options:d,onChange:m,noOptionsMessage:g})})})},RO=u.memo(TO),BO=e=>{const{nodeId:t,field:n,fieldTemplate:o}=e,r=O(),a=u.useMemo(()=>o.type.name==="IntegerField",[o.type]),c=u.useCallback(m=>{r(UI({nodeId:t,fieldName:n.name,value:a?Math.floor(Number(m)):Number(m)}))},[r,n.name,a,t]),d=u.useMemo(()=>{if(!ln(o.minimum))return o.minimum;if(!ln(o.exclusiveMinimum))return o.exclusiveMinimum+.01},[o.exclusiveMinimum,o.minimum]),f=u.useMemo(()=>{if(!ln(o.maximum))return o.maximum;if(!ln(o.exclusiveMaximum))return o.exclusiveMaximum-.01},[o.exclusiveMaximum,o.maximum]);return s.jsx(Ee,{defaultValue:o.default,onChange:c,value:n.value,min:d??-wd,max:f??wd,step:a?1:.1,fineStep:a?1:.01,className:"nodrag"})},NO=u.memo(BO),zO=e=>{const{nodeId:t,field:n}=e,o=O(),[r,{isLoading:a}]=Kg(),c=u.useCallback(x=>{x&&o(ZI({nodeId:t,fieldName:n.name,value:x}))},[o,n.name,t]),{options:d,value:f,onChange:m,placeholder:h,noOptionsMessage:g}=Js({modelConfigs:r,onChange:c,isLoading:a,selectedModel:n.value});return s.jsx(P,{w:"full",alignItems:"center",gap:2,children:s.jsx($,{className:"nowheel nodrag",isDisabled:!d.length,isInvalid:!f,children:s.jsx(ot,{value:f,placeholder:h,options:d,onChange:m,noOptionsMessage:g})})})},OO=u.memo(zO),FO=e=>{const{nodeId:t,field:n}=e,o=O(),r=u.useCallback(c=>{ai(c==null?void 0:c.value)&&o(qI({nodeId:t,fieldName:n.name,value:c.value}))},[o,n.name,t]),a=u.useMemo(()=>Qr.find(c=>c.value===(n==null?void 0:n.value)),[n==null?void 0:n.value]);return s.jsx($,{className:"nowheel nodrag",children:s.jsx(ot,{value:a,options:Qr,onChange:r})})},VO=u.memo(FO),HO=e=>{const{nodeId:t,field:n}=e,o=O(),[r,{isLoading:a}]=x_(),c=u.useCallback(x=>{x&&o(by({nodeId:t,fieldName:n.name,value:x}))},[o,n.name,t]),{options:d,value:f,onChange:m,placeholder:h,noOptionsMessage:g}=Js({modelConfigs:r,onChange:c,isLoading:a,selectedModel:n.value});return s.jsx(P,{w:"full",alignItems:"center",gap:2,children:s.jsx($,{className:"nowheel nodrag",isDisabled:!d.length,isInvalid:!f,children:s.jsx(ot,{value:f,placeholder:h,options:d,onChange:m,noOptionsMessage:g})})})},$O=u.memo(HO),WO=e=>{const{nodeId:t,field:n,fieldTemplate:o}=e,r=O(),a=u.useCallback(c=>{r(QI({nodeId:t,fieldName:n.name,value:c.target.value}))},[r,n.name,t]);return o.ui_component==="textarea"?s.jsx(Oo,{className:"nodrag",onChange:a,value:n.value,rows:5,resize:"none"}):s.jsx(mn,{className:"nodrag",onChange:a,value:n.value})},GO=u.memo(WO),UO=e=>{const{nodeId:t,field:n}=e,o=O(),[r,{isLoading:a}]=Xg(),c=u.useCallback(h=>{h&&o(KI({nodeId:t,fieldName:n.name,value:h}))},[o,n.name,t]),{options:d,value:f,onChange:m}=Js({modelConfigs:r,onChange:c,selectedModel:n.value,isLoading:a});return s.jsx(Dt,{label:f==null?void 0:f.description,children:s.jsx($,{className:"nowheel nodrag",isInvalid:!f,children:s.jsx(ot,{value:f,placeholder:"Pick one",options:d,onChange:m})})})},ZO=u.memo(UO),qO=e=>{const{nodeId:t,field:n}=e,o=O(),[r,{isLoading:a}]=Ef(),c=u.useCallback(x=>{x&&o(YI({nodeId:t,fieldName:n.name,value:x}))},[o,n.name,t]),{options:d,value:f,onChange:m,placeholder:h,noOptionsMessage:g}=Js({modelConfigs:r,onChange:c,selectedModel:n.value,isLoading:a});return s.jsx(P,{w:"full",alignItems:"center",gap:2,children:s.jsx($,{className:"nowheel nodrag",isDisabled:!d.length,isInvalid:!f,children:s.jsx(ot,{value:f,placeholder:h,options:d,onChange:m,noOptionsMessage:g})})})},QO=u.memo(qO),KO=({nodeId:e,fieldName:t})=>{const n=j0(e,t),o=Pw(e,t);if(XI(n)&&JI(o))return s.jsx(GO,{nodeId:e,field:n,fieldTemplate:o});if(eM(n)&&tM(o))return s.jsx(oO,{nodeId:e,field:n,fieldTemplate:o});if(nM(n)&&sM(o)||oM(n)&&rM(o))return s.jsx(NO,{nodeId:e,field:n,fieldTemplate:o});if(aM(n)&&lM(o))return s.jsx(MO,{nodeId:e,field:n,fieldTemplate:o});if(iM(n)&&cM(o))return s.jsx(PO,{nodeId:e,field:n,fieldTemplate:o});if(uM(n)&&dM(o))return s.jsx(nO,{nodeId:e,field:n,fieldTemplate:o});if(fM(n)&&hM(o))return s.jsx(RO,{nodeId:e,field:n,fieldTemplate:o});if(mM(n)&&pM(o))return s.jsx(OO,{nodeId:e,field:n,fieldTemplate:o});if(gM(n)&&xM(o))return s.jsx(QO,{nodeId:e,field:n,fieldTemplate:o});if(vM(n)&&CM(o))return s.jsx(LO,{nodeId:e,field:n,fieldTemplate:o});if(yM(n)&&bM(o))return s.jsx(kO,{nodeId:e,field:n,fieldTemplate:o});if(jM(n)&&SM(o))return s.jsx(EO,{nodeId:e,field:n,fieldTemplate:o});if(wM(n)&&kM(o))return s.jsx(ZO,{nodeId:e,field:n,fieldTemplate:o});if(IM(n)&&MM(o))return s.jsx(SO,{nodeId:e,field:n,fieldTemplate:o});if(AM(n)&&PM(o))return s.jsx($O,{nodeId:e,field:n,fieldTemplate:o});if(DM(n)&&EM(o))return s.jsx(VO,{nodeId:e,field:n,fieldTemplate:o});if(o)return null},k0=u.memo(KO),Rw=(e,t)=>{const n=u.useMemo(()=>it(lt,r=>{var a;return((a=jw(r,e,t))==null?void 0:a.label)??null}),[t,e]);return b(n)},Bw=(e,t)=>{const n=u.useMemo(()=>Ve(lt,r=>{var c;const a=r.nodes.find(d=>d.id===e);if(Zr(a))return(c=a==null?void 0:a.data.inputs[t])==null?void 0:c.value}),[t,e]);return b(n)},Nw=(e,t)=>{const n=O(),o=u.useMemo(()=>it(Go,f=>{var m;return(m=f.originalExposedFieldValues.find(h=>h.nodeId===e&&h.fieldName===t))==null?void 0:m.value}),[e,t]),r=b(o),a=Bw(e,t),c=u.useMemo(()=>!_M(a,r),[a,r]),d=u.useCallback(()=>{n(LM({nodeId:e,fieldName:t,value:r}))},[n,t,e,r]);return{originalValue:r,isValueChanged:c,onReset:d}},zw=(e,t,n)=>{const o=u.useMemo(()=>it(lt,a=>{var c,d;return n==="inputs"?((c=Kf(a,e,t))==null?void 0:c.title)??null:((d=$c(a,e,t))==null?void 0:d.title)??null}),[t,n,e]);return b(o)},YO=({nodeId:e,fieldName:t})=>{const n=Rw(e,t),o=zw(e,t,"inputs"),{isValueChanged:r,onReset:a}=Nw(e,t);return s.jsxs(P,{layerStyle:"second",position:"relative",borderRadius:"base",w:"full",p:4,gap:"2",flexDir:"column",children:[s.jsxs(P,{alignItems:"center",children:[s.jsx(Y,{fontSize:"sm",children:n||o}),s.jsx(Tn,{}),r&&s.jsx(ve,{"aria-label":Te("nodes.resetToDefaultValue"),tooltip:Te("nodes.resetToDefaultValue"),variant:"ghost",size:"sm",onClick:a,icon:s.jsx(ca,{})}),s.jsx(Dt,{label:s.jsx(Yf,{nodeId:e,fieldName:t,kind:"inputs"}),openDelay:Ac,placement:"top",children:s.jsx(P,{h:"24px",alignItems:"center",children:s.jsx(gn,{fontSize:"md",color:"base.300",as:Rc})})})]}),s.jsx(k0,{nodeId:e,fieldName:t})]})},XO=u.memo(YO),JO=Ve(Go,e=>({fields:e.exposedFields,name:e.name})),eF=()=>{const{isLoading:e}=mg(),{fields:t}=b(JO);return s.jsx(Ae,{position:"relative",w:"full",h:"full",children:s.jsx(Wn,{children:s.jsx(P,{position:"relative",flexDir:"column",alignItems:"flex-start",p:1,gap:2,h:"full",w:"full",children:e?s.jsx(Ut,{label:Te("nodes.loadingNodes"),icon:null}):t.length?t.map(({nodeId:n,fieldName:o})=>s.jsx(XO,{nodeId:n,fieldName:o},`${n}.${o}`)):s.jsx(Xz,{})})})})},tF=Ve(Go,e=>{const{author:t,name:n,description:o,tags:r,version:a,contact:c,notes:d}=e;return{name:n,author:t,description:o,tags:r,version:a,contact:c,notes:d}}),nF=()=>{const{author:e,name:t,description:n,tags:o,version:r,contact:a,notes:c}=b(tF),d=O(),f=u.useCallback(M=>{d(jy(M.target.value))},[d]),m=u.useCallback(M=>{d(TM(M.target.value))},[d]),h=u.useCallback(M=>{d(RM(M.target.value))},[d]),g=u.useCallback(M=>{d(BM(M.target.value))},[d]),x=u.useCallback(M=>{d(NM(M.target.value))},[d]),C=u.useCallback(M=>{d(zM(M.target.value))},[d]),j=u.useCallback(M=>{d(OM(M.target.value))},[d]),{t:S}=L();return s.jsx(Wn,{children:s.jsx(P,{flexDir:"column",alignItems:"flex-start",gap:2,h:"full",children:s.jsxs(En,{orientation:"vertical",formControlProps:oF,children:[s.jsxs(P,{gap:2,w:"full",children:[s.jsxs($,{children:[s.jsx(Y,{children:S("nodes.workflowName")}),s.jsx(mn,{value:t,onChange:f})]}),s.jsxs($,{children:[s.jsx(Y,{children:S("nodes.workflowVersion")}),s.jsx(mn,{value:r,onChange:g})]})]}),s.jsxs(P,{gap:2,w:"full",children:[s.jsxs($,{children:[s.jsx(Y,{children:S("nodes.workflowAuthor")}),s.jsx(mn,{value:e,onChange:m})]}),s.jsxs($,{children:[s.jsx(Y,{children:S("nodes.workflowContact")}),s.jsx(mn,{value:a,onChange:h})]})]}),s.jsxs($,{children:[s.jsx(Y,{children:S("nodes.workflowTags")}),s.jsx(mn,{value:o,onChange:C})]}),s.jsxs($,{children:[s.jsx(Y,{children:S("nodes.workflowDescription")}),s.jsx(Oo,{onChange:x,value:n,fontSize:"sm",resize:"none",rows:3})]}),s.jsxs($,{children:[s.jsx(Y,{children:S("nodes.workflowNotes")}),s.jsx(Oo,{onChange:j,value:c,fontSize:"sm",resize:"none",rows:10})]})]})})})},sF=u.memo(nF),oF={flexShrink:0},il=Za(null),rF=r7(e=>{il.set(FM(e))},300),aF=it(lt,Go,(e,t)=>({nodes:e.nodes,edges:e.edges,workflow:t})),lF=()=>{const e=b(aF);u.useEffect(()=>{rF(e)},[e])},iF=()=>{const e=yt(il),{t}=L();return s.jsx(P,{flexDir:"column",alignItems:"flex-start",gap:2,h:"full",children:s.jsx(ta,{data:e??{},label:t("nodes.workflow")})})},cF=u.memo(iF);function I0(e,t,n){const o=e.slice();return o.splice(n<0?o.length+n:n,0,o.splice(t,1)[0]),o}function uF(e,t){return e.reduce((n,o,r)=>{const a=t.get(o);return a&&(n[r]=a),n},Array(e.length))}function od(e){return e!==null&&e>=0}function dF(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function fF(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Ow=e=>{let{rects:t,activeIndex:n,overIndex:o,index:r}=e;const a=I0(t,o,n),c=t[r],d=a[r];return!d||!c?null:{x:d.left-c.left,y:d.top-c.top,scaleX:d.width/c.width,scaleY:d.height/c.height}},rd={scaleX:1,scaleY:1},hF=e=>{var t;let{activeIndex:n,activeNodeRect:o,index:r,rects:a,overIndex:c}=e;const d=(t=a[n])!=null?t:o;if(!d)return null;if(r===n){const m=a[c];return m?{x:0,y:n<c?m.top+m.height-(d.top+d.height):m.top-d.top,...rd}:null}const f=mF(a,r,n);return r>n&&r<=c?{x:0,y:-d.height-f,...rd}:r<n&&r>=c?{x:0,y:d.height+f,...rd}:{x:0,y:0,...rd}};function mF(e,t,n){const o=e[t],r=e[t-1],a=e[t+1];return o?n<t?r?o.top-(r.top+r.height):a?a.top-(o.top+o.height):0:a?a.top-(o.top+o.height):r?o.top-(r.top+r.height):0:0}const Fw="Sortable",Vw=q.createContext({activeIndex:-1,containerId:Fw,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Ow,disabled:{draggable:!1,droppable:!1}});function pF(e){let{children:t,id:n,items:o,strategy:r=Ow,disabled:a=!1}=e;const{active:c,dragOverlay:d,droppableRects:f,over:m,measureDroppableContainers:h}=VM(),g=HM(Fw,n),x=d.rect!==null,C=u.useMemo(()=>o.map(A=>typeof A=="object"&&"id"in A?A.id:A),[o]),j=c!=null,S=c?C.indexOf(c.id):-1,M=m?C.indexOf(m.id):-1,I=u.useRef(C),k=!dF(C,I.current),D=M!==-1&&S===-1||k,T=fF(a);Sy(()=>{k&&j&&h(C)},[k,C,j,h]),u.useEffect(()=>{I.current=C},[C]);const E=u.useMemo(()=>({activeIndex:S,containerId:g,disabled:T,disableTransforms:D,items:C,overIndex:M,useDragOverlay:x,sortedRects:uF(C,f),strategy:r}),[S,g,T.draggable,T.droppable,D,C,M,f,x,r]);return q.createElement(Vw.Provider,{value:E},t)}const gF=e=>{let{id:t,items:n,activeIndex:o,overIndex:r}=e;return I0(n,o,r).indexOf(t)},xF=e=>{let{containerId:t,isSorting:n,wasDragging:o,index:r,items:a,newIndex:c,previousItems:d,previousContainerId:f,transition:m}=e;return!m||!o||d!==a&&r===c?!1:n?!0:c!==r&&t===f},vF={duration:200,easing:"ease"},Hw="transform",CF=pg.Transition.toString({property:Hw,duration:0,easing:"linear"}),yF={roleDescription:"sortable"};function bF(e){let{disabled:t,index:n,node:o,rect:r}=e;const[a,c]=u.useState(null),d=u.useRef(n);return Sy(()=>{if(!t&&n!==d.current&&o.current){const f=r.current;if(f){const m=GM(o.current,{ignoreTransform:!0}),h={x:f.left-m.left,y:f.top-m.top,scaleX:f.width/m.width,scaleY:f.height/m.height};(h.x||h.y)&&c(h)}}n!==d.current&&(d.current=n)},[t,n,o,r]),u.useEffect(()=>{a&&c(null)},[a]),a}function jF(e){let{animateLayoutChanges:t=xF,attributes:n,disabled:o,data:r,getNewIndex:a=gF,id:c,strategy:d,resizeObserverConfig:f,transition:m=vF}=e;const{items:h,containerId:g,activeIndex:x,disabled:C,disableTransforms:j,sortedRects:S,overIndex:M,useDragOverlay:I,strategy:k}=u.useContext(Vw),D=SF(o,C),T=h.indexOf(c),E=u.useMemo(()=>({sortable:{containerId:g,index:T,items:h},...r}),[g,r,T,h]),A=u.useMemo(()=>h.slice(h.indexOf(c)),[h,c]),{rect:N,node:W,isOver:G,setNodeRef:z}=_C({id:c,data:E,disabled:D.droppable,resizeObserverConfig:{updateMeasurementsFor:A,...f}}),{active:X,activatorEvent:B,activeNodeRect:Q,attributes:V,setNodeRef:H,listeners:me,isDragging:Ie,over:ye,setActivatorNodeRef:de,transform:He}=LC({id:c,data:E,attributes:{...yF,...n},disabled:D.draggable}),Be=$M(z,H),ce=!!X,ue=ce&&!j&&od(x)&&od(M),je=!I&&Ie,be=je&&ue?He:null,J=ue?be??(d??k)({rects:S,activeNodeRect:Q,activeIndex:x,overIndex:M,index:T}):null,F=od(x)&&od(M)?a({id:c,items:h,activeIndex:x,overIndex:M}):T,oe=X==null?void 0:X.id,le=u.useRef({activeId:oe,items:h,newIndex:F,containerId:g}),fe=h!==le.current.items,he=t({active:X,containerId:g,isDragging:Ie,isSorting:ce,id:c,index:T,items:h,newIndex:le.current.newIndex,previousItems:le.current.items,previousContainerId:le.current.containerId,transition:m,wasDragging:le.current.activeId!=null}),ke=bF({disabled:!he,index:T,node:W,rect:N});return u.useEffect(()=>{ce&&le.current.newIndex!==F&&(le.current.newIndex=F),g!==le.current.containerId&&(le.current.containerId=g),h!==le.current.items&&(le.current.items=h)},[ce,F,g,h]),u.useEffect(()=>{if(oe===le.current.activeId)return;if(oe&&!le.current.activeId){le.current.activeId=oe;return}const $e=setTimeout(()=>{le.current.activeId=oe},50);return()=>clearTimeout($e)},[oe]),{active:X,activeIndex:x,attributes:V,data:E,rect:N,index:T,newIndex:F,items:h,isOver:G,isSorting:ce,isDragging:Ie,listeners:me,node:W,overIndex:M,over:ye,setNodeRef:Be,setActivatorNodeRef:de,setDroppableNodeRef:z,setDraggableNodeRef:H,transform:ke??J,transition:ze()};function ze(){if(ke||fe&&le.current.newIndex===T)return CF;if(!(je&&!WM(B)||!m)&&(ce||he))return pg.Transition.toString({...m,property:Hw})}}function SF(e,t){var n,o;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(o=e==null?void 0:e.droppable)!=null?o:t.droppable}}Uu.Down,Uu.Right,Uu.Up,Uu.Left;const wF=e=>s.jsx(UM,{onDragEnd:e.onDragEnd,children:s.jsx(pF,{items:e.items,strategy:hF,children:e.children})}),kF=u.memo(wF),IF=({isSelected:e,isHovered:t})=>{const n=u.useMemo(()=>{if(e&&t)return"nodeHoveredSelected";if(e)return"nodeSelected";if(t)return"nodeHovered"},[t,e]);return s.jsx(Ae,{className:"selection-box",position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,borderRadius:"base",opacity:e||t?1:.5,transitionProperty:"common",transitionDuration:"0.1s",pointerEvents:"none",shadow:n})},$w=u.memo(IF),vd=Za(null),Ww=e=>{const[t,n]=u.useState(!1);u.useEffect(()=>vd.subscribe(c=>{n(c===e)}),[t,e]);const o=u.useCallback(()=>{vd.set(e)},[e]),r=u.useCallback(()=>{vd.set(null)},[]);return{isMouseOverNode:t,handleMouseOver:o,handleMouseOut:r}},MF=af((e,t)=>{const{nodeId:n,fieldName:o,kind:r,isMissingInput:a=!1,withTooltip:c=!1}=e,d=Rw(n,o),f=zw(n,o,r),{t:m}=L(),h=O(),[g,x]=u.useState(d||f||m("nodes.unknownField")),C=u.useCallback(async S=>{S&&(S===d||S===f)||(x(S||f||m("nodes.unknownField")),h(ZM({nodeId:n,fieldName:o,label:S})))},[d,f,h,n,o,m]),j=u.useCallback(S=>{x(S)},[]);return u.useEffect(()=>{x(d||f||m("nodes.unknownField"))},[d,f,m]),s.jsx(Dt,{label:c?s.jsx(Yf,{nodeId:n,fieldName:o,kind:"inputs"}):void 0,openDelay:Ac,children:s.jsxs(sf,{value:g,onChange:j,onSubmit:C,as:P,ref:t,position:"relative",overflow:"hidden",alignItems:"center",justifyContent:"flex-start",gap:1,w:"full",children:[s.jsx(of,{fontWeight:"semibold",sx:PF,noOfLines:1,color:a?"error.300":"base.300"}),s.jsx(rf,{className:"nodrag",sx:AF}),s.jsx(Gw,{})]})})}),AF={p:0,w:"full",fontWeight:"semibold",color:"base.100",_focusVisible:{p:0,textAlign:"left",boxShadow:"none"}},PF={p:0,textAlign:"left",_hover:{fontWeight:"semibold !important"}},Op=u.memo(MF),Gw=u.memo(()=>{const{isEditing:e,getEditButtonProps:t}=wy(),n=u.useCallback(o=>{const{onClick:r}=t();r&&(r(o),o.preventDefault())},[t]);return e?null:s.jsx(P,{onClick:n,position:"absolute",w:"full",h:"full",top:0,insetInlineStart:0,cursor:"text"})});Gw.displayName="EditableControls";const DF=({nodeId:e,fieldName:t})=>{const n=O(),{isValueChanged:o,onReset:r}=Nw(e,t),{isMouseOverNode:a,handleMouseOut:c,handleMouseOver:d}=Ww(e),{t:f}=L(),m=u.useCallback(()=>{n(ky({nodeId:e,fieldName:t}))},[n,t,e]),{attributes:h,listeners:g,setNodeRef:x,transform:C,transition:j}=jF({id:`${e}.${t}`}),S={transform:pg.Translate.toString(C),transition:j};return s.jsxs(P,{onMouseEnter:d,onMouseLeave:c,layerStyle:"second",alignItems:"center",position:"relative",borderRadius:"base",w:"full",p:4,paddingLeft:0,ref:x,style:S,children:[s.jsx(ve,{"aria-label":f("nodes.reorderLinearView"),variant:"ghost",icon:s.jsx(bD,{}),...g,...h,mx:2,height:"full"}),s.jsxs(P,{flexDir:"column",w:"full",children:[s.jsxs(P,{alignItems:"center",children:[s.jsx(Op,{nodeId:e,fieldName:t,kind:"inputs"}),s.jsx(Tn,{}),o&&s.jsx(ve,{"aria-label":f("nodes.resetToDefaultValue"),tooltip:f("nodes.resetToDefaultValue"),variant:"ghost",size:"sm",onClick:r,icon:s.jsx(ca,{})}),s.jsx(Dt,{label:s.jsx(Yf,{nodeId:e,fieldName:t,kind:"inputs"}),openDelay:Ac,placement:"top",children:s.jsx(P,{h:"full",alignItems:"center",children:s.jsx(gn,{fontSize:"sm",color:"base.300",as:Rc})})}),s.jsx(ve,{"aria-label":f("nodes.removeLinearView"),tooltip:f("nodes.removeLinearView"),variant:"ghost",size:"sm",onClick:m,icon:s.jsx(Xs,{})})]}),s.jsx(k0,{nodeId:e,fieldName:t}),s.jsx($w,{isSelected:!1,isHovered:a})]})]})},EF=u.memo(DF),_F=Ve(Go,e=>e.exposedFields),LF=()=>{const e=b(_F),{isLoading:t}=mg(),{t:n}=L(),o=O(),r=u.useCallback(a=>{const{active:c,over:d}=a,f=e.map(m=>`${m.nodeId}.${m.fieldName}`);if(d&&c.id!==d.id){const m=f.indexOf(c.id),h=f.indexOf(d.id),g=I0(f,m,h).map(x=>e.find(C=>`${C.nodeId}.${C.fieldName}`===x)).filter(x=>x);o(qM(g))}},[o,e]);return s.jsx(Ae,{position:"relative",w:"full",h:"full",children:s.jsx(Wn,{children:s.jsx(kF,{onDragEnd:r,items:e.map(a=>`${a.nodeId}.${a.fieldName}`),children:s.jsx(P,{position:"relative",flexDir:"column",alignItems:"flex-start",p:1,gap:2,h:"full",w:"full",children:t?s.jsx(Ut,{label:n("nodes.loadingNodes"),icon:null}):e.length?e.map(({nodeId:a,fieldName:c})=>s.jsx(EF,{nodeId:a,fieldName:c},`${a}.${c}`)):s.jsx(Ut,{label:n("nodes.noFieldsLinearview"),icon:null})})})})})},TF=u.memo(LF),RF=()=>{const{t:e}=L();return s.jsx(P,{layerStyle:"first",flexDir:"column",w:"full",h:"full",borderRadius:"base",p:2,gap:2,children:s.jsxs(Ja,{variant:"line",display:"flex",w:"full",h:"full",flexDir:"column",children:[s.jsxs(el,{children:[s.jsx(pn,{children:e("common.linear")}),s.jsx(pn,{children:e("common.details")}),s.jsx(pn,{children:"JSON"})]}),s.jsxs(ii,{children:[s.jsx(Pn,{children:s.jsx(TF,{})}),s.jsx(Pn,{children:s.jsx(sF,{})}),s.jsx(Pn,{children:s.jsx(cF,{})})]})]})})},BF=u.memo(RF),NF=e=>`${e.trim()} (copy)`,Wm=Za(!1),ad=Za(""),Gm=Za(!1),zF=it(Go,({name:e,id:t})=>t?e.length?NF(e):"":e),eh=()=>{const e=b(zF),t=yt(Wm),n=u.useCallback(()=>{ad.set(e),Wm.set(!0)},[e]),o=u.useCallback(()=>{Wm.set(!1),ad.set(""),Gm.set(!1)},[]),r=yt(ad),a=u.useCallback(f=>ad.set(f),[]),c=yt(Gm),d=u.useCallback(f=>{Gm.set(f)},[]);return{workflowName:r,setWorkflowName:a,shouldSaveToProject:c,setShouldSaveToProject:d,isOpen:t,onOpen:n,onClose:o}},M0=e=>!!e.id,Uw=()=>{const{t:e}=L(),t=O(),[n,o]=ez(),[r,a]=yw(),c=na(),d=u.useRef();return{saveWorkflow:u.useCallback(async()=>{const m=il.get();if(m){d.current=c({title:e("workflows.savingWorkflow"),status:"loading",duration:null,isClosable:!1});try{if(M0(m))await n(m).unwrap(),t(dz());else{const h=await r(m).unwrap();t(Iy(h.workflow.id))}t(My()),c.update(d.current,{title:e("workflows.workflowSaved"),status:"success",duration:1e3,isClosable:!0})}catch{!c.isActive(`auth-error-toast-${Ua.endpoints.createWorkflow.name}`)&&!c.isActive(`auth-error-toast-${Ua.endpoints.updateWorkflow.name}`)?c.update(d.current,{title:e("workflows.problemSavingWorkflow"),status:"error",duration:1e3,isClosable:!0}):c.close(d.current)}}},[n,t,c,e,r]),isLoading:o.isLoading||a.isLoading,isError:o.isError||a.isError}},OF=()=>{const{t:e}=L(),t=b(a=>a.workflow.isTouched),{onOpen:n}=eh(),{saveWorkflow:o}=Uw(),r=u.useCallback(async()=>{const a=il.get();a&&(M0(a)?o():n())},[n,o]);return s.jsx(ve,{tooltip:e("workflows.saveWorkflow"),"aria-label":e("workflows.saveWorkflow"),icon:s.jsx(Tc,{}),isDisabled:!t,onClick:r,pointerEvents:"auto"})},Zw=u.memo(OF),A0=u.memo(e=>{const{t}=L(),n=O(),{isOpen:o,onOpen:r,onClose:a}=fn(),c=b(m=>m.workflow.isTouched),d=u.useCallback(()=>{n(Ay()),n(Sd("edit")),n(Ze(pt({title:t("workflows.newWorkflowCreated"),status:"success"}))),a()},[n,a,t]),f=u.useCallback(()=>{if(!c){d();return}r()},[d,c,r]);return s.jsxs(s.Fragment,{children:[e.renderButton(f),s.jsx(sa,{isOpen:o,onClose:a,title:t("nodes.newWorkflow"),acceptCallback:d,children:s.jsxs(P,{flexDir:"column",gap:2,children:[s.jsx(re,{children:t("nodes.newWorkflowDesc")}),s.jsx(re,{variant:"subtext",children:t("nodes.newWorkflowDesc2")})]})})]})});A0.displayName="NewWorkflowConfirmationAlertDialog";const qw=u.memo(()=>{const{t:e}=L(),t=u.useCallback(n=>s.jsx(ve,{"aria-label":e("nodes.newWorkflow"),tooltip:e("nodes.newWorkflow"),icon:s.jsx(Gb,{}),onClick:n,pointerEvents:"auto"}),[e]);return s.jsx(A0,{renderButton:t})});qw.displayName="NewWorkflowButton";const FF=()=>{const e=O(),t=b(a=>a.workflow.mode),{t:n}=L(),o=u.useCallback(()=>{e(Sd("edit"))},[e]),r=u.useCallback(()=>{e(Sd("view"))},[e]);return s.jsxs(P,{justifyContent:"flex-end",children:[t==="view"&&s.jsx(ve,{"aria-label":n("nodes.editMode"),tooltip:n("nodes.editMode"),onClick:o,icon:s.jsx(GD,{}),colorScheme:"invokeBlue"}),t==="edit"&&s.jsx(ve,{"aria-label":n("nodes.viewMode"),tooltip:n("nodes.viewMode"),onClick:r,icon:s.jsx(Wb,{}),colorScheme:"invokeBlue"})]})},VF=Ve(Go,e=>({mode:e.mode})),HF=()=>{const{mode:e}=b(VF);return s.jsxs(P,{gap:"2",alignItems:"center",children:[e==="edit"&&s.jsx(Zw,{}),s.jsx(qw,{}),s.jsx(FF,{})]})},$F=Ve(Go,e=>({name:e.name,description:e.description,notes:e.notes,author:e.author,tags:e.tags})),WF=()=>{const{name:e,description:t,notes:n,author:o,tags:r}=b($F),{t:a}=L();return s.jsxs(P,{flexDir:"column",gap:"2",children:[!!e.length&&s.jsxs(Ae,{children:[s.jsx(re,{fontWeight:"semibold",children:a("nodes.workflowName")}),s.jsx(re,{opacity:.7,fontStyle:"oblique 5deg",children:e})]}),!!o.length&&s.jsxs(Ae,{children:[s.jsx(re,{fontWeight:"semibold",children:a("nodes.workflowAuthor")}),s.jsx(re,{opacity:.7,fontStyle:"oblique 5deg",children:o})]}),!!r.length&&s.jsxs(Ae,{children:[s.jsx(re,{fontWeight:"semibold",children:a("nodes.workflowTags")}),s.jsx(re,{opacity:.7,fontStyle:"oblique 5deg",children:r})]}),!!t.length&&s.jsxs(Ae,{children:[s.jsx(re,{fontWeight:"semibold",children:a("nodes.workflowDescription")}),s.jsx(re,{opacity:.7,fontStyle:"oblique 5deg",children:t})]}),!!n.length&&s.jsxs(Ae,{children:[s.jsx(re,{fontWeight:"semibold",children:a("nodes.workflowNotes")}),s.jsx(re,{opacity:.7,fontStyle:"oblique 5deg",children:n})]})]})},GF=u.memo(WF),UF=it(lt,e=>e.nodes.filter(Zr).some(t=>{const n=e.templates[t.data.type];return n?Cy(t,n):!1})),Qw=()=>b(UF),ZF=()=>{const{t:e}=L();return s.jsx(P,{flexDir:"column",gap:"2",children:s.jsxs(P,{flexDir:"column",gap:"2",children:[s.jsx(re,{fontWeight:"semibold",children:e("toast.loadedWithWarnings")}),s.jsxs(P,{flexDir:"column",children:[s.jsxs(re,{children:[e("common.toResolve"),":"]}),s.jsxs(re,{children:[e("nodes.editMode")," >> ",e("nodes.updateAllNodes")," >> ",e("common.save")]})]})]})})},qF=()=>Qw()?s.jsx(Dt,{label:s.jsx(ZF,{}),children:s.jsx(P,{h:"full",alignItems:"center",gap:"2",children:s.jsx(gn,{color:"warning.400",as:gf})})}):s.jsx(s.Fragment,{}),Kw=()=>{const{name:e,isTouched:t,mode:n}=b(r=>r.workflow),{t:o}=L();return s.jsxs(P,{gap:"1",alignItems:"center",children:[e.length?s.jsx(Dt,{label:s.jsx(GF,{}),placement:"top",children:s.jsx(re,{fontSize:"lg",userSelect:"none",noOfLines:1,wordBreak:"break-all",fontWeight:"semibold",children:e})}):s.jsx(re,{fontSize:"lg",fontStyle:"italic",fontWeight:"semibold",children:o("workflows.unnamedWorkflow")}),t&&n==="edit"&&s.jsx(Dt,{label:"Workflow has unsaved changes",children:s.jsx(P,{children:s.jsx(gn,{as:qD,boxSize:"20px",sx:{color:"invokeYellow.500"}})})}),s.jsx(qF,{})]})},QF={height:"100%",width:"100%"},KF=Ve(Go,e=>({mode:e.mode})),YF=()=>{const{mode:e}=b(KF),t=u.useRef(null),n=C0(),o=u.useCallback(()=>{t.current&&t.current.setLayout([50,50])},[]);return s.jsxs(P,{w:"full",h:"full",gap:2,flexDir:"column",children:[s.jsx(YS,{}),s.jsxs(P,{w:"full",justifyContent:"space-between",alignItems:"center",gap:"4",padding:1,children:[s.jsxs(P,{justifyContent:"space-between",alignItems:"center",gap:"4",children:[s.jsx(Mz,{}),s.jsx(Kw,{})]}),s.jsx(HF,{})]}),e==="view"&&s.jsx(eF,{}),e==="edit"&&s.jsxs(Qf,{ref:t,id:"workflow-panel-group",autoSaveId:"workflow-panel-group",direction:"vertical",style:QF,storage:n,children:[s.jsx(Ur,{id:"workflow",collapsible:!0,minSize:25,children:s.jsx(BF,{})}),s.jsx(Gd,{orientation:"horizontal",onDoubleClick:o}),s.jsx(Ur,{id:"inspector",collapsible:!0,minSize:25,children:s.jsx(Yz,{})})]})]})},XF=u.memo(YF),JF="data:image/svg+xml,%3csvg%20width='44'%20height='44'%20viewBox='0%200%2044%2044'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M29.1951%2010.6667H42V2H2V10.6667H14.8049L29.1951%2033.3333H42V42H2V33.3333H14.8049'%20stroke='%23E6FD13'%20stroke-width='2.8'/%3e%3c/svg%3e",eV=()=>{const{data:e}=Py(),t=u.useRef(null),n=yt(QM),o=u.useMemo(()=>e?s.jsxs(re,{fontWeight:"semibold",children:["v",e.version]}):null,[e]);return n||s.jsx(Dt,{placement:"right",label:o,p:1,px:2,gutter:16,children:s.jsx(Ks,{ref:t,src:JF,alt:"invoke-logo",w:"24px",h:"24px",minW:"24px",minH:"24px",userSelect:"none"})})},tV=u.memo(eV),Fp="http://github.com/invoke-ai/InvokeAI",Yw="https://discord.gg/ZmtBAhwWhy",kv="https://www.invoke.com/",nV="data:image/svg+xml,%3csvg%20width='231'%20height='100'%20viewBox='0%200%20231%20100'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_659_3578)'%3e%3crect%20width='100'%20height='100'%20fill='%23E6FD13'/%3e%3cpath%20d='M57.1951%2038.6667H70V30H30V38.6667H42.8049L57.1951%2061.3333H70V70H30V61.3333H42.8049'%20stroke='%23181818'%20stroke-width='2.8'/%3e%3crect%20width='131'%20height='100'%20transform='translate(100)'%20fill='%23E6FD13'/%3e%3cpath%20d='M111.37%2043.34H107.89V39.65H111.37V43.34ZM116.38%2060.5H102.76V58.16H108.22V47.84H103.36V45.5H111.07V58.16H116.38V60.5ZM120.538%2060.5V45.5H123.388V47.6C124.288%2046.25%20125.788%2045.2%20128.188%2045.2C131.638%2045.2%20133.588%2047.3%20133.588%2050.45V60.5H130.738V51.05C130.738%2048.95%20129.838%2047.6%20127.708%2047.6H127.468C125.338%2047.6%20123.388%2049.25%20123.388%2052.1V60.5H120.538ZM141.786%2060.5L136.236%2045.5H139.176L143.526%2057.71L147.876%2045.5H150.786L145.236%2060.5H141.786ZM159.723%2060.8C155.673%2060.8%20152.523%2057.65%20152.523%2053C152.523%2048.35%20155.673%2045.2%20159.723%2045.2C163.773%2045.2%20166.923%2048.35%20166.923%2053C166.923%2057.65%20163.773%2060.8%20159.723%2060.8ZM155.373%2053C155.373%2056.45%20157.173%2058.4%20159.603%2058.4H159.843C162.273%2058.4%20164.073%2056.45%20164.073%2053C164.073%2049.55%20162.273%2047.6%20159.843%2047.6H159.603C157.173%2047.6%20155.373%2049.55%20155.373%2053ZM170.804%2060.5V39.5H173.654V51.98L180.254%2045.5H184.004L177.764%2051.47L184.304%2060.5H180.794L175.724%2053.42L173.654%2055.43V60.5H170.804ZM192.459%2060.8C188.739%2060.8%20185.379%2058.22%20185.379%2052.97C185.379%2047.78%20188.829%2045.2%20192.369%2045.2C196.269%2045.2%20198.729%2047.9%20198.729%2051.8V53.45H188.229C188.409%2056.87%20190.599%2058.4%20192.429%2058.4H192.669C194.139%2058.4%20195.549%2057.65%20195.849%2056.06H198.699C198.159%2059.09%20195.549%2060.8%20192.459%2060.8ZM188.409%2051.2H195.879C195.759%2048.59%20194.199%2047.6%20192.489%2047.6H192.249C190.689%2047.6%20188.949%2048.53%20188.409%2051.2Z'%20fill='%23181818'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_659_3578'%3e%3crect%20width='231'%20height='100'%20rx='5'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",sV=({children:e})=>{const{isOpen:t,onOpen:n,onClose:o}=fn(),{t:r}=L(),{depsArray:a,depsObject:c}=KM(void 0,{selectFromResult:({data:m})=>({depsObject:m,depsArray:m?Us(m,(h,g)=>({name:g,version:h})):[]})}),{data:d}=Py(),f=u.useCallback(()=>{navigator.clipboard.writeText(JSON.stringify(c,null,2))},[c]);return s.jsxs(s.Fragment,{children:[u.cloneElement(e,{onClick:n}),s.jsxs(Fa,{isOpen:t,onClose:o,isCentered:!0,size:"2xl",children:[s.jsx(mr,{}),s.jsxs(Va,{maxH:"80vh",h:"34rem",children:[s.jsx(pr,{children:r("accessibility.about")}),s.jsx(ri,{}),s.jsx(gr,{display:"flex",flexDir:"column",gap:4,children:s.jsxs(Nl,{templateColumns:"repeat(2, 1fr)",h:"full",children:[s.jsx(zr,{backgroundColor:"base.750",borderRadius:"base",p:"4",h:"full",children:s.jsxs(Wn,{children:[s.jsxs(P,{position:"sticky",top:"0",backgroundColor:"base.750",p:1,alignItems:"center",children:[s.jsx(sn,{size:"md",children:r("common.localSystem")}),s.jsx(Tn,{}),s.jsx(Dt,{label:r("common.copy"),children:s.jsx(ve,{onClick:f,isDisabled:!c,"aria-label":r("common.copy"),icon:s.jsx(nl,{}),variant:"ghost"})})]}),a.map(({name:m,version:h},g)=>s.jsxs(Nl,{py:"2",px:"1",w:"full",templateColumns:"repeat(2, 1fr)",children:[s.jsx(re,{children:m}),s.jsx(re,{children:h||r("common.notInstalled")})]},g))]})}),s.jsx(zr,{children:s.jsxs(P,{flexDir:"column",gap:3,justifyContent:"center",alignItems:"center",h:"full",children:[s.jsx(Ks,{src:nV,alt:"invoke-logo",w:"120px"}),d&&s.jsx(re,{children:`v${d==null?void 0:d.version}`}),s.jsxs(Nl,{templateColumns:"repeat(2, 1fr)",gap:"3",children:[s.jsx(zr,{children:s.jsx(fd,{href:Fp,label:r("common.githubLabel")})}),s.jsx(zr,{children:s.jsx(fd,{href:Yw,label:r("common.discordLabel")})})]}),s.jsx(sn,{fontSize:"large",children:r("common.aboutHeading")}),s.jsx(re,{fontSize:"sm",children:r("common.aboutDesc")}),s.jsx(fd,{href:kv,label:kv})]})})]})}),s.jsx(Ha,{})]})]})]})},oV=u.memo(sV),rV=()=>{const{t:e}=L(),t=u.useMemo(()=>({title:e("hotkeys.appHotkeys"),hotkeyListItems:[{title:e("hotkeys.invoke.title"),desc:e("hotkeys.invoke.desc"),hotkeys:[["Ctrl","Enter"]]},{title:e("hotkeys.cancel.title"),desc:e("hotkeys.cancel.desc"),hotkeys:[["Shift","X"]]},{title:e("hotkeys.cancelAndClear.title"),desc:e("hotkeys.cancelAndClear.desc"),hotkeys:[["Shift","Ctrl","X"],["Shift","Cmd","X"]]},{title:e("hotkeys.focusPrompt.title"),desc:e("hotkeys.focusPrompt.desc"),hotkeys:[["Alt","A"]]},{title:e("hotkeys.toggleOptions.title"),desc:e("hotkeys.toggleOptions.desc"),hotkeys:[["T"],["O"]]},{title:e("hotkeys.toggleGallery.title"),desc:e("hotkeys.toggleGallery.desc"),hotkeys:[["G"]]},{title:e("hotkeys.toggleOptionsAndGallery.title"),desc:e("hotkeys.toggleOptionsAndGallery.desc"),hotkeys:[["F"]]},{title:e("hotkeys.resetOptionsAndGallery.title"),desc:e("hotkeys.resetOptionsAndGallery.desc"),hotkeys:[["Shift","R"]]},{title:e("hotkeys.maximizeWorkSpace.title"),desc:e("hotkeys.maximizeWorkSpace.desc"),hotkeys:[["F"]]},{title:e("hotkeys.changeTabs.title"),desc:e("hotkeys.changeTabs.desc"),hotkeys:[["1 - 6"]]}]}),[e]),n=u.useMemo(()=>({title:e("hotkeys.generalHotkeys"),hotkeyListItems:[{title:e("hotkeys.remixImage.title"),desc:e("hotkeys.remixImage.desc"),hotkeys:[["R"]]},{title:e("hotkeys.setPrompt.title"),desc:e("hotkeys.setPrompt.desc"),hotkeys:[["P"]]},{title:e("hotkeys.setSeed.title"),desc:e("hotkeys.setSeed.desc"),hotkeys:[["S"]]},{title:e("hotkeys.setParameters.title"),desc:e("hotkeys.setParameters.desc"),hotkeys:[["A"]]},{title:e("hotkeys.upscale.title"),desc:e("hotkeys.upscale.desc"),hotkeys:[["Shift","U"]]},{title:e("hotkeys.showInfo.title"),desc:e("hotkeys.showInfo.desc"),hotkeys:[["I"]]},{title:e("hotkeys.sendToImageToImage.title"),desc:e("hotkeys.sendToImageToImage.desc"),hotkeys:[["Shift","I"]]},{title:e("hotkeys.deleteImage.title"),desc:e("hotkeys.deleteImage.desc"),hotkeys:[["Del"]]}]}),[e]),o=u.useMemo(()=>({title:e("hotkeys.galleryHotkeys"),hotkeyListItems:[{title:e("hotkeys.previousImage.title"),desc:e("hotkeys.previousImage.desc"),hotkeys:[["Arrow Left"]]},{title:e("hotkeys.nextImage.title"),desc:e("hotkeys.nextImage.desc"),hotkeys:[["Arrow Right"]]},{title:e("hotkeys.increaseGalleryThumbSize.title"),desc:e("hotkeys.increaseGalleryThumbSize.desc"),hotkeys:[["Shift","Up"]]},{title:e("hotkeys.decreaseGalleryThumbSize.title"),desc:e("hotkeys.decreaseGalleryThumbSize.desc"),hotkeys:[["Shift","Down"]]}]}),[e]),r=u.useMemo(()=>({title:e("hotkeys.unifiedCanvasHotkeys"),hotkeyListItems:[{title:e("hotkeys.selectBrush.title"),desc:e("hotkeys.selectBrush.desc"),hotkeys:[["B"]]},{title:e("hotkeys.selectEraser.title"),desc:e("hotkeys.selectEraser.desc"),hotkeys:[["E"]]},{title:e("hotkeys.decreaseBrushSize.title"),desc:e("hotkeys.decreaseBrushSize.desc"),hotkeys:[["["]]},{title:e("hotkeys.increaseBrushSize.title"),desc:e("hotkeys.increaseBrushSize.desc"),hotkeys:[["]"]]},{title:e("hotkeys.decreaseBrushOpacity.title"),desc:e("hotkeys.decreaseBrushOpacity.desc"),hotkeys:[["Shift","["]]},{title:e("hotkeys.increaseBrushOpacity.title"),desc:e("hotkeys.increaseBrushOpacity.desc"),hotkeys:[["Shift","]"]]},{title:e("hotkeys.moveTool.title"),desc:e("hotkeys.moveTool.desc"),hotkeys:[["V"]]},{title:e("hotkeys.fillBoundingBox.title"),desc:e("hotkeys.fillBoundingBox.desc"),hotkeys:[["Shift","F"]]},{title:e("hotkeys.eraseBoundingBox.title"),desc:e("hotkeys.eraseBoundingBox.desc"),hotkeys:[["Delete","Backspace"]]},{title:e("hotkeys.colorPicker.title"),desc:e("hotkeys.colorPicker.desc"),hotkeys:[["C"]]},{title:e("hotkeys.toggleSnap.title"),desc:e("hotkeys.toggleSnap.desc"),hotkeys:[["N"]]},{title:e("hotkeys.quickToggleMove.title"),desc:e("hotkeys.quickToggleMove.desc"),hotkeys:[["Hold Space"]]},{title:e("hotkeys.toggleLayer.title"),desc:e("hotkeys.toggleLayer.desc"),hotkeys:[["Q"]]},{title:e("hotkeys.clearMask.title"),desc:e("hotkeys.clearMask.desc"),hotkeys:[["Shift","C"]]},{title:e("hotkeys.hideMask.title"),desc:e("hotkeys.hideMask.desc"),hotkeys:[["H"]]},{title:e("hotkeys.showHideBoundingBox.title"),desc:e("hotkeys.showHideBoundingBox.desc"),hotkeys:[["Shift","H"]]},{title:e("hotkeys.mergeVisible.title"),desc:e("hotkeys.mergeVisible.desc"),hotkeys:[["Shift","M"]]},{title:e("hotkeys.saveToGallery.title"),desc:e("hotkeys.saveToGallery.desc"),hotkeys:[["Shift","S"]]},{title:e("hotkeys.copyToClipboard.title"),desc:e("hotkeys.copyToClipboard.desc"),hotkeys:[["Ctrl","C"]]},{title:e("hotkeys.downloadImage.title"),desc:e("hotkeys.downloadImage.desc"),hotkeys:[["Shift","D"]]},{title:e("hotkeys.undoStroke.title"),desc:e("hotkeys.undoStroke.desc"),hotkeys:[["Ctrl","Z"]]},{title:e("hotkeys.redoStroke.title"),desc:e("hotkeys.redoStroke.desc"),hotkeys:[["Ctrl","Shift","Z"],["Ctrl","Y"]]},{title:e("hotkeys.resetView.title"),desc:e("hotkeys.resetView.desc"),hotkeys:[["R"]]},{title:e("hotkeys.previousStagingImage.title"),desc:e("hotkeys.previousStagingImage.desc"),hotkeys:[["Arrow Left"]]},{title:e("hotkeys.nextStagingImage.title"),desc:e("hotkeys.nextStagingImage.desc"),hotkeys:[["Arrow Right"]]},{title:e("hotkeys.acceptStagingImage.title"),desc:e("hotkeys.acceptStagingImage.desc"),hotkeys:[["Enter"]]}]}),[e]),a=u.useMemo(()=>({title:e("hotkeys.nodesHotkeys"),hotkeyListItems:[{title:e("hotkeys.addNodes.title"),desc:e("hotkeys.addNodes.desc"),hotkeys:[["Shift","A"],["Space"]]}]}),[e]);return u.useMemo(()=>[t,n,o,r,a],[t,n,o,r,a])},Xw=u.memo(e=>s.jsx(P,{ps:2,pb:4,position:"sticky",zIndex:1,top:0,bg:"base.800",sx:e.sx,children:s.jsx(sn,{size:"sm",children:e.title})}));Xw.displayName="StickyScrollableHeading";const Jw=u.memo(e=>s.jsx(P,{p:4,borderRadius:"base",bg:"base.750",flexDir:"column",gap:4,sx:e.sx,children:e.children}));Jw.displayName="StickyScrollableContent";const ar=u.memo(e=>s.jsxs(P,{flexDir:"column",children:[s.jsx(Xw,{title:e.title,sx:e.headingSx}),s.jsx(Jw,{sx:e.contentSx,children:e.children})]},e.title));ar.displayName="StickyScrollable";const aV=e=>{const{t}=L(),{title:n,hotkeys:o,description:r}=e;return s.jsxs(P,{flexDir:"column",gap:2,px:2,children:[s.jsxs(P,{lineHeight:1,gap:1,alignItems:"center",children:[s.jsx(re,{fontWeight:"semibold",children:n}),s.jsx(Tn,{}),o.map((a,c)=>s.jsxs(u.Fragment,{children:[a.map((d,f)=>s.jsxs(s.Fragment,{children:[s.jsx(YM,{textTransform:"lowercase",children:d},`${a}-${d}-${f}`),f!==a.length-1&&s.jsx(re,{as:"span",fontWeight:"semibold",children:"+"})]})),c!==o.length-1&&s.jsx(re,{as:"span",px:2,variant:"subtext",fontWeight:"semibold",children:t("common.or")})]},`${a}-${c}`))]}),s.jsx(re,{variant:"subtext",children:r})]})},lV=u.memo(aV),iV=({children:e})=>{const{isOpen:t,onOpen:n,onClose:o}=fn(),{t:r}=L(),[a,c]=u.useState(""),d=u.useCallback(()=>c(""),[]),f=u.useCallback(g=>c(g.target.value),[]),m=rV(),h=u.useMemo(()=>{if(!a.trim().length)return m;const g=a.trim().toLowerCase(),x=[];return m.forEach(C=>{const j={title:C.title,hotkeyListItems:[]};C.hotkeyListItems.forEach(S=>{(S.title.toLowerCase().includes(g)||S.desc.toLowerCase().includes(g)||S.hotkeys.some(M=>M.some(I=>I.toLowerCase().includes(g))))&&j.hotkeyListItems.push(S)}),j.hotkeyListItems.length&&x.push(j)}),x},[m,a]);return s.jsxs(s.Fragment,{children:[u.cloneElement(e,{onClick:n}),s.jsxs(Fa,{isOpen:t,onClose:o,isCentered:!0,size:"2xl",children:[s.jsx(mr,{}),s.jsxs(Va,{maxH:"80vh",h:"80vh",children:[s.jsx(pr,{children:r("hotkeys.keyboardShortcuts")}),s.jsx(ri,{}),s.jsxs(gr,{display:"flex",flexDir:"column",gap:4,children:[s.jsxs(qa,{children:[s.jsx(mn,{placeholder:r("hotkeys.searchHotkeys"),value:a,onChange:f}),a.length&&s.jsx(Qa,{h:"full",pe:2,children:s.jsx(ve,{onClick:d,size:"sm",variant:"ghost","aria-label":r("hotkeys.clearSearch"),boxSize:4,icon:s.jsx($n,{})})})]}),s.jsx(Wn,{children:s.jsxs(P,{flexDir:"column",gap:4,children:[h.map(g=>s.jsx(ar,{title:g.title,children:g.hotkeyListItems.map((x,C)=>s.jsxs(u.Fragment,{children:[s.jsx(lV,{title:x.title,description:x.desc,hotkeys:x.hotkeys}),C<g.hotkeyListItems.length-1&&s.jsx(An,{})]},C))},g.title)),!h.length&&s.jsx(Ut,{label:r("hotkeys.noHotkeysFound"),icon:null})]})})]}),s.jsx(Ha,{})]})]})]})},cV=u.memo(iV),uV=e=>{const{t}=L(),n=O(),{data:o,refetch:r}=XM(void 0,{refetchOnMountOrArgChange:!0,skip:!e}),[a,{isLoading:c}]=JM(),{data:d}=$o(),f=u.useMemo(()=>!!(d&&(d.queue.in_progress>0||d.queue.pending>0)),[d]),m=u.useCallback(()=>{f||a().unwrap().then(h=>{n(e8()),n(Dy()),n(Ze({title:t("settings.intermediatesCleared",{count:h}),status:"info"}))}).catch(()=>{n(Ze({title:t("settings.intermediatesClearedFailed"),status:"error"}))})},[t,a,n,f]);return{intermediatesCount:o,clearIntermediates:m,isLoading:c,hasPendingItems:f,refetchIntermediatesCount:r}},dV=uf.enum(["ar","az","de","en","es","fi","fr","he","hu","it","ja","ko","nl","pl","pt","pt_BR","ru","sv","tr","ua","zh_CN","zh_Hant"]),fV=e=>dV.safeParse(e).success,hV={ar:"العربية",az:"Azərbaycan dili",de:"Deutsch",en:"English",es:"Español",fi:"Suomi",fr:"Français",he:"עִבְֿרִית",hu:"Magyar Nyelv",it:"Italiano",ja:"日本語",ko:"한국어",nl:"Nederlands",pl:"Polski",pt:"Português",pt_BR:"Português do Brasil",ru:"Русский",sv:"Svenska",tr:"Türkçe",ua:"Украї́нська",zh_CN:"简体中文",zh_Hant:"漢語"},Iv=Us(hV,(e,t)=>({label:e,value:t})),ek=u.memo(()=>{const{t:e}=L(),t=O(),n=b(c=>c.system.language),o=cn("localization").isFeatureEnabled,r=u.useMemo(()=>Iv.find(c=>c.value===n),[n]),a=u.useCallback(c=>{fV(c==null?void 0:c.value)&&t(t8(c.value))},[t]);return s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:e("common.languagePickerLabel")}),s.jsx(ot,{value:r,options:Iv,onChange:a})]})});ek.displayName="SettingsLanguageSelect";const tk=u.memo(()=>{const{t:e}=L(),t=O(),n=b(d=>d.system.consoleLogLevel),o=b(d=>d.system.shouldLogToConsole),r=u.useMemo(()=>n8.options.map(d=>({label:d,value:d})),[]),a=u.useMemo(()=>r.find(d=>d.value===n),[n,r]),c=u.useCallback(d=>{s8(d==null?void 0:d.value)&&t(o8(d.value))},[t]);return s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:e("common.loglevel")}),s.jsx(ot,{value:a,options:r,onChange:c})]})});tk.displayName="SettingsLogLevelSelect";const mV=({children:e,config:t})=>{const n=O(),{t:o}=L(),[r,a]=u.useState(3),c=(t==null?void 0:t.shouldShowDeveloperSettings)??!0,d=(t==null?void 0:t.shouldShowResetWebUiText)??!0,f=(t==null?void 0:t.shouldShowClearIntermediates)??!0,m=(t==null?void 0:t.shouldShowLocalizationToggle)??!0;u.useEffect(()=>{c||n(Hx(!1))},[c,n]);const{isNSFWCheckerAvailable:h,isWatermarkerAvailable:g}=Ey(void 0,{selectFromResult:({data:F})=>({isNSFWCheckerAvailable:(F==null?void 0:F.nsfw_methods.includes("nsfw_checker"))??!1,isWatermarkerAvailable:(F==null?void 0:F.watermarking_methods.includes("invisible_watermark"))??!1})}),{clearIntermediates:x,hasPendingItems:C,intermediatesCount:j,isLoading:S,refetchIntermediatesCount:M}=uV(f),{isOpen:I,onOpen:k,onClose:D}=fn(),{isOpen:T,onOpen:E,onClose:A}=fn(),N=b(F=>F.generation.shouldUseCpuNoise),W=b(F=>F.system.shouldConfirmOnDelete),G=b(F=>F.system.enableImageDebugging),z=b(F=>F.ui.shouldShowProgressInViewer),X=b(F=>F.system.shouldLogToConsole),B=b(F=>F.system.shouldAntialiasProgressImage),Q=b(F=>F.system.shouldUseNSFWChecker),V=b(F=>F.system.shouldUseWatermarker),H=b(F=>F.system.shouldEnableInformationalPopovers),me=Cb(),Ie=u.useCallback(()=>{f&&M(),k()},[k,M,f]),ye=u.useCallback(()=>{me(),D(),E(),setInterval(()=>a(F=>F-1),1e3)},[me,D,E]);u.useEffect(()=>{r<=0&&window.location.reload()},[r]);const de=u.useCallback(F=>{n(Hx(F.target.checked))},[n]),He=u.useCallback(F=>{n(SC(F.target.checked))},[n]),Be=u.useCallback(F=>{n(r8(F.target.checked))},[n]),ce=u.useCallback(F=>{n(a8(F.target.checked))},[n]),ue=u.useCallback(F=>{n(_y(F.target.checked))},[n]),je=u.useCallback(F=>{n(l8(F.target.checked))},[n]),be=u.useCallback(F=>{n(i8(F.target.checked))},[n]),ee=u.useCallback(F=>{n(c8(F.target.checked))},[n]),J=u.useCallback(F=>{n(u8(F.target.checked))},[n]);return s.jsxs(s.Fragment,{children:[u.cloneElement(e,{onClick:Ie}),s.jsxs(Fa,{isOpen:I,onClose:D,size:"2xl",isCentered:!0,children:[s.jsx(mr,{}),s.jsxs(Va,{maxH:"80vh",h:"68rem",children:[s.jsx(pr,{bg:"none",children:o("common.settingsLabel")}),s.jsx(ri,{}),s.jsx(gr,{display:"flex",flexDir:"column",gap:4,children:s.jsx(Wn,{children:s.jsx(P,{flexDir:"column",gap:4,children:s.jsxs(En,{formLabelProps:{flexGrow:1},children:[s.jsx(ar,{title:o("settings.general"),children:s.jsxs($,{children:[s.jsx(Y,{children:o("settings.confirmOnDelete")}),s.jsx(jt,{isChecked:W,onChange:He})]})}),s.jsxs(ar,{title:o("settings.generation"),children:[s.jsxs($,{isDisabled:!h,children:[s.jsx(Y,{children:o("settings.enableNSFWChecker")}),s.jsx(jt,{isChecked:Q,onChange:Be})]}),s.jsxs($,{isDisabled:!g,children:[s.jsx(Y,{children:o("settings.enableInvisibleWatermark")}),s.jsx(jt,{isChecked:V,onChange:ce})]})]}),s.jsxs(ar,{title:o("settings.ui"),children:[s.jsxs($,{children:[s.jsx(Y,{children:o("settings.showProgressInViewer")}),s.jsx(jt,{isChecked:z,onChange:ue})]}),s.jsxs($,{children:[s.jsx(Y,{children:o("settings.antialiasProgressImages")}),s.jsx(jt,{isChecked:B,onChange:je})]}),s.jsxs($,{children:[s.jsx(Ke,{feature:"noiseUseCPU",inPortal:!1,children:s.jsx(Y,{children:o("parameters.useCpuNoise")})}),s.jsx(jt,{isChecked:N,onChange:J})]}),m&&s.jsx(ek,{}),s.jsxs($,{children:[s.jsx(Y,{children:o("settings.enableInformationalPopovers")}),s.jsx(jt,{isChecked:H,onChange:be})]})]}),c&&s.jsxs(ar,{title:o("settings.developer"),children:[s.jsxs($,{children:[s.jsx(Y,{children:o("settings.shouldLogToConsole")}),s.jsx(jt,{isChecked:X,onChange:de})]}),s.jsx(tk,{}),s.jsxs($,{children:[s.jsx(Y,{children:o("settings.enableImageDebugging")}),s.jsx(jt,{isChecked:G,onChange:ee})]})]}),f&&s.jsxs(ar,{title:o("settings.clearIntermediates"),children:[s.jsx(qe,{tooltip:C?o("settings.clearIntermediatesDisabled"):void 0,colorScheme:"warning",onClick:x,isLoading:S,isDisabled:!j||C,children:o("settings.clearIntermediatesWithCount",{count:j??0})}),s.jsx(re,{fontWeight:"bold",children:o("settings.clearIntermediatesDesc1")}),s.jsx(re,{variant:"subtext",children:o("settings.clearIntermediatesDesc2")}),s.jsx(re,{variant:"subtext",children:o("settings.clearIntermediatesDesc3")})]}),s.jsxs(ar,{title:o("settings.resetWebUI"),children:[s.jsx(qe,{colorScheme:"error",onClick:ye,children:o("settings.resetWebUI")}),d&&s.jsxs(s.Fragment,{children:[s.jsx(re,{variant:"subtext",children:o("settings.resetWebUIDesc1")}),s.jsx(re,{variant:"subtext",children:o("settings.resetWebUIDesc2")})]})]})]})})})}),s.jsx(Ha,{})]})]}),s.jsxs(Fa,{closeOnOverlayClick:!1,isOpen:T,onClose:A,isCentered:!0,closeOnEsc:!1,children:[s.jsx(mr,{backdropFilter:"blur(40px)"}),s.jsxs(Va,{children:[s.jsx(pr,{}),s.jsx(gr,{children:s.jsx(P,{justifyContent:"center",children:s.jsx(re,{fontSize:"lg",children:s.jsxs(re,{children:[o("settings.resetComplete")," ",o("settings.reloadingIn")," ",r,"..."]})})})}),s.jsx(Ha,{})]})]})]})},pV=u.memo(mV),gV=()=>{const{t:e}=L(),{isOpen:t,onOpen:n,onClose:o}=fn();df(o);const r=cn("bugLink").isFeatureEnabled,a=cn("discordLink").isFeatureEnabled,c=cn("githubLink").isFeatureEnabled;return s.jsxs(Ic,{isOpen:t,onOpen:n,onClose:o,children:[s.jsx(Mc,{as:ve,variant:"link","aria-label":e("accessibility.menu"),icon:s.jsx(Wj,{fontSize:20}),boxSize:8}),s.jsxs(qr,{children:[s.jsxs(dd,{title:e("common.communityLabel"),children:[c&&s.jsx(ut,{as:"a",href:Fp,target:"_blank",icon:s.jsx(I_,{}),children:e("common.githubLabel")}),r&&s.jsx(ut,{as:"a",href:`${Fp}/issues`,target:"_blank",icon:s.jsx(gD,{}),children:e("common.reportBugLabel")}),a&&s.jsx(ut,{as:"a",href:Yw,target:"_blank",icon:s.jsx(k_,{}),children:e("common.discordLabel")})]}),s.jsxs(dd,{title:e("common.settingsLabel"),children:[s.jsx(cV,{children:s.jsx(ut,{as:"button",icon:s.jsx(RD,{}),children:e("common.hotkeysLabel")})}),s.jsx(pV,{children:s.jsx(ut,{as:"button",icon:s.jsx(YD,{}),children:e("common.settingsLabel")})})]}),s.jsx(dd,{title:e("accessibility.about"),children:s.jsx(oV,{children:s.jsx(ut,{as:"button",icon:s.jsx(Rc,{}),children:e("accessibility.about")})})})]})]})},xV=u.memo(gV),vV=()=>{const e=b(n=>n.system.isConnected),{t}=L();return e?null:s.jsx(Dt,{label:t("common.statusDisconnected"),placement:"end",shouldWrapChildren:!0,gutter:10,children:s.jsx(gn,{as:gf,color:"error.300"})})},CV=u.memo(vV),yV=e=>{const{t}=L();return e.panelApi.isCollapsed?s.jsx(Jp,{children:s.jsx(P,{pos:"absolute",transform:"translate(0, -50%)",minW:8,top:"50%",insetInlineEnd:"21px",children:s.jsx(Dt,{label:t("accessibility.showGalleryPanel"),placement:"start",children:s.jsx(ve,{"aria-label":t("accessibility.showGalleryPanel"),onClick:e.panelApi.expand,icon:s.jsx(TD,{size:"20px"}),p:0,h:48,borderEndRadius:0})})})}):null},bV=u.memo(yV),jV=({sx:e})=>{const{t}=L(),{cancelQueueItem:n,isLoading:o,isDisabled:r}=kg();return s.jsx(ve,{isDisabled:r,isLoading:o,"aria-label":t("queue.cancel"),tooltip:t("queue.cancelTooltip"),icon:s.jsx($n,{size:"16px"}),onClick:n,colorScheme:"error",sx:e})},SV=u.memo(jV),ld={borderStartRadius:0,flexGrow:1},wV=e=>{const{t}=L(),{queueBack:n,isLoading:o,isDisabled:r}=Mg(),{data:a}=$o(),c=u.useMemo(()=>!r&&(a!=null&&a.processor.is_processing)?s.jsx(gn,{boxSize:6,as:vD,animation:Ly}):s.jsx(_f,{size:"16px"}),[r,a==null?void 0:a.processor.is_processing]),d=fn();return e.panelApi.isCollapsed?s.jsx(Jp,{children:s.jsxs(P,{pos:"absolute",transform:"translate(0, -50%)",minW:8,top:"50%",insetInlineStart:"63px",direction:"column",gap:2,h:48,children:[s.jsxs(Nt,{orientation:"vertical",flexGrow:3,children:[s.jsx(ve,{tooltip:t("accessibility.showOptionsPanel"),"aria-label":t("accessibility.showOptionsPanel"),onClick:e.panelApi.expand,sx:ld,icon:s.jsx(Yb,{size:"16px"})}),s.jsx(ve,{"aria-label":t("queue.queueBack"),onClick:n,isLoading:o,isDisabled:r,icon:c,colorScheme:"invokeYellow",tooltip:s.jsx(Hf,{}),sx:ld}),s.jsx(SV,{sx:ld})]}),s.jsx(GS,{sx:ld,onOpen:d.onOpen}),s.jsx(Vf,{disclosure:d})]})}):null},kV=u.memo(wV),Mv=e=>{const t=u.useRef(null),[n,o]=u.useState(e.unit==="percentages"?e.minSize:0);u.useLayoutEffect(()=>{var D;if(e.unit==="percentages"||!e.panelGroupRef.current)return;const j=e.panelGroupRef.current.getId(),S=Zf(j),M=Ga(j);if(!S)return;const I=new ResizeObserver(()=>{if(!(t!=null&&t.current))return;const T=Um(e.minSize,e.panelGroupRef,e.panelGroupDirection);o(T),t.current.resize(T)});I.observe(S),M.forEach(T=>I.observe(T));const k=Um(e.minSize,e.panelGroupRef,e.panelGroupDirection);return(D=t.current)==null||D.resize(k),()=>{I.disconnect()}},[e]);const[r,a]=u.useState(()=>{var j;return!!((j=t.current)!=null&&j.isCollapsed())}),c=u.useCallback(()=>{a(!0)},[]),d=u.useCallback(()=>{a(!1)},[]),f=u.useCallback(()=>{var j,S,M;(j=t.current)!=null&&j.isCollapsed()?(S=t.current)==null||S.expand():(M=t.current)==null||M.collapse()},[]),m=u.useCallback(()=>{var j;(j=t.current)==null||j.expand()},[]),h=u.useCallback(()=>{var j;(j=t.current)==null||j.collapse()},[]),g=u.useCallback(j=>{var M,I;if(e.unit==="percentages"){(M=t.current)==null||M.resize(j);return}const S=Um(j,e.panelGroupRef,e.panelGroupDirection);(I=t.current)==null||I.resize(S)},[e]),x=u.useCallback(()=>{var j;(j=t.current)==null||j.resize(n)},[n]),C=u.useCallback(()=>{var j,S;if(Math.abs((((j=t.current)==null?void 0:j.getSize())??0)-n)<.01){h();return}(S=t.current)==null||S.resize(n)},[n,h]);return{ref:t,minSize:n,isCollapsed:r,onCollapse:c,onExpand:d,reset:x,toggle:f,expand:m,collapse:h,resize:g,onDoubleClickHandle:C}},Um=(e,t,n)=>{if(!t.current)return 0;const o=t.current.getId(),r=Zf(o);if(!r)return 0;let a=n==="horizontal"?r.offsetWidth:r.offsetHeight;return Ga(o).forEach(c=>{a-=n==="horizontal"?c.offsetWidth:c.offsetHeight}),e/a*100},Wc=u.memo(e=>s.jsx(P,{pos:"absolute",insetBlockStart:0,insetInlineEnd:0,flexDir:"column",p:2,gap:2,alignItems:"center",justifyContent:"center",children:e.children}));Wc.displayName="PromptOverlayButtonWrapper";const Gc=u.memo(e=>{const{onOpen:t,isOpen:n}=e,{t:o}=L();return s.jsx(Dt,{label:o("prompt.addPromptTrigger"),children:s.jsx(ve,{variant:"promptOverlay",isDisabled:n,"aria-label":o("prompt.addPromptTrigger"),icon:s.jsx(CD,{}),onClick:t})})});Gc.displayName="AddPromptTriggerButton";const IV=()=>Te("prompt.noMatchingTriggers"),MV=Ve(ff,e=>e.loras),AV=Ve(bs,e=>e.model),nk=u.memo(({onSelect:e,onClose:t})=>{const{t:n}=L(),o=b(AV),r=b(MV),{data:a,isLoading:c}=vo((o==null?void 0:o.key)??Ot),[d,{isLoading:f}]=Df(),[m,{isLoading:h}]=Hj(),g=u.useCallback(C=>{if(!C){e("");return}e(C.value)},[e]),x=u.useMemo(()=>{var j;const C=[];if(m){const S=m.filter(M=>M.base===(a==null?void 0:a.base)).map(M=>({label:M.name,value:`<${M.name}>`}));S.length>0&&C.push({label:n("prompt.compatibleEmbeddings"),options:S})}if(d){const S=d.filter(M=>Us(r,I=>I.model.key).includes(M.key)).map(M=>M.trigger_phrases?M.trigger_phrases.map(I=>({label:I,value:I})):[]).flatMap(M=>M);S.length>0&&C.push({label:n("modelManager.loraTriggerPhrases"),options:d8(S)})}return a&&wc(a)&&((j=a.trigger_phrases)!=null&&j.length)&&C.push({label:n("modelManager.mainModelTriggerPhrases"),options:a.trigger_phrases.map(S=>({label:S,value:S}))}),C},[m,d,a,n,r]);return s.jsx($,{children:s.jsx(ot,{placeholder:n(f||h||c?"common.loading":"prompt.addPromptTrigger"),defaultMenuIsOpen:!0,autoFocus:!0,value:null,options:x,noOptionsMessage:IV,onChange:g,onMenuClose:t,"data-testid":"add-prompt-trigger",sx:PV})})});nk.displayName="PromptTriggerSelect";const PV={w:"full"},Uc=u.memo(e=>{const{onSelect:t,isOpen:n,onClose:o,width:r,children:a}=e;return s.jsxs(oa,{isOpen:n,onClose:o,placement:"bottom",openDelay:0,closeDelay:0,closeOnBlur:!0,returnFocusOnClose:!1,isLazy:!0,children:[s.jsx(Ty,{children:a}),s.jsx(ra,{p:0,insetBlockStart:-1,shadow:"dark-lg",borderColor:"invokeBlue.300",borderWidth:"2px",borderStyle:"solid",children:s.jsx(aa,{p:0,width:`calc(${r}px - 0.25rem)`,children:s.jsx(nk,{onClose:o,onSelect:t})})})]})});Uc.displayName="PromptPopover";const th=({prompt:e,textareaRef:t,onChange:n})=>{const{isOpen:o,onClose:r,onOpen:a}=fn(),c=u.useCallback(x=>{n(x.target.value)},[n]),d=u.useCallback(x=>{if(!t.current)return;const C=t.current.selectionStart;if(ln(C))return;let j=e.slice(0,C);j+=`${x}`;const S=j.length;j+=e.slice(C),dg.flushSync(()=>{n(j)}),t.current.selectionStart=S,t.current.selectionEnd=S},[t,n,e]),f=u.useCallback(()=>{var x;(x=t.current)==null||x.focus()},[t]),m=u.useCallback(()=>{r(),f()},[f,r]),h=u.useCallback(x=>{d(x),m()},[m,d]),g=u.useCallback(x=>{x.key==="<"&&(a(),x.preventDefault())},[a]);return{onChange:c,isOpen:o,onClose:r,onOpen:a,onSelect:h,onKeyDown:g,onFocus:f}},P0=u.memo(()=>{var g;const e=O(),t=b(x=>x.generation.negativePrompt),n=u.useRef(null),{t:o}=L(),r=u.useCallback(x=>{e(UC(x))},[e]),{onChange:a,isOpen:c,onClose:d,onOpen:f,onSelect:m,onKeyDown:h}=th({prompt:t,textareaRef:n,onChange:r});return s.jsx(Uc,{isOpen:c,onClose:d,onSelect:m,width:(g=n.current)==null?void 0:g.clientWidth,children:s.jsxs(Ae,{pos:"relative",children:[s.jsx(Oo,{id:"negativePrompt",name:"negativePrompt",ref:n,value:t,placeholder:o("parameters.negativePromptPlaceholder"),onChange:a,onKeyDown:h,fontSize:"sm",variant:"darkFilled",paddingRight:30}),s.jsx(Wc,{children:s.jsx(Gc,{isOpen:c,onOpen:f})})]})})});P0.displayName="ParamNegativePrompt";function DV(e){return Se({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M1.114 8.063V7.9c1.005-.102 1.497-.615 1.497-1.6V4.503c0-1.094.39-1.538 1.354-1.538h.273V2h-.376C2.25 2 1.49 2.759 1.49 4.352v1.524c0 1.094-.376 1.456-1.49 1.456v1.299c1.114 0 1.49.362 1.49 1.456v1.524c0 1.593.759 2.352 2.372 2.352h.376v-.964h-.273c-.964 0-1.354-.444-1.354-1.538V9.663c0-.984-.492-1.497-1.497-1.6ZM14.886 7.9v.164c-1.005.103-1.497.616-1.497 1.6v1.798c0 1.094-.39 1.538-1.354 1.538h-.273v.964h.376c1.613 0 2.372-.759 2.372-2.352v-1.524c0-1.094.376-1.456 1.49-1.456v-1.3c-1.114 0-1.49-.362-1.49-1.456V4.352C14.51 2.759 13.75 2 12.138 2h-.376v.964h.273c.964 0 1.354.444 1.354 1.538V6.3c0 .984.492 1.497 1.497 1.6ZM7.5 11.5V9.207l-1.621 1.621-.707-.707L6.792 8.5H4.5v-1h2.293L5.172 5.879l.707-.707L7.5 6.792V4.5h1v2.293l1.621-1.621.707.707L9.208 7.5H11.5v1H9.207l1.621 1.621-.707.707L8.5 9.208V11.5h-1Z"},child:[]}]})(e)}const EV={svg:{animation:Ly}},sk=u.memo(()=>{const{t:e}=L(),t=b(a=>a.dynamicPrompts.isLoading),n=b(a=>!!(a.dynamicPrompts.isError||a.dynamicPrompts.parsingError)),{isOpen:o,onOpen:r}=Rb();return s.jsx(Dt,{label:e(t?"dynamicPrompts.loading":"dynamicPrompts.showDynamicPrompts"),children:s.jsx(ve,{size:"sm",variant:"promptOverlay",isDisabled:o,"aria-label":e("dynamicPrompts.showDynamicPrompts"),icon:s.jsx(DV,{}),onClick:r,sx:t?EV:void 0,colorScheme:n&&!t?"error":"base"})})});sk.displayName="ShowDynamicPromptsPreviewButton";const ok=u.memo(()=>{const e=b(a=>a.sdxl.shouldConcatSDXLStylePrompt),t=O(),{t:n}=L(),o=u.useCallback(()=>{t(f8(!e))},[t,e]),r=u.useMemo(()=>n(e?"sdxl.concatPromptStyle":"sdxl.freePromptStyle"),[e,n]);return s.jsx(Dt,{label:r,children:s.jsx(ve,{"aria-label":r,onClick:o,icon:e?s.jsx(BD,{size:14}):s.jsx(ND,{size:14}),variant:"promptOverlay",fontSize:12,px:.5})})});ok.displayName="SDXLConcatButton";const D0=u.memo(()=>{var j,S;const e=O(),t=b(M=>M.generation.positivePrompt),n=(j=b(M=>M.generation.model))==null?void 0:j.base,o=u.useRef(null),{t:r}=L(),a=u.useCallback(M=>{e(GC(M))},[e]),{onChange:c,isOpen:d,onClose:f,onOpen:m,onSelect:h,onKeyDown:g,onFocus:x}=th({prompt:t,textareaRef:o,onChange:a}),C=u.useCallback(M=>{x(),M.preventDefault()},[x]);return Re("alt+a",C,[]),s.jsx(Uc,{isOpen:d,onClose:f,onSelect:h,width:(S=o.current)==null?void 0:S.clientWidth,children:s.jsxs(Ae,{pos:"relative",children:[s.jsx(Oo,{id:"prompt",name:"prompt",ref:o,value:t,placeholder:r("parameters.positivePromptPlaceholder"),onChange:c,minH:28,onKeyDown:g,variant:"darkFilled",paddingRight:30}),s.jsxs(Wc,{children:[s.jsx(Gc,{isOpen:d,onOpen:m}),n==="sdxl"&&s.jsx(ok,{}),s.jsx(sk,{})]})]})})});D0.displayName="ParamPositivePrompt";const rk=u.memo(()=>s.jsxs(P,{flexDir:"column",gap:2,children:[s.jsx(D0,{}),s.jsx(P0,{})]}));rk.displayName="Prompts";const ak=u.memo(()=>{var x;const e=O(),t=b(C=>C.sdxl.negativeStylePrompt),n=u.useRef(null),{t:o}=L(),r=u.useCallback(C=>{e(qC(C))},[e]),{onChange:a,isOpen:c,onClose:d,onOpen:f,onSelect:m,onKeyDown:h,onFocus:g}=th({prompt:t,textareaRef:n,onChange:r});return Re("alt+a",g,[]),s.jsx(Uc,{isOpen:c,onClose:d,onSelect:m,width:(x=n.current)==null?void 0:x.clientWidth,children:s.jsxs(Ae,{pos:"relative",children:[s.jsx(Oo,{id:"prompt",name:"prompt",ref:n,value:t,placeholder:o("sdxl.negStylePrompt"),onChange:a,onKeyDown:h,fontSize:"sm",variant:"darkFilled",paddingRight:30}),s.jsx(Wc,{children:s.jsx(Gc,{isOpen:c,onOpen:f})})]})})});ak.displayName="ParamSDXLNegativeStylePrompt";const lk=u.memo(()=>{var g;const e=O(),t=b(x=>x.sdxl.positiveStylePrompt),n=u.useRef(null),{t:o}=L(),r=u.useCallback(x=>{e(ZC(x))},[e]),{onChange:a,isOpen:c,onClose:d,onOpen:f,onSelect:m,onKeyDown:h}=th({prompt:t,textareaRef:n,onChange:r});return s.jsx(Uc,{isOpen:c,onClose:d,onSelect:m,width:(g=n.current)==null?void 0:g.clientWidth,children:s.jsxs(Ae,{pos:"relative",children:[s.jsx(Oo,{id:"prompt",name:"prompt",ref:n,value:t,placeholder:o("sdxl.posStylePrompt"),onChange:a,onKeyDown:h,fontSize:"sm",variant:"darkFilled",paddingRight:30}),s.jsx(Wc,{children:s.jsx(Gc,{isOpen:c,onOpen:f})})]})})});lk.displayName="ParamSDXLPositiveStylePrompt";const ik=u.memo(()=>{const e=b(t=>t.sdxl.shouldConcatSDXLStylePrompt);return s.jsxs(P,{flexDir:"column",gap:2,pos:"relative",children:[s.jsx(D0,{}),!e&&s.jsx(lk,{}),s.jsx(P0,{}),!e&&s.jsx(ak,{})]})});ik.displayName="SDXLPrompts";const _V=()=>{const e=b(g=>g.generation.cfgRescaleMultiplier),t=b(g=>g.config.sd.cfgRescaleMultiplier.initial),n=b(g=>g.config.sd.cfgRescaleMultiplier.sliderMin),o=b(g=>g.config.sd.cfgRescaleMultiplier.sliderMax),r=b(g=>g.config.sd.cfgRescaleMultiplier.numberInputMin),a=b(g=>g.config.sd.cfgRescaleMultiplier.numberInputMax),c=b(g=>g.config.sd.cfgRescaleMultiplier.coarseStep),d=b(g=>g.config.sd.cfgRescaleMultiplier.fineStep),f=O(),{t:m}=L(),h=u.useCallback(g=>f(KC(g)),[f]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"paramCFGRescaleMultiplier",children:s.jsx(Y,{children:m("parameters.cfgRescaleMultiplier")})}),s.jsx(Ne,{value:e,defaultValue:t,min:n,max:o,step:c,fineStep:d,onChange:h,marks:!0}),s.jsx(Ee,{value:e,defaultValue:t,min:r,max:a,step:c,fineStep:d,onChange:h})]})},LV=u.memo(_V),TV=()=>{const e=b(x=>x.generation.clipSkip),t=b(x=>x.config.sd.clipSkip.initial),n=b(x=>x.config.sd.clipSkip.sliderMin),o=b(x=>x.config.sd.clipSkip.numberInputMin),r=b(x=>x.config.sd.clipSkip.coarseStep),a=b(x=>x.config.sd.clipSkip.fineStep),{model:c}=b(x=>x.generation),d=O(),{t:f}=L(),m=u.useCallback(x=>{d(h8(x))},[d]),h=u.useMemo(()=>c?Zu[c.base].maxClip:Zu["sd-1"].maxClip,[c]),g=u.useMemo(()=>c?Zu[c.base].markers:Zu["sd-1"].markers,[c]);return(c==null?void 0:c.base)==="sdxl"?null:s.jsxs($,{children:[s.jsx(Ke,{feature:"clipSkip",children:s.jsx(Y,{children:f("parameters.clipSkip")})}),s.jsx(Ne,{value:e,defaultValue:t,min:n,max:h,step:r,fineStep:a,onChange:m,marks:g}),s.jsx(Ee,{value:e,defaultValue:t,min:o,max:h,step:r,fineStep:a,onChange:m})]})},RV=u.memo(TV),BV=()=>{const{t:e}=L(),t=b(r=>r.generation.seamlessXAxis),n=O(),o=u.useCallback(r=>{n(m8(r.target.checked))},[n]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"seamlessTilingXAxis",children:s.jsx(Y,{children:e("parameters.seamlessXAxis")})}),s.jsx(jt,{isChecked:t,onChange:o})]})},NV=u.memo(BV),zV=()=>{const{t:e}=L(),t=b(r=>r.generation.seamlessYAxis),n=O(),o=u.useCallback(r=>{n(p8(r.target.checked))},[n]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"seamlessTilingYAxis",children:s.jsx(Y,{children:e("parameters.seamlessYAxis")})}),s.jsx(jt,{isChecked:t,onChange:o})]})},OV=u.memo(zV),FV=Ve(bs,e=>{const{model:t,vae:n}=e;return{model:t,vae:n}}),VV=()=>{const e=O(),{t}=L(),{model:n,vae:o}=b(FV),[r,{isLoading:a}]=Ef(),c=u.useCallback(x=>{const C=(n==null?void 0:n.base)===x.base;return!!!(n!=null&&n.base)||!C},[n==null?void 0:n.base]),d=u.useCallback(x=>{e(op(x?Wo.parse(x):null))},[e]),{options:f,value:m,onChange:h,noOptionsMessage:g}=Js({modelConfigs:r,onChange:d,selectedModel:o,isLoading:a,getIsDisabled:c});return s.jsxs($,{isDisabled:!f.length,isInvalid:!f.length,children:[s.jsx(Ke,{feature:"paramVAE",children:s.jsx(Y,{children:t("modelManager.vae")})}),s.jsx(ot,{isClearable:!0,value:m,placeholder:m?m.value:t("models.defaultVAE"),options:f,onChange:h,noOptionsMessage:g})]})},HV=u.memo(VV),Av=[{label:"FP16",value:"fp16"},{label:"FP32",value:"fp32"}],$V=()=>{const{t:e}=L(),t=O(),n=b(a=>a.generation.vaePrecision),o=u.useCallback(a=>{Ry(a==null?void 0:a.value)&&t(g8(a.value))},[t]),r=u.useMemo(()=>Av.find(a=>a.value===n),[n]);return s.jsxs($,{w:"14rem",flexShrink:0,children:[s.jsx(Ke,{feature:"paramVAEPrecision",children:s.jsx(Y,{children:e("modelManager.vaePrecision")})}),s.jsx(ot,{value:r,options:Av,onChange:o})]})},WV=u.memo($V),Ci=e=>{const t=O(),n=u.useMemo(()=>it(By,a=>a.accordions[e.id]??e.defaultIsOpen),[e]),o=b(n),r=u.useCallback(()=>{t(x8({id:e.id,isOpen:!o}))},[e.id,t,o]);return{isOpen:o,onToggle:r}},GV={minW:"9.2rem"},UV={flexGrow:1},ck=u.memo(()=>{const e=b(d=>{var f;return(f=d.generation.vae)==null?void 0:f.key}),{currentData:t}=vo(e??Ot),n=u.useMemo(()=>Ve(bs,d=>{const f=[];if(t){let m=t.name;d.vaePrecision==="fp16"&&(m+=` ${d.vaePrecision}`),f.push(m)}else d.vaePrecision==="fp16"&&f.push(`VAE ${d.vaePrecision}`);return d.clipSkip&&f.push(`Skip ${d.clipSkip}`),d.cfgRescaleMultiplier&&f.push(`Rescale ${d.cfgRescaleMultiplier}`),(d.seamlessXAxis||d.seamlessYAxis)&&f.push("seamless"),f}),[t]),o=b(n),{t:r}=L(),{isOpen:a,onToggle:c}=Ci({id:"advanced-settings",defaultIsOpen:!1});return s.jsx(ci,{label:r("accordions.advanced.title"),badges:o,isOpen:a,onToggle:c,children:s.jsxs(P,{gap:4,alignItems:"center",p:4,flexDir:"column",children:[s.jsxs(P,{gap:4,w:"full",children:[s.jsx(HV,{}),s.jsx(WV,{})]}),s.jsxs(En,{formLabelProps:GV,children:[s.jsx(RV,{}),s.jsx(LV,{})]}),s.jsx(P,{gap:4,w:"full",children:s.jsxs(En,{formLabelProps:UV,children:[s.jsx(NV,{}),s.jsx(OV,{})]})})]})})});ck.displayName="AdvancedSettingsAccordion";const ZV=()=>{const e=O(),t=b(g=>g.generation.canvasCoherenceEdgeSize),n=b(g=>g.config.sd.canvasCoherenceEdgeSize.initial),o=b(g=>g.config.sd.canvasCoherenceEdgeSize.sliderMin),r=b(g=>g.config.sd.canvasCoherenceEdgeSize.sliderMax),a=b(g=>g.config.sd.canvasCoherenceEdgeSize.numberInputMin),c=b(g=>g.config.sd.canvasCoherenceEdgeSize.numberInputMax),d=b(g=>g.config.sd.canvasCoherenceEdgeSize.coarseStep),f=b(g=>g.config.sd.canvasCoherenceEdgeSize.fineStep),{t:m}=L(),h=u.useCallback(g=>{e(v8(g))},[e]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"compositingCoherenceEdgeSize",children:s.jsx(Y,{children:m("parameters.coherenceEdgeSize")})}),s.jsx(Ne,{min:o,max:r,step:d,fineStep:f,value:t,defaultValue:n,onChange:h,marks:!0}),s.jsx(Ee,{min:a,max:c,step:d,fineStep:f,value:t,defaultValue:n,onChange:h})]})},qV=u.memo(ZV),QV=()=>{const e=O(),t=b(r=>r.generation.canvasCoherenceMinDenoise),{t:n}=L(),o=u.useCallback(r=>{e(C8(r))},[e]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"compositingCoherenceMinDenoise",children:s.jsx(Y,{children:n("parameters.coherenceMinDenoise")})}),s.jsx(Ne,{min:0,max:1,step:.01,value:t,defaultValue:0,onChange:o}),s.jsx(Ee,{min:0,max:1,step:.01,value:t,defaultValue:0,onChange:o})]})},KV=u.memo(QV),YV=()=>{const e=O(),t=b(c=>c.generation.canvasCoherenceMode),{t:n}=L(),o=u.useMemo(()=>[{label:n("unifiedCanvas.coherenceModeGaussianBlur"),value:"Gaussian Blur"},{label:n("unifiedCanvas.coherenceModeBoxBlur"),value:"Box Blur"},{label:n("unifiedCanvas.coherenceModeStaged"),value:"Staged"}],[n]),r=u.useCallback(c=>{y8(c==null?void 0:c.value)&&e(b8(c.value))},[e]),a=u.useMemo(()=>o.find(c=>c.value===t),[t,o]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"compositingCoherenceMode",children:s.jsx(Y,{children:n("parameters.coherenceMode")})}),s.jsx(ot,{options:o,value:a,onChange:r})]})},XV=u.memo(YV),JV=()=>{const{t:e}=L(),t=O(),n=b(g=>g.generation.maskBlur),o=b(g=>g.config.sd.maskBlur.initial),r=b(g=>g.config.sd.maskBlur.sliderMin),a=b(g=>g.config.sd.maskBlur.sliderMax),c=b(g=>g.config.sd.maskBlur.numberInputMin),d=b(g=>g.config.sd.maskBlur.numberInputMax),f=b(g=>g.config.sd.maskBlur.coarseStep),m=b(g=>g.config.sd.maskBlur.fineStep),h=u.useCallback(g=>{t(j8(g))},[t]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"compositingMaskBlur",children:s.jsx(Y,{children:e("parameters.maskBlur")})}),s.jsx(Ne,{min:r,max:a,value:n,defaultValue:o,onChange:h,step:f,fineStep:m,marks:!0}),s.jsx(Ee,{min:c,max:d,value:n,defaultValue:o,onChange:h,step:f,fineStep:m})]})},eH=u.memo(JV),tH=()=>{const{t:e}=L(),t=O(),n=b(d=>d.generation.infillMethod),{data:o}=Ey(),r=u.useMemo(()=>o?o.infill_methods.map(d=>({label:d,value:d})):[],[o]),a=u.useCallback(d=>{!d||!r.find(f=>f.value===d.value)||t(S8(d.value))},[t,r]),c=u.useMemo(()=>r.find(d=>d.value===n),[r,n]);return s.jsxs($,{isDisabled:r.length===0,children:[s.jsx(Ke,{feature:"infillMethod",children:s.jsx(Y,{children:e("parameters.infillMethod")})}),s.jsx(ot,{value:c,options:r,onChange:a})]})},nH=u.memo(tH),sH=()=>{const e=O(),t=b(x=>x.generation.infillMethod),n=b(x=>x.generation.infillPatchmatchDownscaleSize),o=b(x=>x.config.sd.infillPatchmatchDownscaleSize.initial),r=b(x=>x.config.sd.infillPatchmatchDownscaleSize.sliderMin),a=b(x=>x.config.sd.infillPatchmatchDownscaleSize.sliderMax),c=b(x=>x.config.sd.infillPatchmatchDownscaleSize.numberInputMin),d=b(x=>x.config.sd.infillPatchmatchDownscaleSize.numberInputMax),f=b(x=>x.config.sd.infillPatchmatchDownscaleSize.coarseStep),m=b(x=>x.config.sd.infillPatchmatchDownscaleSize.fineStep),{t:h}=L(),g=u.useCallback(x=>{e(w8(x))},[e]);return s.jsxs($,{isDisabled:t!=="patchmatch",children:[s.jsx(Ke,{feature:"patchmatchDownScaleSize",children:s.jsx(Y,{children:h("parameters.patchmatchDownScaleSize")})}),s.jsx(Ne,{min:r,max:a,step:f,fineStep:m,value:n,defaultValue:o,onChange:g,marks:!0}),s.jsx(Ee,{min:c,max:d,step:f,fineStep:m,value:n,defaultValue:o,onChange:g})]})},oH=u.memo(sH),rH=()=>{const e=O(),t=b(x=>x.generation.infillTileSize),n=b(x=>x.config.sd.infillTileSize.initial),o=b(x=>x.config.sd.infillTileSize.sliderMin),r=b(x=>x.config.sd.infillTileSize.sliderMax),a=b(x=>x.config.sd.infillTileSize.numberInputMin),c=b(x=>x.config.sd.infillTileSize.numberInputMax),d=b(x=>x.config.sd.infillTileSize.coarseStep),f=b(x=>x.config.sd.infillTileSize.fineStep),m=b(x=>x.generation.infillMethod),{t:h}=L(),g=u.useCallback(x=>{e(k8(x))},[e]);return s.jsxs($,{isDisabled:m!=="tile",children:[s.jsx(Y,{children:h("parameters.tileSize")}),s.jsx(Ne,{min:o,max:r,value:t,defaultValue:n,onChange:g,step:d,fineStep:f,marks:!0}),s.jsx(Ee,{min:a,max:c,value:t,defaultValue:n,onChange:g,step:d,fineStep:f})]})},aH=u.memo(rH),lH=()=>{const e=b(t=>t.generation.infillMethod);return e==="tile"?s.jsx(aH,{}):e==="patchmatch"?s.jsx(oH,{}):null},iH=u.memo(lH),Pv={minW:"4.5rem"},uk=u.memo(()=>{const{t:e}=L(),{isOpen:t,onToggle:n}=Ci({id:"compositing-settings",defaultIsOpen:!1});return s.jsx(ci,{isOpen:t,onToggle:n,label:e("accordions.compositing.title"),children:s.jsxs(Ja,{variant:"collapse",children:[s.jsxs(el,{children:[s.jsx(pn,{children:e("accordions.compositing.coherenceTab")}),s.jsx(pn,{children:e("accordions.compositing.infillTab")})]}),s.jsxs(ii,{children:[s.jsx(Pn,{children:s.jsx(P,{gap:4,p:4,flexDir:"column",children:s.jsxs(En,{formLabelProps:Pv,children:[s.jsx(XV,{}),s.jsx(qV,{}),s.jsx(KV,{}),s.jsx(eH,{})]})})}),s.jsx(Pn,{children:s.jsx(P,{gap:4,p:4,flexDir:"column",children:s.jsxs(En,{formLabelProps:Pv,children:[s.jsx(nH,{}),s.jsx(iH,{})]})})})]})]})})});uk.displayName="CompositingSettingsAccordion";const vr=e=>{const t=u.useMemo(()=>it(Rn,o=>{var r;return((r=Ys(o,e))==null?void 0:r.isEnabled)??!1}),[e]);return b(t)},E0=(e,t)=>vo(e??Ot,{selectFromResult:o=>{const r=o.data;return{...o,modelConfig:r&&t(r)?r:void 0}}}),dk=e=>{const t=u.useMemo(()=>Ve(Rn,r=>{var a,c;return(c=(a=Ys(r,e))==null?void 0:a.model)==null?void 0:c.key}),[e]),n=b(t);return E0(n??Ot,I8)},fk=e=>{const t=Yg(),n=Xg(),o=Jg();return e==="controlnet"?t:e==="t2i_adapter"?n:e==="ip_adapter"?o:e},hk=e=>{const t=u.useMemo(()=>Ve(Rn,o=>{var a;const r=(a=Ys(o,e))==null?void 0:a.type;return Ny.assert(r!==void 0,`Control adapter with id ${e} not found`),r}),[e]);return b(t)},cH=Ve(bs,e=>e.model),uH=({id:e})=>{const t=vr(e),n=hk(e),{modelConfig:o}=dk(e),r=O(),a=b(I=>{var k;return(k=I.generation.model)==null?void 0:k.base}),c=b(cH),{t:d}=L(),[f,{isLoading:m}]=fk(n),h=u.useCallback(I=>{I&&r(M8({id:e,modelConfig:I}))},[r,e]),g=u.useMemo(()=>o&&n?{...o,model_type:n}:null,[n,o]),x=u.useCallback(I=>{const k=a===I.base;return!!!a||!k},[a]),{options:C,value:j,onChange:S,noOptionsMessage:M}=Js({modelConfigs:f,onChange:h,selectedModel:g,getIsDisabled:x,isLoading:m});return s.jsx(Dt,{label:j==null?void 0:j.description,children:s.jsx($,{isDisabled:!t,isInvalid:!j||(c==null?void 0:c.base)!==(o==null?void 0:o.base),children:s.jsx(ot,{options:C,placeholder:d("controlnet.selectModel"),value:j,onChange:S,noOptionsMessage:M})})})},dH=u.memo(uH);var fH=function(e,t){return typeof t=="boolean"?t:!e},hH=function(e){return u.useReducer(fH,e)};function mH(e,t){t===void 0&&(t=0);var n=u.useRef(!1),o=u.useRef(),r=u.useRef(e),a=u.useCallback(function(){return n.current},[]),c=u.useCallback(function(){n.current=!1,o.current&&clearTimeout(o.current),o.current=setTimeout(function(){n.current=!0,r.current()},t)},[t]),d=u.useCallback(function(){n.current=null,o.current&&clearTimeout(o.current)},[]);return u.useEffect(function(){r.current=e},[e]),u.useEffect(function(){return c(),d},[t]),[a,d,c]}function pH(e,t,n){t===void 0&&(t=0),n===void 0&&(n=[]);var o=mH(e,t),r=o[0],a=o[1],c=o[2];return u.useEffect(c,n),[r,a]}const gH=e=>{const t=u.useMemo(()=>it(Rn,o=>{var r;return(r=Ys(o,e))==null?void 0:r.controlImage}),[e]);return b(t)},xH=e=>{const t=u.useMemo(()=>it(Rn,o=>{const r=Ys(o,e);return r&&si(r)?r.processedControlImage:void 0}),[e]);return b(t)},vH=e=>{const t=u.useMemo(()=>it(Rn,o=>{const r=Ys(o,e);return r&&si(r)?r.processorType:void 0}),[e]);return b(t)},CH=Ve(Rn,e=>e.pendingControlImages),yH=({isSmall:e,id:t})=>{const{t:n}=L(),o=O(),r=gH(t),a=xH(t),c=vH(t),d=b(V=>V.gallery.autoAddBoardId),f=b(V=>V.system.isConnected),m=b(ys),h=b(ls),g=b(CH),[x,C]=u.useState(!1),{currentData:j,isError:S}=Gs(r??Ot),{currentData:M,isError:I}=Gs(a??Ot),[k]=A8(),[D]=P8(),[T]=D8(),E=u.useCallback(()=>{o(E8({id:t,controlImage:null}))},[t,o]),A=u.useCallback(async()=>{M&&(await k({imageDTO:M,is_intermediate:!1}).unwrap(),d!=="none"?D({imageDTO:M,board_id:d}):T({imageDTO:M}))},[M,k,d,D,T]),N=u.useCallback(()=>{if(j)if(m==="unifiedCanvas")o(lc({width:j.width,height:j.height},h));else{const{width:V,height:H}=Ji(j.width/j.height,h*h);o(zy(V)),o(Oy(H))}},[j,m,o,h]),W=u.useCallback(()=>{C(!0)},[]),G=u.useCallback(()=>{C(!1)},[]),z=u.useMemo(()=>{if(j)return{id:t,payloadType:"IMAGE_DTO",payload:{imageDTO:j}}},[j,t]),X=u.useMemo(()=>({id:t,actionType:"SET_CONTROL_ADAPTER_IMAGE",context:{id:t}}),[t]),B=u.useMemo(()=>({type:"SET_CONTROL_ADAPTER_IMAGE",id:t}),[t]),Q=j&&M&&!x&&!g.includes(t)&&c!=="none";return u.useEffect(()=>{f&&(S||I)&&E()},[E,f,S,I]),s.jsxs(P,{onMouseEnter:W,onMouseLeave:G,position:"relative",w:"full",h:e?32:366,alignItems:"center",justifyContent:"center",children:[s.jsx(Jr,{draggableData:z,droppableData:X,imageDTO:j,isDropDisabled:Q,postUploadAction:B}),s.jsx(Ae,{position:"absolute",top:0,insetInlineStart:0,w:"full",h:"full",opacity:Q?1:0,transitionProperty:"common",transitionDuration:"normal",pointerEvents:"none",children:s.jsx(Jr,{draggableData:z,droppableData:X,imageDTO:M,isUploadDisabled:!0})}),s.jsxs(s.Fragment,{children:[s.jsx($l,{onClick:E,icon:j?s.jsx(ca,{size:16}):void 0,tooltip:n("controlnet.resetControlImage")}),s.jsx($l,{onClick:A,icon:j?s.jsx(Tc,{size:16}):void 0,tooltip:n("controlnet.saveControlImage"),styleOverrides:bH}),s.jsx($l,{onClick:N,icon:j?s.jsx(Dg,{size:16}):void 0,tooltip:n("controlnet.setControlImageDimensions"),styleOverrides:jH})]}),g.includes(t)&&s.jsx(P,{position:"absolute",top:0,insetInlineStart:0,w:"full",h:"full",alignItems:"center",justifyContent:"center",opacity:.8,borderRadius:"base",bg:"base.900",children:s.jsx(la,{size:"xl",color:"base.400"})})]})},Dv=u.memo(yH),bH={mt:6},jH={mt:12},mk=e=>{const t=u.useMemo(()=>Ve(Rn,o=>{const r=Ys(o,e);return r&&si(r)?r.processorNode:void 0}),[e]);return b(t)},ks=()=>{const e=O();return u.useCallback((n,o)=>{e(_8({id:n,params:o}))},[e])},Is=e=>{const t=b(o=>{var r;return(r=o.generation.model)==null?void 0:r.base});return u.useMemo(()=>gg[e].buildDefaults(t),[t,e])},SH=e=>s.jsx(P,{flexDir:"column",gap:4,children:e.children}),Ms=u.memo(SH),wH=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{low_threshold:r,high_threshold:a,image_resolution:c,detect_resolution:d}=n,f=ks(),{t:m}=L(),h=Is("canny_image_processor"),g=u.useCallback(S=>{f(t,{low_threshold:S})},[t,f]),x=u.useCallback(S=>{f(t,{high_threshold:S})},[t,f]),C=u.useCallback(S=>{f(t,{image_resolution:S})},[t,f]),j=u.useCallback(S=>{f(t,{detect_resolution:S})},[t,f]);return s.jsxs(Ms,{children:[s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.lowThreshold")}),s.jsx(Ne,{value:r,onChange:g,defaultValue:h.low_threshold,min:0,max:255}),s.jsx(Ee,{value:r,onChange:g,defaultValue:h.low_threshold,min:0,max:255})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.highThreshold")}),s.jsx(Ne,{value:a,onChange:x,defaultValue:h.high_threshold,min:0,max:255}),s.jsx(Ee,{value:a,onChange:x,defaultValue:h.high_threshold,min:0,max:255})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.imageResolution")}),s.jsx(Ne,{value:c,onChange:C,defaultValue:h.image_resolution,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:c,onChange:C,defaultValue:h.image_resolution,min:0,max:4096})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.detectResolution")}),s.jsx(Ne,{value:d,onChange:j,defaultValue:h.detect_resolution,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:d,onChange:j,defaultValue:h.detect_resolution,min:0,max:4096})]})]})},kH=u.memo(wH),IH=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{color_map_tile_size:r}=n,a=ks(),{t:c}=L(),d=Is("color_map_image_processor"),f=u.useCallback(m=>{a(t,{color_map_tile_size:m})},[t,a]);return s.jsx(Ms,{children:s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:c("controlnet.colorMapTileSize")}),s.jsx(Ne,{value:r,defaultValue:d.color_map_tile_size,onChange:f,min:1,max:256,step:1,marks:!0}),s.jsx(Ee,{value:r,defaultValue:d.color_map_tile_size,onChange:f,min:1,max:4096,step:1})]})})},MH=u.memo(IH),AH=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{image_resolution:r,detect_resolution:a,w:c,h:d,f}=n,m=ks(),{t:h}=L(),g=Is("content_shuffle_image_processor"),x=u.useCallback(I=>{m(t,{detect_resolution:I})},[t,m]),C=u.useCallback(I=>{m(t,{image_resolution:I})},[t,m]),j=u.useCallback(I=>{m(t,{w:I})},[t,m]),S=u.useCallback(I=>{m(t,{h:I})},[t,m]),M=u.useCallback(I=>{m(t,{f:I})},[t,m]);return s.jsxs(Ms,{children:[s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:h("controlnet.detectResolution")}),s.jsx(Ne,{value:a,defaultValue:g.detect_resolution,onChange:x,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:a,defaultValue:g.detect_resolution,onChange:x,min:0,max:4096})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:h("controlnet.imageResolution")}),s.jsx(Ne,{value:r,defaultValue:g.image_resolution,onChange:C,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:r,defaultValue:g.image_resolution,onChange:C,min:0,max:4096})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:h("controlnet.w")}),s.jsx(Ne,{value:c,defaultValue:g.w,onChange:j,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:c,defaultValue:g.w,onChange:j,min:0,max:4096})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:h("controlnet.h")}),s.jsx(Ne,{value:d,defaultValue:g.h,onChange:S,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:d,defaultValue:g.h,onChange:S,min:0,max:4096})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:h("controlnet.f")}),s.jsx(Ne,{value:f,defaultValue:g.f,onChange:M,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:f,defaultValue:g.f,onChange:M,min:0,max:4096})]})]})},PH=u.memo(AH),DH=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{model_size:r,resolution:a}=n,c=ks(),{t:d}=L(),f=Is("midas_depth_image_processor"),m=u.useCallback(j=>{L8(j==null?void 0:j.value)&&c(t,{model_size:j.value})},[t,c]),h=u.useMemo(()=>[{label:d("controlnet.small"),value:"small"},{label:d("controlnet.base"),value:"base"},{label:d("controlnet.large"),value:"large"}],[d]),g=u.useMemo(()=>h.filter(j=>j.value===r)[0],[h,r]),x=u.useCallback(j=>{c(t,{resolution:j})},[t,c]),C=u.useCallback(()=>{c(t,{resolution:512})},[t,c]);return s.jsxs(Ms,{children:[s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:d("controlnet.modelSize")}),s.jsx(ot,{value:g,defaultInputValue:f.model_size,options:h,onChange:m})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:d("controlnet.imageResolution")}),s.jsx(Ne,{value:a,onChange:x,defaultValue:f.resolution,min:64,max:4096,step:64,marks:!0,onReset:C}),s.jsx(Ee,{value:a,onChange:x,defaultValue:f.resolution,min:64,max:4096,step:64})]})]})},EH=u.memo(DH),_H=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{image_resolution:r,draw_body:a,draw_face:c,draw_hands:d}=n,f=ks(),{t:m}=L(),h=Is("dw_openpose_image_processor"),g=u.useCallback(S=>{f(t,{draw_body:S.target.checked})},[t,f]),x=u.useCallback(S=>{f(t,{draw_face:S.target.checked})},[t,f]),C=u.useCallback(S=>{f(t,{draw_hands:S.target.checked})},[t,f]),j=u.useCallback(S=>{f(t,{image_resolution:S})},[t,f]);return s.jsxs(Ms,{children:[s.jsxs(P,{sx:{flexDir:"row",gap:6},children:[s.jsxs($,{isDisabled:!o,w:"max-content",children:[s.jsx(Y,{children:m("controlnet.body")}),s.jsx(jt,{defaultChecked:h.draw_body,isChecked:a,onChange:g})]}),s.jsxs($,{isDisabled:!o,w:"max-content",children:[s.jsx(Y,{children:m("controlnet.face")}),s.jsx(jt,{defaultChecked:h.draw_face,isChecked:c,onChange:x})]}),s.jsxs($,{isDisabled:!o,w:"max-content",children:[s.jsx(Y,{children:m("controlnet.hands")}),s.jsx(jt,{defaultChecked:h.draw_hands,isChecked:d,onChange:C})]})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.imageResolution")}),s.jsx(Ne,{value:r,onChange:j,defaultValue:h.image_resolution,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:r,onChange:j,defaultValue:h.image_resolution,min:0,max:4096})]})]})},LH=u.memo(_H),TH=e=>{const{controlNetId:t,processorNode:{detect_resolution:n,image_resolution:o,scribble:r},isEnabled:a}=e,c=ks(),{t:d}=L(),f=Is("hed_image_processor"),m=u.useCallback(x=>{c(t,{detect_resolution:x})},[t,c]),h=u.useCallback(x=>{c(t,{image_resolution:x})},[t,c]),g=u.useCallback(x=>{c(t,{scribble:x.target.checked})},[t,c]);return s.jsxs(Ms,{children:[s.jsxs($,{isDisabled:!a,children:[s.jsx(Y,{children:d("controlnet.detectResolution")}),s.jsx(Ne,{value:n,defaultValue:f.detect_resolution,onChange:m,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:n,defaultValue:f.detect_resolution,onChange:m,min:0,max:4096})]}),s.jsxs($,{isDisabled:!a,children:[s.jsx(Y,{children:d("controlnet.imageResolution")}),s.jsx(Ne,{value:o,onChange:h,defaultValue:f.image_resolution,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:o,onChange:h,defaultValue:f.image_resolution,min:0,max:4096})]}),s.jsxs($,{isDisabled:!a,children:[s.jsx(Y,{children:d("controlnet.scribble")}),s.jsx(jt,{isChecked:r,onChange:g})]})]})},RH=u.memo(TH),BH=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{image_resolution:r,detect_resolution:a}=n,c=ks(),{t:d}=L(),f=Is("lineart_anime_image_processor"),m=u.useCallback(g=>{c(t,{detect_resolution:g})},[t,c]),h=u.useCallback(g=>{c(t,{image_resolution:g})},[t,c]);return s.jsxs(Ms,{children:[s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:d("controlnet.detectResolution")}),s.jsx(Ne,{value:a,defaultValue:f.detect_resolution,onChange:m,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:a,defaultValue:f.detect_resolution,onChange:m,min:0,max:4096})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:d("controlnet.imageResolution")}),s.jsx(Ne,{value:r,onChange:h,defaultValue:f.image_resolution,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:r,onChange:h,defaultValue:f.image_resolution,min:0,max:4096})]})]})},NH=u.memo(BH),zH=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{image_resolution:r,detect_resolution:a,coarse:c}=n,d=ks(),{t:f}=L(),m=Is("lineart_image_processor"),h=u.useCallback(C=>{d(t,{detect_resolution:C})},[t,d]),g=u.useCallback(C=>{d(t,{image_resolution:C})},[t,d]),x=u.useCallback(C=>{d(t,{coarse:C.target.checked})},[t,d]);return s.jsxs(Ms,{children:[s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:f("controlnet.detectResolution")}),s.jsx(Ne,{value:a,onChange:h,defaultValue:m.detect_resolution,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:a,onChange:h,defaultValue:m.detect_resolution,min:0,max:4096})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:f("controlnet.imageResolution")}),s.jsx(Ne,{value:r,onChange:g,defaultValue:m.image_resolution,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:r,onChange:g,defaultValue:m.image_resolution,min:0,max:4096})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:f("controlnet.coarse")}),s.jsx(jt,{isChecked:c,onChange:x})]})]})},OH=u.memo(zH),FH=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{max_faces:r,min_confidence:a,image_resolution:c,detect_resolution:d}=n,f=ks(),{t:m}=L(),h=Is("mediapipe_face_processor"),g=u.useCallback(S=>{f(t,{max_faces:S})},[t,f]),x=u.useCallback(S=>{f(t,{min_confidence:S})},[t,f]),C=u.useCallback(S=>{f(t,{image_resolution:S})},[t,f]),j=u.useCallback(S=>{f(t,{detect_resolution:S})},[t,f]);return s.jsxs(Ms,{children:[s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.maxFaces")}),s.jsx(Ne,{value:r,onChange:g,defaultValue:h.max_faces,min:1,max:20,marks:!0}),s.jsx(Ee,{value:r,onChange:g,defaultValue:h.max_faces,min:1,max:20})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.minConfidence")}),s.jsx(Ne,{value:a,onChange:x,defaultValue:h.min_confidence,min:0,max:1,step:.01,marks:!0}),s.jsx(Ee,{value:a,onChange:x,defaultValue:h.min_confidence,min:0,max:1,step:.01})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.imageResolution")}),s.jsx(Ne,{value:c,onChange:C,defaultValue:h.image_resolution,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:c,onChange:C,defaultValue:h.image_resolution,min:0,max:4096})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.detectResolution")}),s.jsx(Ne,{value:d,onChange:j,defaultValue:h.detect_resolution,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:d,onChange:j,defaultValue:h.detect_resolution,min:0,max:4096})]})]})},VH=u.memo(FH),HH=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{a_mult:r,bg_th:a,image_resolution:c,detect_resolution:d}=n,f=ks(),{t:m}=L(),h=Is("midas_depth_image_processor"),g=u.useCallback(S=>{f(t,{a_mult:S})},[t,f]),x=u.useCallback(S=>{f(t,{bg_th:S})},[t,f]),C=u.useCallback(S=>{f(t,{image_resolution:S})},[t,f]),j=u.useCallback(S=>{f(t,{detect_resolution:S})},[t,f]);return s.jsxs(Ms,{children:[s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.amult")}),s.jsx(Ne,{value:r,onChange:g,defaultValue:h.a_mult,min:0,max:20,step:.01,marks:!0}),s.jsx(Ee,{value:r,onChange:g,defaultValue:h.a_mult,min:0,max:20,step:.01})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.bgth")}),s.jsx(Ne,{value:a,onChange:x,defaultValue:h.bg_th,min:0,max:20,step:.01,marks:!0}),s.jsx(Ee,{value:a,onChange:x,defaultValue:h.bg_th,min:0,max:20,step:.01})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.imageResolution")}),s.jsx(Ne,{value:c,onChange:C,defaultValue:h.image_resolution,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:c,onChange:C,defaultValue:h.image_resolution,min:0,max:4096})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.detectResolution")}),s.jsx(Ne,{value:d,onChange:j,defaultValue:h.detect_resolution,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:d,onChange:j,defaultValue:h.detect_resolution,min:0,max:4096})]})]})},$H=u.memo(HH),WH=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{image_resolution:r,detect_resolution:a,thr_d:c,thr_v:d}=n,f=ks(),{t:m}=L(),h=Is("mlsd_image_processor"),g=u.useCallback(S=>{f(t,{detect_resolution:S})},[t,f]),x=u.useCallback(S=>{f(t,{image_resolution:S})},[t,f]),C=u.useCallback(S=>{f(t,{thr_d:S})},[t,f]),j=u.useCallback(S=>{f(t,{thr_v:S})},[t,f]);return s.jsxs(Ms,{children:[s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.detectResolution")}),s.jsx(Ne,{value:a,onChange:g,defaultValue:h.detect_resolution,min:0,max:4096,marks:Ev}),s.jsx(Ee,{value:a,onChange:g,defaultValue:h.detect_resolution,min:0,max:4096})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.imageResolution")}),s.jsx(Ne,{value:r,onChange:x,defaultValue:h.image_resolution,min:0,max:4096,marks:Ev}),s.jsx(Ee,{value:r,onChange:x,defaultValue:h.image_resolution,min:0,max:4096})]}),s.jsxs($,{isDisabled:!o,children:[s.jsxs(Y,{children:[m("controlnet.w")," "]}),s.jsx(Ne,{value:c,onChange:C,defaultValue:h.thr_d,min:0,max:1,step:.01,marks:_v}),s.jsx(Ee,{value:c,onChange:C,defaultValue:h.thr_d,min:0,max:1,step:.01})]}),s.jsxs($,{isDisabled:!o,children:[s.jsxs(Y,{children:[m("controlnet.h")," "]}),s.jsx(Ne,{value:d,onChange:j,defaultValue:h.thr_v,min:0,max:1,step:.01,marks:_v}),s.jsx(Ee,{value:d,onChange:j,defaultValue:h.thr_v,min:0,max:1,step:.01})]})]})},GH=u.memo(WH),Ev=[0,4096],_v=[0,1],UH=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{image_resolution:r,detect_resolution:a}=n,c=ks(),{t:d}=L(),f=Is("normalbae_image_processor"),m=u.useCallback(g=>{c(t,{detect_resolution:g})},[t,c]),h=u.useCallback(g=>{c(t,{image_resolution:g})},[t,c]);return s.jsxs(Ms,{children:[s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:d("controlnet.detectResolution")}),s.jsx(Ne,{value:a,onChange:m,defaultValue:f.detect_resolution,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:a,onChange:m,defaultValue:f.detect_resolution,min:0,max:4096})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:d("controlnet.imageResolution")}),s.jsx(Ne,{value:r,onChange:h,defaultValue:f.image_resolution,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:r,onChange:h,defaultValue:f.image_resolution,min:0,max:4096})]})]})},ZH=u.memo(UH),qH=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{image_resolution:r,detect_resolution:a,scribble:c,safe:d}=n,f=ks(),{t:m}=L(),h=Is("pidi_image_processor"),g=u.useCallback(S=>{f(t,{detect_resolution:S})},[t,f]),x=u.useCallback(S=>{f(t,{image_resolution:S})},[t,f]),C=u.useCallback(S=>{f(t,{scribble:S.target.checked})},[t,f]),j=u.useCallback(S=>{f(t,{safe:S.target.checked})},[t,f]);return s.jsxs(Ms,{children:[s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.detectResolution")}),s.jsx(Ne,{value:a,onChange:g,defaultValue:h.detect_resolution,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:a,onChange:g,defaultValue:h.detect_resolution,min:0,max:4096})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.imageResolution")}),s.jsx(Ne,{value:r,onChange:x,defaultValue:h.image_resolution,min:0,max:4096,marks:!0}),s.jsx(Ee,{value:r,onChange:x,defaultValue:h.image_resolution,min:0,max:4096})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.scribble")}),s.jsx(jt,{isChecked:c,onChange:C})]}),s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.safe")}),s.jsx(jt,{isChecked:d,onChange:j})]})]})},QH=u.memo(qH),KH=e=>null,YH=u.memo(KH),XH=({id:e})=>{const t=vr(e),n=mk(e);return n?n.type==="canny_image_processor"?s.jsx(kH,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="color_map_image_processor"?s.jsx(MH,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="depth_anything_image_processor"?s.jsx(EH,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="hed_image_processor"?s.jsx(RH,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="lineart_image_processor"?s.jsx(OH,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="content_shuffle_image_processor"?s.jsx(PH,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="lineart_anime_image_processor"?s.jsx(NH,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="mediapipe_face_processor"?s.jsx(VH,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="midas_depth_image_processor"?s.jsx($H,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="mlsd_image_processor"?s.jsx(GH,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="normalbae_image_processor"?s.jsx(ZH,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="dw_openpose_image_processor"?s.jsx(LH,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="pidi_image_processor"?s.jsx(QH,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="zoe_depth_image_processor"?s.jsx(YH,{controlNetId:e,processorNode:n,isEnabled:t}):null:null},JH=u.memo(XH),e$=e=>{const t=u.useMemo(()=>it(Rn,o=>{const r=Ys(o,e);if(r&&si(r))return r.shouldAutoConfig}),[e]);return b(t)},t$=({id:e})=>{const t=vr(e),n=e$(e),{modelConfig:o}=dk(e),r=O(),{t:a}=L(),c=u.useCallback(()=>{r(T8({id:e,modelConfig:o}))},[e,r,o]);return ln(n)?null:s.jsxs($,{isDisabled:!t,children:[s.jsx(Y,{flexGrow:1,children:a("controlnet.autoConfigure")}),s.jsx(jt,{isChecked:n,onChange:c})]})},n$=u.memo(t$),s$=e=>{const{id:t}=e,n=O(),{t:o}=L(),r=u.useCallback(()=>{n(R8({id:t}))},[t,n]),a=u.useCallback(()=>{n(B8({id:t}))},[t,n]);return s.jsxs(P,{gap:4,children:[s.jsx(ve,{size:"sm",icon:s.jsx(_D,{}),tooltip:o("controlnet.importImageFromCanvas"),"aria-label":o("controlnet.importImageFromCanvas"),onClick:r}),s.jsx(ve,{size:"sm",icon:s.jsx($b,{}),tooltip:o("controlnet.importMaskFromCanvas"),"aria-label":o("controlnet.importMaskFromCanvas"),onClick:a})]})},o$=u.memo(s$),r$=e=>{const t=u.useMemo(()=>Ve(Rn,o=>{const r=Ys(o,e);return r?{beginStepPct:r.beginStepPct,endStepPct:r.endStepPct}:void 0}),[e]);return b(t)},a$=e=>`${Math.round(e*100)}%`,pk=u.memo(({id:e})=>{const t=vr(e),n=r$(e),o=O(),{t:r}=L(),a=u.useCallback(f=>{o($x({id:e,beginStepPct:f[0]})),o(Wx({id:e,endStepPct:f[1]}))},[o,e]),c=u.useCallback(()=>{o($x({id:e,beginStepPct:0})),o(Wx({id:e,endStepPct:1}))},[o,e]),d=u.useMemo(()=>[(n==null?void 0:n.beginStepPct)??0,(n==null?void 0:n.endStepPct)??1],[n]);return n?s.jsxs($,{isDisabled:!t,orientation:"vertical",children:[s.jsx(Ke,{feature:"controlNetBeginEnd",children:s.jsx(Y,{children:r("controlnet.beginEndStepPercent")})}),s.jsx(N8,{"aria-label":l$,value:d,onChange:a,onReset:c,min:0,max:1,step:.05,fineStep:.01,minStepsBetweenThumbs:1,formatValue:a$,marks:!0,withThumbTooltip:!0})]}):null});pk.displayName="ParamControlAdapterBeginEnd";const l$=["Begin Step %","End Step %"],i$=e=>{const t=u.useMemo(()=>it(Rn,o=>{const r=Ys(o,e);if(r&&z8(r))return r.controlMode}),[e]);return b(t)},c$=({id:e})=>{const t=vr(e),n=i$(e),o=O(),{t:r}=L(),a=u.useMemo(()=>[{label:r("controlnet.balanced"),value:"balanced"},{label:r("controlnet.prompt"),value:"more_prompt"},{label:r("controlnet.control"),value:"more_control"},{label:r("controlnet.megaControl"),value:"unbalanced"}],[r]),c=u.useCallback(f=>{f&&o(O8({id:e,controlMode:f.value}))},[e,o]),d=u.useMemo(()=>a.filter(f=>f.value===n)[0],[a,n]);return n?s.jsxs($,{isDisabled:!t,children:[s.jsx(Ke,{feature:"controlNetControlMode",children:s.jsx(Y,{children:r("controlnet.controlMode")})}),s.jsx(ot,{value:d,options:a,onChange:c})]}):null},u$=u.memo(c$),d$=e=>e.config,f$=Ve(d$,e=>Us(gg,n=>({value:n.type,label:n.label})).sort((n,o)=>n.value==="none"?-1:o.value==="none"?1:n.label.localeCompare(o.label)).filter(n=>!e.sd.disabledControlNetProcessors.includes(n.value))),h$=({id:e})=>{const t=vr(e),n=mk(e),o=O(),r=b(f$),{t:a}=L(),c=u.useCallback(f=>{f&&o(F8({id:e,processorType:f.value}))},[e,o]),d=u.useMemo(()=>r.find(f=>f.value===(n==null?void 0:n.type)),[r,n]);return n?s.jsxs($,{isDisabled:!t,children:[s.jsx(Ke,{feature:"controlNetProcessor",children:s.jsx(Y,{children:a("controlnet.processor")})}),s.jsx(ot,{value:d,options:r,onChange:c})]}):null},m$=u.memo(h$),p$=e=>{const t=u.useMemo(()=>Ve(Rn,o=>{const r=Ys(o,e);if(r&&si(r))return r.resizeMode}),[e]);return b(t)},g$=({id:e})=>{const t=vr(e),n=p$(e),o=O(),{t:r}=L(),a=u.useMemo(()=>[{label:r("controlnet.resize"),value:"just_resize"},{label:r("controlnet.crop"),value:"crop_resize"},{label:r("controlnet.fill"),value:"fill_resize"},{label:r("controlnet.resizeSimple"),value:"just_resize_simple"}],[r]),c=u.useCallback(f=>{V8(f==null?void 0:f.value)&&o(H8({id:e,resizeMode:f.value}))},[e,o]),d=u.useMemo(()=>a.find(f=>f.value===n),[a,n]);return n?s.jsxs($,{children:[s.jsx(Ke,{feature:"controlNetResizeMode",children:s.jsx(Y,{children:r("controlnet.resizeMode")})}),s.jsx(ot,{value:d,options:a,isDisabled:!t,onChange:c})]}):null},x$=u.memo(g$),v$=e=>{const t=u.useMemo(()=>it(Rn,o=>{var r;return(r=Ys(o,e))==null?void 0:r.weight}),[e]);return b(t)},C$=e=>e.toFixed(2),y$=({id:e})=>{const{t}=L(),n=O(),o=vr(e),r=v$(e),a=b(C=>C.config.sd.ca.weight.initial),c=b(C=>C.config.sd.ca.weight.sliderMin),d=b(C=>C.config.sd.ca.weight.sliderMax),f=b(C=>C.config.sd.ca.weight.numberInputMin),m=b(C=>C.config.sd.ca.weight.numberInputMax),h=b(C=>C.config.sd.ca.weight.coarseStep),g=b(C=>C.config.sd.ca.weight.fineStep),x=u.useCallback(C=>{n($8({id:e,weight:C}))},[n,e]);return ln(r)?null:s.jsxs($,{isDisabled:!o,children:[s.jsx(Ke,{feature:"controlNetWeight",children:s.jsx(Y,{children:t("controlnet.weight")})}),s.jsx(Ne,{value:r,onChange:x,defaultValue:a,min:c,max:d,step:h,fineStep:g,marks:j$,formatValue:C$}),s.jsx(Ee,{value:r,onChange:x,min:f,max:m,step:h,fineStep:g,maxW:20,defaultValue:a})]})},b$=u.memo(y$),j$=[0,1,2],S$=e=>{const{id:t,number:n}=e,o=hk(t),r=O(),{t:a}=L(),c=b(ys),d=vr(t),[f,m]=hH(!1),h=u.useCallback(()=>{r(W8({id:t}))},[t,r]),g=u.useCallback(()=>{r(G8(t))},[t,r]),x=u.useCallback(C=>{r(U8({id:t,isEnabled:C.target.checked}))},[t,r]);return o?s.jsxs(P,{flexDir:"column",gap:4,p:4,borderRadius:"base",position:"relative",bg:"base.750",children:[s.jsx(P,{gap:2,alignItems:"center",justifyContent:"space-between",children:s.jsxs($,{children:[s.jsx(Y,{flexGrow:1,children:a(`controlnet.${o}`,{number:n})}),s.jsx(jt,{"aria-label":a("controlnet.toggleControlNet"),isChecked:d,onChange:x})]})}),s.jsxs(P,{gap:4,alignItems:"center",children:[s.jsx(Ae,{minW:0,w:"full",transitionProperty:"common",transitionDuration:"0.1s",children:s.jsx(dH,{id:t})}),c==="unifiedCanvas"&&s.jsx(o$,{id:t}),s.jsx(ve,{size:"sm",tooltip:a("controlnet.duplicate"),"aria-label":a("controlnet.duplicate"),onClick:g,icon:s.jsx(nl,{})}),s.jsx(ve,{size:"sm",tooltip:a("controlnet.delete"),"aria-label":a("controlnet.delete"),colorScheme:"error",onClick:h,icon:s.jsx(Xs,{})}),s.jsx(ve,{size:"sm",tooltip:a(f?"controlnet.hideAdvanced":"controlnet.showAdvanced"),"aria-label":a(f?"controlnet.hideAdvanced":"controlnet.showAdvanced"),onClick:m,variant:"ghost",icon:s.jsx(gn,{boxSize:4,as:Ag,transform:f?"rotate(0deg)":"rotate(180deg)",transitionProperty:"common",transitionDuration:"normal"})})]}),s.jsx(P,{w:"full",flexDir:"column",gap:4,children:s.jsxs(P,{gap:8,w:"full",alignItems:"center",children:[s.jsxs(P,{flexDir:"column",gap:2,h:32,w:"full",children:[s.jsx(b$,{id:t}),s.jsx(pk,{id:t})]}),!f&&s.jsx(P,{alignItems:"center",justifyContent:"center",h:32,w:32,aspectRatio:"1/1",children:s.jsx(Dv,{id:t,isSmall:!0})})]})}),f&&s.jsxs(s.Fragment,{children:[s.jsxs(P,{gap:2,children:[s.jsx(u$,{id:t}),s.jsx(x$,{id:t})]}),s.jsx(m$,{id:t}),s.jsx(Dv,{id:t}),s.jsx(n$,{id:t}),s.jsx(JH,{id:t})]})]}):null},w$=u.memo(S$),Zm=e=>{const t=b(d=>{var f;return(f=d.generation.model)==null?void 0:f.base}),n=O(),[o]=fk(e),r=u.useMemo(()=>{const d=o.filter(f=>t?f.base===t:!0)[0];return d||o[0]},[t,o]),a=u.useMemo(()=>!r,[r]);return[u.useCallback(()=>{var d;if(!a){if((e==="controlnet"||e==="t2i_adapter")&&((r==null?void 0:r.type)==="controlnet"||(r==null?void 0:r.type)==="t2i_adapter")){const f=(d=r.default_settings)==null?void 0:d.preprocessor,m=Z8(f)?f:"none",h=gg[m].buildDefaults(t);n(Gx({type:e,overrides:{model:r,processorType:m,processorNode:h}}));return}n(Gx({type:e,overrides:{model:r}}))}},[n,r,a,e,t]),a]},k$=Ve(Rn,e=>{const t=[];let n=!1;const o=q8(e).filter(h=>h.isEnabled).length,r=Q8(e).length;o>0&&t.push(`${o} IP`),o>r&&(n=!0);const a=K8(e).filter(h=>h.isEnabled).length,c=Y8(e).length;a>0&&t.push(`${a} ControlNet`),a>c&&(n=!0);const d=X8(e).filter(h=>h.isEnabled).length,f=J8(e).length;return d>0&&t.push(`${d} T2I`),d>f&&(n=!0),{controlAdapterIds:e3(e),badges:t,isError:n}}),gk=u.memo(()=>{const{t:e}=L(),{controlAdapterIds:t,badges:n}=b(k$),o=cn("controlNet").isFeatureDisabled,{isOpen:r,onToggle:a}=Ci({id:"control-settings",defaultIsOpen:!0}),[c,d]=Zm("controlnet"),[f,m]=Zm("ip_adapter"),[h,g]=Zm("t2i_adapter");return o?null:s.jsx(ci,{label:e("accordions.control.title"),badges:n,isOpen:r,onToggle:a,children:s.jsxs(P,{gap:2,p:4,flexDir:"column",children:[s.jsxs(Nt,{size:"sm",w:"full",justifyContent:"space-between",variant:"ghost",isAttached:!1,children:[s.jsx(qe,{tooltip:e("controlnet.addControlNet"),leftIcon:s.jsx(Hs,{}),onClick:c,"data-testid":"add controlnet",flexGrow:1,isDisabled:d,children:e("common.controlNet")}),s.jsx(qe,{tooltip:e("controlnet.addIPAdapter"),leftIcon:s.jsx(Hs,{}),onClick:f,"data-testid":"add ip adapter",flexGrow:1,isDisabled:m,children:e("common.ipAdapter")}),s.jsx(qe,{tooltip:e("controlnet.addT2IAdapter"),leftIcon:s.jsx(Hs,{}),onClick:h,"data-testid":"add t2i adapter",flexGrow:1,isDisabled:g,children:e("common.t2iAdapter")})]}),t.map((x,C)=>s.jsxs(u.Fragment,{children:[s.jsx(An,{}),s.jsx(w$,{id:x,number:C+1})]},x))]})})});gk.displayName="ControlAdaptersSettingsAccordion";const xk=u.memo(e=>{const{lora:t}=e,n=O(),{data:o}=vo(t.model.key),r=u.useCallback(d=>{n(t3({key:t.model.key,weight:d}))},[n,t.model.key]),a=u.useCallback(()=>{n(n3({key:t.model.key,isEnabled:!t.isEnabled}))},[n,t.model.key,t.isEnabled]),c=u.useCallback(()=>{n(s3(t.model.key))},[n,t.model.key]);return s.jsxs(o3,{variant:"lora",children:[s.jsx(r3,{children:s.jsxs(P,{alignItems:"center",justifyContent:"space-between",width:"100%",gap:2,children:[s.jsx(re,{noOfLines:1,wordBreak:"break-all",color:t.isEnabled?"base.200":"base.500",children:(o==null?void 0:o.name)??t.model.key.substring(0,8)}),s.jsxs(P,{alignItems:"center",gap:2,children:[s.jsx(jt,{size:"sm",onChange:a,isChecked:t.isEnabled}),s.jsx(ve,{"aria-label":"Remove LoRA",variant:"ghost",size:"sm",onClick:c,icon:s.jsx(Xs,{})})]})]})}),s.jsx(Ke,{feature:"loraWeight",children:s.jsxs(a3,{children:[s.jsx(Ne,{value:t.weight,onChange:r,min:-1,max:2,step:.01,marks:I$,defaultValue:.75,isDisabled:!t.isEnabled}),s.jsx(Ee,{value:t.weight,onChange:r,min:-5,max:5,step:.01,w:20,flexShrink:0,defaultValue:.75,isDisabled:!t.isEnabled})]})})]})});xk.displayName="LoRACard";const I$=[-1,0,1,2],M$=Ve(ff,e=>Us(e.loras)),vk=u.memo(()=>{const e=b(M$);return e.length?s.jsx(P,{flexWrap:"wrap",gap:2,children:e.map(t=>s.jsx(xk,{lora:t},t.model.key))}):null});vk.displayName="LoRAList";const A$=Ve(ff,e=>e.loras),P$=()=>{const e=O(),[t,{isLoading:n}]=Df(),{t:o}=L(),r=b(A$),a=b(x=>{var C;return(C=x.generation.model)==null?void 0:C.base}),c=x=>{const C=a===x.base,j=!!r[x.key];return!!!a||!C||j},d=u.useCallback(x=>{x&&e(l3(x))},[e]),{options:f,onChange:m}=Js({modelConfigs:t,getIsDisabled:c,onChange:d}),h=u.useMemo(()=>n?o("common.loading"):f.length===0?o("models.noLoRAsInstalled"):o("models.addLora"),[n,f.length,o]),g=u.useCallback(()=>o("models.noMatchingLoRAs"),[o]);return s.jsxs($,{isDisabled:!f.length,children:[s.jsx(Ke,{feature:"lora",children:s.jsxs(Y,{children:[o("models.concepts")," "]})}),s.jsx(ot,{placeholder:h,value:null,options:f,noOptionsMessage:g,onChange:m,"data-testid":"add-lora",sx:E$})]})},D$=u.memo(P$),E$={w:"full"},_$=()=>{const e=b(x=>x.generation.cfgScale),t=b(x=>x.config.sd.guidance.sliderMin),n=b(x=>x.config.sd.guidance.sliderMax),o=b(x=>x.config.sd.guidance.numberInputMin),r=b(x=>x.config.sd.guidance.numberInputMax),a=b(x=>x.config.sd.guidance.coarseStep),c=b(x=>x.config.sd.guidance.fineStep),d=b(x=>x.config.sd.guidance.initial),f=O(),{t:m}=L(),h=u.useMemo(()=>[t,Math.floor(n/2),n],[n,t]),g=u.useCallback(x=>f(QC(x)),[f]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"paramCFGScale",children:s.jsx(Y,{children:m("parameters.cfgScale")})}),s.jsx(Ne,{value:e,defaultValue:d,min:t,max:n,step:a,fineStep:c,onChange:g,marks:h}),s.jsx(Ee,{value:e,defaultValue:d,min:o,max:r,step:a,fineStep:c,onChange:g})]})},L$=u.memo(_$),T$=()=>{const e=O(),{t}=L(),n=b(a=>a.generation.scheduler),o=u.useCallback(a=>{ai(a==null?void 0:a.value)&&e(YC(a.value))},[e]),r=u.useMemo(()=>Qr.find(a=>a.value===n),[n]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"paramScheduler",children:s.jsx(Y,{children:t("parameters.scheduler")})}),s.jsx(ot,{value:r,options:Qr,onChange:o})]})},R$=u.memo(T$),B$=()=>{const e=b(x=>x.generation.steps),t=b(x=>x.config.sd.steps.initial),n=b(x=>x.config.sd.steps.sliderMin),o=b(x=>x.config.sd.steps.sliderMax),r=b(x=>x.config.sd.steps.numberInputMin),a=b(x=>x.config.sd.steps.numberInputMax),c=b(x=>x.config.sd.steps.coarseStep),d=b(x=>x.config.sd.steps.fineStep),f=O(),{t:m}=L(),h=u.useMemo(()=>[n,Math.floor(o/2),o],[o,n]),g=u.useCallback(x=>{f(XC(x))},[f]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"paramSteps",children:s.jsx(Y,{children:m("parameters.steps")})}),s.jsx(Ne,{value:e,defaultValue:t,min:n,max:o,step:c,fineStep:d,onChange:g,marks:h}),s.jsx(Ee,{value:e,defaultValue:t,min:r,max:a,step:c,fineStep:d,onChange:g})]})},N$=u.memo(B$),Ck=u.memo(e=>{const{t}=L(),n=O(),o=b(c=>c.config.disabledTabs),r=u.useMemo(()=>!o.includes("modelManager"),[o]),a=u.useCallback(()=>{n(zs("modelManager"))},[n]);return r?s.jsx(ve,{icon:s.jsx(qb,{}),tooltip:t("modelManager.modelManager"),"aria-label":t("modelManager.modelManager"),onClick:a,size:"sm",variant:"ghost",...e}):null});Ck.displayName="NavigateToModelManagerButton";const z$=Ve(bs,e=>e.model),O$=()=>{const e=O(),{t}=L(),n=b(z$),[o,{isLoading:r}]=Pf(),a=u.useMemo(()=>{var x;if(!(!o.length||!n))return(x=o.find(C=>C.key===(n==null?void 0:n.key)))==null?void 0:x.description},[o,n]),c=u.useCallback(x=>{if(x)try{e(cy(Wo.parse(x)))}catch{}},[e]),{options:d,value:f,onChange:m,placeholder:h,noOptionsMessage:g}=Js({modelConfigs:o,selectedModel:n,onChange:c,isLoading:r});return s.jsx(Dt,{label:a,children:s.jsxs($,{isDisabled:!o.length,isInvalid:!f||!o.length,children:[s.jsx(Ke,{feature:"paramModel",children:s.jsx(Y,{children:t("modelManager.model")})}),s.jsx(ot,{value:f,placeholder:h,options:d,onChange:m,noOptionsMessage:g})]})})},F$=u.memo(O$),V$=()=>{const e=b(r=>r.generation.model),{t}=L(),n=O(),o=u.useCallback(()=>{n(i3())},[n]);return s.jsx(ve,{icon:s.jsx(_f,{}),tooltip:t("modelManager.useDefaultSettings"),"aria-label":t("modelManager.useDefaultSettings"),isDisabled:!e,onClick:o,size:"sm",variant:"ghost"})},yk=e=>{const t=O(),n=u.useMemo(()=>it(By,a=>a.expanders[e.id]??e.defaultIsOpen),[e]),o=b(n),r=u.useCallback(()=>{t(c3({id:e.id,isOpen:!o}))},[t,e.id,o]);return{isOpen:o,onToggle:r}},H$=it(bs,e=>{var t;return(t=e.model)==null?void 0:t.key}),$$=()=>{const e=b(H$),{currentData:t}=vo(e??Ot);return t},W$={minW:"4rem"},bk=u.memo(()=>{const{t:e}=L(),t=$$(),n=u.useMemo(()=>Ve(ff,m=>{const h=Fy(m.loras,C=>!!C.isEnabled).length,g=h?[`${h} ${e("models.concepts")}`]:Gl,x=t?[t.name,t.base]:Gl;return{loraTabBadges:g,accordionBadges:x}}),[t,e]),{loraTabBadges:o,accordionBadges:r}=b(n),{isOpen:a,onToggle:c}=yk({id:"generation-settings-advanced",defaultIsOpen:!1}),{isOpen:d,onToggle:f}=Ci({id:"generation-settings",defaultIsOpen:!0});return s.jsx(ci,{label:e("accordions.generation.title"),badges:[...r,...o],isOpen:d,onToggle:f,children:s.jsxs(Ae,{px:4,pt:4,children:[s.jsxs(P,{gap:4,flexDir:"column",children:[s.jsxs(P,{gap:4,alignItems:"center",children:[s.jsx(F$,{}),s.jsxs(P,{children:[s.jsx(V$,{}),s.jsx(Ck,{})]})]}),s.jsxs(P,{gap:4,flexDir:"column",children:[s.jsx(D$,{}),s.jsx(vk,{})]})]}),s.jsx(Vy,{label:e("accordions.advanced.options"),isOpen:a,onToggle:c,children:s.jsx(P,{gap:4,flexDir:"column",pb:4,children:s.jsxs(En,{formLabelProps:W$,children:[s.jsx(R$,{}),s.jsx(N$,{}),s.jsx(L$,{})]})})})]})})});bk.displayName="GenerationSettingsAccordion";const Lv=[{label:"ESRGAN",value:"ESRGAN"},{label:"bilinear",value:"bilinear"}],G$=()=>{const e=O(),{t}=L(),n=b(a=>a.hrf.hrfMethod),o=u.useCallback(a=>{WC(a==null?void 0:a.value)&&e(ny(a.value))},[e]),r=u.useMemo(()=>Lv.find(a=>a.value===n),[n]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"paramUpscaleMethod",children:s.jsx(Y,{children:t("hrf.upscaleMethod")})}),s.jsx(ot,{value:r,options:Lv,onChange:o})]})},U$=u.memo(G$),Z$=()=>{const e=b(g=>g.hrf.hrfStrength),t=b(g=>g.config.sd.hrfStrength.initial),n=b(g=>g.config.sd.hrfStrength.sliderMin),o=b(g=>g.config.sd.hrfStrength.sliderMax),r=b(g=>g.config.sd.hrfStrength.numberInputMin),a=b(g=>g.config.sd.hrfStrength.numberInputMax),c=b(g=>g.config.sd.hrfStrength.coarseStep),d=b(g=>g.config.sd.hrfStrength.fineStep),f=O(),{t:m}=L(),h=u.useCallback(g=>{f(ty(g))},[f]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"paramDenoisingStrength",children:s.jsx(Y,{children:`${m("parameters.denoisingStrength")}`})}),s.jsx(Ne,{min:n,max:o,step:c,fineStep:d,value:e,defaultValue:t,onChange:h,marks:!0}),s.jsx(Ee,{min:r,max:a,step:c,fineStep:d,value:e,defaultValue:t,onChange:h})]})},q$=u.memo(Z$),Q$=()=>{const e=O(),{t}=L(),n=b(r=>r.hrf.hrfEnabled),o=u.useCallback(r=>e(ey(r.target.checked)),[e]);return s.jsxs($,{w:"full",children:[s.jsx(Ke,{feature:"paramHrf",children:s.jsx(Y,{flexGrow:1,children:t("hrf.enableHrf")})}),s.jsx(jt,{isChecked:n,onChange:o})]})},K$=u.memo(Q$),jk=u.memo(()=>{const e=cn("hrf").isFeatureEnabled,t=b(n=>n.hrf.hrfEnabled);return e?s.jsxs(s.Fragment,{children:[s.jsx(K$,{}),s.jsxs(En,{isDisabled:!t,children:[s.jsx(q$,{}),s.jsx(U$,{})]})]}):null});jk.displayName="HrfSettings";const Y$=()=>{const e=O(),{t}=L(),n=b(d=>d.canvas.boundingBoxScaleMethod),o=b(ls),r=u.useMemo(()=>[{label:t("modelManager.none"),value:"none"},{label:t("common.auto"),value:"auto"},{label:t("modelManager.manual"),value:"manual"}],[t]),a=u.useCallback(d=>{u3(d==null?void 0:d.value)&&e(d3(d.value,o))},[e,o]),c=u.useMemo(()=>r.find(d=>d.value===n),[n,r]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"scaleBeforeProcessing",children:s.jsx(Y,{children:t("parameters.scaleBeforeProcessing")})}),s.jsx(ot,{value:c,options:r,onChange:a})]})},X$=u.memo(Y$),J$=()=>{const{t:e}=L(),t=O(),n=b(ls),o=b(x=>x.canvas.boundingBoxScaleMethod==="manual"),r=b(x=>x.canvas.scaledBoundingBoxDimensions.height),a=b(x=>x.config.sd.scaledBoundingBoxHeight.sliderMin),c=b(x=>x.config.sd.scaledBoundingBoxHeight.sliderMax),d=b(x=>x.config.sd.scaledBoundingBoxHeight.numberInputMin),f=b(x=>x.config.sd.scaledBoundingBoxHeight.numberInputMax),m=b(x=>x.config.sd.scaledBoundingBoxHeight.coarseStep),h=b(x=>x.config.sd.scaledBoundingBoxHeight.fineStep),g=u.useCallback(x=>{t(Hy({height:x}))},[t]);return s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:e("parameters.scaledHeight")}),s.jsx(Ne,{min:a,max:c,step:m,fineStep:h,value:r,onChange:g,marks:!0,defaultValue:n}),s.jsx(Ee,{min:d,max:f,step:m,fineStep:h,value:r,onChange:g,defaultValue:n})]})},eW=u.memo(J$),tW=()=>{const{t:e}=L(),t=O(),n=b(ls),o=b(x=>x.canvas.boundingBoxScaleMethod==="manual"),r=b(x=>x.canvas.scaledBoundingBoxDimensions.width),a=b(x=>x.config.sd.scaledBoundingBoxWidth.sliderMin),c=b(x=>x.config.sd.scaledBoundingBoxWidth.sliderMax),d=b(x=>x.config.sd.scaledBoundingBoxWidth.numberInputMin),f=b(x=>x.config.sd.scaledBoundingBoxWidth.numberInputMax),m=b(x=>x.config.sd.scaledBoundingBoxWidth.coarseStep),h=b(x=>x.config.sd.scaledBoundingBoxWidth.fineStep),g=u.useCallback(x=>{t(Hy({width:x}))},[t]);return s.jsxs($,{isDisabled:!o,children:[s.jsx(Y,{children:e("parameters.scaledWidth")}),s.jsx(Ne,{min:a,max:c,step:m,fineStep:h,value:r,onChange:g,defaultValue:n,marks:!0}),s.jsx(Ee,{min:d,max:f,step:m,fineStep:h,value:r,onChange:g,defaultValue:n})]})},nW=u.memo(tW),sW=()=>{const e=O(),t=b(r=>r.generation.shouldFitToWidthHeight),n=u.useCallback(r=>{e(f3(r.target.checked))},[e]),{t:o}=L();return s.jsxs($,{w:"full",children:[s.jsx(Ke,{feature:"imageFit",children:s.jsx(Y,{flexGrow:1,children:o("parameters.imageFit")})}),s.jsx(jt,{isChecked:t,onChange:n})]})},oW=u.memo(sW),rW=[0,.5,1],aW=()=>{const e=b(g=>g.generation.img2imgStrength),t=b(g=>g.config.sd.img2imgStrength.initial),n=b(g=>g.config.sd.img2imgStrength.sliderMin),o=b(g=>g.config.sd.img2imgStrength.sliderMax),r=b(g=>g.config.sd.img2imgStrength.numberInputMin),a=b(g=>g.config.sd.img2imgStrength.numberInputMax),c=b(g=>g.config.sd.img2imgStrength.coarseStep),d=b(g=>g.config.sd.img2imgStrength.fineStep),f=O(),{t:m}=L(),h=u.useCallback(g=>f(JC(g)),[f]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"paramDenoisingStrength",children:s.jsx(Y,{children:`${m("parameters.denoisingStrength")}`})}),s.jsx(Ne,{step:c,fineStep:d,min:n,max:o,onChange:h,value:e,defaultValue:t,marks:rW}),s.jsx(Ee,{step:c,fineStep:d,min:r,max:a,onChange:h,value:e,defaultValue:t})]})},lW=u.memo(aW),Sk=u.memo(()=>{const e=b(a=>a.generation.seed),t=b(a=>a.generation.shouldRandomizeSeed),{t:n}=L(),o=O(),r=u.useCallback(a=>o(lg(a)),[o]);return s.jsxs($,{flexGrow:1,children:[s.jsx(Ke,{feature:"paramSeed",children:s.jsx(Y,{children:n("parameters.seed")})}),s.jsx(Ee,{step:1,min:$y,max:wd,isDisabled:t,onChange:r,value:e,flexGrow:1,defaultValue:0})]})});Sk.displayName="ParamSeedNumberInput";const wk=u.memo(()=>{const e=O(),{t}=L(),n=b(r=>r.generation.shouldRandomizeSeed),o=u.useCallback(r=>e(h3(r.target.checked)),[e]);return s.jsxs($,{w:"min-content",children:[s.jsx(Y,{children:t("common.random")}),s.jsx(jt,{isChecked:n,onChange:o})]})});wk.displayName="ParamSeedRandomize";const iW=(e,t)=>Math.floor(Math.random()*(t-e+1)+e),kk=u.memo(()=>{const e=O(),t=b(r=>r.generation.shouldRandomizeSeed),{t:n}=L(),o=u.useCallback(()=>e(lg(iW($y,wd))),[e]);return s.jsx(qe,{size:"sm",isDisabled:t,onClick:o,leftIcon:s.jsx(UD,{}),flexShrink:0,children:n("parameters.shuffle")})});kk.displayName="ParamSeedShuffle";const Ik=u.createContext(null),Cr=()=>{const e=u.useContext(Ik),t=b(ls);if(!e)throw new Error("useImageSizeContext must be used within a ImageSizeContext.Provider");const n=u.useCallback(m=>{const h={...e.aspectRatioState,id:m};if(h.id==="Free")h.isLocked=!1;else{h.isLocked=!0,h.value=Ux[h.id].ratio;const{width:g,height:x}=Ji(h.value,e.width*e.height);e.onChangeWidth(g),e.onChangeHeight(x)}e.onChangeAspectRatioState(h)},[e]),o=u.useCallback(()=>{const m={...e.aspectRatioState};if(m.value=1/m.value,m.id==="Free"){const h=e.height,g=e.width;e.onChangeWidth(h),e.onChangeHeight(g)}else{const{width:h,height:g}=Ji(m.value,e.width*e.height);e.onChangeWidth(h),e.onChangeHeight(g),m.id=Ux[m.id].inverseID}e.onChangeAspectRatioState(m)},[e]),r=u.useCallback(m=>{let h=e.height;const g={...e.aspectRatioState};g.isLocked?h=kd(m/g.value,8):(g.isLocked=!1,g.id="Free",g.value=m/h),e.onChangeWidth(m),e.onChangeHeight(h),e.onChangeAspectRatioState(g)},[e]),a=u.useCallback(m=>{let h=e.width;const g={...e.aspectRatioState};g.isLocked?h=kd(m*g.value,8):(g.isLocked=!1,g.id="Free",g.value=h/m),e.onChangeWidth(h),e.onChangeHeight(m),e.onChangeAspectRatioState(g)},[e]),c=u.useCallback(()=>{const m={...e.aspectRatioState};m.isLocked=!m.isLocked,e.onChangeAspectRatioState(m)},[e]),d=u.useCallback(()=>{if(e.aspectRatioState.isLocked){const{width:m,height:h}=Ji(e.aspectRatioState.value,t*t);e.onChangeWidth(m),e.onChangeHeight(h)}else e.onChangeAspectRatioState({...m3}),e.onChangeWidth(t),e.onChangeHeight(t)},[e,t]);return u.useMemo(()=>({...e,aspectRatioSelected:n,dimensionsSwapped:o,widthChanged:r,heightChanged:a,isLockedToggled:c,setOptimalSize:d}),[e,n,o,a,c,d,r])},cW=()=>{const{t:e}=L(),t=Cr(),n=b(ws),o=b(ls),r=b(g=>g.config.sd.boundingBoxHeight.sliderMin),a=b(g=>g.config.sd.boundingBoxHeight.sliderMax),c=b(g=>g.config.sd.boundingBoxHeight.numberInputMin),d=b(g=>g.config.sd.boundingBoxHeight.numberInputMax),f=b(g=>g.config.sd.boundingBoxHeight.coarseStep),m=b(g=>g.config.sd.boundingBoxHeight.fineStep),h=u.useCallback(g=>{t.heightChanged(g)},[t]);return s.jsxs($,{isDisabled:n,children:[s.jsx(Y,{children:e("parameters.height")}),s.jsx(Ne,{min:r,max:a,step:f,fineStep:m,value:t.height,defaultValue:o,onChange:h,marks:!0}),s.jsx(Ee,{min:c,max:d,step:f,fineStep:m,value:t.height,defaultValue:o,onChange:h})]})},uW=u.memo(cW),dW=()=>{const{t:e}=L(),t=Cr(),n=b(ws),o=b(ls),r=b(g=>g.config.sd.boundingBoxWidth.sliderMin),a=b(g=>g.config.sd.boundingBoxWidth.sliderMax),c=b(g=>g.config.sd.boundingBoxWidth.numberInputMin),d=b(g=>g.config.sd.boundingBoxWidth.numberInputMax),f=b(g=>g.config.sd.boundingBoxWidth.coarseStep),m=b(g=>g.config.sd.boundingBoxWidth.fineStep),h=u.useCallback(g=>{t.widthChanged(g)},[t]);return s.jsxs($,{isDisabled:n,children:[s.jsx(Y,{children:e("parameters.width")}),s.jsx(Ne,{min:r,max:a,step:f,fineStep:m,value:t.width,defaultValue:o,onChange:h,marks:!0}),s.jsx(Ee,{min:c,max:d,step:f,fineStep:m,value:t.width,defaultValue:o,onChange:h})]})},fW=u.memo(dW);function hW(e,t){if(!e){t(void 0);return}t({width:e.offsetWidth,height:e.offsetHeight});const n=e.ownerDocument.defaultView??window,o=new n.ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const[a]=r;let c,d;if("borderBoxSize"in a){const f=a.borderBoxSize,m=Array.isArray(f)?f[0]:f;c=m.inlineSize,d=m.blockSize}else c=e.offsetWidth,d=e.offsetHeight;t({width:c,height:d})});return o.observe(e,{box:"border-box"}),()=>o.unobserve(e)}var mW=globalThis!=null&&globalThis.document?u.useLayoutEffect:u.useEffect;function pW(e,t){var n,o;if(!e||!e.parentElement)return;const r=(o=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?o:window,a=new r.MutationObserver(()=>{t()});return a.observe(e.parentElement,{childList:!0}),()=>{a.disconnect()}}function gW({getNodes:e,observeMutation:t=!0}){const[n,o]=u.useState([]),[r,a]=u.useState(0);return mW(()=>{const c=e(),d=c.map((f,m)=>hW(f,h=>{o(g=>[...g.slice(0,m),h,...g.slice(m+1)])}));if(t){const f=c[0];d.push(pW(f,()=>{a(m=>m+1)}))}return()=>{d.forEach(f=>{f==null||f()})}},[r]),n}function xW(e){return typeof e=="object"&&e!==null&&"current"in e}function vW(e){const[t]=gW({observeMutation:!1,getNodes(){return[xW(e)?e.current:e]}});return t}const CW=()=>{const e=Cr(),t=u.useRef(null),n=vW(t),o=u.useMemo(()=>e.aspectRatioState.value<p3&&e.aspectRatioState.value>g3,[e.aspectRatioState.value]),{width:r,height:a}=u.useMemo(()=>{if(!n)return{width:0,height:0};let c=e.width,d=e.height;return e.width>e.height?(c=n.width,d=c/e.aspectRatioState.value):(d=n.height,c=d*e.aspectRatioState.value),{width:c,height:d}},[n,e.width,e.height,e.aspectRatioState.value]);return s.jsx(P,{w:"full",h:"full",alignItems:"center",justifyContent:"center",ref:t,children:s.jsx(P,{bg:"blackAlpha.400",borderRadius:"base",width:`${r}px`,height:`${a}px`,alignItems:"center",justifyContent:"center",children:s.jsx(Ul,{children:o&&s.jsx(P,{as:Oa.div,initial:x3,animate:v3,exit:C3,style:y3,children:s.jsx(gn,{as:XD,color:"base.700",boxSize:b3})})})})})},yW=uf.enum(["Free","16:9","3:2","4:3","1:1","3:4","2:3","9:16"]),bW=e=>yW.safeParse(e).success,Mk=u.memo(()=>{const{t:e}=L(),t=Cr(),n=u.useCallback(r=>{!r||!bW(r.value)||t.aspectRatioSelected(r.value)},[t]),o=u.useMemo(()=>Zx.filter(r=>r.value===t.aspectRatioState.id)[0],[t.aspectRatioState.id]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"paramAspect",children:s.jsx(Y,{children:e("parameters.aspect")})}),s.jsx(ot,{value:o,onChange:n,options:Zx,sx:jW})]})});Mk.displayName="AspectRatioSelect";const jW={minW:24},Ak=u.memo(()=>{const{t:e}=L(),t=Cr(),n=u.useCallback(()=>{t.isLockedToggled()},[t]);return s.jsx(ve,{tooltip:e("parameters.lockAspectRatio"),"aria-label":e("parameters.lockAspectRatio"),onClick:n,variant:t.aspectRatioState.isLocked?"outline":"ghost",size:"sm",icon:t.aspectRatioState.isLocked?s.jsx(KD,{}):s.jsx(zD,{})})});Ak.displayName="LockAspectRatioButton";const Pk=u.memo(()=>{const{t:e}=L(),t=Cr(),n=b(ls),o=u.useMemo(()=>j3(t.width,t.height,n),[t.height,t.width,n]),r=u.useMemo(()=>S3(t.width,t.height,n),[t.height,t.width,n]),a=u.useCallback(()=>{t.setOptimalSize()},[t]),c=u.useMemo(()=>e(o?"parameters.setToOptimalSizeTooSmall":r?"parameters.setToOptimalSizeTooLarge":"parameters.setToOptimalSize"),[r,o,e]);return s.jsx(ve,{tooltip:c,"aria-label":e("parameters.setToOptimalSize"),onClick:a,variant:"ghost",size:"sm",icon:s.jsx(_f,{}),colorScheme:o||r?"warning":"base"})});Pk.displayName="SetOptimalSizeButton";const Dk=u.memo(()=>{const{t:e}=L(),t=Cr(),n=u.useCallback(()=>{t.dimensionsSwapped()},[t]);return s.jsx(ve,{tooltip:e("parameters.swapDimensions"),"aria-label":e("parameters.swapDimensions"),onClick:n,variant:"ghost",size:"sm",icon:s.jsx(pD,{})})});Dk.displayName="SwapDimensionsButton";const _0=u.memo(e=>{const{widthComponent:t,heightComponent:n,...o}=e;return s.jsx(Ik.Provider,{value:o,children:s.jsxs(P,{gap:4,alignItems:"center",children:[s.jsx(P,{gap:4,flexDirection:"column",width:"full",children:s.jsxs(En,{formLabelProps:SW,children:[s.jsxs(P,{gap:4,children:[s.jsx(Mk,{}),s.jsx(Dk,{}),s.jsx(Ak,{}),s.jsx(Pk,{})]}),t,n]})}),s.jsx(P,{w:"108px",h:"108px",flexShrink:0,flexGrow:0,children:s.jsx(CW,{})})]})})});_0.displayName="ImageSize";const SW={minW:14},Ek=u.memo(()=>{const e=O(),{width:t,height:n}=b(f=>f.canvas.boundingBoxDimensions),o=b(f=>f.canvas.aspectRatio),r=b(ls),a=u.useCallback(f=>{e(lc({width:f},r))},[e,r]),c=u.useCallback(f=>{e(lc({height:f},r))},[e,r]),d=u.useCallback(f=>{e(Wy(f))},[e]);return s.jsx(_0,{width:t,height:n,aspectRatioState:o,heightComponent:s.jsx(uW,{}),widthComponent:s.jsx(fW,{}),onChangeAspectRatioState:d,onChangeWidth:a,onChangeHeight:c})});Ek.displayName="ImageSizeCanvas";const _k=u.memo(()=>{const{t:e}=L(),t=Cr(),n=b(ls),o=b(g=>g.config.sd.height.sliderMin),r=b(g=>g.config.sd.height.sliderMax),a=b(g=>g.config.sd.height.numberInputMin),c=b(g=>g.config.sd.height.numberInputMax),d=b(g=>g.config.sd.height.coarseStep),f=b(g=>g.config.sd.height.fineStep),m=u.useCallback(g=>{t.heightChanged(g)},[t]),h=u.useMemo(()=>[o,n,r],[o,n,r]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"paramHeight",children:s.jsx(Y,{children:e("parameters.height")})}),s.jsx(Ne,{value:t.height,defaultValue:n,onChange:m,min:o,max:r,step:d,fineStep:f,marks:h}),s.jsx(Ee,{value:t.height,defaultValue:n,onChange:m,min:a,max:c,step:d,fineStep:f})]})});_k.displayName="ParamHeight";const Lk=u.memo(()=>{const{t:e}=L(),t=Cr(),n=b(ls),o=b(g=>g.config.sd.width.sliderMin),r=b(g=>g.config.sd.width.sliderMax),a=b(g=>g.config.sd.width.numberInputMin),c=b(g=>g.config.sd.width.numberInputMax),d=b(g=>g.config.sd.width.coarseStep),f=b(g=>g.config.sd.width.fineStep),m=u.useCallback(g=>{t.widthChanged(g)},[t]),h=u.useMemo(()=>[o,n,r],[o,n,r]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"paramWidth",children:s.jsx(Y,{children:e("parameters.width")})}),s.jsx(Ne,{value:t.width,onChange:m,defaultValue:n,min:o,max:r,step:d,fineStep:f,marks:h}),s.jsx(Ee,{value:t.width,onChange:m,defaultValue:n,min:a,max:c,step:d,fineStep:f})]})});Lk.displayName="ParamWidth";const Tk=u.memo(()=>{const e=O(),t=b(d=>d.generation.width),n=b(d=>d.generation.height),o=b(d=>d.generation.aspectRatio),r=u.useCallback(d=>{e(zy(d))},[e]),a=u.useCallback(d=>{e(Oy(d))},[e]),c=u.useCallback(d=>{e(w3(d))},[e]);return s.jsx(_0,{width:t,height:n,aspectRatioState:o,heightComponent:s.jsx(_k,{}),widthComponent:s.jsx(Lk,{}),onChangeAspectRatioState:c,onChangeWidth:r,onChangeHeight:a})});Tk.displayName="ImageSizeLinear";const wW=Ve([bs,js,k3,ys],(e,t,n,o)=>{const{shouldRandomizeSeed:r,model:a}=e,{hrfEnabled:c}=n,d=[];if(o==="unifiedCanvas"){const{aspectRatio:f,boundingBoxDimensions:{width:m,height:h}}=t;d.push(`${m}×${h}`),d.push(f.id),f.isLocked&&d.push("locked")}else{const{aspectRatio:f,width:m,height:h}=e;d.push(`${m}×${h}`),d.push(f.id),f.isLocked&&d.push("locked")}return r||d.push("Manual Seed"),c&&d.push("HiRes Fix"),{badges:d,activeTabName:o,isSDXL:(a==null?void 0:a.base)==="sdxl"}}),kW={minW:"4.5rem"},Rk=u.memo(()=>{const{t:e}=L(),{badges:t,activeTabName:n,isSDXL:o}=b(wW),{isOpen:r,onToggle:a}=Ci({id:"image-settings",defaultIsOpen:!0}),{isOpen:c,onToggle:d}=yk({id:"image-settings-advanced",defaultIsOpen:!1});return s.jsx(ci,{label:e("accordions.image.title"),badges:t,isOpen:r,onToggle:a,children:s.jsxs(P,{px:4,pt:4,w:"full",h:"full",flexDir:"column",children:[n==="unifiedCanvas"?s.jsx(Ek,{}):s.jsx(Tk,{}),s.jsx(Vy,{label:e("accordions.advanced.options"),isOpen:c,onToggle:d,children:s.jsxs(P,{gap:4,pb:4,flexDir:"column",children:[s.jsxs(P,{gap:4,alignItems:"center",children:[s.jsx(Sk,{}),s.jsx(kk,{}),s.jsx(wk,{})]}),(n==="img2img"||n==="unifiedCanvas")&&s.jsx(lW,{}),n==="img2img"&&s.jsx(oW,{}),n==="txt2img"&&!o&&s.jsx(jk,{}),n==="unifiedCanvas"&&s.jsxs(s.Fragment,{children:[s.jsx(X$,{}),s.jsxs(En,{formLabelProps:kW,children:[s.jsx(nW,{}),s.jsx(eW,{})]})]})]})})]})})});Rk.displayName="ImageSettingsAccordion";const IW=()=>{const{t:e}=L(),t=O(),n=b(x=>x.sdxl.refinerCFGScale),o=b(x=>x.config.sd.guidance.sliderMin),r=b(x=>x.config.sd.guidance.sliderMax),a=b(x=>x.config.sd.guidance.numberInputMin),c=b(x=>x.config.sd.guidance.numberInputMax),d=b(x=>x.config.sd.guidance.coarseStep),f=b(x=>x.config.sd.guidance.fineStep),m=b(x=>x.config.sd.guidance.initial),h=u.useMemo(()=>[o,Math.floor(r/2),r],[r,o]),g=u.useCallback(x=>t(oy(x)),[t]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"refinerCfgScale",children:s.jsx(Y,{children:e("sdxl.cfgScale")})}),s.jsx(Ne,{value:n,defaultValue:m,min:o,max:r,step:d,fineStep:f,onChange:g,marks:h}),s.jsx(Ee,{value:n,defaultValue:m,min:a,max:c,step:d,fineStep:f,onChange:g})]})},MW=u.memo(IW),AW=e=>{const{t}=L(),{modelConfigs:n,selectedModel:o,getIsDisabled:r,onChange:a,isLoading:c,optionsFilter:d=()=>!0}=e,f=u.useMemo(()=>n.filter(d).map(C=>({label:C.name,value:C.key,isDisabled:r?r(C):!1})),[d,r,n]),m=u.useMemo(()=>f.find(C=>o?C.value===o.key:!1),[f,o]),h=u.useCallback(C=>{if(!C){a(null);return}const j=n.find(S=>S.key===C.value);if(!j){a(null);return}a(j)},[n,a]),g=u.useMemo(()=>c?t("common.loading"):f.length===0?t("models.noModelsAvailable"):t("models.selectModel"),[c,f,t]),x=u.useCallback(()=>t("models.noMatchingModels"),[t]);return{options:f,value:m,onChange:h,placeholder:g,noOptionsMessage:x}},PW=Ve(Gy,e=>e.refinerModel),DW=e=>e.base==="sdxl-refiner",EW=()=>{const e=O(),t=b(PW),{t:n}=L(),[o,{isLoading:r}]=Kg(),a=u.useCallback(g=>{if(!g){e(sp(null));return}e(sp(Wo.parse(g)))},[e]),{options:c,value:d,onChange:f,placeholder:m,noOptionsMessage:h}=AW({modelConfigs:o,onChange:a,selectedModel:t,isLoading:r,optionsFilter:DW});return s.jsxs($,{isDisabled:!c.length,isInvalid:!c.length,children:[s.jsx(Ke,{feature:"refinerModel",children:s.jsx(Y,{children:n("sdxl.refinermodel")})}),s.jsx(ot,{value:d,placeholder:m,options:c,onChange:f,noOptionsMessage:h,isClearable:!0})]})},_W=u.memo(EW),LW=()=>{const e=b(r=>r.sdxl.refinerNegativeAestheticScore),t=O(),{t:n}=L(),o=u.useCallback(r=>t(ly(r)),[t]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"refinerNegativeAestheticScore",children:s.jsx(Y,{children:n("sdxl.negAestheticScore")})}),s.jsx(Ne,{min:1,max:10,step:.5,fineStep:.1,onChange:o,value:e,defaultValue:2.5,marks:!0}),s.jsx(Ee,{min:1,max:10,step:.5,fineStep:.1,onChange:o,value:e,defaultValue:2.5})]})},TW=u.memo(LW),RW=()=>{const e=b(r=>r.sdxl.refinerPositiveAestheticScore),t=O(),{t:n}=L(),o=u.useCallback(r=>t(ay(r)),[t]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"refinerPositiveAestheticScore",children:s.jsx(Y,{children:n("sdxl.posAestheticScore")})}),s.jsx(Ne,{step:.5,min:1,max:10,fineStep:.1,onChange:o,value:e,defaultValue:6,marks:!0}),s.jsx(Ee,{step:.5,min:1,max:10,fineStep:.1,onChange:o,value:e,defaultValue:6})]})},BW=u.memo(RW),NW=()=>{const e=O(),{t}=L(),n=b(a=>a.sdxl.refinerScheduler),o=u.useCallback(a=>{ai(a==null?void 0:a.value)&&e(ry(a.value))},[e]),r=u.useMemo(()=>Qr.find(a=>a.value===n),[n]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"refinerScheduler",children:s.jsx(Y,{children:t("sdxl.scheduler")})}),s.jsx(ot,{value:r,options:Qr,onChange:o})]})},zW=u.memo(NW),OW=()=>{const e=b(r=>r.sdxl.refinerStart),t=O(),n=u.useCallback(r=>t(iy(r)),[t]),{t:o}=L();return s.jsxs($,{children:[s.jsx(Ke,{feature:"refinerStart",children:s.jsx(Y,{children:o("sdxl.refinerStart")})}),s.jsx(Ne,{step:.01,min:0,max:1,onChange:n,defaultValue:.8,value:e,marks:!0}),s.jsx(Ee,{step:.01,min:0,max:1,onChange:n,defaultValue:.8,value:e})]})},FW=u.memo(OW),VW=()=>{const{t:e}=L(),t=O(),n=b(x=>x.sdxl.refinerSteps),o=b(x=>x.config.sd.steps.initial),r=b(x=>x.config.sd.steps.sliderMin),a=b(x=>x.config.sd.steps.sliderMax),c=b(x=>x.config.sd.steps.numberInputMin),d=b(x=>x.config.sd.steps.numberInputMax),f=b(x=>x.config.sd.steps.coarseStep),m=b(x=>x.config.sd.steps.fineStep),h=u.useMemo(()=>[r,Math.floor(a/2),a],[a,r]),g=u.useCallback(x=>{t(sy(x))},[t]);return s.jsxs($,{children:[s.jsx(Ke,{feature:"refinerSteps",children:s.jsx(Y,{children:e("sdxl.steps")})}),s.jsx(Ne,{value:n,defaultValue:o,min:r,max:a,step:f,fineStep:m,onChange:g,marks:h}),s.jsx(Ee,{value:n,defaultValue:o,min:c,max:d,step:f,fineStep:m,onChange:g})]})},HW=u.memo(VW),$W=()=>{const[e]=Kg();return!!e.length},WW={minW:"9.2rem"},GW={minW:"5rem"},UW=Ve(Gy,e=>e.refinerModel?["Enabled"]:void 0),Bk=u.memo(()=>{const{t:e}=L(),t=$W(),n=b(UW),{isOpen:o,onToggle:r}=Ci({id:"refiner-settings",defaultIsOpen:!1});return s.jsx(ci,{label:e("sdxl.refiner"),badges:n,isOpen:o,onToggle:r,children:t?s.jsx(zk,{}):s.jsx(Nk,{})})});Bk.displayName="RefinerSettingsAccordion";const Nk=u.memo(()=>{const{t:e}=L();return s.jsx(P,{justifyContent:"center",p:4,children:s.jsx(re,{fontSize:"sm",color:"base.500",children:e("models.noRefinerModelsInstalled")})})});Nk.displayName="RefinerSettingsAccordionNoRefiner";const zk=u.memo(()=>{const e=b(t=>!ln(t.sdxl.refinerModel));return s.jsx(En,{isDisabled:!e,children:s.jsxs(P,{p:4,gap:4,flexDir:"column",children:[s.jsx(_W,{}),s.jsxs(En,{formLabelProps:GW,isDisabled:!e,children:[s.jsx(zW,{}),s.jsx(HW,{}),s.jsx(MW,{}),s.jsx(FW,{})]}),s.jsxs(En,{formLabelProps:WW,isDisabled:!e,children:[s.jsx(BW,{}),s.jsx(TW,{})]})]})})});zk.displayName="RefinerSettingsAccordionContent";const ZW={height:"100%",width:"100%"},qW=()=>{const e=b(ys),t=b(n=>{var o;return((o=n.generation.model)==null?void 0:o.base)==="sdxl"});return s.jsxs(P,{w:"full",h:"full",flexDir:"column",gap:2,children:[s.jsx(YS,{}),s.jsx(P,{w:"full",h:"full",position:"relative",children:s.jsx(Ae,{position:"absolute",top:0,left:0,right:0,bottom:0,children:s.jsx(Af,{defer:!0,style:ZW,options:Oc.options,children:s.jsxs(P,{gap:2,flexDirection:"column",h:"full",w:"full",children:[t?s.jsx(ik,{}):s.jsx(rk,{}),s.jsx(Rk,{}),s.jsx(bk,{}),s.jsx(gk,{}),e==="unifiedCanvas"&&s.jsx(uk,{}),t&&s.jsx(Bk,{}),s.jsx(ck,{})]})})})})]})},QW=u.memo(qW),KW=Ve(bs,e=>e.initialImage),YW=()=>{const{t:e}=L(),t=O(),n=b(KW),o=b(f=>f.system.isConnected),{currentData:r,isError:a}=Gs((n==null?void 0:n.imageName)??Ot),c=u.useMemo(()=>{if(r)return{id:"initial-image",payloadType:"IMAGE_DTO",payload:{imageDTO:r}}},[r]),d=u.useMemo(()=>({id:"initial-image",actionType:"SET_INITIAL_IMAGE"}),[]);return u.useEffect(()=>{a&&o&&t(Uy())},[t,o,a]),s.jsx(Jr,{imageDTO:r,droppableData:d,draggableData:c,isUploadDisabled:!0,fitContainer:!0,dropLabel:e("toast.setInitialImage"),noContentFallback:s.jsx(Ut,{label:e("parameters.invoke.noInitialImageSelected")}),dataTestId:"initial-image"})},XW=u.memo(YW),JW=Ve(bs,e=>e.initialImage),eG={type:"SET_INITIAL_IMAGE"},tG=()=>{const{t:e}=L(),t=b(JW),n=O(),{getUploadButtonProps:o,getUploadInputProps:r}=h0({postUploadAction:eG}),a=u.useCallback(()=>{n(Uy())},[n]),c=u.useCallback(()=>{t&&FS(t)},[t]);return Re("shift+d",c,[t]),s.jsxs(P,{layerStyle:"first",position:"relative",flexDirection:"column",height:"full",width:"full",alignItems:"center",justifyContent:"center",borderRadius:"base",p:2,gap:4,children:[s.jsxs(P,{w:"full",flexWrap:"wrap",justifyContent:"center",alignItems:"center",gap:2,children:[s.jsx(re,{ps:2,fontWeight:"semibold",userSelect:"none",color:"base.200",children:e("metadata.initImage")}),s.jsx(Tn,{}),s.jsx(ve,{tooltip:e("toast.uploadInitialImage"),"aria-label":e("toast.uploadInitialImage"),icon:s.jsx(mi,{}),...o()}),s.jsx(ve,{tooltip:`${e("parameters.useSize")} (Shift+D)`,"aria-label":`${e("parameters.useSize")} (Shift+D)`,icon:s.jsx(Dg,{}),onClick:c,isDisabled:!t}),s.jsx(ve,{tooltip:e("toast.resetInitialImage"),"aria-label":e("toast.resetInitialImage"),icon:s.jsx(ca,{}),onClick:a,isDisabled:!t})]}),s.jsx(XW,{}),s.jsx("input",{...r()})]})},nG=u.memo(tG),Ok=u.memo(e=>{const{onClick:t,isDisabled:n}=e,{t:o}=L(),r=b(a=>a.system.isConnected);return s.jsx(ve,{onClick:t,icon:s.jsx(Xs,{}),tooltip:`${o("gallery.deleteImage")} (Del)`,"aria-label":`${o("gallery.deleteImage")} (Del)`,isDisabled:n||!r,colorScheme:"error"})});Ok.displayName="DeleteImageButton";const Fk=()=>{const[e,{isLoading:t}]=Jd({fixedCacheKey:"enqueueBatch"}),[n,{isLoading:o}]=gy({fixedCacheKey:"resumeProcessor"}),[r,{isLoading:a}]=py({fixedCacheKey:"pauseProcessor"}),[c,{isLoading:d}]=Zp({fixedCacheKey:"cancelQueueItem"}),[f,{isLoading:m}]=CC({fixedCacheKey:"clearQueue"}),[h,{isLoading:g}]=Zy({fixedCacheKey:"pruneQueue"});return t||o||a||d||m||g},Tv=[{label:"x2 Upscalers",options:[{label:"RealESRGAN x2 Plus",value:"RealESRGAN_x2plus.pth",description:"Attempts to retain sharpness, low smoothing"}]},{label:"x4 Upscalers",options:[{label:"RealESRGAN x4 Plus",value:"RealESRGAN_x4plus.pth",description:"Best for photos and highly detailed images, medium smoothing"},{label:"RealESRGAN x4 Plus (anime 6B)",value:"RealESRGAN_x4plus_anime_6B.pth",description:"Best for anime/manga, high smoothing"},{label:"ESRGAN SRx4",value:"ESRGAN_SRx4_DF2KOST_official-ff704c30.pth",description:"Retains sharpness, low smoothing"}]}],sG=()=>{const{t:e}=L(),t=b(a=>a.postprocessing.esrganModelName),n=O(),o=u.useCallback(a=>{I3(a==null?void 0:a.value)&&n(M3(a.value))},[n]),r=u.useMemo(()=>Tv.flatMap(a=>a.options).find(a=>a.value===t),[t]);return s.jsxs($,{orientation:"vertical",children:[s.jsxs(Y,{children:[e("models.esrganModel")," "]}),s.jsx(ot,{value:r,onChange:o,options:Tv})]})},oG=u.memo(sG),rG=e=>{const{imageDTO:t}=e,n=O(),o=Fk(),{t:r}=L(),{isOpen:a,onOpen:c,onClose:d}=fn(),{isAllowedToUpscale:f,detail:m}=A3(t),h=u.useCallback(()=>{d(),!(!t||!f)&&n(qy({imageDTO:t}))},[n,t,f,d]);return s.jsxs(oa,{isOpen:a,onClose:d,isLazy:!0,children:[s.jsx(oi,{children:s.jsx(ve,{tooltip:r("parameters.upscale"),onClick:c,icon:s.jsx(Zb,{}),"aria-label":r("parameters.upscale")})}),s.jsx(ra,{children:s.jsx(aa,{minW:96,children:s.jsxs(P,{flexDirection:"column",gap:4,children:[s.jsx(oG,{}),s.jsx(qe,{tooltip:m,size:"sm",isDisabled:!t||o||!f,onClick:h,children:r("parameters.upscaleImage")})]})})})]})},aG=u.memo(rG),lG=it(ni,kc,lf,(e,t,n)=>{var r;return!!((r=e.denoiseProgress)!=null&&r.progress_image)||!n}),iG=()=>{const e=O(),t=b(B=>B.system.isConnected),n=b(B=>B.ui.shouldShowImageDetails),o=b(B=>B.ui.shouldShowProgressInViewer),r=b(lf),a=b(lG),c=cn("upscaling").isFeatureEnabled,d=Fk(),f=Uo(),{t:m}=L(),{currentData:h}=Gs((r==null?void 0:r.image_name)??Ot),{recallAll:g,remix:x,recallSeed:C,recallPrompts:j,hasMetadata:S,hasSeed:M,hasPrompts:I,isLoadingMetadata:k}=HS(r==null?void 0:r.image_name),{getAndLoadEmbeddedWorkflow:D,getAndLoadEmbeddedWorkflowResult:T}=$S({}),E=u.useCallback(()=>{!r||!r.has_workflow||D(r.image_name)},[D,r]);Re("w",E,[r]),Re("a",g,[g]),Re("s",C,[C]),Re("p",j,[j]),Re("r",x,[x]);const A=u.useCallback(()=>{FS(r)},[r]);Re("d",A,[A]);const N=u.useCallback(()=>{e(RS()),e(ug(h))},[e,h]);Re("shift+i",N,[h]);const W=u.useCallback(()=>{h&&e(qy({imageDTO:h}))},[e,h]),G=u.useCallback(()=>{h&&e(cf([h]))},[e,h]);Re("Shift+U",()=>{W()},{enabled:()=>!!(c&&!a&&t)},[c,h,a,t]);const z=u.useCallback(()=>e(P3(!n)),[e,n]);Re("i",()=>{h?z():f({title:m("toast.metadataLoadFailed"),status:"error",duration:2500,isClosable:!0})},[h,n,f]),Re("delete",()=>{G()},[e,h]);const X=u.useCallback(()=>{e(_y(!o))},[e,o]);return s.jsx(s.Fragment,{children:s.jsxs(P,{flexWrap:"wrap",justifyContent:"center",alignItems:"center",gap:2,children:[s.jsx(Nt,{isDisabled:a,children:s.jsxs(Ic,{isLazy:!0,children:[s.jsx(Mc,{as:ve,"aria-label":m("parameters.imageActions"),tooltip:m("parameters.imageActions"),isDisabled:!h,icon:s.jsx(_g,{})}),s.jsx(qr,{children:h&&s.jsx(WS,{imageDTO:h})})]})}),s.jsxs(Nt,{isDisabled:a,children:[s.jsx(ve,{icon:s.jsx(Pg,{}),tooltip:`${m("nodes.loadWorkflow")} (W)`,"aria-label":`${m("nodes.loadWorkflow")} (W)`,isDisabled:!(h!=null&&h.has_workflow),onClick:E,isLoading:T.isLoading}),s.jsx(ve,{isLoading:k,icon:s.jsx(Ob,{}),tooltip:`${m("parameters.remixImage")} (R)`,"aria-label":`${m("parameters.remixImage")} (R)`,isDisabled:!S,onClick:x}),s.jsx(ve,{isLoading:k,icon:s.jsx(Kb,{}),tooltip:`${m("parameters.usePrompt")} (P)`,"aria-label":`${m("parameters.usePrompt")} (P)`,isDisabled:!I,onClick:j}),s.jsx(ve,{isLoading:k,icon:s.jsx(Qb,{}),tooltip:`${m("parameters.useSeed")} (S)`,"aria-label":`${m("parameters.useSeed")} (S)`,isDisabled:!M,onClick:C}),s.jsx(ve,{isLoading:k,icon:s.jsx(Dg,{}),tooltip:`${m("parameters.useSize")} (D)`,"aria-label":`${m("parameters.useSize")} (D)`,onClick:A}),s.jsx(ve,{isLoading:k,icon:s.jsx(Fb,{}),tooltip:`${m("parameters.useAll")} (A)`,"aria-label":`${m("parameters.useAll")} (A)`,isDisabled:!S,onClick:g})]}),c&&s.jsx(Nt,{isDisabled:d,children:c&&s.jsx(aG,{imageDTO:h})}),s.jsx(Nt,{children:s.jsx(ve,{icon:s.jsx(Rc,{}),tooltip:`${m("parameters.info")} (I)`,"aria-label":`${m("parameters.info")} (I)`,isChecked:n,onClick:z})}),s.jsx(Nt,{children:s.jsx(ve,{"aria-label":m("settings.displayInProgress"),tooltip:m("settings.displayInProgress"),icon:s.jsx(ED,{}),isChecked:o,onClick:X})}),s.jsx(Nt,{children:s.jsx(Ok,{onClick:G})})]})})},cG=u.memo(iG),uG=()=>{const e=b(o=>{var r;return(r=o.system.denoiseProgress)==null?void 0:r.progress_image}),t=b(o=>o.system.shouldAntialiasProgressImage),n=u.useMemo(()=>({imageRendering:t?"auto":"pixelated"}),[t]);return e?s.jsx(Ks,{src:e.dataURL,width:e.width,height:e.height,draggable:!1,"data-testid":"progress-image",objectFit:"contain",maxWidth:"full",maxHeight:"full",position:"absolute",borderRadius:"base",sx:n}):null},dG=u.memo(uG),fG=()=>{const{t:e}=L();return s.jsx(re,{children:e("common.loading")})},hG=()=>{const{t:e}=L();return s.jsx(re,{children:e("metadata.parsingFailed")})},Vk=(e,t)=>{const[n,o]=u.useState(Il),[r,a]=u.useState(null);u.useEffect(()=>{(async()=>{try{const x=await t.parse(e);o(x)}catch{o(Ea)}})()},[t,e]);const c=u.useMemo(()=>n===Il||n===Ea,[n]),d=u.useMemo(()=>t.getLabel(),[t]);u.useEffect(()=>{(async()=>{if(n===Il){a(null);return}if(n===Ea){a(null);return}const x=await t.renderValue(n);a(x)})()},[t,n]);const f=u.useMemo(()=>n===Il?s.jsx(fG,{}):n===Ea?s.jsx(hG,{}):s.jsx(re,{children:r}),[r,n]),m=u.useCallback(()=>{if(!t.recall||n===Il||n===Ea)return null;t.recall(n,!0)},[t,n]),h=u.useMemo(()=>n===Il||n===Ea?null:n,[n]);return{label:d,isDisabled:c,value:n,renderedValue:f,onRecall:m,valueOrNull:h}},Hk=u.memo(({label:e,...t})=>{const{t:n}=L();return s.jsx(Dt,{label:n("metadata.recallParameter",{label:e}),children:s.jsx(ve,{"aria-label":n("metadata.recallParameter",{label:e}),icon:s.jsx(uD,{}),size:"xs",variant:"ghost",...t})})});Hk.displayName="RecallButton";const yi=u.memo(({label:e,onRecall:t,isDisabled:n,renderedValue:o,direction:r="row"})=>s.jsxs(P,{gap:2,children:[t&&s.jsx(Hk,{label:e,onClick:t,isDisabled:n}),s.jsxs(P,{direction:r,fontSize:"sm",children:[s.jsxs(re,{fontWeight:"semibold",whiteSpace:"pre-wrap",pr:2,children:[e,":"]}),o]})]}));yi.displayName="MetadataItemView";const mG=({metadata:e})=>{const[t,n]=u.useState([]);u.useEffect(()=>{(async()=>{try{const a=await Fe.controlNets.parse(e);n(a)}catch{n([])}})()},[e]);const o=u.useMemo(()=>Fe.controlNets.getLabel(),[]);return s.jsx(s.Fragment,{children:t.map(r=>s.jsx(pG,{label:o,controlNet:r,handlers:Fe.controlNets},r.id))})},pG=({label:e,controlNet:t,handlers:n})=>{const o=u.useCallback(()=>{n.recallItem&&n.recallItem(t,!0)},[n,t]),[r,a]=u.useState(null);return u.useEffect(()=>{(async()=>{if(!n.renderItemValue){a(null);return}const d=await n.renderItemValue(t);a(d)})()},[n,t]),s.jsx(yi,{label:e,isDisabled:!1,onRecall:o,renderedValue:r})},gG=({metadata:e})=>{const[t,n]=u.useState([]);u.useEffect(()=>{(async()=>{try{const a=await Fe.ipAdapters.parse(e);n(a)}catch{n([])}})()},[e]);const o=u.useMemo(()=>Fe.ipAdapters.getLabel(),[]);return s.jsx(s.Fragment,{children:t.map(r=>s.jsx(xG,{label:o,ipAdapter:r,handlers:Fe.ipAdapters},r.id))})},xG=({label:e,ipAdapter:t,handlers:n})=>{const o=u.useCallback(()=>{n.recallItem&&n.recallItem(t,!0)},[n,t]),[r,a]=u.useState(null);return u.useEffect(()=>{(async()=>{if(!n.renderItemValue){a(null);return}const d=await n.renderItemValue(t);a(d)})()},[n,t]),s.jsx(yi,{label:e,isDisabled:!1,onRecall:o,renderedValue:r})},vG=xg(({metadata:e,handlers:t,direction:n="row"})=>{const{label:o,isDisabled:r,value:a,renderedValue:c,onRecall:d}=Vk(e,t);return a===Ea?null:s.jsx(yi,{label:o,onRecall:d,isDisabled:r,renderedValue:c,direction:n})}),Ht=xg(vG);Ht.displayName="MetadataItem";const CG=({metadata:e})=>{const[t,n]=u.useState([]);u.useEffect(()=>{(async()=>{try{const a=await Fe.loras.parse(e);n(a)}catch{n([])}})()},[e]);const o=u.useMemo(()=>Fe.loras.getLabel(),[]);return s.jsx(s.Fragment,{children:t.map(r=>s.jsx(yG,{label:o,lora:r,handlers:Fe.loras},r.model.key))})},yG=({label:e,lora:t,handlers:n})=>{const o=u.useCallback(()=>{n.recallItem&&n.recallItem(t,!0)},[n,t]),[r,a]=u.useState(null);return u.useEffect(()=>{(async()=>{if(!n.renderItemValue){a(null);return}const d=await n.renderItemValue(t);a(d)})()},[n,t]),s.jsx(yi,{label:e,isDisabled:!1,onRecall:o,renderedValue:r})},bG=({metadata:e})=>{const[t,n]=u.useState([]);u.useEffect(()=>{(async()=>{try{const a=await Fe.t2iAdapters.parse(e);n(a)}catch{n([])}})()},[e]);const o=u.useMemo(()=>Fe.t2iAdapters.getLabel(),[]);return s.jsx(s.Fragment,{children:t.map(r=>s.jsx(jG,{label:o,t2iAdapter:r,handlers:Fe.t2iAdapters},r.id))})},jG=({label:e,t2iAdapter:t,handlers:n})=>{const o=u.useCallback(()=>{n.recallItem&&n.recallItem(t,!0)},[n,t]),[r,a]=u.useState(null);return u.useEffect(()=>{(async()=>{if(!n.renderItemValue){a(null);return}const d=await n.renderItemValue(t);a(d)})()},[n,t]),s.jsx(yi,{label:e,isDisabled:!1,onRecall:o,renderedValue:r})},SG=e=>{const{metadata:t}=e;return!t||Object.keys(t).length===0?null:s.jsxs(s.Fragment,{children:[s.jsx(Ht,{metadata:t,handlers:Fe.generationMode}),s.jsx(Ht,{metadata:t,handlers:Fe.positivePrompt,direction:"column"}),s.jsx(Ht,{metadata:t,handlers:Fe.negativePrompt,direction:"column"}),s.jsx(Ht,{metadata:t,handlers:Fe.sdxlPositiveStylePrompt,direction:"column"}),s.jsx(Ht,{metadata:t,handlers:Fe.sdxlNegativeStylePrompt,direction:"column"}),s.jsx(Ht,{metadata:t,handlers:Fe.model}),s.jsx(Ht,{metadata:t,handlers:Fe.vae}),s.jsx(Ht,{metadata:t,handlers:Fe.width}),s.jsx(Ht,{metadata:t,handlers:Fe.height}),s.jsx(Ht,{metadata:t,handlers:Fe.seed}),s.jsx(Ht,{metadata:t,handlers:Fe.steps}),s.jsx(Ht,{metadata:t,handlers:Fe.scheduler}),s.jsx(Ht,{metadata:t,handlers:Fe.cfgScale}),s.jsx(Ht,{metadata:t,handlers:Fe.cfgRescaleMultiplier}),s.jsx(Ht,{metadata:t,handlers:Fe.strength}),s.jsx(Ht,{metadata:t,handlers:Fe.hrfEnabled}),s.jsx(Ht,{metadata:t,handlers:Fe.hrfMethod}),s.jsx(Ht,{metadata:t,handlers:Fe.hrfStrength}),s.jsx(Ht,{metadata:t,handlers:Fe.refinerCFGScale}),s.jsx(Ht,{metadata:t,handlers:Fe.refinerModel}),s.jsx(Ht,{metadata:t,handlers:Fe.refinerNegativeAestheticScore}),s.jsx(Ht,{metadata:t,handlers:Fe.refinerPositiveAestheticScore}),s.jsx(Ht,{metadata:t,handlers:Fe.refinerScheduler}),s.jsx(Ht,{metadata:t,handlers:Fe.refinerStart}),s.jsx(Ht,{metadata:t,handlers:Fe.refinerSteps}),s.jsx(CG,{metadata:t}),s.jsx(mG,{metadata:t}),s.jsx(bG,{metadata:t}),s.jsx(gG,{metadata:t})]})},wG=u.memo(SG),kG=e=>{const t=b(a=>a.config.workflowFetchDebounce??300),[n]=m0(e!=null&&e.has_workflow?e.image_name:null,t),{data:o,isLoading:r}=D3(n??Ot);return{workflow:o,isLoading:r}},IG=({image:e})=>{const{t}=L(),{workflow:n}=kG(e);return n?s.jsx(ta,{data:n,label:t("metadata.workflow")}):s.jsx(Ut,{label:t("nodes.noWorkflow")})},MG=u.memo(IG),AG=({image:e})=>{const{t}=L(),{metadata:n}=VS(e.image_name),o=Vk(n,Fe.createdBy);return s.jsxs(P,{layerStyle:"first",padding:4,gap:1,flexDirection:"column",width:"full",height:"full",borderRadius:"base",position:"absolute",overflow:"hidden",children:[s.jsx(fd,{href:e.image_url,label:e.image_name}),o.valueOrNull&&s.jsxs(re,{children:[t("metadata.createdBy"),": ",o.valueOrNull]}),s.jsxs(Ja,{variant:"line",isLazy:!0,display:"flex",flexDir:"column",w:"full",h:"full",children:[s.jsxs(el,{children:[s.jsx(pn,{children:t("metadata.recallParameters")}),s.jsx(pn,{children:t("metadata.metadata")}),s.jsx(pn,{children:t("metadata.imageDetails")}),s.jsx(pn,{children:t("metadata.workflow")})]}),s.jsxs(ii,{children:[s.jsx(Pn,{children:n?s.jsx(Wn,{children:s.jsx(wG,{metadata:n})}):s.jsx(Ut,{label:t("metadata.noRecallParameters")})}),s.jsx(Pn,{children:n?s.jsx(ta,{data:n,label:t("metadata.metadata")}):s.jsx(Ut,{label:t("metadata.noMetaData")})}),s.jsx(Pn,{children:e?s.jsx(ta,{data:e,label:t("metadata.imageDetails")}):s.jsx(Ut,{label:t("metadata.noImageDetails")})}),s.jsx(Pn,{children:s.jsx(MG,{image:e})})]})]})]})},PG=u.memo(AG),qm={color:"base.100",pointerEvents:"auto"},DG=()=>{const{t:e}=L(),{handleLeftImage:t,handleRightImage:n,isOnFirstImage:o,isOnLastImage:r}=nS(),{areMoreImagesAvailable:a,handleLoadMoreImages:c,queryResult:{isFetching:d}}=Tf();return s.jsxs(Ae,{pos:"relative",h:"full",w:"full",children:[s.jsx(Ae,{pos:"absolute",top:"50%",transform:"translate(0, -50%)",insetInlineStart:1,children:!o&&s.jsx(ve,{"aria-label":e("accessibility.previousImage"),icon:s.jsx(Vb,{size:64}),variant:"unstyled",onClick:t,boxSize:16,sx:qm})}),s.jsxs(Ae,{pos:"absolute",top:"50%",transform:"translate(0, -50%)",insetInlineEnd:6,children:[!r&&s.jsx(ve,{"aria-label":e("accessibility.nextImage"),icon:s.jsx(Hb,{size:64}),variant:"unstyled",onClick:n,boxSize:16,sx:qm}),r&&a&&!d&&s.jsx(ve,{"aria-label":e("accessibility.loadMore"),icon:s.jsx(xD,{size:64}),variant:"unstyled",onClick:c,boxSize:16,sx:qm}),r&&a&&d&&s.jsx(P,{w:16,h:16,alignItems:"center",justifyContent:"center",children:s.jsx(la,{opacity:.5,size:"xl"})})]})]})},$k=u.memo(DG),EG=it(lf,e=>e==null?void 0:e.image_name),_G=()=>{const e=b(C=>C.ui.shouldShowImageDetails),t=b(EG),n=b(C=>!!C.system.denoiseProgress),o=b(C=>C.ui.shouldShowProgressInViewer),{currentData:r}=Gs(t??Ot),a=u.useMemo(()=>{if(r)return{id:"current-image",payloadType:"IMAGE_DTO",payload:{imageDTO:r}}},[r]),c=u.useMemo(()=>({id:"current-image",actionType:"SET_CURRENT_IMAGE"}),[]),[d,f]=u.useState(!1),m=u.useRef(0),{t:h}=L(),g=u.useCallback(()=>{f(!0),window.clearTimeout(m.current)},[]),x=u.useCallback(()=>{m.current=window.setTimeout(()=>{f(!1)},500)},[]);return s.jsxs(P,{onMouseOver:g,onMouseOut:x,width:"full",height:"full",alignItems:"center",justifyContent:"center",position:"relative",children:[n&&o?s.jsx(dG,{}):s.jsx(Jr,{imageDTO:r,droppableData:c,draggableData:a,isUploadDisabled:!0,fitContainer:!0,useThumbailFallback:!0,dropLabel:h("gallery.setCurrentImage"),noContentFallback:s.jsx(Ut,{icon:dc,label:h("gallery.noImageSelected")}),dataTestId:"image-preview"}),e&&r&&s.jsx(Ae,{position:"absolute",top:"0",width:"full",height:"full",borderRadius:"base",children:s.jsx(PG,{image:r})}),s.jsx(Ul,{children:!e&&r&&d&&s.jsx(Oa.div,{initial:TG,animate:RG,exit:BG,style:NG,children:s.jsx($k,{})},"nextPrevButtons")})]})},LG=u.memo(_G),TG={opacity:0},RG={opacity:1,transition:{duration:.1}},BG={opacity:0,transition:{duration:.1}},NG={position:"absolute",top:"0",width:"100%",height:"100%",pointerEvents:"none"},zG=()=>s.jsxs(P,{position:"relative",flexDirection:"column",height:"100%",width:"100%",rowGap:4,alignItems:"center",justifyContent:"center",children:[s.jsx(cG,{}),s.jsx(LG,{})]}),Wk=u.memo(zG),OG=()=>s.jsx(Ae,{layerStyle:"first",position:"relative",w:"full",h:"full",p:2,borderRadius:"base",children:s.jsx(P,{w:"full",h:"full",children:s.jsx(Wk,{})})}),Gk=u.memo(OG),FG={height:"100%",width:"100%"},VG={position:"relative"},HG=()=>{const e=u.useRef(null),t=u.useCallback(()=>{e.current&&e.current.setLayout([50,50])},[]),n=C0();return s.jsx(Ae,{w:"full",h:"full",children:s.jsxs(Qf,{ref:e,autoSaveId:"imageTab.content",direction:"horizontal",style:FG,storage:n,children:[s.jsx(Ur,{id:"imageTab.content.initImage",order:0,defaultSize:50,minSize:25,style:VG,children:s.jsx(nG,{})}),s.jsx(Gd,{orientation:"vertical",onDoubleClick:t}),s.jsx(Ur,{id:"imageTab.content.selectedImage",order:1,defaultSize:50,minSize:25,children:s.jsx(Gk,{})})]})})},$G=u.memo(HG),rr=u.memo(({loadingMessage:e})=>s.jsx(P,{flexDirection:"column",gap:4,borderRadius:"base",p:4,bg:"base.800",children:s.jsxs(P,{justifyContent:"center",alignItems:"center",flexDirection:"column",p:4,gap:8,children:[s.jsx(la,{}),s.jsx(re,{variant:"subtext",children:e||"Fetching..."})]})}));rr.displayName="FetchingModelsLoader";const WG={any:"base","sd-1":"green","sd-2":"teal",sdxl:"invokeBlue","sdxl-refiner":"invokeBlue"},GG=({base:e})=>s.jsx(Ws,{flexGrow:0,colorScheme:WG[e],variant:"subtle",h:"min-content",children:E3[e]}),Uk=u.memo(GG),UG={diffusers:"diffusers",lycoris:"lycoris",checkpoint:"checkpoint",invokeai:"internal",embedding_file:"embedding",embedding_folder:"embedding"},ZG={diffusers:"base",lycoris:"base",checkpoint:"orange",invokeai:"base",embedding_file:"base",embedding_folder:"base"},qG=({format:e})=>s.jsx(Ws,{flexGrow:0,colorScheme:ZG[e],variant:"subtle",children:UG[e]}),QG=u.memo(qG),Zc=u.memo,lr="40px",KG="24px",YG=({image_url:e})=>e?s.jsx(Ks,{src:e,objectFit:"cover",objectPosition:"50% 50%",height:lr,width:lr,minHeight:lr,minWidth:lr,borderRadius:"base"}):s.jsx(P,{height:lr,minWidth:lr,bg:"base.650",borderRadius:"base",alignItems:"center",justifyContent:"center",children:s.jsx(gn,{color:"base.500",as:JD,boxSize:KG})}),XG=Zc(YG),JG={_hover:{bg:"base.700"},"&[aria-selected='true']":{bg:"base.700"}},eU=e=>{const{t}=L(),n=O(),o=b(C=>C.modelmanagerV2.selectedModelKey),[r]=_3(),{isOpen:a,onOpen:c,onClose:d}=fn(),{model:f}=e,m=u.useCallback(()=>{n(ap(f.key))},[f.key,n]),h=u.useCallback(C=>{C.stopPropagation(),c()},[c]),g=u.useMemo(()=>o===f.key,[o,f.key]),x=u.useCallback(()=>{r({key:f.key}).unwrap().then(C=>{n(Ze(pt({title:`${t("modelManager.modelDeleted")}: ${f.name}`,status:"success"})))}).catch(C=>{C&&n(Ze(pt({title:`${t("modelManager.modelDeleteFailed")}: ${f.name}`,status:"error"})))}),n(ap(null))},[r,f,n,t]);return s.jsxs(P,{sx:JG,"aria-selected":g,justifyContent:"flex-start",p:2,borderRadius:"base",w:"full",alignItems:"center",gap:2,cursor:"pointer",onClick:m,children:[s.jsxs(P,{gap:2,w:"full",h:"full",children:[s.jsx(XG,{image_url:f.cover_image}),s.jsxs(P,{gap:1,alignItems:"flex-start",flexDir:"column",w:"full",children:[s.jsxs(P,{gap:2,w:"full",alignItems:"flex-start",children:[s.jsx(re,{fontWeight:"semibold",children:f.name}),s.jsx(Tn,{})]}),s.jsx(re,{variant:"subtext",noOfLines:1,children:f.description||"No Description"})]}),s.jsxs(P,{h:lr,flexDir:"column",alignItems:"flex-end",justifyContent:"space-between",gap:2,children:[s.jsx(Uk,{base:f.base}),s.jsx(QG,{format:f.format})]})]}),s.jsx(ve,{onClick:h,icon:s.jsx(Xs,{size:16}),"aria-label":t("modelManager.deleteConfig"),colorScheme:"error",h:lr,w:lr}),s.jsx(sa,{isOpen:a,onClose:d,title:t("modelManager.deleteModel"),acceptCallback:x,acceptButtonText:t("modelManager.delete"),children:s.jsxs(P,{rowGap:4,flexDirection:"column",children:[s.jsx(re,{fontWeight:"bold",children:t("modelManager.deleteMsg1")}),s.jsx(re,{children:t("modelManager.deleteMsg2")})]})})]})},tU=u.memo(eU),Ma=e=>{const{title:t,modelList:n}=e;return s.jsx(ar,{title:t,contentSx:{gap:1,p:2},children:n.map(o=>s.jsx(tU,{model:o},o.key))})},nU=()=>{const{searchTerm:e,filteredModelType:t}=b(W=>W.modelmanagerV2),{t:n}=L(),[o,{isLoading:r}]=Pf(),a=u.useMemo(()=>Aa(o,e,t),[o,e,t]),[c,{isLoading:d}]=Df(),f=u.useMemo(()=>Aa(c,e,t),[c,e,t]),[m,{isLoading:h}]=Hj(),g=u.useMemo(()=>Aa(m,e,t),[m,e,t]),[x,{isLoading:C}]=Yg(),j=u.useMemo(()=>Aa(x,e,t),[x,e,t]),[S,{isLoading:M}]=Xg(),I=u.useMemo(()=>Aa(S,e,t),[S,e,t]),[k,{isLoading:D}]=Jg(),T=u.useMemo(()=>Aa(k,e,t),[k,e,t]),[E,{isLoading:A}]=Ef(),N=u.useMemo(()=>Aa(E,e,t),[E,e,t]);return s.jsx(Wn,{children:s.jsxs(P,{flexDirection:"column",w:"full",h:"full",gap:4,children:[r&&s.jsx(rr,{loadingMessage:"Loading Main Models..."}),!r&&a.length>0&&s.jsx(Ma,{title:n("modelManager.main"),modelList:a},"main"),d&&s.jsx(rr,{loadingMessage:"Loading LoRAs..."}),!d&&f.length>0&&s.jsx(Ma,{title:n("modelManager.loraModels"),modelList:f},"loras"),h&&s.jsx(rr,{loadingMessage:"Loading Textual Inversions..."}),!h&&g.length>0&&s.jsx(Ma,{title:n("modelManager.textualInversions"),modelList:g},"textual-inversions"),A&&s.jsx(rr,{loadingMessage:"Loading VAEs..."}),!A&&N.length>0&&s.jsx(Ma,{title:"VAE",modelList:N},"vae"),C&&s.jsx(rr,{loadingMessage:"Loading ControlNets..."}),!C&&j.length>0&&s.jsx(Ma,{title:"ControlNet",modelList:j},"controlnets"),D&&s.jsx(rr,{loadingMessage:"Loading IP Adapters..."}),!D&&T.length>0&&s.jsx(Ma,{title:n("common.ipAdapter"),modelList:T},"ip-adapters"),M&&s.jsx(rr,{loadingMessage:"Loading T2I Adapters..."}),!M&&I.length>0&&s.jsx(Ma,{title:n("common.t2iAdapter"),modelList:I},"t2i-adapters")]})})},sU=u.memo(nU),Aa=(e,t,n)=>e.filter(o=>{const r=o.name.toLowerCase().includes(t.toLowerCase()),a=n?o.type===n:!0;return r&&a}),oU=()=>{const{t:e}=L(),t=O(),n=u.useMemo(()=>({main:e("modelManager.main"),lora:"LoRA",embedding:e("modelManager.textualInversions"),controlnet:"ControlNet",vae:"VAE",t2i_adapter:e("common.t2iAdapter"),ip_adapter:e("common.ipAdapter"),clip_vision:"Clip Vision"}),[e]),o=b(c=>c.modelmanagerV2.filteredModelType),r=u.useCallback(c=>{t(qx(c))},[t]),a=u.useCallback(()=>{t(qx(null))},[t]);return s.jsxs(Ic,{children:[s.jsx(Mc,{as:qe,size:"sm",leftIcon:s.jsx(AD,{}),children:o?n[o]:e("modelManager.allModels")}),s.jsxs(qr,{children:[s.jsx(ut,{onClick:a,children:e("modelManager.allModels")}),Ny.objectKeys(n).map(c=>s.jsx(ut,{bg:o===c?"base.700":"transparent",onClick:r.bind(null,c),children:n[c]},c))]})]})},rU=()=>{const e=O(),t=b(r=>r.modelmanagerV2.searchTerm),n=u.useCallback(r=>{e(Qx(r.target.value))},[e]),o=u.useCallback(()=>{e(Qx(""))},[e]);return s.jsxs(P,{gap:2,alignItems:"center",justifyContent:"space-between",children:[s.jsx(oU,{}),s.jsx(Tn,{}),s.jsxs(qa,{maxW:"400px",children:[s.jsx(mn,{placeholder:Te("modelManager.search"),value:t||"","data-testid":"board-search-input",onChange:n}),!!(t!=null&&t.length)&&s.jsx(Qa,{h:"full",pe:2,children:s.jsx(ve,{size:"sm",variant:"link","aria-label":Te("boards.clearSearch"),icon:s.jsx($n,{}),onClick:o})})]})]})},aU=()=>{const{t:e}=L(),t=O(),n=u.useCallback(()=>{t(ap(null))},[t]);return s.jsxs(P,{flexDir:"column",layerStyle:"first",p:4,gap:4,borderRadius:"base",w:"50%",h:"full",children:[s.jsxs(P,{w:"full",gap:4,justifyContent:"space-between",alignItems:"center",children:[s.jsx(sn,{fontSize:"xl",children:e("common.modelManager")}),s.jsx(qe,{size:"sm",colorScheme:"invokeYellow",leftIcon:s.jsx(Hs,{}),onClick:n,children:e("modelManager.addModels")})]}),s.jsxs(P,{flexDir:"column",layerStyle:"second",p:4,gap:4,borderRadius:"base",w:"full",h:"full",children:[s.jsx(rU,{}),s.jsx(sU,{})]})]})},lU=({result:e})=>{const{t}=L(),n=O(),o=u.useMemo(()=>{const c=[e.source];return e.dependencies&&c.push(...e.dependencies.map(d=>d.source)),c},[e]),[r]=tl(),a=u.useCallback(()=>{for(const c of o)r({source:c}).unwrap().then(d=>{n(Ze(pt({title:t("toast.modelAddedSimple"),status:"success"})))}).catch(d=>{d&&n(Ze(pt({title:`${d.data.detail} `,status:"error"})))})},[o,r,n,t]);return s.jsxs(P,{alignItems:"center",justifyContent:"space-between",w:"100%",gap:3,children:[s.jsxs(P,{fontSize:"sm",flexDir:"column",children:[s.jsxs(P,{gap:3,children:[s.jsx(Ws,{h:"min-content",children:e.type.replace("_"," ")}),s.jsx(Uk,{base:e.base}),s.jsx(re,{fontWeight:"semibold",children:e.name})]}),s.jsx(re,{variant:"subtext",children:e.description})]}),s.jsx(Ae,{children:e.is_installed?s.jsx(Ws,{children:t("common.installed")}):s.jsx(ve,{"aria-label":t("modelManager.install"),icon:s.jsx(Hs,{}),onClick:a,size:"sm"})})]})},iU=({results:e})=>{const{t}=L(),[n,o]=u.useState(""),r=u.useMemo(()=>e.filter(d=>{const f=d.name.toLowerCase(),m=d.type.toLowerCase();return f.includes(n.toLowerCase())||m.includes(n.toLowerCase())}),[e,n]),a=u.useCallback(d=>{o(d.target.value.trim())},[]),c=u.useCallback(()=>{o("")},[]);return s.jsxs(P,{flexDir:"column",gap:3,height:"100%",children:[s.jsx(P,{justifyContent:"flex-end",alignItems:"center",children:s.jsxs(qa,{w:64,size:"xs",children:[s.jsx(mn,{placeholder:t("modelManager.search"),value:n,"data-testid":"board-search-input",onChange:a,size:"xs"}),n&&s.jsx(Qa,{h:"full",pe:2,children:s.jsx(ve,{size:"sm",variant:"link","aria-label":t("boards.clearSearch"),icon:s.jsx($n,{}),onClick:c,flexShrink:0})})]})}),s.jsx(P,{height:"100%",layerStyle:"third",borderRadius:"base",p:3,children:s.jsx(Wn,{children:s.jsx(P,{flexDir:"column",gap:3,children:r.map(d=>s.jsx(lU,{result:d},d.source))})})})]})},cU=()=>{const{isLoading:e,data:t}=L3();return s.jsxs(P,{flexDir:"column",height:"100%",gap:3,children:[e&&s.jsx(rr,{loadingMessage:"Loading Embeddings..."}),t&&s.jsx(iU,{results:t})]})},uU=({result:e})=>{const{t}=L(),n=O(),[o]=tl(),r=u.useCallback(()=>{o({source:e}).unwrap().then(a=>{n(Ze(pt({title:t("toast.modelAddedSimple"),status:"success"})))}).catch(a=>{a&&n(Ze(pt({title:`${a.data.detail} `,status:"error"})))})},[o,e,n,t]);return s.jsxs(P,{alignItems:"center",justifyContent:"space-between",w:"100%",gap:3,children:[s.jsxs(P,{fontSize:"sm",flexDir:"column",children:[s.jsx(re,{fontWeight:"semibold",children:e.split("/").slice(-1)[0]}),s.jsx(re,{variant:"subtext",noOfLines:1,wordBreak:"break-all",children:e})]}),s.jsx(ve,{"aria-label":t("modelManager.install"),icon:s.jsx(Hs,{}),onClick:r,size:"sm"})]})},dU=({results:e})=>{const{t}=L(),[n,o]=u.useState(""),r=O(),[a]=tl(),c=u.useMemo(()=>e.filter(h=>{const g=h.split("/").slice(-1)[0];return g==null?void 0:g.toLowerCase().includes(n.toLowerCase())}),[e,n]),d=u.useCallback(h=>{o(h.target.value.trim())},[]),f=u.useCallback(()=>{o("")},[]),m=u.useCallback(()=>{for(const h of c)a({source:h}).unwrap().then(g=>{r(Ze(pt({title:t("toast.modelAddedSimple"),status:"success"})))}).catch(g=>{g&&r(Ze(pt({title:`${g.data.detail} `,status:"error"})))})},[c,a,r,t]);return s.jsxs(s.Fragment,{children:[s.jsx(An,{}),s.jsxs(P,{flexDir:"column",gap:3,height:"100%",children:[s.jsxs(P,{justifyContent:"space-between",alignItems:"center",children:[s.jsx(sn,{size:"sm",children:t("modelManager.availableModels")}),s.jsxs(P,{alignItems:"center",gap:3,children:[s.jsx(qe,{size:"sm",onClick:m,isDisabled:e.length===0,flexShrink:0,children:t("modelManager.installAll")}),s.jsxs(qa,{w:64,size:"xs",children:[s.jsx(mn,{placeholder:t("modelManager.search"),value:n,"data-testid":"board-search-input",onChange:d,size:"xs"}),n&&s.jsx(Qa,{h:"full",pe:2,children:s.jsx(ve,{size:"sm",variant:"link","aria-label":t("boards.clearSearch"),icon:s.jsx($n,{}),onClick:f})})]})]})]}),s.jsx(P,{height:"100%",layerStyle:"third",borderRadius:"base",p:3,children:s.jsx(Wn,{children:s.jsx(P,{flexDir:"column",gap:3,children:c.map(h=>s.jsx(uU,{result:h},h))})})})]})]})},fU=()=>{const[e,t]=u.useState(""),[n,o]=u.useState(!1),[r,a]=u.useState(""),{t:c}=L(),d=O(),[f,{isLoading:m,data:h}]=T3(),[g]=tl(),x=u.useCallback(S=>{g({source:S}).unwrap().then(M=>{d(Ze(pt({title:c("toast.modelAddedSimple"),status:"success"})))}).catch(M=>{M&&d(Ze(pt({title:`${M.data.detail} `,status:"error"})))})},[g,d,c]),C=u.useCallback(async()=>{f(e).unwrap().then(S=>{var M;S.is_diffusers?(x(e),o(!1)):((M=S.urls)==null?void 0:M.length)===1&&S.urls[0]?(x(S.urls[0]),o(!1)):o(!0)}).catch(S=>{a(S.data.detail||"")})},[f,x,e]),j=u.useCallback(S=>{t(S.target.value),a("")},[]);return s.jsxs(P,{flexDir:"column",height:"100%",gap:3,children:[s.jsxs($,{isInvalid:!!r.length,w:"full",orientation:"vertical",flexShrink:0,children:[s.jsx(Y,{children:c("modelManager.huggingFaceRepoID")}),s.jsxs(P,{gap:3,alignItems:"center",w:"full",children:[s.jsx(mn,{placeholder:c("modelManager.huggingFacePlaceholder"),value:e,onChange:j}),s.jsx(qe,{onClick:C,isLoading:m,isDisabled:e.length===0,size:"sm",flexShrink:0,children:c("modelManager.installRepo")})]}),s.jsx(ir,{children:c("modelManager.huggingFaceHelper")}),!!r.length&&s.jsx(hf,{children:r})]}),h&&h.urls&&n&&s.jsx(dU,{results:h.urls})]})};var qc=e=>e.type==="checkbox",Rl=e=>e instanceof Date,Un=e=>e==null;const Zk=e=>typeof e=="object";var Sn=e=>!Un(e)&&!Array.isArray(e)&&Zk(e)&&!Rl(e),qk=e=>Sn(e)&&e.target?qc(e.target)?e.target.checked:e.target.value:e,hU=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,Qk=(e,t)=>e.has(hU(t)),mU=e=>{const t=e.constructor&&e.constructor.prototype;return Sn(t)&&t.hasOwnProperty("isPrototypeOf")},L0=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function rs(e){let t;const n=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(L0&&(e instanceof Blob||e instanceof FileList))&&(n||Sn(e)))if(t=n?[]:{},!n&&!mU(e))t=e;else for(const o in e)e.hasOwnProperty(o)&&(t[o]=rs(e[o]));else return e;return t}var Qc=e=>Array.isArray(e)?e.filter(Boolean):[],an=e=>e===void 0,Pe=(e,t,n)=>{if(!t||!Sn(e))return n;const o=Qc(t.split(/[,[\].]+?/)).reduce((r,a)=>Un(r)?r:r[a],e);return an(o)||o===e?an(e[t])?n:e[t]:o},io=e=>typeof e=="boolean";const Ud={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},uo={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},or={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},pU=q.createContext(null),T0=()=>q.useContext(pU);var Kk=(e,t,n,o=!0)=>{const r={defaultValues:t._defaultValues};for(const a in e)Object.defineProperty(r,a,{get:()=>{const c=a;return t._proxyFormState[c]!==uo.all&&(t._proxyFormState[c]=!o||uo.all),n&&(n[c]=!0),e[c]}});return r},ps=e=>Sn(e)&&!Object.keys(e).length,Yk=(e,t,n,o)=>{n(e);const{name:r,...a}=e;return ps(a)||Object.keys(a).length>=Object.keys(t).length||Object.keys(a).find(c=>t[c]===(!o||uo.all))},Cd=e=>Array.isArray(e)?e:[e],Xk=(e,t,n)=>!e||!t||e===t||Cd(e).some(o=>o&&(n?o===t:o.startsWith(t)||t.startsWith(o)));function R0(e){const t=q.useRef(e);t.current=e,q.useEffect(()=>{const n=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{n&&n.unsubscribe()}},[e.disabled])}function gU(e){const t=T0(),{control:n=t.control,disabled:o,name:r,exact:a}=e||{},[c,d]=q.useState(n._formState),f=q.useRef(!0),m=q.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),h=q.useRef(r);return h.current=r,R0({disabled:o,next:g=>f.current&&Xk(h.current,g.name,a)&&Yk(g,m.current,n._updateFormState)&&d({...n._formState,...g}),subject:n._subjects.state}),q.useEffect(()=>(f.current=!0,m.current.isValid&&n._updateValid(!0),()=>{f.current=!1}),[n]),Kk(c,n,m.current,!1)}var No=e=>typeof e=="string",Jk=(e,t,n,o,r)=>No(e)?(o&&t.watch.add(e),Pe(n,e,r)):Array.isArray(e)?e.map(a=>(o&&t.watch.add(a),Pe(n,a))):(o&&(t.watchAll=!0),n);function xU(e){const t=T0(),{control:n=t.control,name:o,defaultValue:r,disabled:a,exact:c}=e||{},d=q.useRef(o);d.current=o,R0({disabled:a,subject:n._subjects.values,next:h=>{Xk(d.current,h.name,c)&&m(rs(Jk(d.current,n._names,h.values||n._formValues,!1,r)))}});const[f,m]=q.useState(n._getWatch(o,r));return q.useEffect(()=>n._removeUnmounted()),f}var B0=e=>/^\w*$/.test(e),e4=e=>Qc(e.replace(/["|']|\]/g,"").split(/\.|\[/)),Bt=(e,t,n)=>{let o=-1;const r=B0(t)?[t]:e4(t),a=r.length,c=a-1;for(;++o<a;){const d=r[o];let f=n;if(o!==c){const m=e[d];f=Sn(m)||Array.isArray(m)?m:isNaN(+r[o+1])?{}:[]}e[d]=f,e=e[d]}return e};function As(e){const t=T0(),{name:n,disabled:o,control:r=t.control,shouldUnregister:a}=e,c=Qk(r._names.array,n),d=xU({control:r,name:n,defaultValue:Pe(r._formValues,n,Pe(r._defaultValues,n,e.defaultValue)),exact:!0}),f=gU({control:r,name:n}),m=q.useRef(r.register(n,{...e.rules,value:d,...io(e.disabled)?{disabled:e.disabled}:{}}));return q.useEffect(()=>{const h=r._options.shouldUnregister||a,g=(x,C)=>{const j=Pe(r._fields,x);j&&(j._f.mount=C)};if(g(n,!0),h){const x=rs(Pe(r._options.defaultValues,n));Bt(r._defaultValues,n,x),an(Pe(r._formValues,n))&&Bt(r._formValues,n,x)}return()=>{(c?h&&!r._state.action:h)?r.unregister(n):g(n,!1)}},[n,r,c,a]),q.useEffect(()=>{Pe(r._fields,n)&&r._updateDisabledField({disabled:o,fields:r._fields,name:n,value:Pe(r._fields,n)._f.value})},[o,n,r]),{field:{name:n,value:d,...io(o)||f.disabled?{disabled:f.disabled||o}:{},onChange:q.useCallback(h=>m.current.onChange({target:{value:qk(h),name:n},type:Ud.CHANGE}),[n]),onBlur:q.useCallback(()=>m.current.onBlur({target:{value:Pe(r._formValues,n),name:n},type:Ud.BLUR}),[n,r]),ref:h=>{const g=Pe(r._fields,n);g&&h&&(g._f.ref={focus:()=>h.focus(),select:()=>h.select(),setCustomValidity:x=>h.setCustomValidity(x),reportValidity:()=>h.reportValidity()})}},formState:f,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Pe(f.errors,n)},isDirty:{enumerable:!0,get:()=>!!Pe(f.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!Pe(f.touchedFields,n)},isValidating:{enumerable:!0,get:()=>!!Pe(f.validatingFields,n)},error:{enumerable:!0,get:()=>Pe(f.errors,n)}})}}var vU=(e,t,n,o,r)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[o]:r||!0}}:{},Rv=e=>({isOnSubmit:!e||e===uo.onSubmit,isOnBlur:e===uo.onBlur,isOnChange:e===uo.onChange,isOnAll:e===uo.all,isOnTouch:e===uo.onTouched}),Bv=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some(o=>e.startsWith(o)&&/^\.\w+/.test(e.slice(o.length))));const ac=(e,t,n,o)=>{for(const r of n||Object.keys(e)){const a=Pe(e,r);if(a){const{_f:c,...d}=a;if(c){if(c.refs&&c.refs[0]&&t(c.refs[0],r)&&!o)break;if(c.ref&&t(c.ref,c.name)&&!o)break;ac(d,t)}else Sn(d)&&ac(d,t)}}};var CU=(e,t,n)=>{const o=Qc(Pe(e,n));return Bt(o,"root",t[n]),Bt(e,n,o),e},N0=e=>e.type==="file",Gr=e=>typeof e=="function",Zd=e=>{if(!L0)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},yd=e=>No(e),z0=e=>e.type==="radio",qd=e=>e instanceof RegExp;const Nv={value:!1,isValid:!1},zv={value:!0,isValid:!0};var t4=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!an(e[0].attributes.value)?an(e[0].value)||e[0].value===""?zv:{value:e[0].value,isValid:!0}:zv:Nv}return Nv};const Ov={isValid:!1,value:null};var n4=e=>Array.isArray(e)?e.reduce((t,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:t,Ov):Ov;function Fv(e,t,n="validate"){if(yd(e)||Array.isArray(e)&&e.every(yd)||io(e)&&!e)return{type:n,message:yd(e)?e:"",ref:t}}var Al=e=>Sn(e)&&!qd(e)?e:{value:e,message:""},Vv=async(e,t,n,o,r)=>{const{ref:a,refs:c,required:d,maxLength:f,minLength:m,min:h,max:g,pattern:x,validate:C,name:j,valueAsNumber:S,mount:M,disabled:I}=e._f,k=Pe(t,j);if(!M||I)return{};const D=c?c[0]:a,T=B=>{o&&D.reportValidity&&(D.setCustomValidity(io(B)?"":B||""),D.reportValidity())},E={},A=z0(a),N=qc(a),W=A||N,G=(S||N0(a))&&an(a.value)&&an(k)||Zd(a)&&a.value===""||k===""||Array.isArray(k)&&!k.length,z=vU.bind(null,j,n,E),X=(B,Q,V,H=or.maxLength,me=or.minLength)=>{const Ie=B?Q:V;E[j]={type:B?H:me,message:Ie,ref:a,...z(B?H:me,Ie)}};if(r?!Array.isArray(k)||!k.length:d&&(!W&&(G||Un(k))||io(k)&&!k||N&&!t4(c).isValid||A&&!n4(c).isValid)){const{value:B,message:Q}=yd(d)?{value:!!d,message:d}:Al(d);if(B&&(E[j]={type:or.required,message:Q,ref:D,...z(or.required,Q)},!n))return T(Q),E}if(!G&&(!Un(h)||!Un(g))){let B,Q;const V=Al(g),H=Al(h);if(!Un(k)&&!isNaN(k)){const me=a.valueAsNumber||k&&+k;Un(V.value)||(B=me>V.value),Un(H.value)||(Q=me<H.value)}else{const me=a.valueAsDate||new Date(k),Ie=He=>new Date(new Date().toDateString()+" "+He),ye=a.type=="time",de=a.type=="week";No(V.value)&&k&&(B=ye?Ie(k)>Ie(V.value):de?k>V.value:me>new Date(V.value)),No(H.value)&&k&&(Q=ye?Ie(k)<Ie(H.value):de?k<H.value:me<new Date(H.value))}if((B||Q)&&(X(!!B,V.message,H.message,or.max,or.min),!n))return T(E[j].message),E}if((f||m)&&!G&&(No(k)||r&&Array.isArray(k))){const B=Al(f),Q=Al(m),V=!Un(B.value)&&k.length>+B.value,H=!Un(Q.value)&&k.length<+Q.value;if((V||H)&&(X(V,B.message,Q.message),!n))return T(E[j].message),E}if(x&&!G&&No(k)){const{value:B,message:Q}=Al(x);if(qd(B)&&!k.match(B)&&(E[j]={type:or.pattern,message:Q,ref:a,...z(or.pattern,Q)},!n))return T(Q),E}if(C){if(Gr(C)){const B=await C(k,t),Q=Fv(B,D);if(Q&&(E[j]={...Q,...z(or.validate,Q.message)},!n))return T(Q.message),E}else if(Sn(C)){let B={};for(const Q in C){if(!ps(B)&&!n)break;const V=Fv(await C[Q](k,t),D,Q);V&&(B={...V,...z(Q,V.message)},T(V.message),n&&(E[j]=B))}if(!ps(B)&&(E[j]={ref:D,...B},!n))return E}}return T(!0),E};function yU(e,t){const n=t.slice(0,-1).length;let o=0;for(;o<n;)e=an(e)?o++:e[t[o++]];return e}function bU(e){for(const t in e)if(e.hasOwnProperty(t)&&!an(e[t]))return!1;return!0}function yn(e,t){const n=Array.isArray(t)?t:B0(t)?[t]:e4(t),o=n.length===1?e:yU(e,n),r=n.length-1,a=n[r];return o&&delete o[a],r!==0&&(Sn(o)&&ps(o)||Array.isArray(o)&&bU(o))&&yn(e,n.slice(0,-1)),e}var Qm=()=>{let e=[];return{get observers(){return e},next:r=>{for(const a of e)a.next&&a.next(r)},subscribe:r=>(e.push(r),{unsubscribe:()=>{e=e.filter(a=>a!==r)}}),unsubscribe:()=>{e=[]}}},Qd=e=>Un(e)||!Zk(e);function Ra(e,t){if(Qd(e)||Qd(t))return e===t;if(Rl(e)&&Rl(t))return e.getTime()===t.getTime();const n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(const r of n){const a=e[r];if(!o.includes(r))return!1;if(r!=="ref"){const c=t[r];if(Rl(a)&&Rl(c)||Sn(a)&&Sn(c)||Array.isArray(a)&&Array.isArray(c)?!Ra(a,c):a!==c)return!1}}return!0}var s4=e=>e.type==="select-multiple",jU=e=>z0(e)||qc(e),Km=e=>Zd(e)&&e.isConnected,o4=e=>{for(const t in e)if(Gr(e[t]))return!0;return!1};function Kd(e,t={}){const n=Array.isArray(e);if(Sn(e)||n)for(const o in e)Array.isArray(e[o])||Sn(e[o])&&!o4(e[o])?(t[o]=Array.isArray(e[o])?[]:{},Kd(e[o],t[o])):Un(e[o])||(t[o]=!0);return t}function r4(e,t,n){const o=Array.isArray(e);if(Sn(e)||o)for(const r in e)Array.isArray(e[r])||Sn(e[r])&&!o4(e[r])?an(t)||Qd(n[r])?n[r]=Array.isArray(e[r])?Kd(e[r],[]):{...Kd(e[r])}:r4(e[r],Un(t)?{}:t[r],n[r]):n[r]=!Ra(e[r],t[r]);return n}var id=(e,t)=>r4(e,t,Kd(t)),a4=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:o})=>an(e)?e:t?e===""?NaN:e&&+e:n&&No(e)?new Date(e):o?o(e):e;function Ym(e){const t=e.ref;if(!(e.refs?e.refs.every(n=>n.disabled):t.disabled))return N0(t)?t.files:z0(t)?n4(e.refs).value:s4(t)?[...t.selectedOptions].map(({value:n})=>n):qc(t)?t4(e.refs).value:a4(an(t.value)?e.ref.value:t.value,e)}var SU=(e,t,n,o)=>{const r={};for(const a of e){const c=Pe(t,a);c&&Bt(r,a,c._f)}return{criteriaMode:n,names:[...e],fields:r,shouldUseNativeValidation:o}},Gi=e=>an(e)?e:qd(e)?e.source:Sn(e)?qd(e.value)?e.value.source:e.value:e,wU=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function Hv(e,t,n){const o=Pe(e,n);if(o||B0(n))return{error:o,name:n};const r=n.split(".");for(;r.length;){const a=r.join("."),c=Pe(t,a),d=Pe(e,a);if(c&&!Array.isArray(c)&&n!==a)return{name:n};if(d&&d.type)return{name:a,error:d};r.pop()}return{name:n}}var kU=(e,t,n,o,r)=>r.isOnAll?!1:!n&&r.isOnTouch?!(t||e):(n?o.isOnBlur:r.isOnBlur)?!e:(n?o.isOnChange:r.isOnChange)?e:!0,IU=(e,t)=>!Qc(Pe(e,t)).length&&yn(e,t);const MU={mode:uo.onSubmit,reValidateMode:uo.onChange,shouldFocusError:!0};function AU(e={}){let t={...MU,...e},n={submitCount:0,isDirty:!1,isLoading:Gr(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},o={},r=Sn(t.defaultValues)||Sn(t.values)?rs(t.defaultValues||t.values)||{}:{},a=t.shouldUnregister?{}:rs(r),c={action:!1,mount:!1,watch:!1},d={mount:new Set,unMount:new Set,array:new Set,watch:new Set},f,m=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},g={values:Qm(),array:Qm(),state:Qm()},x=Rv(t.mode),C=Rv(t.reValidateMode),j=t.criteriaMode===uo.all,S=R=>Z=>{clearTimeout(m),m=setTimeout(R,Z)},M=async R=>{if(h.isValid||R){const Z=t.resolver?ps((await W()).errors):await z(o,!0);Z!==n.isValid&&g.state.next({isValid:Z})}},I=(R,Z)=>{(h.isValidating||h.validatingFields)&&((R||Array.from(d.mount)).forEach(ne=>{ne&&(Z?Bt(n.validatingFields,ne,Z):yn(n.validatingFields,ne))}),g.state.next({validatingFields:n.validatingFields,isValidating:!ps(n.validatingFields)}))},k=(R,Z=[],ne,ge,xe=!0,pe=!0)=>{if(ge&&ne){if(c.action=!0,pe&&Array.isArray(Pe(o,R))){const te=ne(Pe(o,R),ge.argA,ge.argB);xe&&Bt(o,R,te)}if(pe&&Array.isArray(Pe(n.errors,R))){const te=ne(Pe(n.errors,R),ge.argA,ge.argB);xe&&Bt(n.errors,R,te),IU(n.errors,R)}if(h.touchedFields&&pe&&Array.isArray(Pe(n.touchedFields,R))){const te=ne(Pe(n.touchedFields,R),ge.argA,ge.argB);xe&&Bt(n.touchedFields,R,te)}h.dirtyFields&&(n.dirtyFields=id(r,a)),g.state.next({name:R,isDirty:B(R,Z),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else Bt(a,R,Z)},D=(R,Z)=>{Bt(n.errors,R,Z),g.state.next({errors:n.errors})},T=R=>{n.errors=R,g.state.next({errors:n.errors,isValid:!1})},E=(R,Z,ne,ge)=>{const xe=Pe(o,R);if(xe){const pe=Pe(a,R,an(ne)?Pe(r,R):ne);an(pe)||ge&&ge.defaultChecked||Z?Bt(a,R,Z?pe:Ym(xe._f)):H(R,pe),c.mount&&M()}},A=(R,Z,ne,ge,xe)=>{let pe=!1,te=!1;const Ce={name:R},Ue=!!(Pe(o,R)&&Pe(o,R)._f.disabled);if(!ne||ge){h.isDirty&&(te=n.isDirty,n.isDirty=Ce.isDirty=B(),pe=te!==Ce.isDirty);const tt=Ue||Ra(Pe(r,R),Z);te=!!(!Ue&&Pe(n.dirtyFields,R)),tt||Ue?yn(n.dirtyFields,R):Bt(n.dirtyFields,R,!0),Ce.dirtyFields=n.dirtyFields,pe=pe||h.dirtyFields&&te!==!tt}if(ne){const tt=Pe(n.touchedFields,R);tt||(Bt(n.touchedFields,R,ne),Ce.touchedFields=n.touchedFields,pe=pe||h.touchedFields&&tt!==ne)}return pe&&xe&&g.state.next(Ce),pe?Ce:{}},N=(R,Z,ne,ge)=>{const xe=Pe(n.errors,R),pe=h.isValid&&io(Z)&&n.isValid!==Z;if(e.delayError&&ne?(f=S(()=>D(R,ne)),f(e.delayError)):(clearTimeout(m),f=null,ne?Bt(n.errors,R,ne):yn(n.errors,R)),(ne?!Ra(xe,ne):xe)||!ps(ge)||pe){const te={...ge,...pe&&io(Z)?{isValid:Z}:{},errors:n.errors,name:R};n={...n,...te},g.state.next(te)}},W=async R=>{I(R,!0);const Z=await t.resolver(a,t.context,SU(R||d.mount,o,t.criteriaMode,t.shouldUseNativeValidation));return I(R),Z},G=async R=>{const{errors:Z}=await W(R);if(R)for(const ne of R){const ge=Pe(Z,ne);ge?Bt(n.errors,ne,ge):yn(n.errors,ne)}else n.errors=Z;return Z},z=async(R,Z,ne={valid:!0})=>{for(const ge in R){const xe=R[ge];if(xe){const{_f:pe,...te}=xe;if(pe){const Ce=d.array.has(pe.name);I([ge],!0);const Ue=await Vv(xe,a,j,t.shouldUseNativeValidation&&!Z,Ce);if(I([ge]),Ue[pe.name]&&(ne.valid=!1,Z))break;!Z&&(Pe(Ue,pe.name)?Ce?CU(n.errors,Ue,pe.name):Bt(n.errors,pe.name,Ue[pe.name]):yn(n.errors,pe.name))}te&&await z(te,Z,ne)}}return ne.valid},X=()=>{for(const R of d.unMount){const Z=Pe(o,R);Z&&(Z._f.refs?Z._f.refs.every(ne=>!Km(ne)):!Km(Z._f.ref))&&ee(R)}d.unMount=new Set},B=(R,Z)=>(R&&Z&&Bt(a,R,Z),!Ra(Be(),r)),Q=(R,Z,ne)=>Jk(R,d,{...c.mount?a:an(Z)?r:No(R)?{[R]:Z}:Z},ne,Z),V=R=>Qc(Pe(c.mount?a:r,R,e.shouldUnregister?Pe(r,R,[]):[])),H=(R,Z,ne={})=>{const ge=Pe(o,R);let xe=Z;if(ge){const pe=ge._f;pe&&(!pe.disabled&&Bt(a,R,a4(Z,pe)),xe=Zd(pe.ref)&&Un(Z)?"":Z,s4(pe.ref)?[...pe.ref.options].forEach(te=>te.selected=xe.includes(te.value)):pe.refs?qc(pe.ref)?pe.refs.length>1?pe.refs.forEach(te=>(!te.defaultChecked||!te.disabled)&&(te.checked=Array.isArray(xe)?!!xe.find(Ce=>Ce===te.value):xe===te.value)):pe.refs[0]&&(pe.refs[0].checked=!!xe):pe.refs.forEach(te=>te.checked=te.value===xe):N0(pe.ref)?pe.ref.value="":(pe.ref.value=xe,pe.ref.type||g.values.next({name:R,values:{...a}})))}(ne.shouldDirty||ne.shouldTouch)&&A(R,xe,ne.shouldTouch,ne.shouldDirty,!0),ne.shouldValidate&&He(R)},me=(R,Z,ne)=>{for(const ge in Z){const xe=Z[ge],pe=`${R}.${ge}`,te=Pe(o,pe);(d.array.has(R)||!Qd(xe)||te&&!te._f)&&!Rl(xe)?me(pe,xe,ne):H(pe,xe,ne)}},Ie=(R,Z,ne={})=>{const ge=Pe(o,R),xe=d.array.has(R),pe=rs(Z);Bt(a,R,pe),xe?(g.array.next({name:R,values:{...a}}),(h.isDirty||h.dirtyFields)&&ne.shouldDirty&&g.state.next({name:R,dirtyFields:id(r,a),isDirty:B(R,pe)})):ge&&!ge._f&&!Un(pe)?me(R,pe,ne):H(R,pe,ne),Bv(R,d)&&g.state.next({...n}),g.values.next({name:c.mount?R:void 0,values:{...a}})},ye=async R=>{const Z=R.target;let ne=Z.name,ge=!0;const xe=Pe(o,ne),pe=()=>Z.type?Ym(xe._f):qk(R),te=Ce=>{ge=Number.isNaN(Ce)||Ce===Pe(a,ne,Ce)};if(xe){let Ce,Ue;const tt=pe(),wt=R.type===Ud.BLUR||R.type===Ud.FOCUS_OUT,Zt=!wU(xe._f)&&!t.resolver&&!Pe(n.errors,ne)&&!xe._f.deps||kU(wt,Pe(n.touchedFields,ne),n.isSubmitted,C,x),Ft=Bv(ne,d,wt);Bt(a,ne,tt),wt?(xe._f.onBlur&&xe._f.onBlur(R),f&&f(0)):xe._f.onChange&&xe._f.onChange(R);const on=A(ne,tt,wt,!1),is=!ps(on)||Ft;if(!wt&&g.values.next({name:ne,type:R.type,values:{...a}}),Zt)return h.isValid&&M(),is&&g.state.next({name:ne,...Ft?{}:on});if(!wt&&Ft&&g.state.next({...n}),t.resolver){const{errors:xn}=await W([ne]);if(te(tt),ge){const Yn=Hv(n.errors,o,ne),Bn=Hv(xn,o,Yn.name||ne);Ce=Bn.error,ne=Bn.name,Ue=ps(xn)}}else I([ne],!0),Ce=(await Vv(xe,a,j,t.shouldUseNativeValidation))[ne],I([ne]),te(tt),ge&&(Ce?Ue=!1:h.isValid&&(Ue=await z(o,!0)));ge&&(xe._f.deps&&He(xe._f.deps),N(ne,Ue,Ce,on))}},de=(R,Z)=>{if(Pe(n.errors,Z)&&R.focus)return R.focus(),1},He=async(R,Z={})=>{let ne,ge;const xe=Cd(R);if(t.resolver){const pe=await G(an(R)?R:xe);ne=ps(pe),ge=R?!xe.some(te=>Pe(pe,te)):ne}else R?(ge=(await Promise.all(xe.map(async pe=>{const te=Pe(o,pe);return await z(te&&te._f?{[pe]:te}:te)}))).every(Boolean),!(!ge&&!n.isValid)&&M()):ge=ne=await z(o);return g.state.next({...!No(R)||h.isValid&&ne!==n.isValid?{}:{name:R},...t.resolver||!R?{isValid:ne}:{},errors:n.errors}),Z.shouldFocus&&!ge&&ac(o,de,R?xe:d.mount),ge},Be=R=>{const Z={...r,...c.mount?a:{}};return an(R)?Z:No(R)?Pe(Z,R):R.map(ne=>Pe(Z,ne))},ce=(R,Z)=>({invalid:!!Pe((Z||n).errors,R),isDirty:!!Pe((Z||n).dirtyFields,R),isTouched:!!Pe((Z||n).touchedFields,R),isValidating:!!Pe((Z||n).validatingFields,R),error:Pe((Z||n).errors,R)}),ue=R=>{R&&Cd(R).forEach(Z=>yn(n.errors,Z)),g.state.next({errors:R?n.errors:{}})},je=(R,Z,ne)=>{const ge=(Pe(o,R,{_f:{}})._f||{}).ref;Bt(n.errors,R,{...Z,ref:ge}),g.state.next({name:R,errors:n.errors,isValid:!1}),ne&&ne.shouldFocus&&ge&&ge.focus&&ge.focus()},be=(R,Z)=>Gr(R)?g.values.subscribe({next:ne=>R(Q(void 0,Z),ne)}):Q(R,Z,!0),ee=(R,Z={})=>{for(const ne of R?Cd(R):d.mount)d.mount.delete(ne),d.array.delete(ne),Z.keepValue||(yn(o,ne),yn(a,ne)),!Z.keepError&&yn(n.errors,ne),!Z.keepDirty&&yn(n.dirtyFields,ne),!Z.keepTouched&&yn(n.touchedFields,ne),!Z.keepIsValidating&&yn(n.validatingFields,ne),!t.shouldUnregister&&!Z.keepDefaultValue&&yn(r,ne);g.values.next({values:{...a}}),g.state.next({...n,...Z.keepDirty?{isDirty:B()}:{}}),!Z.keepIsValid&&M()},J=({disabled:R,name:Z,field:ne,fields:ge,value:xe})=>{if(io(R)){const pe=R?void 0:an(xe)?Ym(ne?ne._f:Pe(ge,Z)._f):xe;Bt(a,Z,pe),A(Z,pe,!1,!1,!0)}},F=(R,Z={})=>{let ne=Pe(o,R);const ge=io(Z.disabled);return Bt(o,R,{...ne||{},_f:{...ne&&ne._f?ne._f:{ref:{name:R}},name:R,mount:!0,...Z}}),d.mount.add(R),ne?J({field:ne,disabled:Z.disabled,name:R,value:Z.value}):E(R,!0,Z.value),{...ge?{disabled:Z.disabled}:{},...t.progressive?{required:!!Z.required,min:Gi(Z.min),max:Gi(Z.max),minLength:Gi(Z.minLength),maxLength:Gi(Z.maxLength),pattern:Gi(Z.pattern)}:{},name:R,onChange:ye,onBlur:ye,ref:xe=>{if(xe){F(R,Z),ne=Pe(o,R);const pe=an(xe.value)&&xe.querySelectorAll&&xe.querySelectorAll("input,select,textarea")[0]||xe,te=jU(pe),Ce=ne._f.refs||[];if(te?Ce.find(Ue=>Ue===pe):pe===ne._f.ref)return;Bt(o,R,{_f:{...ne._f,...te?{refs:[...Ce.filter(Km),pe,...Array.isArray(Pe(r,R))?[{}]:[]],ref:{type:pe.type,name:R}}:{ref:pe}}}),E(R,!1,void 0,pe)}else ne=Pe(o,R,{}),ne._f&&(ne._f.mount=!1),(t.shouldUnregister||Z.shouldUnregister)&&!(Qk(d.array,R)&&c.action)&&d.unMount.add(R)}}},oe=()=>t.shouldFocusError&&ac(o,de,d.mount),le=R=>{io(R)&&(g.state.next({disabled:R}),ac(o,(Z,ne)=>{let ge=R;const xe=Pe(o,ne);xe&&io(xe._f.disabled)&&(ge||(ge=xe._f.disabled)),Z.disabled=ge},0,!1))},fe=(R,Z)=>async ne=>{let ge;ne&&(ne.preventDefault&&ne.preventDefault(),ne.persist&&ne.persist());let xe=rs(a);if(g.state.next({isSubmitting:!0}),t.resolver){const{errors:pe,values:te}=await W();n.errors=pe,xe=te}else await z(o);if(yn(n.errors,"root"),ps(n.errors)){g.state.next({errors:{}});try{await R(xe,ne)}catch(pe){ge=pe}}else Z&&await Z({...n.errors},ne),oe(),setTimeout(oe);if(g.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:ps(n.errors)&&!ge,submitCount:n.submitCount+1,errors:n.errors}),ge)throw ge},he=(R,Z={})=>{Pe(o,R)&&(an(Z.defaultValue)?Ie(R,rs(Pe(r,R))):(Ie(R,Z.defaultValue),Bt(r,R,rs(Z.defaultValue))),Z.keepTouched||yn(n.touchedFields,R),Z.keepDirty||(yn(n.dirtyFields,R),n.isDirty=Z.defaultValue?B(R,rs(Pe(r,R))):B()),Z.keepError||(yn(n.errors,R),h.isValid&&M()),g.state.next({...n}))},ke=(R,Z={})=>{const ne=R?rs(R):r,ge=rs(ne),xe=ps(R),pe=xe?r:ge;if(Z.keepDefaultValues||(r=ne),!Z.keepValues){if(Z.keepDirtyValues)for(const te of d.mount)Pe(n.dirtyFields,te)?Bt(pe,te,Pe(a,te)):Ie(te,Pe(pe,te));else{if(L0&&an(R))for(const te of d.mount){const Ce=Pe(o,te);if(Ce&&Ce._f){const Ue=Array.isArray(Ce._f.refs)?Ce._f.refs[0]:Ce._f.ref;if(Zd(Ue)){const tt=Ue.closest("form");if(tt){tt.reset();break}}}}o={}}a=e.shouldUnregister?Z.keepDefaultValues?rs(r):{}:rs(pe),g.array.next({values:{...pe}}),g.values.next({values:{...pe}})}d={mount:Z.keepDirtyValues?d.mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},c.mount=!h.isValid||!!Z.keepIsValid||!!Z.keepDirtyValues,c.watch=!!e.shouldUnregister,g.state.next({submitCount:Z.keepSubmitCount?n.submitCount:0,isDirty:xe?!1:Z.keepDirty?n.isDirty:!!(Z.keepDefaultValues&&!Ra(R,r)),isSubmitted:Z.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:xe?[]:Z.keepDirtyValues?Z.keepDefaultValues&&a?id(r,a):n.dirtyFields:Z.keepDefaultValues&&R?id(r,R):{},touchedFields:Z.keepTouched?n.touchedFields:{},errors:Z.keepErrors?n.errors:{},isSubmitSuccessful:Z.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1})},ze=(R,Z)=>ke(Gr(R)?R(a):R,Z);return{control:{register:F,unregister:ee,getFieldState:ce,handleSubmit:fe,setError:je,_executeSchema:W,_getWatch:Q,_getDirty:B,_updateValid:M,_removeUnmounted:X,_updateFieldArray:k,_updateDisabledField:J,_getFieldArray:V,_reset:ke,_resetDefaultValues:()=>Gr(t.defaultValues)&&t.defaultValues().then(R=>{ze(R,t.resetOptions),g.state.next({isLoading:!1})}),_updateFormState:R=>{n={...n,...R}},_disableForm:le,_subjects:g,_proxyFormState:h,_setErrors:T,get _fields(){return o},get _formValues(){return a},get _state(){return c},set _state(R){c=R},get _defaultValues(){return r},get _names(){return d},set _names(R){d=R},get _formState(){return n},set _formState(R){n=R},get _options(){return t},set _options(R){t={...t,...R}}},trigger:He,register:F,handleSubmit:fe,watch:be,setValue:Ie,getValues:Be,reset:ze,resetField:he,clearErrors:ue,unregister:ee,setError:je,setFocus:(R,Z={})=>{const ne=Pe(o,R),ge=ne&&ne._f;if(ge){const xe=ge.refs?ge.refs[0]:ge.ref;xe.focus&&(xe.focus(),Z.shouldSelect&&xe.select())}},getFieldState:ce}}function nh(e={}){const t=q.useRef(),n=q.useRef(),[o,r]=q.useState({isDirty:!1,isValidating:!1,isLoading:Gr(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:Gr(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...AU(e),formState:o});const a=t.current.control;return a._options=e,R0({subject:a._subjects.state,next:c=>{Yk(c,a._proxyFormState,a._updateFormState,!0)&&r({...a._formState})}}),q.useEffect(()=>a._disableForm(e.disabled),[a,e.disabled]),q.useEffect(()=>{if(a._proxyFormState.isDirty){const c=a._getDirty();c!==o.isDirty&&a._subjects.state.next({isDirty:c})}},[a,o.isDirty]),q.useEffect(()=>{e.values&&!Ra(e.values,n.current)?(a._reset(e.values,a._options.resetOptions),n.current=e.values,r(c=>({...c}))):a._resetDefaultValues()},[e.values,a]),q.useEffect(()=>{e.errors&&a._setErrors(e.errors)},[e.errors,a]),q.useEffect(()=>{a._state.mount||(a._updateValid(),a._state.mount=!0),a._state.watch&&(a._state.watch=!1,a._subjects.state.next({...a._formState})),a._removeUnmounted()}),q.useEffect(()=>{e.shouldUnregister&&a._subjects.values.next({values:a._getWatch()})},[e.shouldUnregister,a]),t.current.formState=Kk(o,a),t.current}const PU=()=>{const e=O(),[t,{isLoading:n}]=tl(),{register:o,handleSubmit:r,formState:a,reset:c}=nh({defaultValues:{location:"",inplace:!0},mode:"onChange"}),d=u.useCallback(f=>{f!=null&&f.location&&t({source:f.location,inplace:f.inplace}).unwrap().then(m=>{e(Ze(pt({title:Te("toast.modelAddedSimple"),status:"success"}))),c(void 0,{keepValues:!0})}).catch(m=>{c(void 0,{keepValues:!0}),m&&e(Ze(pt({title:`${m.data.detail} `,status:"error"})))})},[e,c,t]);return s.jsx("form",{onSubmit:r(d),children:s.jsxs(P,{flexDir:"column",gap:4,children:[s.jsx(P,{gap:2,alignItems:"flex-end",justifyContent:"space-between",children:s.jsxs($,{orientation:"vertical",children:[s.jsx(Y,{children:Te("modelManager.urlOrLocalPath")}),s.jsxs(P,{alignItems:"center",gap:3,w:"full",children:[s.jsx(mn,{placeholder:Te("modelManager.simpleModelPlaceholder"),...o("location")}),s.jsx(qe,{onClick:r(d),isDisabled:!a.dirtyFields.location,isLoading:n,type:"submit",size:"sm",children:Te("modelManager.install")})]}),s.jsx(ir,{children:Te("modelManager.urlOrLocalPathHelper")})]})}),s.jsx($,{children:s.jsxs(P,{flexDir:"column",gap:2,children:[s.jsxs(P,{gap:4,children:[s.jsx(bn,{...o("inplace")}),s.jsxs(Y,{children:[Te("modelManager.inplaceInstall")," (",Te("modelManager.localOnly"),")"]})]}),s.jsx(ir,{children:Te("modelManager.inplaceInstallDesc")})]})})]})})},Xm={waiting:{colorScheme:"cyan",translationKey:"queue.pending"},downloading:{colorScheme:"yellow",translationKey:"queue.in_progress"},downloads_done:{colorScheme:"yellow",translationKey:"queue.in_progress"},running:{colorScheme:"yellow",translationKey:"queue.in_progress"},completed:{colorScheme:"green",translationKey:"queue.completed"},error:{colorScheme:"red",translationKey:"queue.failed"},cancelled:{colorScheme:"orange",translationKey:"queue.canceled"}},DU=({status:e})=>{const{t}=L();return!e||!Object.keys(Xm).includes(e)?null:s.jsx(Ws,{textAlign:"center",w:"134px",colorScheme:Xm[e].colorScheme,children:t(Xm[e].translationKey)})},EU=u.memo(DU),$v=e=>{const t=["B","KB","MB","GB","TB"];let n=0;for(n;e>=1024&&n<4;n++)e/=1024;return`${e.toFixed(2)} ${t[n]}`},_U=e=>{const{installJob:t}=e,n=O(),[o]=R3(),r=u.useCallback(()=>{o(t.id).unwrap().then(f=>{n(Ze(pt({title:Te("toast.modelImportCanceled"),status:"success"})))}).catch(f=>{f&&n(Ze(pt({title:`${f.data.detail} `,status:"error"})))})},[o,t,n]),a=u.useMemo(()=>{switch(t.source.type){case"hf":return t.source.repo_id;case"url":return t.source.url;case"local":return t.source.path;default:return Te("common.unknown")}},[t.source]),c=u.useMemo(()=>{switch(t.source.type){case"hf":return t.source.repo_id;case"url":return t.source.url.split("/").slice(-1)[0]??Te("common.unknown");case"local":return t.source.path.split("\\").slice(-1)[0]??Te("common.unknown");default:return Te("common.unknown")}},[t.source]),d=u.useMemo(()=>ln(t.bytes)||ln(t.total_bytes)?null:t.total_bytes===0?0:t.bytes/t.total_bytes*100,[t.bytes,t.total_bytes]);return s.jsxs(P,{gap:3,w:"full",alignItems:"center",children:[s.jsx(Dt,{maxW:600,label:s.jsx(LU,{name:c,source:a,installJob:t}),children:s.jsxs(P,{gap:3,w:"full",alignItems:"center",children:[s.jsx(re,{w:96,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:c}),s.jsx(my,{w:"full",flexGrow:1,value:d??0,isIndeterminate:d===null,"aria-label":Te("accessibility.invokeProgressBar"),h:2}),s.jsx(EU,{status:t.status})]})}),s.jsx(ve,{isDisabled:t.status!=="downloading"&&t.status!=="waiting"&&t.status!=="running",size:"xs",tooltip:Te("modelManager.cancel"),"aria-label":Te("modelManager.cancel"),icon:s.jsx($n,{}),onClick:r,variant:"ghost"})]})},LU=({name:e,source:t,installJob:n})=>{const o=u.useMemo(()=>n.status!=="downloading"||n.bytes===void 0||n.total_bytes===void 0?"":`${$v(n.bytes)} / ${$v(n.total_bytes)}`,[n.bytes,n.total_bytes,n.status]);return s.jsxs(s.Fragment,{children:[s.jsxs(P,{gap:3,justifyContent:"space-between",children:[s.jsx(re,{fontWeight:"semibold",children:e}),o&&s.jsx(re,{children:o})]}),s.jsx(re,{fontStyle:"italic",wordBreak:"break-all",children:t}),n.error_reason&&s.jsxs(re,{color:"error.500",children:[Te("queue.failed"),": ",n.error]})]})},TU=()=>{const e=O(),{data:t}=B3(),[n]=N3(),o=u.useCallback(()=>{n().unwrap().then(a=>{e(Ze(pt({title:Te("toast.prunedQueue"),status:"success"})))}).catch(a=>{a&&e(Ze(pt({title:`${a.data.detail} `,status:"error"})))})},[n,e]),r=u.useMemo(()=>t==null?void 0:t.some(a=>a.status==="cancelled"||a.status==="error"||a.status==="completed"),[t]);return s.jsxs(P,{flexDir:"column",p:3,h:"full",gap:3,children:[s.jsxs(P,{justifyContent:"space-between",alignItems:"center",children:[s.jsx(sn,{size:"sm",children:Te("modelManager.installQueue")}),s.jsx(qe,{size:"sm",isDisabled:!r,onClick:o,tooltip:Te("modelManager.pruneTooltip"),children:Te("modelManager.prune")})]}),s.jsx(Ae,{layerStyle:"first",p:3,borderRadius:"base",w:"full",h:"full",children:s.jsx(Wn,{children:s.jsx(P,{flexDir:"column-reverse",gap:"2",w:"full",children:t==null?void 0:t.map(a=>s.jsx(_U,{installJob:a},a.id))})})})]})},RU=({result:e})=>{const{t}=L(),n=O(),[o]=tl(),r=u.useCallback(()=>{o({source:e.path}).unwrap().then(a=>{n(Ze(pt({title:t("toast.modelAddedSimple"),status:"success"})))}).catch(a=>{a&&n(Ze(pt({title:`${a.data.detail} `,status:"error"})))})},[o,e,n,t]);return s.jsxs(P,{alignItems:"center",justifyContent:"space-between",w:"100%",gap:3,children:[s.jsxs(P,{fontSize:"sm",flexDir:"column",children:[s.jsx(re,{fontWeight:"semibold",children:e.path.split("\\").slice(-1)[0]}),s.jsx(re,{variant:"subtext",children:e.path})]}),s.jsx(Ae,{children:e.is_installed?s.jsx(Ws,{children:t("common.installed")}):s.jsx(ve,{"aria-label":t("modelManager.install"),icon:s.jsx(Hs,{}),onClick:r,size:"sm"})})]})},BU=({results:e})=>{const{t}=L(),[n,o]=u.useState(""),r=O(),[a]=tl(),c=u.useMemo(()=>e.filter(h=>{const g=h.path.split("\\").slice(-1)[0];return g==null?void 0:g.toLowerCase().includes(n.toLowerCase())}),[e,n]),d=u.useCallback(h=>{o(h.target.value.trim())},[]),f=u.useCallback(()=>{o("")},[]),m=u.useCallback(()=>{for(const h of c)h.is_installed||a({source:h.path}).unwrap().then(g=>{r(Ze(pt({title:t("toast.modelAddedSimple"),status:"success"})))}).catch(g=>{g&&r(Ze(pt({title:`${g.data.detail} `,status:"error"})))})},[a,c,r,t]);return s.jsxs(s.Fragment,{children:[s.jsx(An,{}),s.jsxs(P,{flexDir:"column",gap:3,height:"100%",children:[s.jsxs(P,{justifyContent:"space-between",alignItems:"center",children:[s.jsx(sn,{size:"sm",children:t("modelManager.scanResults")}),s.jsxs(P,{alignItems:"center",gap:3,children:[s.jsx(qe,{size:"sm",onClick:m,isDisabled:c.length===0,children:t("modelManager.installAll")}),s.jsxs(qa,{w:64,size:"xs",children:[s.jsx(mn,{placeholder:t("modelManager.search"),value:n,"data-testid":"board-search-input",onChange:d,size:"xs"}),n&&s.jsx(Qa,{h:"full",pe:2,children:s.jsx(ve,{size:"sm",variant:"link","aria-label":t("boards.clearSearch"),icon:s.jsx($n,{}),onClick:f,flexShrink:0})})]})]})]}),s.jsx(P,{height:"100%",layerStyle:"third",borderRadius:"base",p:3,children:s.jsx(Wn,{children:s.jsx(P,{flexDir:"column",gap:3,children:c.map(h=>s.jsx(RU,{result:h},h.path))})})})]})]})},NU=()=>{const e=b(h=>h.modelmanagerV2.scanPath),t=O(),[n,o]=u.useState(""),{t:r}=L(),[a,{isLoading:c,data:d}]=z3(),f=u.useCallback(async()=>{a({scan_path:e}).unwrap().catch(h=>{h&&o(h.data.detail)})},[a,e]),m=u.useCallback(h=>{t(O3(h.target.value)),o("")},[t]);return s.jsxs(P,{flexDir:"column",height:"100%",gap:3,children:[s.jsxs($,{isInvalid:!!n.length,w:"full",orientation:"vertical",flexShrink:0,children:[s.jsx(Y,{children:r("common.folder")}),s.jsxs(P,{gap:3,alignItems:"center",w:"full",children:[s.jsx(mn,{placeholder:r("modelManager.scanPlaceholder"),value:e,onChange:m}),s.jsx(qe,{onClick:f,isLoading:c,isDisabled:e===void 0||e.length===0,size:"sm",flexShrink:0,children:r("modelManager.scanFolder")})]}),s.jsx(ir,{children:r("modelManager.scanFolderHelper")}),!!n.length&&s.jsx(hf,{children:n})]}),d&&s.jsx(BU,{results:d})]})},zU=()=>{const{t:e}=L(),[t,{data:n}]=Pf(),o=u.useMemo(()=>n&&t.length?0:3,[n,t.length]);return s.jsxs(P,{layerStyle:"first",borderRadius:"base",w:"full",h:"full",flexDir:"column",gap:4,children:[s.jsx(sn,{fontSize:"xl",children:e("modelManager.addModel")}),s.jsxs(Ja,{variant:"collapse",height:"50%",display:"flex",flexDir:"column",defaultIndex:o,children:[s.jsxs(el,{children:[s.jsx(pn,{children:e("modelManager.urlOrLocalPath")}),s.jsx(pn,{children:e("modelManager.huggingFace")}),s.jsx(pn,{children:e("modelManager.scanFolder")}),s.jsx(pn,{children:e("modelManager.starterModels")})]}),s.jsxs(ii,{p:3,height:"100%",children:[s.jsx(Pn,{children:s.jsx(PU,{})}),s.jsx(Pn,{height:"100%",children:s.jsx(fU,{})}),s.jsx(Pn,{height:"100%",children:s.jsx(NU,{})}),s.jsx(Pn,{height:"100%",children:s.jsx(cU,{})})]})]}),s.jsx(Ae,{layerStyle:"second",borderRadius:"base",h:"50%",children:s.jsx(TU,{})})]})},OU=e=>{const{modelKey:t}=e,n=O(),{t:o}=L(),{data:r}=vo(t??Ot),[a,{isLoading:c}]=F3(),{isOpen:d,onOpen:f,onClose:m}=fn(),h=u.useCallback(()=>{!r||c||(n(Ze(pt({title:`${o("modelManager.convertingModelBegin")}: ${r==null?void 0:r.name}`,status:"info"}))),a(r==null?void 0:r.key).unwrap().then(()=>{n(Ze(pt({title:`${o("modelManager.modelConverted")}: ${r==null?void 0:r.name}`,status:"success"})))}).catch(()=>{n(Ze(pt({title:`${o("modelManager.modelConversionFailed")}: ${r==null?void 0:r.name}`,status:"error"})))}))},[r,c,n,o,a]);if((r==null?void 0:r.format)==="checkpoint")return s.jsxs(s.Fragment,{children:[s.jsxs(qe,{onClick:f,size:"sm","aria-label":o("modelManager.convertToDiffusers"),className:" modal-close-btn",isLoading:c,flexShrink:0,children:["🧨 ",o("modelManager.convert")]}),s.jsx(sa,{title:`${o("modelManager.convert")} ${r==null?void 0:r.name}`,acceptCallback:h,acceptButtonText:`${o("modelManager.convert")}`,isOpen:d,onClose:m,children:s.jsxs(P,{flexDirection:"column",rowGap:4,children:[s.jsx(re,{fontSize:"md",children:o("modelManager.convertToDiffusersHelpText1")}),s.jsxs(Xp,{children:[s.jsx(To,{children:s.jsx(re,{fontSize:"md",children:o("modelManager.convertToDiffusersHelpText2")})}),s.jsx(To,{children:s.jsx(re,{fontSize:"md",children:o("modelManager.convertToDiffusersHelpText3")})}),s.jsx(To,{children:s.jsx(re,{fontSize:"md",children:o("modelManager.convertToDiffusersHelpText4")})}),s.jsx(To,{children:s.jsx(re,{fontSize:"md",children:o("modelManager.convertToDiffusersHelpText5")})})]}),s.jsx(An,{}),s.jsx(re,{fontSize:"md",children:o("modelManager.convertToDiffusersHelpText6")})]})})]})};function FU(e){return Se({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"44",d:"M358.62 129.28 86.49 402.08 70 442l39.92-16.49 272.8-272.13-24.1-24.1zm54.45-54.44-11.79 11.78 24.1 24.1 11.79-11.79a16.51 16.51 0 0 0 0-23.34l-.75-.75a16.51 16.51 0 0 0-23.35 0z"},child:[]}]})(e)}const VU=()=>{const{t:e}=L(),t=O(),n=u.useCallback(()=>{t(lp("edit"))},[t]);return s.jsx(qe,{size:"sm",leftIcon:s.jsx(FU,{}),colorScheme:"invokeYellow",onClick:n,flexShrink:0,children:e("modelManager.edit")})},HU=({model_key:e,model_image:t})=>{const n=O(),[o,r]=u.useState(t||null),{t:a}=L(),[c]=V3(),[d]=H3(),f=u.useCallback(x=>{const C=x[0];!C||!e||c({key:e,image:C}).unwrap().then(()=>{r(URL.createObjectURL(C)),n(Ze(pt({title:a("modelManager.modelImageUpdated"),status:"success"})))}).catch(j=>{n(Ze(pt({title:a("modelManager.modelImageUpdateFailed"),status:"error"})))})},[n,e,a,c]),m=u.useCallback(()=>{e&&(r(null),d(e).unwrap().then(()=>{n(Ze(pt({title:a("modelManager.modelImageDeleted"),status:"success"})))}).catch(x=>{n(Ze(pt({title:a("modelManager.modelImageDeleteFailed"),status:"error"})))}))},[n,e,a,d]),{getInputProps:h,getRootProps:g}=hi({accept:{"image/png":[".png"],"image/jpeg":[".jpg",".jpeg",".png"]},onDropAccepted:f,noDrag:!0,multiple:!1});return o?s.jsxs(Ae,{position:"relative",flexShrink:0,children:[s.jsx(Ks,{src:o,objectFit:"cover",objectPosition:"50% 50%",height:108,width:108,minWidth:108,borderRadius:"base"}),s.jsx(ve,{position:"absolute",insetInlineEnd:0,insetBlockStart:0,onClick:m,"aria-label":a("modelManager.deleteModelImage"),tooltip:a("modelManager.deleteModelImage"),icon:s.jsx(ca,{}),size:"md",variant:"ghost"})]}):s.jsxs(s.Fragment,{children:[s.jsx(Dt,{label:a("modelManager.uploadImage"),children:s.jsx(P,{as:qe,w:108,h:108,opacity:.3,borderRadius:"base",alignItems:"center",justifyContent:"center",flexShrink:0,...g(),children:s.jsx(gn,{as:mi,w:16,h:16})})}),s.jsx("input",{...h()})]})},$U=Zc(HU),Wv=[{value:"sd-1",label:qu["sd-1"]},{value:"sd-2",label:qu["sd-2"]},{value:"sdxl",label:qu.sdxl},{value:"sdxl-refiner",label:qu["sdxl-refiner"]}],WU=({control:e})=>{const{field:t}=As({control:e,name:"base"}),n=u.useMemo(()=>Wv.find(r=>r.value===t.value),[t.value]),o=u.useCallback(r=>{t.onChange(r==null?void 0:r.value)},[t]);return s.jsx(ot,{value:n,options:Wv,onChange:o})},GU=Zc(WU),Gv=[{value:"normal",label:"Normal"},{value:"inpaint",label:"Inpaint"},{value:"depth",label:"Depth"}],UU=({control:e})=>{const{field:t}=As({control:e,name:"variant"}),n=u.useMemo(()=>Gv.find(r=>r.value===t.value),[t.value]),o=u.useCallback(r=>{t.onChange(r==null?void 0:r.value)},[t]);return s.jsx(ot,{value:n,options:Gv,onChange:o})},ZU=Zc(UU),Uv=[{value:"none",label:"-"},{value:"epsilon",label:"epsilon"},{value:"v_prediction",label:"v_prediction"},{value:"sample",label:"sample"}],qU=({control:e})=>{const{field:t}=As({control:e,name:"prediction_type"}),n=u.useMemo(()=>Uv.find(r=>r.value===t.value),[t.value]),o=u.useCallback(r=>{(r==null?void 0:r.value)==="none"?t.onChange(void 0):t.onChange(r==null?void 0:r.value)},[t]);return s.jsx(ot,{value:n,options:Uv,onChange:o})},QU=Zc(qU),Zv={validate:e=>e&&e.trim().length>3||"Must be at least 3 characters"},KU=({form:e})=>{var a,c;const t=b(d=>d.modelmanagerV2.selectedModelKey),{data:n,isLoading:o}=vo(t??Ot),{t:r}=L();return o?s.jsx(re,{children:r("common.loading")}):n?s.jsx(P,{flexDir:"column",h:"full",children:s.jsxs("form",{children:[s.jsx(P,{w:"full",justifyContent:"space-between",gap:4,alignItems:"center",children:s.jsxs($,{flexDir:"column",alignItems:"flex-start",gap:1,isInvalid:!!e.formState.errors.name,children:[s.jsx(Y,{children:r("modelManager.modelName")}),s.jsx(mn,{...e.register("name",Zv),size:"md"}),((a=e.formState.errors.name)==null?void 0:a.message)&&s.jsx(hf,{children:(c=e.formState.errors.name)==null?void 0:c.message})]})}),s.jsxs(P,{flexDir:"column",gap:3,mt:"4",children:[s.jsx(P,{gap:"4",alignItems:"center",children:s.jsxs($,{flexDir:"column",alignItems:"flex-start",gap:1,children:[s.jsx(Y,{children:r("modelManager.description")}),s.jsx(Oo,{...e.register("description"),minH:32})]})}),s.jsx(sn,{as:"h3",fontSize:"md",mt:"4",children:r("modelManager.modelSettings")}),s.jsx(P,{gap:4,children:s.jsxs($,{flexDir:"column",alignItems:"flex-start",gap:1,children:[s.jsx(Y,{children:r("modelManager.baseModel")}),s.jsx(GU,{control:e.control})]})}),n.type==="main"&&n.format==="checkpoint"&&s.jsxs(s.Fragment,{children:[s.jsxs(P,{gap:4,children:[s.jsxs($,{flexDir:"column",alignItems:"flex-start",gap:1,children:[s.jsx(Y,{children:r("modelManager.pathToConfig")}),s.jsx(mn,{...e.register("config_path",Zv)})]}),s.jsxs($,{flexDir:"column",alignItems:"flex-start",gap:1,children:[s.jsx(Y,{children:r("modelManager.variant")}),s.jsx(ZU,{control:e.control})]})]}),s.jsxs(P,{gap:4,children:[s.jsxs($,{flexDir:"column",alignItems:"flex-start",gap:1,children:[s.jsx(Y,{children:r("modelManager.predictionType")}),s.jsx(QU,{control:e.control})]}),s.jsxs($,{flexDir:"column",alignItems:"flex-start",gap:1,children:[s.jsx(Y,{children:r("modelManager.upcastAttention")}),s.jsx(bn,{...e.register("upcast_attention")})]})]})]})]})]})}):s.jsx(re,{children:r("common.somethingWentWrong")})},YU=e=>{const{modelConfig:t,isLoading:n}=E0(e??Ot,$3);return{defaultSettingsDefaults:u.useMemo(()=>{var r,a;return{preprocessor:{isEnabled:!ln((r=t==null?void 0:t.default_settings)==null?void 0:r.preprocessor),value:((a=t==null?void 0:t.default_settings)==null?void 0:a.preprocessor)||"none"}}},[t==null?void 0:t.default_settings]),isLoading:n}};function yr(e){const{field:t}=As(e),n=u.useMemo(()=>!!t.value.isEnabled,[t.value]),o=u.useCallback(r=>{const a={...t.value,isEnabled:r.target.checked};t.onChange(a)},[t]);return s.jsx(jt,{size:"sm",isChecked:n,onChange:o})}const qv=[{label:"Canny",value:"canny_image_processor"},{label:"MLSD",value:"mlsd_image_processor"},{label:"Depth Anything",value:"depth_anything_image_processor"},{label:"Normal BAE",value:"normalbae_image_processor"},{label:"Pidi",value:"pidi_image_processor"},{label:"Lineart",value:"lineart_image_processor"},{label:"Lineart Anime",value:"lineart_anime_image_processor"},{label:"HED",value:"hed_image_processor"},{label:"Content Shuffle",value:"content_shuffle_image_processor"},{label:"DW OpenPose",value:"dw_openpose_image_processor"},{label:"MediaPipe Face",value:"mediapipe_face_processor"},{label:"ZoeDepth",value:"zoe_depth_image_processor"},{label:"Color Map",value:"color_map_image_processor"},{label:"None",value:"none"}];function XU(e){const{t}=L(),{field:n}=As(e),o=u.useCallback(c=>{if(!c)return;const d={...n.value,value:c.value};n.onChange(d)},[n]),r=u.useMemo(()=>qv.find(c=>c.value===n.value.value),[n]),a=u.useMemo(()=>!n.value.isEnabled,[n.value]);return s.jsxs($,{flexDir:"column",gap:2,alignItems:"flex-start",children:[s.jsxs(P,{justifyContent:"space-between",w:"full",children:[s.jsx(Ke,{feature:"controlNetProcessor",children:s.jsx(Y,{children:t("controlnet.processor")})}),s.jsx(yr,{control:e.control,name:"preprocessor"})]}),s.jsx(ot,{isDisabled:a,value:r,options:qv,onChange:o})]})}const JU=()=>{const e=b(x=>x.modelmanagerV2.selectedModelKey),{t}=L(),n=O(),{defaultSettingsDefaults:o,isLoading:r}=YU(e),[a,{isLoading:c}]=mf(),{handleSubmit:d,control:f,formState:m,reset:h}=nh({defaultValues:o}),g=u.useCallback(x=>{if(!e)return;const C={preprocessor:x.preprocessor.isEnabled?x.preprocessor.value:null};a({key:e,body:{default_settings:C}}).unwrap().then(j=>{n(Ze(pt({title:t("modelManager.defaultSettingsSaved"),status:"success"}))),h(x)}).catch(j=>{j&&n(Ze(pt({title:`${j.data.detail} `,status:"error"})))})},[e,n,h,a,t]);return r?s.jsx(re,{children:t("common.loading")}):s.jsxs(s.Fragment,{children:[s.jsxs(P,{gap:"4",justifyContent:"space-between",w:"full",pb:4,children:[s.jsx(sn,{fontSize:"md",children:t("modelManager.defaultSettings")}),s.jsx(qe,{size:"sm",leftIcon:s.jsx(_c,{}),colorScheme:"invokeYellow",isDisabled:!m.isDirty,onClick:d(g),type:"submit",isLoading:c,children:t("common.save")})]}),s.jsx(P,{flexDir:"column",gap:8,children:s.jsx(P,{gap:8,children:s.jsx(P,{gap:4,w:"full",children:s.jsx(XU,{control:f,name:"preprocessor"})})})})]})},eZ=()=>{const{t:e}=L(),t=b(x=>x.modelmanagerV2.selectedModelKey),{currentData:n}=vo(t??Ot),[o,r]=u.useState(""),[a,{isLoading:c}]=mf(),d=u.useCallback(x=>{r(x.target.value)},[]),f=u.useMemo(()=>!n||!wc(n)&&!tg(n)?[]:(n==null?void 0:n.trigger_phrases)||[],[n]),m=u.useMemo(()=>{const x=[];return o.length&&f.includes(o)&&x.push("Phrase is already in list"),x},[o,f]),h=u.useCallback(async()=>{t&&(!o.length||f.includes(o)||(r(""),await a({key:t,body:{trigger_phrases:[...f,o]}}).unwrap()))},[a,t,o,f]),g=u.useCallback(async x=>{if(!t)return;const C=f.filter(j=>j!==x);await a({key:t,body:{trigger_phrases:C}}).unwrap()},[a,t,f]);return s.jsxs(P,{flexDir:"column",w:"full",gap:"5",children:[s.jsx("form",{children:s.jsxs($,{w:"full",isInvalid:!!m.length,orientation:"vertical",children:[s.jsx(Y,{children:e("modelManager.triggerPhrases")}),s.jsxs(P,{flexDir:"column",w:"full",children:[s.jsxs(P,{gap:"3",alignItems:"center",w:"full",children:[s.jsx(mn,{value:o,onChange:d,placeholder:e("modelManager.typePhraseHere")}),s.jsx(qe,{leftIcon:s.jsx(Hs,{}),size:"sm",type:"submit",onClick:h,isDisabled:!o||!!m.length,isLoading:c,children:e("common.add")})]}),!!m.length&&m.map(x=>s.jsx(hf,{children:x},x))]})]})}),s.jsx(P,{gap:"4",flexWrap:"wrap",children:f.map((x,C)=>s.jsxs(W3,{size:"md",py:2,px:4,bg:"base.700",children:[s.jsx(G3,{children:x}),s.jsx(U3,{onClick:g.bind(null,x),isDisabled:c})]},C))})]})},tZ=Ve(Qy,e=>{const{steps:t,guidance:n,scheduler:o,cfgRescaleMultiplier:r,vaePrecision:a,width:c,height:d}=e.sd;return{initialSteps:t.initial,initialCfg:n.initial,initialScheduler:o,initialCfgRescaleMultiplier:r.initial,initialVaePrecision:a,initialWidth:c.initial,initialHeight:d.initial}}),nZ=e=>{const{modelConfig:t,isLoading:n}=E0(e??Ot,wc),{initialSteps:o,initialCfg:r,initialScheduler:a,initialCfgRescaleMultiplier:c,initialVaePrecision:d,initialWidth:f,initialHeight:m}=b(tZ);return{defaultSettingsDefaults:u.useMemo(()=>{var g,x,C,j,S,M,I,k,D,T,E,A,N,W,G,z;return{vae:{isEnabled:!ln((g=t==null?void 0:t.default_settings)==null?void 0:g.vae),value:((x=t==null?void 0:t.default_settings)==null?void 0:x.vae)||"default"},vaePrecision:{isEnabled:!ln((C=t==null?void 0:t.default_settings)==null?void 0:C.vae_precision),value:((j=t==null?void 0:t.default_settings)==null?void 0:j.vae_precision)||d||"fp32"},scheduler:{isEnabled:!ln((S=t==null?void 0:t.default_settings)==null?void 0:S.scheduler),value:((M=t==null?void 0:t.default_settings)==null?void 0:M.scheduler)||a||"euler"},steps:{isEnabled:!ln((I=t==null?void 0:t.default_settings)==null?void 0:I.steps),value:((k=t==null?void 0:t.default_settings)==null?void 0:k.steps)||o},cfgScale:{isEnabled:!ln((D=t==null?void 0:t.default_settings)==null?void 0:D.cfg_scale),value:((T=t==null?void 0:t.default_settings)==null?void 0:T.cfg_scale)||r},cfgRescaleMultiplier:{isEnabled:!ln((E=t==null?void 0:t.default_settings)==null?void 0:E.cfg_rescale_multiplier),value:((A=t==null?void 0:t.default_settings)==null?void 0:A.cfg_rescale_multiplier)||c},width:{isEnabled:!ln((N=t==null?void 0:t.default_settings)==null?void 0:N.width),value:((W=t==null?void 0:t.default_settings)==null?void 0:W.width)||f},height:{isEnabled:!ln((G=t==null?void 0:t.default_settings)==null?void 0:G.height),value:((z=t==null?void 0:t.default_settings)==null?void 0:z.height)||m}}},[t,d,a,o,r,c,f,m]),isLoading:n,optimalDimension:Z3(t)}};function sZ({control:e,optimalDimension:t}){const{field:n}=As({control:e,name:"height"}),o=b(j=>j.config.sd.height.sliderMin),r=b(j=>j.config.sd.height.sliderMax),a=b(j=>j.config.sd.height.numberInputMin),c=b(j=>j.config.sd.height.numberInputMax),d=b(j=>j.config.sd.height.coarseStep),f=b(j=>j.config.sd.height.fineStep),{t:m}=L(),h=u.useMemo(()=>[o,t,r],[o,t,r]),g=u.useCallback(j=>{const S={...n.value,value:j};n.onChange(S)},[n]),x=u.useMemo(()=>n.value.value,[n.value]),C=u.useMemo(()=>!n.value.isEnabled,[n.value]);return s.jsxs($,{flexDir:"column",gap:2,alignItems:"flex-start",children:[s.jsxs(P,{justifyContent:"space-between",w:"full",children:[s.jsx(Ke,{feature:"paramHeight",children:s.jsx(Y,{children:m("parameters.height")})}),s.jsx(yr,{control:e,name:"height"})]}),s.jsxs(P,{w:"full",gap:4,children:[s.jsx(Ne,{value:x,min:o,max:r,step:d,fineStep:f,onChange:g,marks:h,isDisabled:C}),s.jsx(Ee,{value:x,min:a,max:c,step:d,fineStep:f,onChange:g,isDisabled:C})]})]})}function oZ({control:e,optimalDimension:t}){const{field:n}=As({control:e,name:"width"}),o=b(j=>j.config.sd.width.sliderMin),r=b(j=>j.config.sd.width.sliderMax),a=b(j=>j.config.sd.width.numberInputMin),c=b(j=>j.config.sd.width.numberInputMax),d=b(j=>j.config.sd.width.coarseStep),f=b(j=>j.config.sd.width.fineStep),{t:m}=L(),h=u.useMemo(()=>[o,t,r],[o,t,r]),g=u.useCallback(j=>{const S={...n.value,value:j};n.onChange(S)},[n]),x=u.useMemo(()=>n.value.value,[n.value]),C=u.useMemo(()=>!n.value.isEnabled,[n.value]);return s.jsxs($,{flexDir:"column",gap:2,alignItems:"flex-start",children:[s.jsxs(P,{justifyContent:"space-between",w:"full",children:[s.jsx(Ke,{feature:"paramWidth",children:s.jsx(Y,{children:m("parameters.width")})}),s.jsx(yr,{control:e,name:"width"})]}),s.jsxs(P,{w:"full",gap:4,children:[s.jsx(Ne,{value:x,min:o,max:r,step:d,fineStep:f,onChange:g,marks:h,isDisabled:C}),s.jsx(Ee,{value:x,min:a,max:c,step:d,fineStep:f,onChange:g,isDisabled:C})]})]})}function rZ(e){const{field:t}=As(e),n=b(C=>C.config.sd.cfgRescaleMultiplier.sliderMin),o=b(C=>C.config.sd.cfgRescaleMultiplier.sliderMax),r=b(C=>C.config.sd.cfgRescaleMultiplier.numberInputMin),a=b(C=>C.config.sd.cfgRescaleMultiplier.numberInputMax),c=b(C=>C.config.sd.cfgRescaleMultiplier.coarseStep),d=b(C=>C.config.sd.cfgRescaleMultiplier.fineStep),{t:f}=L(),m=u.useMemo(()=>[n,Math.floor(o/2),o],[o,n]),h=u.useCallback(C=>{const j={...t.value,value:C};t.onChange(j)},[t]),g=u.useMemo(()=>t.value.value,[t.value]),x=u.useMemo(()=>!t.value.isEnabled,[t.value]);return s.jsxs($,{flexDir:"column",gap:2,alignItems:"flex-start",children:[s.jsxs(P,{justifyContent:"space-between",w:"full",children:[s.jsx(Ke,{feature:"paramCFGRescaleMultiplier",children:s.jsx(Y,{children:f("parameters.cfgRescaleMultiplier")})}),s.jsx(yr,{control:e.control,name:"cfgRescaleMultiplier"})]}),s.jsxs(P,{w:"full",gap:4,children:[s.jsx(Ne,{value:g,min:n,max:o,step:c,fineStep:d,onChange:h,marks:m,isDisabled:x}),s.jsx(Ee,{value:g,min:r,max:a,step:c,fineStep:d,onChange:h,isDisabled:x})]})]})}function aZ(e){const{field:t}=As(e),n=b(C=>C.config.sd.guidance.sliderMin),o=b(C=>C.config.sd.guidance.sliderMax),r=b(C=>C.config.sd.guidance.numberInputMin),a=b(C=>C.config.sd.guidance.numberInputMax),c=b(C=>C.config.sd.guidance.coarseStep),d=b(C=>C.config.sd.guidance.fineStep),{t:f}=L(),m=u.useMemo(()=>[n,Math.floor(o/2),o],[o,n]),h=u.useCallback(C=>{const j={...t.value,value:C};t.onChange(j)},[t]),g=u.useMemo(()=>t.value.value,[t.value]),x=u.useMemo(()=>!t.value.isEnabled,[t.value]);return s.jsxs($,{flexDir:"column",gap:2,alignItems:"flex-start",children:[s.jsxs(P,{justifyContent:"space-between",w:"full",children:[s.jsx(Ke,{feature:"paramCFGScale",children:s.jsx(Y,{children:f("parameters.cfgScale")})}),s.jsx(yr,{control:e.control,name:"cfgScale"})]}),s.jsxs(P,{w:"full",gap:4,children:[s.jsx(Ne,{value:g,min:n,max:o,step:c,fineStep:d,onChange:h,marks:m,isDisabled:x}),s.jsx(Ee,{value:g,min:r,max:a,step:c,fineStep:d,onChange:h,isDisabled:x})]})]})}function lZ(e){const{t}=L(),{field:n}=As(e),o=u.useCallback(c=>{if(!ai(c==null?void 0:c.value))return;const d={...n.value,value:c.value};n.onChange(d)},[n]),r=u.useMemo(()=>Qr.find(c=>c.value===n.value.value),[n]),a=u.useMemo(()=>!n.value.isEnabled,[n.value]);return s.jsxs($,{flexDir:"column",gap:2,alignItems:"flex-start",children:[s.jsxs(P,{justifyContent:"space-between",w:"full",children:[s.jsx(Ke,{feature:"paramScheduler",children:s.jsx(Y,{children:t("parameters.scheduler")})}),s.jsx(yr,{control:e.control,name:"scheduler"})]}),s.jsx(ot,{isDisabled:a,value:r,options:Qr,onChange:o})]})}function iZ(e){const{field:t}=As(e),n=b(C=>C.config.sd.steps.sliderMin),o=b(C=>C.config.sd.steps.sliderMax),r=b(C=>C.config.sd.steps.numberInputMin),a=b(C=>C.config.sd.steps.numberInputMax),c=b(C=>C.config.sd.steps.coarseStep),d=b(C=>C.config.sd.steps.fineStep),{t:f}=L(),m=u.useMemo(()=>[n,Math.floor(o/2),o],[o,n]),h=u.useCallback(C=>{const j={...t.value,value:C};t.onChange(j)},[t]),g=u.useMemo(()=>t.value.value,[t.value]),x=u.useMemo(()=>!t.value.isEnabled,[t.value]);return s.jsxs($,{flexDir:"column",gap:2,alignItems:"flex-start",children:[s.jsxs(P,{justifyContent:"space-between",w:"full",children:[s.jsx(Ke,{feature:"paramSteps",children:s.jsx(Y,{children:f("parameters.steps")})}),s.jsx(yr,{control:e.control,name:"steps"})]}),s.jsxs(P,{w:"full",gap:4,children:[s.jsx(Ne,{value:g,min:n,max:o,step:c,fineStep:d,onChange:h,marks:m,isDisabled:x}),s.jsx(Ee,{value:g,min:r,max:a,step:c,fineStep:d,onChange:h,isDisabled:x})]})]})}function cZ(e){const{t}=L(),{field:n}=As(e),o=b(h=>h.modelmanagerV2.selectedModelKey),{data:r}=vo(o??Ot),[a]=Ef(),c=u.useMemo(()=>{const h=a.filter(x=>x.base===(r==null?void 0:r.base)).map(x=>({label:x.name,value:x.key}));return[{label:"Default VAE",value:"default"},...h]},[r==null?void 0:r.base,a]),d=u.useCallback(h=>{const g=h!=null&&h.value?h.value:"default",x={...n.value,value:g};n.onChange(x)},[n]),f=u.useMemo(()=>c.find(h=>h.value===n.value.value),[c,n.value]),m=u.useMemo(()=>!n.value.isEnabled,[n.value]);return s.jsxs($,{flexDir:"column",gap:2,alignItems:"flex-start",children:[s.jsxs(P,{justifyContent:"space-between",w:"full",children:[s.jsx(Ke,{feature:"paramVAE",children:s.jsx(Y,{children:t("modelManager.vae")})}),s.jsx(yr,{control:e.control,name:"vae"})]}),s.jsx(ot,{isDisabled:m,value:f,options:c,onChange:d})]})}const Qv=[{label:"FP16",value:"fp16"},{label:"FP32",value:"fp32"}];function uZ(e){const{t}=L(),{field:n}=As(e),o=u.useCallback(c=>{if(!Ry(c==null?void 0:c.value))return;const d={...n.value,value:c.value};n.onChange(d)},[n]),r=u.useMemo(()=>Qv.find(c=>c.value===n.value.value),[n]),a=u.useMemo(()=>!n.value.isEnabled,[n.value]);return s.jsxs($,{flexDir:"column",gap:1,alignItems:"flex-start",children:[s.jsxs(P,{justifyContent:"space-between",w:"full",children:[s.jsx(Ke,{feature:"paramVAEPrecision",children:s.jsx(Y,{children:t("modelManager.vaePrecision")})}),s.jsx(yr,{control:e.control,name:"vaePrecision"})]}),s.jsx(ot,{isDisabled:a,value:r,options:Qv,onChange:o})]})}const dZ=()=>{const e=b(C=>C.modelmanagerV2.selectedModelKey),{t}=L(),n=O(),{defaultSettingsDefaults:o,isLoading:r,optimalDimension:a}=nZ(e),[c,{isLoading:d}]=mf(),{handleSubmit:f,control:m,formState:h,reset:g}=nh({defaultValues:o}),x=u.useCallback(C=>{if(!e)return;const j={vae:C.vae.isEnabled?C.vae.value:null,vae_precision:C.vaePrecision.isEnabled?C.vaePrecision.value:null,cfg_scale:C.cfgScale.isEnabled?C.cfgScale.value:null,cfg_rescale_multiplier:C.cfgRescaleMultiplier.isEnabled?C.cfgRescaleMultiplier.value:null,steps:C.steps.isEnabled?C.steps.value:null,scheduler:C.scheduler.isEnabled?C.scheduler.value:null,width:C.width.isEnabled?C.width.value:null,height:C.height.isEnabled?C.height.value:null};c({key:e,body:{default_settings:j}}).unwrap().then(S=>{n(Ze(pt({title:t("modelManager.defaultSettingsSaved"),status:"success"}))),g(C)}).catch(S=>{S&&n(Ze(pt({title:`${S.data.detail} `,status:"error"})))})},[e,n,g,c,t]);return r?s.jsx(re,{children:t("common.loading")}):s.jsxs(s.Fragment,{children:[s.jsxs(P,{gap:"4",justifyContent:"space-between",w:"full",pb:4,children:[s.jsx(sn,{fontSize:"md",children:t("modelManager.defaultSettings")}),s.jsx(qe,{size:"sm",leftIcon:s.jsx(_c,{}),colorScheme:"invokeYellow",isDisabled:!h.isDirty,onClick:f(x),type:"submit",isLoading:d,children:t("common.save")})]}),s.jsxs(P,{flexDir:"column",gap:8,children:[s.jsxs(P,{gap:8,children:[s.jsx(P,{gap:4,w:"full",children:s.jsx(cZ,{control:m,name:"vae"})}),s.jsx(P,{gap:4,w:"full",children:s.jsx(uZ,{control:m,name:"vaePrecision"})})]}),s.jsxs(P,{gap:8,children:[s.jsx(P,{gap:4,w:"full",children:s.jsx(lZ,{control:m,name:"scheduler"})}),s.jsx(P,{gap:4,w:"full",children:s.jsx(iZ,{control:m,name:"steps"})})]}),s.jsxs(P,{gap:8,children:[s.jsx(P,{gap:4,w:"full",children:s.jsx(aZ,{control:m,name:"cfgScale"})}),s.jsx(P,{gap:4,w:"full",children:s.jsx(rZ,{control:m,name:"cfgRescaleMultiplier"})})]}),s.jsxs(P,{gap:8,children:[s.jsx(P,{gap:4,w:"full",children:s.jsx(oZ,{control:m,optimalDimension:a})}),s.jsx(P,{gap:4,w:"full",children:s.jsx(sZ,{control:m,optimalDimension:a})})]})]})]})},Po=({label:e,value:t})=>s.jsxs($,{flexDir:"column",alignItems:"flex-start",gap:0,children:[s.jsx(Y,{children:e}),s.jsx(re,{fontSize:"md",children:t||"-"})]}),fZ=()=>{const{t:e}=L(),t=b(r=>r.modelmanagerV2.selectedModelKey),{data:n,isLoading:o}=vo(t??Ot);return o?s.jsx(re,{children:e("common.loading")}):n?s.jsxs(P,{flexDir:"column",h:"full",gap:4,children:[s.jsx(Ae,{layerStyle:"second",borderRadius:"base",p:4,children:s.jsxs(P,{flexDir:"column",gap:4,children:[s.jsxs(P,{gap:2,children:[s.jsx(Po,{label:e("modelManager.baseModel"),value:n.base}),s.jsx(Po,{label:e("modelManager.modelType"),value:n.type})]}),s.jsxs(P,{gap:2,children:[s.jsx(Po,{label:e("common.format"),value:n.format}),s.jsx(Po,{label:e("modelManager.path"),value:n.path})]}),n.type==="main"&&n.format==="diffusers"&&n.repo_variant&&s.jsx(P,{gap:2,children:s.jsx(Po,{label:e("modelManager.repoVariant"),value:n.repo_variant})}),n.type==="main"&&n.format==="checkpoint"&&s.jsxs(s.Fragment,{children:[s.jsxs(P,{gap:2,children:[s.jsx(Po,{label:e("modelManager.pathToConfig"),value:n.config_path}),s.jsx(Po,{label:e("modelManager.variant"),value:n.variant})]}),s.jsxs(P,{gap:2,children:[s.jsx(Po,{label:e("modelManager.predictionType"),value:n.prediction_type}),s.jsx(Po,{label:e("modelManager.upcastAttention"),value:`${n.upcast_attention}`})]})]}),n.type==="ip_adapter"&&s.jsx(P,{gap:2,children:s.jsx(Po,{label:e("modelManager.imageEncoderModelId"),value:n.image_encoder_model_id})})]})}),n.type==="main"&&n.base!=="sdxl-refiner"&&s.jsx(Ae,{layerStyle:"second",borderRadius:"base",p:4,children:s.jsx(dZ,{})}),(n.type==="controlnet"||n.type==="t2i_adapter")&&s.jsx(Ae,{layerStyle:"second",borderRadius:"base",p:4,children:s.jsx(JU,{})}),(n.type==="main"||n.type==="lora")&&s.jsx(Ae,{layerStyle:"second",borderRadius:"base",p:4,children:s.jsx(eZ,{})})]}):s.jsx(re,{children:e("common.somethingWentWrong")})},hZ=()=>{const{t:e}=L(),t=b(g=>g.modelmanagerV2.selectedModelMode),n=b(g=>g.modelmanagerV2.selectedModelKey),{data:o,isLoading:r}=vo(n??Ot),[a,{isLoading:c}]=mf(),d=O(),f=nh({defaultValues:o,mode:"onChange"}),m=u.useCallback(g=>{if(!(o!=null&&o.key))return;const x={key:o.key,body:g};a(x).unwrap().then(C=>{f.reset(C,{keepDefaultValues:!0}),d(lp("view")),d(Ze(pt({title:e("modelManager.modelUpdated"),status:"success"})))}).catch(C=>{f.reset(),d(Ze(pt({title:e("modelManager.modelUpdateFailed"),status:"error"})))})},[d,o==null?void 0:o.key,f,e,a]),h=u.useCallback(()=>{d(lp("view"))},[d]);return r?s.jsx(re,{children:e("common.loading")}):o?s.jsxs(P,{flexDir:"column",gap:4,children:[s.jsxs(P,{alignItems:"flex-start",gap:4,children:[s.jsx($U,{model_key:n,model_image:o.cover_image}),s.jsxs(P,{flexDir:"column",gap:1,flexGrow:1,children:[s.jsxs(P,{gap:2,children:[s.jsx(sn,{as:"h2",fontSize:"lg",children:o.name}),s.jsx(Tn,{}),t==="view"&&s.jsx(OU,{modelKey:n}),t==="view"&&s.jsx(VU,{}),t==="edit"&&s.jsx(qe,{size:"sm",onClick:h,leftIcon:s.jsx($n,{}),children:e("common.cancel")}),t==="edit"&&s.jsx(qe,{size:"sm",colorScheme:"invokeYellow",leftIcon:s.jsx(_c,{}),onClick:f.handleSubmit(m),isLoading:c,isDisabled:!!Object.keys(f.formState.errors).length,children:e("common.save")})]}),o.source&&s.jsxs(re,{variant:"subtext",children:[e("modelManager.source"),": ",o==null?void 0:o.source]}),s.jsx(re,{noOfLines:3,children:o.description})]})]}),t==="view"?s.jsx(fZ,{}):s.jsx(KU,{form:f,onSubmit:m})]}):s.jsx(re,{children:e("common.somethingWentWrong")})},mZ=()=>{const e=b(t=>t.modelmanagerV2.selectedModelKey);return s.jsx(Ae,{layerStyle:"first",p:4,borderRadius:"base",w:"50%",h:"full",children:e?s.jsx(hZ,{},e):s.jsx(zU,{})})},pZ=()=>s.jsxs(P,{w:"full",h:"full",gap:"2",children:[s.jsx(aU,{}),s.jsx(mZ,{})]}),gZ=u.memo(pZ),xZ=()=>{const e=O(),{t}=L(),n=u.useCallback(()=>{e(Ky())},[e]);return s.jsx(ve,{tooltip:t("nodes.addNodeToolTip"),"aria-label":t("nodes.addNode"),icon:s.jsx(Hs,{}),onClick:n,pointerEvents:"auto"})},vZ=u.memo(xZ),CZ=()=>{const e=O(),{t}=L(),{isOpen:n,onOpen:o,onClose:r}=fn(),a=b(f=>f.workflow.isTouched),c=u.useCallback(()=>{e(Ay()),e(Ze(pt({title:t("workflows.workflowCleared"),status:"success"}))),r()},[e,r,t]),d=u.useCallback(()=>{if(!a){c();return}o()},[c,a,o]);return s.jsxs(s.Fragment,{children:[s.jsx(ve,{tooltip:t("nodes.clearWorkflow"),"aria-label":t("nodes.clearWorkflow"),icon:s.jsx(Bc,{}),onClick:d,pointerEvents:"auto"}),s.jsx(sa,{isOpen:n,onClose:r,title:t("nodes.clearWorkflow"),acceptCallback:c,children:s.jsxs(P,{flexDir:"column",gap:2,children:[s.jsx(re,{children:t("nodes.clearWorkflowDesc")}),s.jsx(re,{variant:"subtext",children:t("nodes.clearWorkflowDesc2")})]})})]})},yZ=u.memo(CZ),bZ=()=>{const e=O(),{t}=L(),n=Qw(),o=u.useCallback(()=>{e(q3())},[e]);return n?s.jsx(ve,{tooltip:t("nodes.updateAllNodes"),"aria-label":t("nodes.updateAllNodes"),icon:s.jsx(gf,{}),onClick:o,pointerEvents:"auto",colorScheme:"warning"}):null},jZ=u.memo(bZ),SZ=()=>{const e=O();return u.useCallback(()=>{const n=il.get();if(!n)return;const o=new Blob([JSON.stringify(n,null,2)]),r=document.createElement("a");r.href=URL.createObjectURL(o),r.download=`${n.name||"My Workflow"}.json`,document.body.appendChild(r),r.click(),r.remove(),e(iz())},[e])},wZ=()=>{const{t:e}=L(),t=SZ();return s.jsx(ut,{as:"button",icon:s.jsx(Lc,{}),onClick:t,children:e("workflows.downloadWorkflow")})},kZ=u.memo(wZ),l4=u.memo(()=>{const{t:e}=L(),t=u.useCallback(n=>s.jsx(ut,{as:"button",icon:s.jsx(Gb,{}),onClick:n,children:e("nodes.newWorkflow")}),[e]);return s.jsx(A0,{renderButton:t})});l4.displayName="NewWorkflowMenuItem";const IZ=()=>{const{t:e}=L(),{onOpen:t}=eh();return s.jsx(ut,{as:"button",icon:s.jsx(nl,{}),onClick:t,children:e("workflows.saveWorkflowAs")})},MZ=u.memo(IZ),AZ=()=>{const{t:e}=L(),{saveWorkflow:t}=Uw(),{onOpen:n}=eh(),o=b(a=>a.workflow.isTouched),r=u.useCallback(async()=>{const a=il.get();a&&(M0(a)?t():n())},[n,t]);return s.jsx(ut,{as:"button",isDisabled:!o,icon:s.jsx(Tc,{}),onClick:r,children:e("workflows.saveWorkflow")})},PZ=u.memo(AZ),DZ=()=>{const{t:e}=L(),[t]=Q3(),n=u.useCallback(()=>{t()},[t]);return s.jsx(qe,{leftIcon:s.jsx(mD,{}),tooltip:e("nodes.reloadNodeTemplates"),"aria-label":e("nodes.reloadNodeTemplates"),onClick:n,children:e("nodes.reloadNodeTemplates")})},EZ=u.memo(DZ),_Z={flexGrow:1},LZ=Ve(lt,e=>{const{shouldAnimateEdges:t,shouldValidateGraph:n,shouldSnapToGrid:o,shouldColorEdges:r,selectionMode:a}=e;return{shouldAnimateEdges:t,shouldValidateGraph:n,shouldSnapToGrid:o,shouldColorEdges:r,selectionModeIsChecked:a===K3.Full}}),TZ=({children:e})=>{const{isOpen:t,onOpen:n,onClose:o}=fn(),r=O(),{shouldAnimateEdges:a,shouldValidateGraph:c,shouldSnapToGrid:d,shouldColorEdges:f,selectionModeIsChecked:m}=b(LZ),h=u.useCallback(M=>{r(Y3(M.target.checked))},[r]),g=u.useCallback(M=>{r(X3(M.target.checked))},[r]),x=u.useCallback(M=>{r(J3(M.target.checked))},[r]),C=u.useCallback(M=>{r(eA(M.target.checked))},[r]),j=u.useCallback(M=>{r(tA(M.target.checked))},[r]),{t:S}=L();return s.jsxs(s.Fragment,{children:[e({onOpen:n}),s.jsxs(Fa,{isOpen:t,onClose:o,size:"2xl",isCentered:!0,children:[s.jsx(mr,{}),s.jsxs(Va,{children:[s.jsx(pr,{children:S("nodes.workflowSettings")}),s.jsx(ri,{}),s.jsx(gr,{children:s.jsxs(P,{flexDirection:"column",gap:4,py:4,children:[s.jsx(sn,{size:"sm",children:S("parameters.general")}),s.jsxs(En,{orientation:"vertical",formLabelProps:_Z,children:[s.jsxs($,{children:[s.jsxs(P,{w:"full",children:[s.jsx(Y,{children:S("nodes.animatedEdges")}),s.jsx(jt,{onChange:g,isChecked:a})]}),s.jsx(ir,{children:S("nodes.animatedEdgesHelp")})]}),s.jsx(An,{}),s.jsxs($,{children:[s.jsxs(P,{w:"full",children:[s.jsx(Y,{children:S("nodes.snapToGrid")}),s.jsx(jt,{isChecked:d,onChange:x})]}),s.jsx(ir,{children:S("nodes.snapToGridHelp")})]}),s.jsx(An,{}),s.jsxs($,{children:[s.jsxs(P,{w:"full",children:[s.jsx(Y,{children:S("nodes.colorCodeEdges")}),s.jsx(jt,{isChecked:f,onChange:C})]}),s.jsx(ir,{children:S("nodes.colorCodeEdgesHelp")})]}),s.jsx(An,{}),s.jsxs($,{children:[s.jsxs(P,{w:"full",children:[s.jsx(Y,{children:S("nodes.fullyContainNodes")}),s.jsx(jt,{isChecked:m,onChange:j})]}),s.jsx(ir,{children:S("nodes.fullyContainNodesHelp")})]}),s.jsx(An,{}),s.jsx(sn,{size:"sm",pt:4,children:S("common.advanced")}),s.jsxs($,{children:[s.jsxs(P,{w:"full",children:[s.jsx(Y,{children:S("nodes.validateConnections")}),s.jsx(jt,{isChecked:c,onChange:h})]}),s.jsx(ir,{children:S("nodes.validateConnectionsHelp")})]}),s.jsx(An,{})]}),s.jsx(EZ,{})]})})]})]})]})},RZ=u.memo(TZ),BZ=()=>{const{t:e}=L();return s.jsx(RZ,{children:({onOpen:t})=>s.jsx(ut,{as:"button",icon:s.jsx(Wj,{}),onClick:t,children:e("nodes.workflowSettings")})})},NZ=u.memo(BZ),zZ=()=>{const{t:e}=L(),t=u.useRef(null),n=bw({resetRef:t}),o=u.useCallback(c=>{c[0]&&n(c[0])},[n]),{getRootProps:r,getInputProps:a}=hi({accept:{"application/json":[".json"]},onDropAccepted:o,noDrag:!0,multiple:!1});return s.jsxs(ut,{as:"button",icon:s.jsx(mi,{}),...r(),children:[e("workflows.uploadWorkflow"),s.jsx("input",{...a()})]})},OZ=u.memo(zZ),FZ=()=>{const{t:e}=L(),{isOpen:t,onOpen:n,onClose:o}=fn();return df(o),s.jsxs(Ic,{isOpen:t,onOpen:n,onClose:o,children:[s.jsx(Mc,{as:ve,"aria-label":e("workflows.workflowEditorMenu"),icon:s.jsx(_g,{}),pointerEvents:"auto"}),s.jsxs(qr,{pointerEvents:"auto",children:[s.jsx(l4,{}),s.jsx(OZ,{}),s.jsx(Or,{}),s.jsx(PZ,{}),s.jsx(MZ,{}),s.jsx(kZ,{}),s.jsx(Or,{}),s.jsx(NZ,{})]})]})},VZ=u.memo(FZ),HZ=()=>{const e=b(t=>t.workflow.name);return s.jsxs(P,{gap:2,top:2,left:2,right:2,position:"absolute",alignItems:"flex-start",pointerEvents:"none",children:[s.jsxs(P,{gap:"2",children:[s.jsx(vZ,{}),s.jsx(jZ,{})]}),s.jsx(Tn,{}),!!e.length&&s.jsx(Kw,{}),s.jsx(Tn,{}),s.jsx(yZ,{}),s.jsx(Zw,{}),s.jsx(VZ,{})]})},$Z=u.memo(HZ),WZ=()=>{const{t:e}=L(),t=O(),[n,o]=yw(),r=na(),a=u.useRef();return{saveWorkflowAs:u.useCallback(async({name:d,category:f,onSuccess:m,onError:h})=>{const g=il.get();if(g){a.current=r({title:e("workflows.savingWorkflow"),status:"loading",duration:null,isClosable:!1});try{g.id=void 0,g.name=d,g.meta.category=f;const x=await n(g).unwrap();t(Iy(x.workflow.id)),t(jy(x.workflow.name)),t(nA(x.workflow.meta.category)),t(My()),t(uz({category:f})),m&&m(),r.update(a.current,{title:e("workflows.workflowSaved"),status:"success",duration:1e3,isClosable:!0})}catch{h&&h(),r.isActive(`auth-error-toast-${Ua.endpoints.createWorkflow.name}`)?r.close(a.current):r.update(a.current,{title:e("workflows.problemSavingWorkflow"),status:"error",duration:1e3,isClosable:!0})}}},[r,n,t,e]),isLoading:o.isLoading,isError:o.isError}},GZ=()=>{const{isOpen:e,onClose:t,workflowName:n,setWorkflowName:o,shouldSaveToProject:r,setShouldSaveToProject:a}=eh(),c=yt(vy),{saveWorkflowAs:d}=WZ(),f=u.useRef(null),m=u.useRef(null),h=u.useCallback(j=>{o(j.target.value)},[o]),g=u.useCallback(j=>{a(j.target.checked)},[a]),x=u.useCallback(()=>{t()},[t]),C=u.useCallback(async()=>{await d({name:n,category:r?"project":"user",onSuccess:x,onError:x})},[n,d,r,x]);return s.jsx(DC,{isOpen:e,onClose:t,leastDestructiveRef:f,isCentered:!0,children:s.jsx(mr,{children:s.jsxs(EC,{children:[s.jsx(pr,{fontSize:"lg",fontWeight:"bold",children:Te("workflows.saveWorkflowAs")}),s.jsx(gr,{children:s.jsxs($,{alignItems:"flex-start",children:[s.jsx(Y,{mt:"2",children:Te("workflows.workflowName")}),s.jsxs(P,{flexDir:"column",width:"full",gap:"2",children:[s.jsx(mn,{ref:m,value:n,onChange:h,placeholder:Te("workflows.workflowName")}),c.includes("project")&&s.jsx(bn,{isChecked:r,onChange:g,children:s.jsx(Y,{children:Te("workflows.saveWorkflowToProject")})})]})]})}),s.jsxs(Ha,{children:[s.jsx(qe,{ref:f,onClick:x,children:Te("common.cancel")}),s.jsx(qe,{colorScheme:"invokeBlue",onClick:C,ml:3,isDisabled:!n||!n.length,children:Te("common.saveAs")})]})]})})})};function UZ(e){return Se({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"m17 16-4-4V8.82C14.16 8.4 15 7.3 15 6c0-1.66-1.34-3-3-3S9 4.34 9 6c0 1.3.84 2.4 2 2.82V12l-4 4H3v5h5v-3.05l4-4.2 4 4.2V21h5v-5h-4z"},child:[]}]})(e)}const ZZ=e=>{const t=ia();return{...Yy,id:t,type:"current_image",position:e,data:{id:t,type:"current_image",isOpen:!0,label:"Current Image"}}},qZ=e=>{const t=ia();return{...Yy,id:t,type:"notes",position:e,data:{id:t,isOpen:!0,label:"Notes",notes:"",type:"notes"}}},QZ=()=>{const e=b(n=>n.nodes.templates),t=Xy();return u.useCallback(n=>{var f;let o=window.innerWidth/2,r=window.innerHeight/2;const a=(f=document.querySelector("#workflow-editor"))==null?void 0:f.getBoundingClientRect();a&&(o=a.width/2-ip/2+a.left,r=a.height/2-ip/2+a.top);const c=t.screenToFlowPosition({x:o,y:r});if(n==="current_image")return ZZ(c);if(n==="notes")return qZ(c);const d=e[n];return sA(c,d)},[e,t])},KZ=Jy(e=>new RegExp(e.trim().replace(/[-[\]{}()*+!<=:?./\\^$|#,]/g,"").split(" ").join(".*"),"gi")),YZ=Jy((e,t)=>{if(!t)return!0;const n=KZ(t);return n.test(e.label)||n.test(e.data.description??"")||(e.data.tags??[]).some(o=>n.test(o))}),XZ=()=>{const e=O(),t=QZ(),n=Uo(),{t:o}=L(),r=u.useRef(null),a=u.useRef(null),c=b(D=>D.nodes.connectionStartFieldType),d=b(D=>{var T;return(T=D.nodes.connectionStartParams)==null?void 0:T.handleType}),f=Ve(lt,D=>{const T=c?Fy(D.templates,A=>{const N=d==="source"?A.inputs:A.outputs;return fo(N,W=>{const G=d==="source"?c:W.type,z=d==="target"?c:W.type;return vg(G,z)})}):Us(D.templates),E=Us(T,A=>({label:A.title,value:A.type,description:A.description,tags:A.tags}));return c===null&&(E.push({label:o("nodes.currentImage"),value:"current_image",description:o("nodes.currentImageDescription"),tags:["progress"]}),E.push({label:o("nodes.notes"),value:"notes",description:o("nodes.notesDescription"),tags:["notes"]})),E.sort((A,N)=>A.label.localeCompare(N.label)),{options:E}}),{options:m}=b(f),h=b(D=>D.nodes.isAddNodePopoverOpen),g=u.useCallback(D=>{const T=t(D);if(!T){const E=o("nodes.unknownNode",{nodeType:D});n({status:"error",title:E});return}e(oA(T))},[e,t,n,o]),x=u.useCallback(D=>{D&&(g(D.value),e(Kx()))},[g,e]),C=u.useCallback(()=>{e(Kx())},[e]),j=u.useCallback(()=>{e(Ky())},[e]),S=u.useCallback(D=>{D.preventDefault(),j(),dg.flushSync(()=>{var T,E;(E=(T=r.current)==null?void 0:T.inputRef)==null||E.focus()})},[j]),M=u.useCallback(()=>{C()},[C]);Re(["shift+a","space"],S),Re(["escape"],M);const I=u.useCallback(D=>{D.key==="Escape"&&C()},[C]),k=u.useCallback(()=>o("nodes.noMatchingNodes"),[o]);return s.jsxs(oa,{isOpen:h,onClose:C,placement:"bottom",openDelay:0,closeDelay:0,closeOnBlur:!0,returnFocusOnClose:!0,initialFocusRef:a,isLazy:!0,children:[s.jsx(Ty,{children:s.jsx(P,{position:"absolute",top:"15%",insetInlineStart:"50%",pointerEvents:"none"})}),s.jsx(ra,{p:0,top:-1,shadow:"dark-lg",borderColor:"invokeBlue.400",borderWidth:"2px",borderStyle:"solid",children:s.jsx(aa,{w:"32rem",p:0,children:s.jsx(ot,{menuIsOpen:h,selectRef:r,value:null,placeholder:o("nodes.nodeSearch"),options:m,noOptionsMessage:k,filterOption:YZ,onChange:x,onMenuClose:C,onKeyDown:I,inputRef:a,closeMenuOnSelect:!1})})})]})},JZ=u.memo(XZ),eq=()=>{const e=rA(),t=b(o=>o.nodes.shouldValidateGraph);return u.useCallback(({source:o,sourceHandle:r,target:a,targetHandle:c})=>{var S,M;if(!(o&&r&&a&&c)||o===a)return!1;const d=e.getState(),{nodes:f,edges:m,templates:h}=d.nodes,g=f.find(I=>I.id===o),x=f.find(I=>I.id===a),C=(S=h[g.data.type])==null?void 0:S.outputs[r],j=(M=h[x.data.type])==null?void 0:M.inputs[c];return C&&j?t?m.find(I=>{I.target===a&&I.targetHandle===c&&I.source===o&&I.sourceHandle})||m.find(I=>I.target===a&&I.targetHandle===c)&&j.type.name!=="CollectionItemField"||!vg(C.type,j.type)?!1:eb(o,a,f,m):!0:!1},[t,e])},O0=e=>{if(!e)return hr("base.500");const t=aA[e.name];return hr(t||"base.500")},tq=it(lt,e=>e.shouldColorEdges?O0(e.connectionStartFieldType):hr("base.500")),nq=it(lt,e=>e.shouldAnimateEdges?"react-flow__custom_connection-path animated":"react-flow__custom_connection-path"),sq={opacity:.8},oq=({fromX:e,fromY:t,fromPosition:n,toX:o,toY:r,toPosition:a})=>{const c=b(tq),d=b(nq),f={sourceX:e,sourceY:t,sourcePosition:n,targetX:o,targetY:r,targetPosition:a},[m]=Cg(f);return s.jsx("g",{children:s.jsx("path",{fill:"none",stroke:c,strokeWidth:2,className:d,d:m,style:sq})})},rq=u.memo(oq),i4=()=>{const[e,t,n,o,r,a,c,d,f,m,h,g,x,C,j,S,M,I,k,D,T,E,A,N,W,G,z,X,B,Q,V,H,me,Ie,ye,de,He,Be,ce,ue,je,be,ee,J,F,oe,le,fe,he,ke,ze,$e,Je,gt,R,Z,ne,ge,xe,pe,te,Ce,Ue,tt,wt,Zt,Ft,on,is,xn,Yn,Bn,Ps,cs,us,eo]=pf("colors",["base.50","base.100","base.150","base.200","base.250","base.300","base.350","base.400","base.450","base.500","base.550","base.600","base.650","base.700","base.750","base.800","base.850","base.900","base.950","accent.50","accent.100","accent.150","accent.200","accent.250","accent.300","accent.350","accent.400","accent.450","accent.500","accent.550","accent.600","accent.650","accent.700","accent.750","accent.800","accent.850","accent.900","accent.950","baseAlpha.50","baseAlpha.100","baseAlpha.150","baseAlpha.200","baseAlpha.250","baseAlpha.300","baseAlpha.350","baseAlpha.400","baseAlpha.450","baseAlpha.500","baseAlpha.550","baseAlpha.600","baseAlpha.650","baseAlpha.700","baseAlpha.750","baseAlpha.800","baseAlpha.850","baseAlpha.900","baseAlpha.950","accentAlpha.50","accentAlpha.100","accentAlpha.150","accentAlpha.200","accentAlpha.250","accentAlpha.300","accentAlpha.350","accentAlpha.400","accentAlpha.450","accentAlpha.500","accentAlpha.550","accentAlpha.600","accentAlpha.650","accentAlpha.700","accentAlpha.750","accentAlpha.800","accentAlpha.850","accentAlpha.900","accentAlpha.950"]);return{base50:e,base100:t,base150:n,base200:o,base250:r,base300:a,base350:c,base400:d,base450:f,base500:m,base550:h,base600:g,base650:x,base700:C,base750:j,base800:S,base850:M,base900:I,base950:k,accent50:D,accent100:T,accent150:E,accent200:A,accent250:N,accent300:W,accent350:G,accent400:z,accent450:X,accent500:B,accent550:Q,accent600:V,accent650:H,accent700:me,accent750:Ie,accent800:ye,accent850:de,accent900:He,accent950:Be,baseAlpha50:ce,baseAlpha100:ue,baseAlpha150:je,baseAlpha200:be,baseAlpha250:ee,baseAlpha300:J,baseAlpha350:F,baseAlpha400:oe,baseAlpha450:le,baseAlpha500:fe,baseAlpha550:he,baseAlpha600:ke,baseAlpha650:ze,baseAlpha700:$e,baseAlpha750:Je,baseAlpha800:gt,baseAlpha850:R,baseAlpha900:Z,baseAlpha950:ne,accentAlpha50:ge,accentAlpha100:xe,accentAlpha150:pe,accentAlpha200:te,accentAlpha250:Ce,accentAlpha300:Ue,accentAlpha350:tt,accentAlpha400:wt,accentAlpha450:Zt,accentAlpha500:Ft,accentAlpha550:on,accentAlpha600:is,accentAlpha650:xn,accentAlpha700:Yn,accentAlpha750:Bn,accentAlpha800:Ps,accentAlpha850:cs,accentAlpha900:us,accentAlpha950:eo}},aq={isSelected:!1,shouldAnimate:!1,stroke:hr("base.500")},c4=(e,t,n,o,r)=>Ve(lt,a=>{const c=a.nodes.find(C=>C.id===e),d=a.nodes.find(C=>C.id===n),f=Zr(c)&&Zr(d),m=!!(c!=null&&c.selected||d!=null&&d.selected||r);if(!c||!t)return aq;const h=$c(a,c.id,t),g=f?h==null?void 0:h.type:void 0,x=g&&a.shouldColorEdges?O0(g):hr("base.500");return{isSelected:m,shouldAnimate:a.shouldAnimateEdges&&m,stroke:x}}),lq=({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:r,targetPosition:a,markerEnd:c,data:d,selected:f,source:m,target:h,sourceHandleId:g,targetHandleId:x})=>{const C=u.useMemo(()=>c4(m,g,h,x,f),[f,m,g,h,x]),{isSelected:j,shouldAnimate:S}=b(C),[M,I,k]=Cg({sourceX:e,sourceY:t,sourcePosition:r,targetX:n,targetY:o,targetPosition:a}),{base500:D}=i4(),T=u.useMemo(()=>({strokeWidth:j?3:2,stroke:D,opacity:j?.8:.5,animation:S?"dashdraw 0.5s linear infinite":void 0,strokeDasharray:S?5:"none"}),[D,j,S]);return s.jsxs(s.Fragment,{children:[s.jsx(tb,{path:M,markerEnd:c,style:T}),(d==null?void 0:d.count)&&d.count>1&&s.jsx(lA,{children:s.jsx(P,{position:"absolute",transform:`translate(-50%, -50%) translate(${I}px,${k}px)`,className:"nodrag nopan",children:s.jsx(Ws,{variant:"solid",bg:"base.500",opacity:j?.8:.5,boxShadow:"base",children:d.count})})})]})},iq=u.memo(lq),cq=({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:r,targetPosition:a,markerEnd:c,selected:d,source:f,target:m,sourceHandleId:h,targetHandleId:g})=>{const x=u.useMemo(()=>c4(f,h,m,g,d),[f,h,m,g,d]),{isSelected:C,shouldAnimate:j,stroke:S}=b(x),[M]=Cg({sourceX:e,sourceY:t,sourcePosition:r,targetX:n,targetY:o,targetPosition:a}),I=u.useMemo(()=>({strokeWidth:C?3:2,stroke:S,opacity:C?.8:.5,animation:j?"dashdraw 0.5s linear infinite":void 0,strokeDasharray:j?5:"none"}),[C,j,S]);return s.jsx(tb,{path:M,markerEnd:c,style:I})},uq=u.memo(cq),dq=e=>{const{nodeId:t,width:n,children:o,selected:r}=e,{isMouseOverNode:a,handleMouseOut:c,handleMouseOver:d}=Ww(t),f=u.useMemo(()=>it(lt,I=>{var k;return((k=I.nodeExecutionStates[t])==null?void 0:k.status)===ur.enum.IN_PROGRESS}),[t]),m=b(f),[h,g,x]=pf("shadows",["nodeInProgress","shadows.xl","shadows.base"]),C=O(),j=b(I=>I.nodes.nodeOpacity),{onCloseGlobal:S}=df(),M=u.useCallback(I=>{!I.ctrlKey&&!I.altKey&&!I.metaKey&&!I.shiftKey&&C(iA(t)),S()},[C,S,t]);return s.jsxs(Ae,{onClick:M,onMouseEnter:d,onMouseLeave:c,className:ui,h:"full",position:"relative",borderRadius:"base",w:n||ip,transitionProperty:"common",transitionDuration:"0.1s",cursor:"grab",opacity:j,children:[s.jsx(Ae,{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,borderRadius:"base",pointerEvents:"none",shadow:`${g}, ${x}, ${x}`,zIndex:-1}),s.jsx(Ae,{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,borderRadius:"md",pointerEvents:"none",transitionProperty:"common",transitionDuration:"0.1s",opacity:.7,shadow:m?h:void 0,zIndex:-1}),o,s.jsx($w,{isSelected:r,isHovered:a})]})},sh=u.memo(dq),fq=Ve(ni,kc,(e,t)=>{var o;return{imageDTO:t.selection[t.selection.length-1],progressImage:(o=e.denoiseProgress)==null?void 0:o.progress_image}}),hq=e=>{const{progressImage:t,imageDTO:n}=b(fq);return t?s.jsx(Jm,{nodeProps:e,children:s.jsx(Ks,{src:t.dataURL,w:"full",h:"full",objectFit:"contain",borderRadius:"base"})}):n?s.jsx(Jm,{nodeProps:e,children:s.jsx(Jr,{imageDTO:n,isDragDisabled:!0,useThumbailFallback:!0})}):s.jsx(Jm,{nodeProps:e,children:s.jsx(Ut,{})})},mq=u.memo(hq),Jm=e=>{const[t,n]=u.useState(!1),o=u.useCallback(()=>{n(!0)},[]),r=u.useCallback(()=>{n(!1)},[]),{t:a}=L();return s.jsx(sh,{nodeId:e.nodeProps.id,selected:e.nodeProps.selected,width:384,children:s.jsxs(P,{onMouseEnter:o,onMouseLeave:r,className:ui,position:"relative",flexDirection:"column",children:[s.jsx(P,{layerStyle:"nodeHeader",borderTopRadius:"base",alignItems:"center",justifyContent:"center",h:8,children:s.jsx(re,{fontSize:"sm",fontWeight:"semibold",color:"base.200",children:a("nodes.currentImage")})}),s.jsxs(P,{layerStyle:"nodeBody",w:"full",h:"full",borderBottomRadius:"base",p:2,children:[e.children,t&&s.jsx(Oa.div,{initial:pq,animate:gq,exit:xq,style:vq,children:s.jsx($k,{})},"nextPrevButtons")]})]})})},pq={opacity:0},gq={opacity:1,transition:{duration:.1}},xq={opacity:0,transition:{duration:.1}},vq={position:"absolute",top:40,left:-2,right:-2,bottom:0,pointerEvents:"none"},F0=e=>{const t=e.filter(r=>!r.ui_hidden),n=t.filter(r=>!ln(r.ui_order)).sort((r,a)=>(r.ui_order??0)-(a.ui_order??0)),o=t.filter(r=>ln(r.ui_order));return n.concat(o).map(r=>r.name).filter(r=>r!=="is_intermediate")},Cq=e=>{const t=u.useMemo(()=>Ve(lt,o=>{const r=Ko(o,e);if(!r)return Gl;const a=Us(r.inputs).filter(c=>(["any","direct"].includes(c.input)||c.type.isCollectionOrScalar)&&nb(sb).includes(c.type.name));return F0(a)}),[e]);return b(t)},yq=e=>{const t=u.useMemo(()=>Ve(lt,o=>{const r=Ko(o,e);if(!r)return Gl;const a=Us(r.inputs).filter(c=>c.input==="connection"&&!c.type.isCollectionOrScalar||!nb(sb).includes(c.type.name));return F0(a)}),[e]);return b(t)},bq=e=>{const t=u.useMemo(()=>it(lt,o=>{const r=Ko(o,e);return r?F0(Us(r.outputs)):Gl}),[e]);return b(t)},V0=e=>{const t=u.useMemo(()=>Ve(lt,o=>{const r=Ko(o,e);return fo(r==null?void 0:r.outputs,a=>a.type.name==="ImageField"&&(r==null?void 0:r.type)!=="image")}),[e]);return b(t)},jq=e=>{const t=V0(e),n=cn("invocationCache").isFeatureEnabled;return u.useMemo(()=>t||n,[t,n])},Sq=(e,t,n,o)=>it(lt,r=>{if(!o)return rn.t("nodes.noFieldType");const{connectionStartFieldType:a,connectionStartParams:c,nodes:d,edges:f}=r;if(!c||!a)return rn.t("nodes.noConnectionInProgress");const{handleType:m,nodeId:h,handleId:g}=c;if(!m||!h||!g)return rn.t("nodes.noConnectionData");const x=n==="target"?o:a,C=n==="source"?o:a;if(e===h)return rn.t("nodes.cannotConnectToSelf");if(n===m)return n==="source"?rn.t("nodes.cannotConnectOutputToOutput"):rn.t("nodes.cannotConnectInputToInput");const j=n==="target"?e:h,S=n==="target"?t:g,M=n==="source"?e:h,I=n==="source"?t:g;if(f.find(D=>{D.target===j&&D.targetHandle===S&&D.source===M&&D.sourceHandle}))return rn.t("nodes.cannotDuplicateConnection");if(f.find(D=>D.target===j&&D.targetHandle===S)&&x.name!=="CollectionItemField")return rn.t("nodes.inputMayOnlyHaveOneConnection");if(!vg(C,x))return rn.t("nodes.fieldTypesMustMatch");if(!eb(m==="source"?h:e,m==="source"?e:h,d,f))return rn.t("nodes.connectionWouldCreateCycle")}),wq=(e,t,n)=>{const o=u.useMemo(()=>Ve(lt,a=>{var c,d;return n==="inputs"?((c=Kf(a,e,t))==null?void 0:c.type)??null:((d=$c(a,e,t))==null?void 0:d.type)??null}),[t,n,e]);return b(o)},kq=it(lt,e=>e.connectionStartFieldType!==null&&e.connectionStartParams!==null),u4=({nodeId:e,fieldName:t,kind:n})=>{const o=wq(e,t,n),r=u.useMemo(()=>it(lt,x=>!!x.edges.filter(C=>(n==="inputs"?C.target:C.source)===e&&(n==="inputs"?C.targetHandle:C.sourceHandle)===t).length),[t,n,e]),a=u.useMemo(()=>Sq(e,t,n==="inputs"?"target":"source",o),[e,t,n,o]),c=u.useMemo(()=>it(lt,x=>{var C,j,S;return((C=x.connectionStartParams)==null?void 0:C.nodeId)===e&&((j=x.connectionStartParams)==null?void 0:j.handleId)===t&&((S=x.connectionStartParams)==null?void 0:S.handleType)==={inputs:"target",outputs:"source"}[n]}),[t,n,e]),d=b(r),f=b(kq),m=b(c),h=b(a),g=u.useMemo(()=>!!(f&&h&&!m),[h,f,m]);return{isConnected:d,isConnectionInProgress:f,isConnectionStartField:m,connectionError:h,shouldDim:g}},Iq=(e,t)=>{const n=u.useMemo(()=>Ve(lt,r=>{var c;const a=ll(r,e);return a?((c=a.inputs[t])==null?void 0:c.value)!==void 0:!1}),[t,e]);return b(n)},Mq=e=>{const{fieldTemplate:t,handleType:n,isConnectionInProgress:o,isConnectionStartField:r,connectionError:a}=e,{name:c}=t,d=t.type,f=Aw(d),m=u.useMemo(()=>{const g=cA.some(j=>j===d.name),x=O0(d),C={backgroundColor:d.isCollection||d.isCollectionOrScalar?hr("base.900"):x,position:"absolute",width:"1rem",height:"1rem",borderWidth:d.isCollection||d.isCollectionOrScalar?4:0,borderStyle:"solid",borderColor:x,borderRadius:g?4:"100%",zIndex:1};return n==="target"?C.insetInlineStart="-1rem":C.insetInlineEnd="-1rem",o&&!r&&a&&(C.filter="opacity(0.4) grayscale(0.7)"),o&&a?r?C.cursor="grab":C.cursor="not-allowed":C.cursor="crosshair",C},[a,n,o,r,d]),h=u.useMemo(()=>o&&a?a:f,[a,f,o]);return s.jsx(Dt,{label:h,placement:n==="target"?"start":"end",openDelay:Ac,children:s.jsx(Zi,{type:n,id:c,position:n==="target"?Dl.Left:Dl.Right,style:m})})},Vp=u.memo(Mq),Aq=({nodeId:e,fieldName:t})=>{const n=O(),{t:o}=L(),r=Bw(e,t),a=u.useMemo(()=>it(Go,m=>!!m.exposedFields.find(h=>h.nodeId===e&&h.fieldName===t)),[t,e]),c=b(a),d=u.useCallback(()=>{n(uA({nodeId:e,fieldName:t,value:r}))},[n,t,e,r]),f=u.useCallback(()=>{n(ky({nodeId:e,fieldName:t}))},[n,t,e]);return c?s.jsx(ve,{variant:"ghost",tooltip:o("nodes.removeLinearView"),"aria-label":o("nodes.removeLinearView"),icon:s.jsx(HD,{}),onClick:f,pointerEvents:"auto",size:"xs"}):s.jsx(ve,{variant:"ghost",tooltip:o("nodes.addLinearView"),"aria-label":o("nodes.addLinearView"),icon:s.jsx(Hs,{}),onClick:d,pointerEvents:"auto",size:"xs"})},Pq=u.memo(Aq),Dq=({nodeId:e,fieldName:t})=>{const{t:n}=L(),o=Pw(e,t),r=j0(e,t),a=Iq(e,t),[c,d]=u.useState(!1),{isConnected:f,isConnectionInProgress:m,isConnectionStartField:h,connectionError:g,shouldDim:x}=u4({nodeId:e,fieldName:t,kind:"inputs"}),C=u.useMemo(()=>!o||!o.required?!1:!f&&o.input==="connection"||!a&&!f&&o.input!=="connection",[o,f,a]),j=u.useCallback(()=>{d(!0)},[]),S=u.useCallback(()=>{d(!1)},[]);return!o||!r?s.jsx(bd,{shouldDim:x,children:s.jsx($,{alignItems:"stretch",justifyContent:"space-between",flexDir:"column",gap:2,h:"full",w:"full",children:s.jsx(Y,{display:"flex",alignItems:"center",mb:0,px:1,gap:2,h:"full",children:n("nodes.unknownInput",{name:(r==null?void 0:r.label)??(o==null?void 0:o.title)??t})})})}):o.input==="connection"?s.jsxs(bd,{shouldDim:x,children:[s.jsx($,{isInvalid:C,isDisabled:f,px:2,children:s.jsx(Op,{nodeId:e,fieldName:t,kind:"inputs",isMissingInput:C,withTooltip:!0})}),s.jsx(Vp,{fieldTemplate:o,handleType:"target",isConnectionInProgress:m,isConnectionStartField:h,connectionError:g})]}):s.jsxs(bd,{shouldDim:x,children:[s.jsx($,{isInvalid:C,isDisabled:f,orientation:"vertical",px:2,children:s.jsxs(P,{flexDir:"column",w:"full",gap:1,onMouseEnter:j,onMouseLeave:S,children:[s.jsxs(P,{children:[s.jsx(Op,{nodeId:e,fieldName:t,kind:"inputs",isMissingInput:C,withTooltip:!0}),c&&s.jsx(Pq,{nodeId:e,fieldName:t})]}),s.jsx(k0,{nodeId:e,fieldName:t})]})}),o.input!=="direct"&&s.jsx(Vp,{fieldTemplate:o,handleType:"target",isConnectionInProgress:m,isConnectionStartField:h,connectionError:g})]})},Kv=u.memo(Dq),bd=u.memo(({shouldDim:e,children:t})=>s.jsx(P,{position:"relative",minH:8,py:.5,alignItems:"center",opacity:e?.5:1,transitionProperty:"opacity",transitionDuration:"0.1s",w:"full",h:"full",children:t}));bd.displayName="InputFieldWrapper";const Eq=(e,t)=>{const n=u.useMemo(()=>Ve(lt,r=>$c(r,e,t)),[t,e]);return b(n)},_q=({nodeId:e,fieldName:t})=>{const{t:n}=L(),o=Eq(e,t),{isConnected:r,isConnectionInProgress:a,isConnectionStartField:c,connectionError:d,shouldDim:f}=u4({nodeId:e,fieldName:t,kind:"outputs"});return o?s.jsxs(Hp,{shouldDim:f,children:[s.jsx(Dt,{label:s.jsx(Yf,{nodeId:e,fieldName:t,kind:"outputs"}),openDelay:Ac,placement:"top",shouldWrapChildren:!0,children:s.jsx($,{isDisabled:r,pe:2,children:s.jsx(Y,{mb:0,children:o==null?void 0:o.title})})}),s.jsx(Vp,{fieldTemplate:o,handleType:"source",isConnectionInProgress:a,isConnectionStartField:c,connectionError:d})]}):s.jsx(Hp,{shouldDim:f,children:s.jsx($,{alignItems:"stretch",justifyContent:"space-between",gap:2,h:"full",w:"full",children:s.jsx(Y,{display:"flex",alignItems:"center",h:"full",color:"error.300",mb:0,px:1,gap:2,children:n("nodes.unknownOutput",{name:t})})})})},Lq=u.memo(_q),Hp=u.memo(({shouldDim:e,children:t})=>s.jsx(P,{position:"relative",minH:8,py:.5,alignItems:"center",opacity:e?.5:1,transitionProperty:"opacity",transitionDuration:"0.1s",justifyContent:"flex-end",children:t}));Hp.displayName="OutputFieldWrapper";const Tq=e=>{const t=u.useMemo(()=>it(lt,o=>{var r;return((r=ll(o,e))==null?void 0:r.isIntermediate)??!1}),[e]);return b(t)},Rq=({nodeId:e})=>{const{t}=L(),n=O(),o=V0(e),r=Tq(e),a=u.useCallback(c=>{n(dA({nodeId:e,isIntermediate:!c.target.checked}))},[n,e]);return o?s.jsxs($,{className:"nopan",children:[s.jsxs(Y,{children:[t("hotkeys.saveToGallery.title")," "]}),s.jsx(bn,{onChange:a,isChecked:!r})]}):null},Bq=u.memo(Rq),Nq=e=>{const t=u.useMemo(()=>it(lt,o=>{var r;return((r=ll(o,e))==null?void 0:r.useCache)??!1}),[e]);return b(t)},zq=({nodeId:e})=>{const t=O(),n=Nq(e),o=u.useCallback(a=>{t(fA({nodeId:e,useCache:a.target.checked}))},[t,e]),{t:r}=L();return s.jsxs($,{children:[s.jsx(Y,{children:r("invocationCache.useCache")}),s.jsx(bn,{className:"nopan",onChange:o,isChecked:n})]})},Oq=u.memo(zq),Yv={w:"unset"},Fq=({nodeId:e})=>{const t=V0(e),n=cn("invocationCache").isFeatureEnabled;return s.jsx(P,{className:ui,layerStyle:"nodeFooter",w:"full",borderBottomRadius:"base",gap:4,px:2,py:0,h:8,justifyContent:"space-between",children:s.jsxs(En,{formControlProps:Yv,formLabelProps:Yv,children:[n&&s.jsx(Oq,{nodeId:e}),t&&s.jsx(Bq,{nodeId:e})]})})},Vq=u.memo(Fq),Hq=({nodeId:e,isOpen:t})=>{const n=O(),o=hA(),r=u.useCallback(()=>{n(mA({nodeId:e,isOpen:!t})),o(e)},[n,t,e,o]);return s.jsx(ve,{className:"nodrag",onClick:r,"aria-label":"Minimize",minW:8,w:8,h:8,variant:"link",icon:s.jsx(gn,{as:Ag,transform:t?"rotate(0deg)":"rotate(180deg)",transitionProperty:"common",transitionDuration:"normal"})})},H0=u.memo(Hq),$q=({nodeId:e,title:t})=>{const n=O(),o=kw(e),r=Iw(e),{t:a}=L(),[c,d]=u.useState(""),f=u.useCallback(async h=>{n(yy({nodeId:e,label:h})),d(o||t||r||a("nodes.problemSettingTitle"))},[n,e,t,r,o,a]),m=u.useCallback(h=>{d(h)},[]);return u.useEffect(()=>{d(o||t||r||a("nodes.problemSettingTitle"))},[o,r,t,a]),s.jsx(P,{overflow:"hidden",w:"full",h:"full",alignItems:"center",justifyContent:"center",cursor:"text",children:s.jsxs(sf,{as:P,value:c,onChange:m,onSubmit:f,alignItems:"center",position:"relative",w:"full",h:"full",children:[s.jsx(of,{fontSize:"sm",p:0,w:"full",noOfLines:1}),s.jsx(rf,{className:"nodrag",fontSize:"sm",sx:Gq}),s.jsx(Wq,{})]})})},d4=u.memo($q);function Wq(){const{isEditing:e,getEditButtonProps:t}=wy(),n=u.useCallback(o=>{const{onClick:r}=t();r&&r(o)},[t]);return e?null:s.jsx(Ae,{className:ui,onDoubleClick:n,position:"absolute",w:"full",h:"full",top:0,cursor:"grab"})}const Gq={p:0,fontWeight:"bold",_focusVisible:{p:0}},Uq=e=>{const t=u.useMemo(()=>it(lt,o=>{var r;return((r=Ko(o,e))==null?void 0:r.classification)??null}),[e]);return b(t)},Zq=({nodeId:e})=>{const t=Uq(e);return!t||t==="stable"?null:s.jsx(Dt,{label:s.jsx(f4,{classification:t}),placement:"top",shouldWrapChildren:!0,children:s.jsx(gn,{as:Qq(t),display:"block",boxSize:4,color:"base.400"})})},qq=u.memo(Zq),f4=u.memo(({classification:e})=>{const{t}=L();return e==="beta"?t("nodes.betaDesc"):e==="prototype"?t("nodes.prototypeDesc"):null});f4.displayName="ClassificationTooltipContent";const Qq=e=>{if(e==="beta")return PD;if(e==="prototype")return ID},h4=e=>{const t=u.useMemo(()=>it(lt,o=>Ko(o,e)),[e]);return b(t)},Xv={visibility:"hidden"},Kq=({nodeId:e})=>{const t=h4(e),{base600:n}=i4(),o=u.useMemo(()=>({borderWidth:0,borderRadius:"3px",width:"1rem",height:"1rem",backgroundColor:n,zIndex:-1}),[n]),r=u.useMemo(()=>({...o,left:"-0.5rem"}),[o]),a=u.useMemo(()=>({...o,right:"-0.5rem"}),[o]);return t?s.jsxs(s.Fragment,{children:[s.jsx(Zi,{type:"target",id:`${e}-collapsed-target`,isConnectable:!1,position:Dl.Left,style:r}),Us(t.inputs,c=>s.jsx(Zi,{type:"target",id:c.name,isConnectable:!1,position:Dl.Left,style:Xv},`${e}-${c.name}-collapsed-input-handle`)),s.jsx(Zi,{type:"source",id:`${e}-collapsed-source`,isConnectable:!1,position:Dl.Right,style:a}),Us(t.outputs,c=>s.jsx(Zi,{type:"source",id:c.name,isConnectable:!1,position:Dl.Right,style:Xv},`${e}-${c.name}-collapsed-output-handle`))]}):null},Yq=u.memo(Kq),Xq=({nodeId:e})=>{const t=ww(e);return s.jsx(Dt,{label:s.jsx(m4,{nodeId:e}),placement:"top",shouldWrapChildren:!0,children:s.jsx(gn,{as:Rc,display:"block",boxSize:4,w:8,color:t?"error.400":"base.400"})})},Jq=u.memo(Xq),m4=u.memo(({nodeId:e})=>{const t=Sw(e),n=h4(e),{t:o}=L(),r=u.useMemo(()=>t!=null&&t.label&&(n!=null&&n.title)?`${t.label} (${n.title})`:t!=null&&t.label&&!n?t.label:!(t!=null&&t.label)&&n?n.title:o("nodes.unknownNode"),[t,n,o]),a=u.useMemo(()=>!rp(t)||!n?null:t.version?n.version?Yx(t.version,n.version,"<")?s.jsxs(re,{as:"span",color:"error.500",children:[o("nodes.version")," ",t.version," (",o("nodes.updateNode"),")"]}):Yx(t.version,n.version,">")?s.jsxs(re,{as:"span",color:"error.500",children:[o("nodes.version")," ",t.version," (",o("nodes.updateApp"),")"]}):s.jsxs(re,{as:"span",children:[o("nodes.version")," ",t.version]}):s.jsxs(re,{as:"span",color:"error.500",children:[o("nodes.version")," ",t.version," (",o("nodes.unknownTemplate"),")"]}):s.jsx(re,{as:"span",color:"error.500",children:o("nodes.versionUnknown")}),[t,n,o]);return rp(t)?s.jsxs(P,{flexDir:"column",children:[s.jsx(re,{as:"span",fontWeight:"semibold",children:r}),(n==null?void 0:n.nodePack)&&s.jsxs(re,{opacity:.7,children:[o("nodes.nodePack"),": ",n.nodePack]}),s.jsx(re,{opacity:.7,fontStyle:"oblique 5deg",children:n==null?void 0:n.description}),a,(t==null?void 0:t.notes)&&s.jsx(re,{children:t.notes})]}):s.jsx(re,{fontWeight:"semibold",children:o("nodes.unknownNode")})});m4.displayName="TooltipContent";const ep=3,Jv={circle:{transitionProperty:"none",transitionDuration:"0s"},".chakra-progress__track":{stroke:"transparent"}},eQ=({nodeId:e})=>{const t=u.useMemo(()=>Ve(lt,o=>o.nodeExecutionStates[e]),[e]),n=b(t);return n?s.jsx(Dt,{label:s.jsx(p4,{nodeExecutionState:n}),placement:"top",children:s.jsx(P,{className:ui,w:5,h:"full",alignItems:"center",justifyContent:"flex-end",children:s.jsx(g4,{nodeExecutionState:n})})}):null},tQ=u.memo(eQ),p4=u.memo(({nodeExecutionState:e})=>{const{status:t,progress:n,progressImage:o}=e,{t:r}=L();return t===ur.enum.PENDING?s.jsx(re,{children:r("queue.pending")}):t===ur.enum.IN_PROGRESS?o?s.jsxs(P,{pos:"relative",pt:1.5,pb:.5,children:[s.jsx(Ks,{src:o.dataURL,w:32,h:32,borderRadius:"base",objectFit:"contain"}),n!==null&&s.jsxs(Ws,{variant:"solid",pos:"absolute",top:2.5,insetInlineEnd:1,children:[Math.round(n*100),"%"]})]}):n!==null?s.jsxs(re,{children:[r("nodes.executionStateInProgress")," (",Math.round(n*100),"%)"]}):s.jsx(re,{children:r("nodes.executionStateInProgress")}):t===ur.enum.COMPLETED?s.jsx(re,{children:r("nodes.executionStateCompleted")}):t===ur.enum.FAILED?s.jsx(re,{children:r("nodes.executionStateError")}):null});p4.displayName="TooltipLabel";const g4=u.memo(e=>{const{progress:t,status:n}=e.nodeExecutionState;return n===ur.enum.PENDING?s.jsx(gn,{as:_g,boxSize:ep,color:"base.300"}):n===ur.enum.IN_PROGRESS?t===null?s.jsx(Xx,{isIndeterminate:!0,size:"14px",color:"base.500",thickness:14,sx:Jv}):s.jsx(Xx,{value:Math.round(t*100),size:"14px",color:"base.500",thickness:14,sx:Jv}):n===ur.enum.COMPLETED?s.jsx(gn,{as:_c,boxSize:ep,color:"ok.300"}):n===ur.enum.FAILED?s.jsx(gn,{as:gf,boxSize:ep,color:"error.300"}):null});g4.displayName="StatusIcon";const nQ=({nodeId:e,isOpen:t})=>s.jsxs(P,{layerStyle:"nodeHeader",borderTopRadius:"base",borderBottomRadius:t?0:"base",alignItems:"center",justifyContent:"space-between",h:8,textAlign:"center",color:"base.200",children:[s.jsx(H0,{nodeId:e,isOpen:t}),s.jsx(qq,{nodeId:e}),s.jsx(d4,{nodeId:e}),s.jsxs(P,{alignItems:"center",children:[s.jsx(tQ,{nodeId:e}),s.jsx(Jq,{nodeId:e})]}),!t&&s.jsx(Yq,{nodeId:e})]}),sQ=u.memo(nQ),oQ=({nodeId:e,isOpen:t,label:n,type:o,selected:r})=>{const a=yq(e),c=Cq(e),d=jq(e),f=bq(e);return s.jsxs(sh,{nodeId:e,selected:r,children:[s.jsx(sQ,{nodeId:e,isOpen:t,label:n,selected:r,type:o}),t&&s.jsxs(s.Fragment,{children:[s.jsx(P,{layerStyle:"nodeBody",flexDirection:"column",w:"full",h:"full",py:2,gap:1,borderBottomRadius:d?0:"base",children:s.jsxs(P,{flexDir:"column",px:2,w:"full",h:"full",children:[s.jsxs(Nl,{gridTemplateColumns:"1fr auto",gridAutoRows:"1fr",children:[a.map((m,h)=>s.jsx(zr,{gridColumnStart:1,gridRowStart:h+1,children:s.jsx(Kv,{nodeId:e,fieldName:m})},`${e}.${m}.input-field`)),f.map((m,h)=>s.jsx(zr,{gridColumnStart:2,gridRowStart:h+1,children:s.jsx(Lq,{nodeId:e,fieldName:m})},`${e}.${m}.output-field`))]}),c.map(m=>s.jsx(Kv,{nodeId:e,fieldName:m},`${e}.${m}.input-field`))]})}),d&&s.jsx(Vq,{nodeId:e})]})]})},rQ=u.memo(oQ),aQ=e=>{const t=u.useMemo(()=>it(lt,o=>{var r;return((r=ll(o,e))==null?void 0:r.nodePack)??null}),[e]);return b(t)},lQ=({nodeId:e,isOpen:t,label:n,type:o,selected:r})=>{const{t:a}=L(),c=aQ(e);return s.jsxs(sh,{nodeId:e,selected:r,children:[s.jsxs(P,{className:ui,layerStyle:"nodeHeader",borderTopRadius:"base",borderBottomRadius:t?0:"base",alignItems:"center",h:8,fontWeight:"semibold",fontSize:"sm",children:[s.jsx(H0,{nodeId:e,isOpen:t}),s.jsx(re,{w:"full",textAlign:"center",pe:8,color:"error.300",children:n?`${n} (${o})`:o})]}),t&&s.jsx(P,{layerStyle:"nodeBody",userSelect:"auto",flexDirection:"column",w:"full",h:"full",p:4,gap:1,borderBottomRadius:"base",fontSize:"sm",children:s.jsxs(P,{gap:2,flexDir:"column",children:[s.jsxs(re,{as:"span",children:[a("nodes.unknownNodeType"),":"," ",s.jsx(re,{as:"span",fontWeight:"semibold",children:o})]}),c&&s.jsxs(re,{as:"span",children:[a("nodes.nodePack"),":"," ",s.jsx(re,{as:"span",fontWeight:"semibold",children:c})]})]})})]})},iQ=u.memo(lQ),cQ=e=>{const{data:t,selected:n}=e,{id:o,type:r,isOpen:a,label:c}=t,d=u.useMemo(()=>it(lt,m=>!!m.templates[r]),[r]);return b(d)?s.jsx(rQ,{nodeId:o,isOpen:a,label:c,type:r,selected:n}):s.jsx(iQ,{nodeId:o,isOpen:a,label:c,type:r,selected:n})},uQ=u.memo(cQ),dQ=e=>{const{id:t,data:n,selected:o}=e,{notes:r,isOpen:a}=n,c=O(),d=u.useCallback(f=>{c(pA({nodeId:t,value:f.target.value}))},[c,t]);return s.jsxs(sh,{nodeId:t,selected:o,children:[s.jsxs(P,{layerStyle:"nodeHeader",borderTopRadius:"base",borderBottomRadius:a?0:"base",alignItems:"center",justifyContent:"space-between",h:8,children:[s.jsx(H0,{nodeId:t,isOpen:a}),s.jsx(d4,{nodeId:t,title:"Notes"}),s.jsx(Ae,{minW:8})]}),a&&s.jsx(s.Fragment,{children:s.jsx(P,{layerStyle:"nodeBody",className:"nopan",cursor:"auto",flexDirection:"column",borderBottomRadius:"base",w:"full",h:"full",p:2,gap:1,children:s.jsx(P,{className:"nopan",w:"full",h:"full",flexDir:"column",children:s.jsx(Oo,{value:r,onChange:d,rows:8,resize:"none",fontSize:"sm"})})})})]})},fQ=u.memo(dQ),hQ=["Delete","Backspace"],mQ={collapsed:iq,default:uq},pQ={invocation:uQ,current_image:mq,notes:fQ},gQ={hideAttribution:!0},xQ=[25,25],x4=u.memo(()=>{const e=O(),t=b(B=>B.nodes.nodes),n=b(B=>B.nodes.edges),o=b(B=>B.nodes.viewport),r=b(B=>B.nodes.shouldSnapToGrid),a=b(B=>B.nodes.selectionMode),c=u.useRef(null),d=u.useRef(null),f=eq();lF();const[m]=pf("radii",["base"]),h=u.useMemo(()=>({borderRadius:m}),[m]),g=u.useCallback(B=>{e(gA(B))},[e]),x=u.useCallback(B=>{e(xA(B))},[e]),C=u.useCallback((B,Q)=>{e(vA(Q))},[e]),j=u.useCallback(B=>{e(Jx(B))},[e]),S=u.useCallback(()=>{d.current&&e(CA({cursorPosition:d.current,mouseOverNodeId:vd.get()}))},[e]),M=u.useCallback(B=>{e(yA(B))},[e]),I=u.useCallback(B=>{e(bA(B))},[e]),k=u.useCallback(({nodes:B,edges:Q})=>{e(jA(B?B.map(V=>V.id):[])),e(SA(Q?Q.map(V=>V.id):[]))},[e]),D=u.useCallback((B,Q)=>{e(wA(Q))},[e]),{onCloseGlobal:T}=df(),E=u.useCallback(()=>{T()},[T]),A=u.useCallback(B=>{e2.set(B),B.fitView()},[]),N=u.useCallback(B=>{var Q,V;(Q=c.current)!=null&&Q.getBoundingClientRect()&&(d.current=((V=e2.get())==null?void 0:V.screenToFlowPosition({x:B.clientX,y:B.clientY}))??null)},[]),W=u.useRef(),G=u.useCallback((B,Q,V)=>{W.current=B,e(kA(Q.id)),e(IA())},[e]),z=u.useCallback((B,Q)=>{e(Jx(Q))},[e]),X=u.useCallback((B,Q,V)=>{var H,me;!("touches"in B)&&((H=W.current)==null?void 0:H.clientX)===B.clientX&&((me=W.current)==null?void 0:me.clientY)===B.clientY&&e(MA(Q)),W.current=void 0},[e]);return Re(["Ctrl+c","Meta+c"],B=>{B.preventDefault(),e(PA())}),Re(["Ctrl+a","Meta+a"],B=>{B.preventDefault(),e(DA())}),Re(["Ctrl+v","Meta+v"],B=>{d.current&&(B.preventDefault(),e(EA({cursorPosition:d.current})))}),s.jsx(AA,{id:"workflow-editor",ref:c,defaultViewport:o,nodeTypes:pQ,edgeTypes:mQ,nodes:t,edges:n,onInit:A,onMouseMove:N,onNodesChange:g,onEdgesChange:x,onEdgesDelete:M,onEdgeUpdate:z,onEdgeUpdateStart:G,onEdgeUpdateEnd:X,onNodesDelete:I,onConnectStart:C,onConnect:j,onConnectEnd:S,onMoveEnd:D,connectionLineComponent:rq,onSelectionChange:k,isValidConnection:f,minZoom:.1,snapToGrid:r,snapGrid:xQ,connectionRadius:30,proOptions:gQ,style:h,onPaneClick:E,deleteKeyCode:hQ,selectionMode:a,children:s.jsx(k7,{})})});x4.displayName="Flow";const vQ=()=>{const e=O(),t=b(r=>r.nodes.nodeOpacity),{t:n}=L(),o=u.useCallback(r=>{e(_A(r))},[e]);return s.jsx(P,{alignItems:"center",children:s.jsx(Ne,{"aria-label":n("nodes.nodeOpacity"),value:t,defaultValue:1,min:.5,max:1,step:.01,onChange:o,orientation:"vertical",h:"calc(100% - 0.5rem)"})})},CQ=u.memo(vQ),yQ=()=>{const{t:e}=L(),{zoomIn:t,zoomOut:n,fitView:o}=Xy(),r=O(),a=b(h=>h.nodes.shouldShowMinimapPanel),c=u.useCallback(()=>{t()},[t]),d=u.useCallback(()=>{n()},[n]),f=u.useCallback(()=>{o()},[o]),m=u.useCallback(()=>{r(LA(!a))},[a,r]);return s.jsxs(Nt,{orientation:"vertical",children:[s.jsx(ve,{tooltip:e("nodes.zoomInNodes"),"aria-label":e("nodes.zoomInNodes"),onClick:c,icon:s.jsx(FD,{})}),s.jsx(ve,{tooltip:e("nodes.zoomOutNodes"),"aria-label":e("nodes.zoomOutNodes"),onClick:d,icon:s.jsx(OD,{})}),s.jsx(ve,{tooltip:e("nodes.fitViewportNodes"),"aria-label":e("nodes.fitViewportNodes"),onClick:f,icon:s.jsx(Zb,{})}),s.jsx(ve,{tooltip:e(a?"nodes.hideMinimapnodes":"nodes.showMinimapnodes"),"aria-label":e(a?"nodes.hideMinimapnodes":"nodes.showMinimapnodes"),isChecked:a,onClick:m,icon:s.jsx(VD,{})})]})},bQ=u.memo(yQ),jQ=()=>s.jsxs(P,{gap:2,position:"absolute",bottom:2,insetInlineStart:2,children:[s.jsx(bQ,{}),s.jsx(CQ,{})]}),SQ=u.memo(jQ),wQ=hg(C7),kQ={m:"0 !important",borderRadius:"base",backgroundColor:"base.500 !important",svg:{borderRadius:"inherit"}},IQ=()=>{const e=b(t=>t.nodes.shouldShowMinimapPanel);return s.jsx(P,{gap:2,position:"absolute",bottom:2,insetInlineEnd:2,children:e&&s.jsx(wQ,{pannable:!0,zoomable:!0,nodeBorderRadius:15,sx:kQ,nodeColor:"var(--invoke-colors-base-600)",maskColor:"var(--invoke-colors-blackAlpha-600)"})})},MQ=u.memo(IQ),AQ={position:"relative",width:"100%",height:"100%"},PQ={position:"absolute",width:"100%",height:"100%"},eC={opacity:0},tC={opacity:1,transition:{duration:.2}},nC={opacity:0,transition:{duration:.2}},DQ=()=>{const{data:e,isLoading:t}=mg(),{t:n}=L();return s.jsxs(P,{layerStyle:"first",position:"relative",width:"full",height:"full",borderRadius:"base",alignItems:"center",justifyContent:"center",children:[s.jsx(Ul,{children:e&&s.jsxs(Oa.div,{initial:eC,animate:tC,exit:nC,style:AQ,children:[s.jsx(x4,{}),s.jsx(JZ,{}),s.jsx($Z,{}),s.jsx(SQ,{}),s.jsx(MQ,{}),s.jsx(GZ,{})]})}),s.jsx(Ul,{children:t&&s.jsx(Oa.div,{initial:eC,animate:tC,exit:nC,style:PQ,children:s.jsx(P,{layerStyle:"first",position:"relative",width:"full",height:"full",borderRadius:"base",alignItems:"center",justifyContent:"center",pointerEvents:"none",children:s.jsx(Ut,{label:n("nodes.loadingNodes"),icon:UZ})})})})]})},EQ=u.memo(DQ),_Q=()=>b(t=>t.workflow.mode)==="edit"?s.jsx(TA,{children:s.jsx(EQ,{})}):s.jsx(Ae,{layerStyle:"first",position:"relative",w:"full",h:"full",p:2,borderRadius:"base",children:s.jsx(P,{w:"full",h:"full",children:s.jsx(Wk,{})})}),LQ=u.memo(_Q),TQ=()=>{const{t:e}=L(),t=O(),{data:n}=Pc(),o=b(f=>f.system.isConnected),[r,{isLoading:a}]=RA({fixedCacheKey:"clearInvocationCache"}),c=u.useMemo(()=>!(n!=null&&n.size)||!o,[n==null?void 0:n.size,o]);return{clearInvocationCache:u.useCallback(async()=>{if(!c)try{await r().unwrap(),t(Ze({title:e("invocationCache.clearSucceeded"),status:"success"}))}catch{t(Ze({title:e("invocationCache.clearFailed"),status:"error"}))}},[c,r,t,e]),isLoading:a,cacheStatus:n,isDisabled:c}},RQ=()=>{const{t:e}=L(),{clearInvocationCache:t,isDisabled:n,isLoading:o}=TQ();return s.jsx(qe,{isDisabled:n,isLoading:o,onClick:t,children:e("invocationCache.clear")})},BQ=u.memo(RQ),NQ=({children:e,...t})=>s.jsx(BA,{alignItems:"center",justifyContent:"center",w:"full",h:"full",layerStyle:"first",borderRadius:"base",py:2,px:3,gap:6,flexWrap:"nowrap",...t,children:e}),v4=u.memo(NQ),zQ={'&[aria-disabled="true"]':{color:"base.500"}},OQ=({label:e,value:t,isDisabled:n=!1,...o})=>s.jsxs(NA,{flexGrow:1,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap","aria-disabled":n,sx:zQ,...o,children:[s.jsx(zA,{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",children:e}),s.jsx(OA,{children:t})]}),_o=u.memo(OQ),FQ=()=>{const{t:e}=L(),t=O(),{data:n}=Pc(),o=b(f=>f.system.isConnected),[r,{isLoading:a}]=FA({fixedCacheKey:"disableInvocationCache"}),c=u.useMemo(()=>!(n!=null&&n.enabled)||!o||(n==null?void 0:n.max_size)===0,[n==null?void 0:n.enabled,n==null?void 0:n.max_size,o]);return{disableInvocationCache:u.useCallback(async()=>{if(!c)try{await r().unwrap(),t(Ze({title:e("invocationCache.disableSucceeded"),status:"success"}))}catch{t(Ze({title:e("invocationCache.disableFailed"),status:"error"}))}},[c,r,t,e]),isLoading:a,cacheStatus:n,isDisabled:c}},VQ=()=>{const{t:e}=L(),t=O(),{data:n}=Pc(),o=b(f=>f.system.isConnected),[r,{isLoading:a}]=VA({fixedCacheKey:"enableInvocationCache"}),c=u.useMemo(()=>(n==null?void 0:n.enabled)||!o||(n==null?void 0:n.max_size)===0,[n==null?void 0:n.enabled,n==null?void 0:n.max_size,o]);return{enableInvocationCache:u.useCallback(async()=>{if(!c)try{await r().unwrap(),t(Ze({title:e("invocationCache.enableSucceeded"),status:"success"}))}catch{t(Ze({title:e("invocationCache.enableFailed"),status:"error"}))}},[c,r,t,e]),isLoading:a,cacheStatus:n,isDisabled:c}},HQ=()=>{const{t:e}=L(),{data:t}=Pc(),{enableInvocationCache:n,isDisabled:o,isLoading:r}=VQ(),{disableInvocationCache:a,isDisabled:c,isLoading:d}=FQ();return t!=null&&t.enabled?s.jsx(qe,{isDisabled:c,isLoading:d,onClick:a,children:e("invocationCache.disable")}):s.jsx(qe,{isDisabled:o,isLoading:r,onClick:n,children:e("invocationCache.enable")})},$Q=u.memo(HQ),WQ=()=>{const{t:e}=L(),{data:t}=Pc(void 0);return s.jsxs(v4,{children:[s.jsx(_o,{isDisabled:!(t!=null&&t.enabled),label:e("invocationCache.cacheSize"),value:(t==null?void 0:t.size)??0}),s.jsx(_o,{isDisabled:!(t!=null&&t.enabled),label:e("invocationCache.hits"),value:(t==null?void 0:t.hits)??0}),s.jsx(_o,{isDisabled:!(t!=null&&t.enabled),label:e("invocationCache.misses"),value:(t==null?void 0:t.misses)??0}),s.jsx(_o,{isDisabled:!(t!=null&&t.enabled),label:e("invocationCache.maxCacheSize"),value:(t==null?void 0:t.max_size)??0}),s.jsxs(Nt,{w:24,orientation:"vertical",size:"sm",children:[s.jsx(BQ,{}),s.jsx($Q,{})]})]})},GQ=u.memo(WQ),sC={pending:{colorScheme:"cyan",translationKey:"queue.pending"},in_progress:{colorScheme:"yellow",translationKey:"queue.in_progress"},completed:{colorScheme:"green",translationKey:"queue.completed"},failed:{colorScheme:"red",translationKey:"queue.failed"},canceled:{colorScheme:"orange",translationKey:"queue.canceled"}},UQ=({status:e})=>{const{t}=L();return s.jsx(Ws,{colorScheme:sC[e].colorScheme,children:t(sC[e].translationKey)})},ZQ=u.memo(UQ),C4=e=>{const t=b(d=>d.system.isConnected),[n,{isLoading:o}]=Zp(),r=O(),{t:a}=L();return{cancelQueueItem:u.useCallback(async()=>{try{await n(e).unwrap(),r(Ze({title:a("queue.cancelSucceeded"),status:"success"}))}catch{r(Ze({title:a("queue.cancelFailed"),status:"error"}))}},[r,e,a,n]),isLoading:o,isDisabled:!t}},y4=(e,t)=>Number(((Date.parse(t)-Date.parse(e))/1e3).toFixed(2)),Lo={number:"3rem",statusBadge:"5.7rem",statusDot:2,time:"4rem",batchId:"5rem",fieldValues:"auto",actions:"auto"},qQ=e=>{const t=b(f=>f.system.isConnected),{isCanceled:n}=HA({batch_id:e},{selectFromResult:({data:f})=>f?{isCanceled:(f==null?void 0:f.in_progress)===0&&(f==null?void 0:f.pending)===0}:{isCanceled:!0}}),[o,{isLoading:r}]=$A({fixedCacheKey:"cancelByBatchIds"}),a=O(),{t:c}=L();return{cancelBatch:u.useCallback(async()=>{if(!n)try{await o({batch_ids:[e]}).unwrap(),a(Ze({title:c("queue.cancelBatchSucceeded"),status:"success"}))}catch{a(Ze({title:c("queue.cancelBatchFailed"),status:"error"}))}},[e,a,n,c,o]),isLoading:r,isCanceled:n,isDisabled:!t}},QQ=({queueItemDTO:e})=>{const{session_id:t,batch_id:n,item_id:o}=e,{t:r}=L(),{cancelBatch:a,isLoading:c,isCanceled:d}=qQ(n),{cancelQueueItem:f,isLoading:m}=C4(o),{data:h}=WA(o),g=u.useMemo(()=>{if(!h)return r("common.loading");if(!h.completed_at||!h.started_at)return r(`queue.${h.status}`);const x=y4(h.started_at,h.completed_at);return h.status==="completed"?`${r("queue.completedIn")} ${x}${x===1?"":"s"}`:`${x}s`},[h,r]);return s.jsxs(P,{layerStyle:"third",flexDir:"column",p:2,pt:0,borderRadius:"base",gap:2,children:[s.jsxs(P,{layerStyle:"second",p:2,gap:2,justifyContent:"space-between",alignItems:"center",borderRadius:"base",h:20,children:[s.jsx(cd,{label:r("queue.status"),data:g}),s.jsx(cd,{label:r("queue.item"),data:o}),s.jsx(cd,{label:r("queue.batch"),data:n}),s.jsx(cd,{label:r("queue.session"),data:t}),s.jsxs(Nt,{size:"xs",orientation:"vertical",children:[s.jsx(qe,{onClick:f,isLoading:m,isDisabled:h?["canceled","completed","failed"].includes(h.status):!0,"aria-label":r("queue.cancelItem"),leftIcon:s.jsx($n,{}),colorScheme:"error",children:r("queue.cancelItem")}),s.jsx(qe,{onClick:a,isLoading:c,isDisabled:d,"aria-label":r("queue.cancelBatch"),leftIcon:s.jsx($n,{}),colorScheme:"error",children:r("queue.cancelBatch")})]})]}),(h==null?void 0:h.error)&&s.jsxs(P,{layerStyle:"second",p:3,gap:1,justifyContent:"space-between",alignItems:"flex-start",borderRadius:"base",flexDir:"column",children:[s.jsx(sn,{size:"sm",color:"error.400",children:r("common.error")}),s.jsx("pre",{children:h.error})]}),s.jsx(P,{layerStyle:"second",h:512,w:"full",borderRadius:"base",alignItems:"center",justifyContent:"center",children:h?s.jsx(ta,{label:"Queue Item",data:h}):s.jsx(la,{opacity:.5})})]})},KQ=u.memo(QQ),cd=({label:e,data:t})=>s.jsxs(P,{flexDir:"column",justifyContent:"flex-start",p:1,gap:1,overflow:"hidden",h:"full",w:"full",children:[s.jsx(sn,{size:"md",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",children:e}),s.jsx(re,{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",children:t})]}),oC={bg:"base.700"},YQ={_hover:oC,"&[aria-selected='true']":oC},XQ=({index:e,item:t,context:n})=>{const{t:o}=L(),r=u.useCallback(()=>{n.toggleQueueItem(t.item_id)},[n,t.item_id]),{cancelQueueItem:a,isLoading:c}=C4(t.item_id),d=u.useCallback(x=>{x.stopPropagation(),a()},[a]),f=u.useMemo(()=>n.openQueueItems.includes(t.item_id),[n.openQueueItems,t.item_id]),m=u.useMemo(()=>!t.completed_at||!t.started_at?void 0:`${y4(t.started_at,t.completed_at)}s`,[t]),h=u.useMemo(()=>["canceled","completed","failed"].includes(t.status),[t.status]),g=u.useMemo(()=>s.jsx($n,{}),[]);return s.jsxs(P,{flexDir:"column","aria-selected":f,fontSize:"sm",borderRadius:"base",justifyContent:"center",sx:YQ,"data-testid":"queue-item",children:[s.jsxs(P,{minH:9,alignItems:"center",gap:4,p:1.5,cursor:"pointer",onClick:r,children:[s.jsx(P,{w:Lo.number,justifyContent:"flex-end",alignItems:"center",flexShrink:0,children:s.jsx(re,{variant:"subtext",children:e+1})}),s.jsx(P,{w:Lo.statusBadge,alignItems:"center",flexShrink:0,children:s.jsx(ZQ,{status:t.status})}),s.jsx(P,{w:Lo.time,alignItems:"center",flexShrink:0,children:m||"-"}),s.jsx(P,{w:Lo.batchId,flexShrink:0,children:s.jsx(re,{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",alignItems:"center",children:t.batch_id})}),s.jsx(P,{alignItems:"center",overflow:"hidden",flexGrow:1,children:t.field_values&&s.jsx(P,{gap:2,w:"full",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",children:t.field_values.filter(x=>x.node_path!=="metadata_accumulator").map(({node_path:x,field_name:C,value:j})=>s.jsxs(re,{as:"span",children:[s.jsxs(re,{as:"span",fontWeight:"semibold",children:[x,".",C]}),": ",j]},`${t.item_id}.${x}.${C}.${j}`))})}),s.jsx(P,{alignItems:"center",w:Lo.actions,pe:3,children:s.jsx(Nt,{size:"xs",variant:"ghost",children:s.jsx(ve,{onClick:d,isDisabled:h,isLoading:c,"aria-label":o("queue.cancelItem"),icon:g})})})]}),s.jsx(zC,{in:f,transition:JQ,unmountOnExit:!0,children:s.jsx(KQ,{queueItemDTO:t})})]})},JQ={enter:{duration:.1},exit:{duration:.1}},eK=u.memo(XQ),b4=xg(af((e,t)=>s.jsx(P,{...e,ref:t,flexDirection:"column",gap:.5,children:e.children})));b4.displayName="QueueListComponent";const tK=()=>{const{t:e}=L();return s.jsxs(P,{alignItems:"center",gap:4,p:1,pb:2,textTransform:"uppercase",fontWeight:"bold",fontSize:"sm",letterSpacing:1,children:[s.jsx(P,{w:Lo.number,justifyContent:"flex-end",alignItems:"center",children:s.jsx(re,{variant:"subtext",children:"#"})}),s.jsx(P,{ps:.5,w:Lo.statusBadge,alignItems:"center",children:s.jsx(re,{variant:"subtext",children:e("queue.status")})}),s.jsx(P,{ps:.5,w:Lo.time,alignItems:"center",children:s.jsx(re,{variant:"subtext",children:e("queue.time")})}),s.jsx(P,{ps:.5,w:Lo.batchId,alignItems:"center",children:s.jsx(re,{variant:"subtext",children:e("queue.batch")})}),s.jsx(P,{ps:.5,w:Lo.fieldValues,alignItems:"center",children:s.jsx(re,{variant:"subtext",children:e("queue.batchFieldValues")})})]})},nK=u.memo(tK),sK=(e,t)=>t.item_id,oK={List:b4},rK=(e,t,n)=>s.jsx(eK,{index:e,item:t,context:n}),aK=()=>{const e=b(I=>I.queue.listCursor),t=b(I=>I.queue.listPriority),n=O(),o=u.useRef(null),[r,a]=u.useState(null),[c,d]=Qg(Oc),{t:f}=L();u.useEffect(()=>{const{current:I}=o;return r&&I&&c({target:I,elements:{viewport:r}}),()=>{var k;return(k=d())==null?void 0:k.destroy()}},[r,c,d]);const{data:m,isLoading:h}=GA({cursor:e,priority:t}),g=u.useMemo(()=>m?UA.selectAll(m):[],[m]),x=u.useCallback(()=>{if(!(m!=null&&m.has_more))return;const I=g[g.length-1];I&&(n(qp(I.item_id)),n(Qp(I.priority)))},[n,m==null?void 0:m.has_more,g]),[C,j]=u.useState([]),S=u.useCallback(I=>{j(k=>k.includes(I)?k.filter(D=>D!==I):[...k,I])},[]),M=u.useMemo(()=>({openQueueItems:C,toggleQueueItem:S}),[C,S]);return h?s.jsx(Tg,{}):g.length?s.jsxs(P,{w:"full",h:"full",flexDir:"column",children:[s.jsx(nK,{}),s.jsx(P,{ref:o,w:"full",h:"full",alignItems:"center",justifyContent:"center",children:s.jsx(DT,{data:g,endReached:x,scrollerRef:a,itemContent:rK,computeItemKey:sK,components:oK,context:M})})]}):s.jsx(P,{w:"full",h:"full",alignItems:"center",justifyContent:"center",children:s.jsx(sn,{color:"base.500",children:f("queue.queueEmpty")})})},lK=u.memo(aK),iK=()=>{const{data:e}=$o(),{t}=L();return s.jsxs(v4,{"data-testid":"queue-status",children:[s.jsx(_o,{label:t("queue.in_progress"),value:(e==null?void 0:e.queue.in_progress)??0}),s.jsx(_o,{label:t("queue.pending"),value:(e==null?void 0:e.queue.pending)??0}),s.jsx(_o,{label:t("queue.completed"),value:(e==null?void 0:e.queue.completed)??0}),s.jsx(_o,{label:t("queue.failed"),value:(e==null?void 0:e.queue.failed)??0}),s.jsx(_o,{label:t("queue.canceled"),value:(e==null?void 0:e.queue.canceled)??0}),s.jsx(_o,{label:t("queue.total"),value:(e==null?void 0:e.queue.total)??0})]})},cK=u.memo(iK),uK=e=>{const{t}=L(),n=fn(),{isLoading:o,isDisabled:r}=Ec();return s.jsxs(s.Fragment,{children:[s.jsx(qe,{isDisabled:r,isLoading:o,tooltip:t("queue.clearTooltip"),leftIcon:s.jsx(Bc,{}),colorScheme:"error",onClick:n.onOpen,"data-testid":t("queue.clear"),...e,children:t("queue.clear")}),s.jsx(Vf,{disclosure:n})]})},dK=u.memo(uK),fK=({label:e,tooltip:t,icon:n,onClick:o,isDisabled:r,colorScheme:a,asIconButton:c,isLoading:d,loadingText:f,sx:m})=>c?s.jsx(ve,{"aria-label":e,tooltip:t,icon:n,onClick:o,isDisabled:r,colorScheme:a,isLoading:d,sx:m,"data-testid":e}):s.jsx(qe,{"aria-label":e,tooltip:t,leftIcon:n,onClick:o,isDisabled:r,colorScheme:a,isLoading:d,loadingText:f??e,flexGrow:1,sx:m,"data-testid":e,children:e}),$0=u.memo(fK),hK=({asIconButton:e})=>{const{t}=L(),{pauseProcessor:n,isLoading:o,isDisabled:r}=qS();return s.jsx($0,{asIconButton:e,label:t("queue.pause"),tooltip:t("queue.pauseTooltip"),isDisabled:r,isLoading:o,icon:s.jsx(Jb,{}),onClick:n,colorScheme:"gold"})},mK=u.memo(hK),pK=()=>{const e=O(),{t}=L(),n=b(f=>f.system.isConnected),[o,{isLoading:r}]=Zy({fixedCacheKey:"pruneQueue"}),{finishedCount:a}=$o(void 0,{selectFromResult:({data:f})=>f?{finishedCount:f.queue.completed+f.queue.canceled+f.queue.failed}:{finishedCount:0}}),c=u.useCallback(async()=>{if(a)try{const f=await o().unwrap();e(Ze({title:t("queue.pruneSucceeded",{item_count:f.deleted}),status:"success"})),e(qp(void 0)),e(Qp(void 0))}catch{e(Ze({title:t("queue.pruneFailed"),status:"error"}))}},[a,o,e,t]),d=u.useMemo(()=>!n||!a,[a,n]);return{pruneQueue:c,isLoading:r,finishedCount:a,isDisabled:d}},gK=({asIconButton:e})=>{const{t}=L(),{pruneQueue:n,isLoading:o,finishedCount:r,isDisabled:a}=pK();return s.jsx($0,{isDisabled:a,isLoading:o,asIconButton:e,label:t("queue.prune"),tooltip:t("queue.pruneTooltip",{item_count:r}),icon:s.jsx(_f,{}),onClick:n,colorScheme:"invokeBlue"})},xK=u.memo(gK),vK=({asIconButton:e})=>{const{t}=L(),{resumeProcessor:n,isLoading:o,isDisabled:r}=QS();return s.jsx($0,{asIconButton:e,label:t("queue.resume"),tooltip:t("queue.resumeTooltip"),isDisabled:r,isLoading:o,icon:s.jsx(ej,{}),onClick:n,colorScheme:"green"})},CK=u.memo(vK),yK=()=>{const e=cn("pauseQueue").isFeatureEnabled,t=cn("resumeQueue").isFeatureEnabled;return s.jsxs(P,{layerStyle:"first",borderRadius:"base",p:2,gap:2,children:[e||t?s.jsxs(Nt,{w:28,orientation:"vertical",size:"sm",children:[t?s.jsx(CK,{}):s.jsx(s.Fragment,{}),e?s.jsx(mK,{}):s.jsx(s.Fragment,{})]}):s.jsx(s.Fragment,{}),s.jsxs(Nt,{w:28,orientation:"vertical",size:"sm",children:[s.jsx(xK,{}),s.jsx(dK,{})]})]})},bK=u.memo(yK),jK=()=>{const e=cn("invocationCache").isFeatureEnabled;return s.jsxs(P,{borderRadius:"base",w:"full",h:"full",flexDir:"column",gap:2,children:[s.jsxs(P,{gap:2,w:"full",children:[s.jsx(bK,{}),s.jsx(cK,{}),e&&s.jsx(GQ,{})]}),s.jsx(Ae,{layerStyle:"first",p:2,borderRadius:"base",w:"full",h:"full",children:s.jsx(lK,{})})]})},SK=u.memo(jK),wK=()=>s.jsx(SK,{}),kK=u.memo(wK),IK=()=>{const e=O(),t=b(ws),n=u.useCallback(()=>{(dn.get()==="move"||t)&&!Fr.get()&&ic.set(!0)},[t]),o=u.useCallback(a=>{if(!((dn.get()==="move"||t)&&!Fr.get()))return;const d={x:a.target.x(),y:a.target.y()};e(ob(d))},[e,t]),r=u.useCallback(()=>{(dn.get()==="move"||t)&&!Fr.get()&&ic.set(!1)},[t]);return{handleDragStart:n,handleDragMove:o,handleDragEnd:r}},MK=e=>e.tagName.toLowerCase()==="input"||e.tagName.toLowerCase()==="textarea"||e.tagName.toLowerCase()==="select",rC=e=>e instanceof HTMLElement?e.tabIndex>-1||MK(e)||["dialog","alertdialog"].includes(e.getAttribute("role")??""):!1,AK=()=>{const e=O(),t=b(ys),n=b(h=>h.canvas.shouldShowBoundingBox),o=b(ws),r=b(h=>h.canvas.isMaskEnabled),a=b(h=>h.canvas.shouldSnapToGrid),c=u.useCallback(()=>e(rb()),[e]);Re(["shift+c"],()=>{c()},{enabled:()=>!o,preventDefault:!0},[]);const d=()=>e(yg(!r));Re(["h"],()=>{d()},{enabled:()=>!o,preventDefault:!0},[r]),Re(["n"],()=>{e(Id(!a))},{enabled:!0,preventDefault:!0},[a]),Re("esc",()=>{ZA()},{enabled:()=>!0,preventDefault:!0}),Re("shift+h",()=>{e(qA(!n))},{enabled:()=>!o,preventDefault:!0},[t,n]);const f=u.useCallback(h=>{var g;h.repeat||h.key!==" "||rC(h.target)||t!=="unifiedCanvas"||Vi.get()||dn.get()==="move"||((g=Md.get())==null||g.container().focus(),Vi.set(dn.get()),dn.set("move"),hd())},[t]),m=u.useCallback(h=>{var g;h.repeat||h.key!==" "||rC(h.target)||t!=="unifiedCanvas"||!Vi.get()||dn.get()!=="move"||((g=Md.get())==null||g.container().focus(),dn.set(Vi.get()??"move"),Vi.set(null))},[t]);u.useEffect(()=>(window.addEventListener("keydown",f),window.addEventListener("keyup",m),()=>{window.removeEventListener("keydown",f),window.removeEventListener("keyup",m)}),[f,m])},W0=e=>{const t=e.getPointerPosition(),n=e.getAbsoluteTransform().copy();if(!t||!n)return;const o=n.invert().point(t);return{x:o.x,y:o.y}},j4=()=>{const e=O(),t=u.useCallback(()=>{const o=Md.get(),r=bg.get();if(!o||!r)return;const a=o.getPointerPosition();if(!a)return;const c=QA.pixelRatio,[d,f,m,h]=r.getContext().getImageData(a.x*c,a.y*c,1,1).data;d===void 0||f===void 0||m===void 0||h===void 0||e(KA({r:d,g:f,b:m,a:h}))},[e]),n=u.useCallback(()=>{e(YA()),dn.set("brush")},[e]);return{updateColorUnderCursor:t,commitColorUnderCursor:n}},PK=e=>{const t=O(),n=b(ws),{commitColorUnderCursor:o}=j4();return u.useCallback(r=>{if(!e.current)return;e.current.container().focus();const a=dn.get();if(a==="move"||n){ic.set(!0);return}if(a==="colorPicker"){o();return}const c=W0(e.current);c&&(r.evt.preventDefault(),cc.set(!0),t(XA({points:[c.x,c.y],tool:a})))},[e,n,t,o])},DK=(e,t,n)=>{const o=O(),r=b(ws),{updateColorUnderCursor:a}=j4();return u.useCallback(()=>{if(!e.current)return;const c=W0(e.current);if(!c)return;jg.set(c),n.current=c;const d=dn.get();if(d==="colorPicker"){a();return}!cc.get()||d==="move"||r||(t.current=!0,o(ab([c.x,c.y])))},[t,o,r,n,e,a])},EK=()=>u.useCallback(()=>{JA()},[]),_K=(e,t)=>{const n=O(),o=yt(cc),r=b(ws);return u.useCallback(()=>{if(dn.get()==="move"||r){ic.set(!1);return}if(!t.current&&o&&e.current){const a=W0(e.current);if(!a)return;n(ab([a.x,a.y]))}else t.current=!1;cc.set(!1)},[t,n,o,r,e])},LK=e=>{const t=O(),n=b(c=>c.canvas.stageScale),o=yt(e9),r=b(c=>c.canvas.brushSize),a=b(c=>c.canvas.shouldInvertBrushSizeScrollDirection);return u.useCallback(c=>{if(!e.current||o)return;c.evt.preventDefault();let d=c.evt.deltaY;if(a&&(d=-d),t9.get()||n9.get()){const f=Math.sign(d)*.7363*Math.pow(1.0394,r),m=fr(f,-20,20),h=fr(r+m,1,500);t(qi(h))}else{const f=e.current.getPointerPosition();let m=c.evt.deltaY;if(!f)return;const h={x:(f.x-e.current.x())/n,y:(f.y-e.current.y())/n};c.evt.ctrlKey&&(m=-m);const g=fr(n*r9**m,o9,s9),x={x:f.x-h.x*g,y:f.y-h.y*g};t(a9(g)),t(ob(x))}},[e,o,r,t,n,a])};var $p={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;var n=t2;Object.defineProperty(t,"Konva",{enumerable:!0,get:function(){return n.Konva}});const o=t2;e.exports=o.Konva})($p,$p.exports);var TK=$p.exports;const bc=Xd(TK);var S4={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RK=function(t){var n={},o=u,r=md,a=Object.assign;function c(l){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+l,p=1;p<arguments.length;p++)i+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+l+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,f=Symbol.for("react.element"),m=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),g=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),j=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),T=Symbol.for("react.offscreen"),E=Symbol.iterator;function A(l){return l===null||typeof l!="object"?null:(l=E&&l[E]||l["@@iterator"],typeof l=="function"?l:null)}function N(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case h:return"Fragment";case m:return"Portal";case x:return"Profiler";case g:return"StrictMode";case M:return"Suspense";case I:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case j:return(l.displayName||"Context")+".Consumer";case C:return(l._context.displayName||"Context")+".Provider";case S:var i=l.render;return l=l.displayName,l||(l=i.displayName||i.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case k:return i=l.displayName||null,i!==null?i:N(l.type)||"Memo";case D:i=l._payload,l=l._init;try{return N(l(i))}catch{}}return null}function W(l){var i=l.type;switch(l.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=i.render,l=l.displayName||l.name||"",i.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return N(i);case 8:return i===g?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function G(l){var i=l,p=l;if(l.alternate)for(;i.return;)i=i.return;else{l=i;do i=l,i.flags&4098&&(p=i.return),l=i.return;while(l)}return i.tag===3?p:null}function z(l){if(G(l)!==l)throw Error(c(188))}function X(l){var i=l.alternate;if(!i){if(i=G(l),i===null)throw Error(c(188));return i!==l?null:l}for(var p=l,v=i;;){var y=p.return;if(y===null)break;var w=y.alternate;if(w===null){if(v=y.return,v!==null){p=v;continue}break}if(y.child===w.child){for(w=y.child;w;){if(w===p)return z(y),l;if(w===v)return z(y),i;w=w.sibling}throw Error(c(188))}if(p.return!==v.return)p=y,v=w;else{for(var _=!1,U=y.child;U;){if(U===p){_=!0,p=y,v=w;break}if(U===v){_=!0,v=y,p=w;break}U=U.sibling}if(!_){for(U=w.child;U;){if(U===p){_=!0,p=w,v=y;break}if(U===v){_=!0,v=w,p=y;break}U=U.sibling}if(!_)throw Error(c(189))}}if(p.alternate!==v)throw Error(c(190))}if(p.tag!==3)throw Error(c(188));return p.stateNode.current===p?l:i}function B(l){return l=X(l),l!==null?Q(l):null}function Q(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var i=Q(l);if(i!==null)return i;l=l.sibling}return null}function V(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){if(l.tag!==4){var i=V(l);if(i!==null)return i}l=l.sibling}return null}var H=Array.isArray,me=t.getPublicInstance,Ie=t.getRootHostContext,ye=t.getChildHostContext,de=t.prepareForCommit,He=t.resetAfterCommit,Be=t.createInstance,ce=t.appendInitialChild,ue=t.finalizeInitialChildren,je=t.prepareUpdate,be=t.shouldSetTextContent,ee=t.createTextInstance,J=t.scheduleTimeout,F=t.cancelTimeout,oe=t.noTimeout,le=t.isPrimaryRenderer,fe=t.supportsMutation,he=t.supportsPersistence,ke=t.supportsHydration,ze=t.getInstanceFromNode,$e=t.preparePortalMount,Je=t.getCurrentEventPriority,gt=t.detachDeletedInstance,R=t.supportsMicrotasks,Z=t.scheduleMicrotask,ne=t.supportsTestSelectors,ge=t.findFiberRoot,xe=t.getBoundingRect,pe=t.getTextContent,te=t.isHiddenSubtree,Ce=t.matchAccessibilityRole,Ue=t.setFocusIfFocusable,tt=t.setupIntersectionObserver,wt=t.appendChild,Zt=t.appendChildToContainer,Ft=t.commitTextUpdate,on=t.commitMount,is=t.commitUpdate,xn=t.insertBefore,Yn=t.insertInContainerBefore,Bn=t.removeChild,Ps=t.removeChildFromContainer,cs=t.resetTextContent,us=t.hideInstance,eo=t.hideTextInstance,br=t.unhideInstance,Kc=t.unhideTextInstance,Yc=t.clearContainer,T4=t.cloneInstance,Z0=t.createContainerChildSet,q0=t.appendChildToContainerChildSet,R4=t.finalizeContainerChildren,rh=t.replaceContainerChildren,Q0=t.cloneHiddenInstance,K0=t.cloneHiddenTextInstance,B4=t.canHydrateInstance,N4=t.canHydrateTextInstance,z4=t.canHydrateSuspenseInstance,Y0=t.isSuspenseInstancePending,ah=t.isSuspenseInstanceFallback,O4=t.getSuspenseInstanceFallbackErrorDetails,F4=t.registerSuspenseInstanceRetry,Xc=t.getNextHydratableSibling,V4=t.getFirstHydratableChild,H4=t.getFirstHydratableChildWithinContainer,$4=t.getFirstHydratableChildWithinSuspenseInstance,W4=t.hydrateInstance,G4=t.hydrateTextInstance,U4=t.hydrateSuspenseInstance,Z4=t.getNextHydratableInstanceAfterSuspenseInstance,q4=t.commitHydratedContainer,Q4=t.commitHydratedSuspenseInstance,K4=t.clearSuspenseBoundary,Y4=t.clearSuspenseBoundaryFromContainer,X4=t.shouldDeleteUnhydratedTailInstances,J4=t.didNotMatchHydratedContainerTextInstance,e6=t.didNotMatchHydratedTextInstance,lh;function bi(l){if(lh===void 0)try{throw Error()}catch(p){var i=p.stack.trim().match(/\n( *(at )?)/);lh=i&&i[1]||""}return`
`+lh+l}var ih=!1;function ch(l,i){if(!l||ih)return"";ih=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(Me){var v=Me}Reflect.construct(l,[],i)}else{try{i.call()}catch(Me){v=Me}l.call(i.prototype)}else{try{throw Error()}catch(Me){v=Me}l()}}catch(Me){if(Me&&v&&typeof Me.stack=="string"){for(var y=Me.stack.split(`
`),w=v.stack.split(`
`),_=y.length-1,U=w.length-1;1<=_&&0<=U&&y[_]!==w[U];)U--;for(;1<=_&&0<=U;_--,U--)if(y[_]!==w[U]){if(_!==1||U!==1)do if(_--,U--,0>U||y[_]!==w[U]){var ae=`
`+y[_].replace(" at new "," at ");return l.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",l.displayName)),ae}while(1<=_&&0<=U);break}}}finally{ih=!1,Error.prepareStackTrace=p}return(l=l?l.displayName||l.name:"")?bi(l):""}var t6=Object.prototype.hasOwnProperty,uh=[],ul=-1;function jr(l){return{current:l}}function Wt(l){0>ul||(l.current=uh[ul],uh[ul]=null,ul--)}function Vt(l,i){ul++,uh[ul]=l.current,l.current=i}var Sr={},Nn=jr(Sr),Xn=jr(!1),ma=Sr;function dl(l,i){var p=l.type.contextTypes;if(!p)return Sr;var v=l.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===i)return v.__reactInternalMemoizedMaskedChildContext;var y={},w;for(w in p)y[w]=i[w];return v&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=i,l.__reactInternalMemoizedMaskedChildContext=y),y}function Jn(l){return l=l.childContextTypes,l!=null}function Jc(){Wt(Xn),Wt(Nn)}function X0(l,i,p){if(Nn.current!==Sr)throw Error(c(168));Vt(Nn,i),Vt(Xn,p)}function J0(l,i,p){var v=l.stateNode;if(i=i.childContextTypes,typeof v.getChildContext!="function")return p;v=v.getChildContext();for(var y in v)if(!(y in i))throw Error(c(108,W(l)||"Unknown",y));return a({},p,v)}function eu(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||Sr,ma=Nn.current,Vt(Nn,l),Vt(Xn,Xn.current),!0}function e1(l,i,p){var v=l.stateNode;if(!v)throw Error(c(169));p?(l=J0(l,i,ma),v.__reactInternalMemoizedMergedChildContext=l,Wt(Xn),Wt(Nn),Vt(Nn,l)):Wt(Xn),Vt(Xn,p)}var to=Math.clz32?Math.clz32:o6,n6=Math.log,s6=Math.LN2;function o6(l){return l>>>=0,l===0?32:31-(n6(l)/s6|0)|0}var tu=64,nu=4194304;function ji(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function su(l,i){var p=l.pendingLanes;if(p===0)return 0;var v=0,y=l.suspendedLanes,w=l.pingedLanes,_=p&268435455;if(_!==0){var U=_&~y;U!==0?v=ji(U):(w&=_,w!==0&&(v=ji(w)))}else _=p&~y,_!==0?v=ji(_):w!==0&&(v=ji(w));if(v===0)return 0;if(i!==0&&i!==v&&!(i&y)&&(y=v&-v,w=i&-i,y>=w||y===16&&(w&4194240)!==0))return i;if(v&4&&(v|=p&16),i=l.entangledLanes,i!==0)for(l=l.entanglements,i&=v;0<i;)p=31-to(i),y=1<<p,v|=l[p],i&=~y;return v}function r6(l,i){switch(l){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function a6(l,i){for(var p=l.suspendedLanes,v=l.pingedLanes,y=l.expirationTimes,w=l.pendingLanes;0<w;){var _=31-to(w),U=1<<_,ae=y[_];ae===-1?(!(U&p)||U&v)&&(y[_]=r6(U,i)):ae<=i&&(l.expiredLanes|=U),w&=~U}}function dh(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function t1(){var l=tu;return tu<<=1,!(tu&4194240)&&(tu=64),l}function fh(l){for(var i=[],p=0;31>p;p++)i.push(l);return i}function Si(l,i,p){l.pendingLanes|=i,i!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,i=31-to(i),l[i]=p}function l6(l,i){var p=l.pendingLanes&~i;l.pendingLanes=i,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=i,l.mutableReadLanes&=i,l.entangledLanes&=i,i=l.entanglements;var v=l.eventTimes;for(l=l.expirationTimes;0<p;){var y=31-to(p),w=1<<y;i[y]=0,v[y]=-1,l[y]=-1,p&=~w}}function hh(l,i){var p=l.entangledLanes|=i;for(l=l.entanglements;p;){var v=31-to(p),y=1<<v;y&i|l[v]&i&&(l[v]|=i),p&=~y}}var kt=0;function n1(l){return l&=-l,1<l?4<l?l&268435455?16:536870912:4:1}var mh=r.unstable_scheduleCallback,s1=r.unstable_cancelCallback,i6=r.unstable_shouldYield,c6=r.unstable_requestPaint,wn=r.unstable_now,ph=r.unstable_ImmediatePriority,u6=r.unstable_UserBlockingPriority,gh=r.unstable_NormalPriority,d6=r.unstable_IdlePriority,ou=null,Co=null;function f6(l){if(Co&&typeof Co.onCommitFiberRoot=="function")try{Co.onCommitFiberRoot(ou,l,void 0,(l.current.flags&128)===128)}catch{}}function h6(l,i){return l===i&&(l!==0||1/l===1/i)||l!==l&&i!==i}var no=typeof Object.is=="function"?Object.is:h6,Yo=null,ru=!1,xh=!1;function o1(l){Yo===null?Yo=[l]:Yo.push(l)}function m6(l){ru=!0,o1(l)}function yo(){if(!xh&&Yo!==null){xh=!0;var l=0,i=kt;try{var p=Yo;for(kt=1;l<p.length;l++){var v=p[l];do v=v(!0);while(v!==null)}Yo=null,ru=!1}catch(y){throw Yo!==null&&(Yo=Yo.slice(l+1)),mh(ph,yo),y}finally{kt=i,xh=!1}}return null}var fl=[],hl=0,au=null,lu=0,Ds=[],Es=0,pa=null,Xo=1,Jo="";function ga(l,i){fl[hl++]=lu,fl[hl++]=au,au=l,lu=i}function r1(l,i,p){Ds[Es++]=Xo,Ds[Es++]=Jo,Ds[Es++]=pa,pa=l;var v=Xo;l=Jo;var y=32-to(v)-1;v&=~(1<<y),p+=1;var w=32-to(i)+y;if(30<w){var _=y-y%5;w=(v&(1<<_)-1).toString(32),v>>=_,y-=_,Xo=1<<32-to(i)+y|p<<y|v,Jo=w+l}else Xo=1<<w|p<<y|v,Jo=l}function vh(l){l.return!==null&&(ga(l,1),r1(l,1,0))}function Ch(l){for(;l===au;)au=fl[--hl],fl[hl]=null,lu=fl[--hl],fl[hl]=null;for(;l===pa;)pa=Ds[--Es],Ds[Es]=null,Jo=Ds[--Es],Ds[Es]=null,Xo=Ds[--Es],Ds[Es]=null}var ds=null,_s=null,qt=!1,wi=!1,so=null;function a1(l,i){var p=Ns(5,null,null,0);p.elementType="DELETED",p.stateNode=i,p.return=l,i=l.deletions,i===null?(l.deletions=[p],l.flags|=16):i.push(p)}function l1(l,i){switch(l.tag){case 5:return i=B4(i,l.type,l.pendingProps),i!==null?(l.stateNode=i,ds=l,_s=V4(i),!0):!1;case 6:return i=N4(i,l.pendingProps),i!==null?(l.stateNode=i,ds=l,_s=null,!0):!1;case 13:if(i=z4(i),i!==null){var p=pa!==null?{id:Xo,overflow:Jo}:null;return l.memoizedState={dehydrated:i,treeContext:p,retryLane:1073741824},p=Ns(18,null,null,0),p.stateNode=i,p.return=l,l.child=p,ds=l,_s=null,!0}return!1;default:return!1}}function yh(l){return(l.mode&1)!==0&&(l.flags&128)===0}function bh(l){if(qt){var i=_s;if(i){var p=i;if(!l1(l,i)){if(yh(l))throw Error(c(418));i=Xc(p);var v=ds;i&&l1(l,i)?a1(v,p):(l.flags=l.flags&-4097|2,qt=!1,ds=l)}}else{if(yh(l))throw Error(c(418));l.flags=l.flags&-4097|2,qt=!1,ds=l}}}function i1(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;ds=l}function iu(l){if(!ke||l!==ds)return!1;if(!qt)return i1(l),qt=!0,!1;if(l.tag!==3&&(l.tag!==5||X4(l.type)&&!be(l.type,l.memoizedProps))){var i=_s;if(i){if(yh(l))throw c1(),Error(c(418));for(;i;)a1(l,i),i=Xc(i)}}if(i1(l),l.tag===13){if(!ke)throw Error(c(316));if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(c(317));_s=Z4(l)}else _s=ds?Xc(l.stateNode):null;return!0}function c1(){for(var l=_s;l;)l=Xc(l)}function ml(){ke&&(_s=ds=null,wi=qt=!1)}function jh(l){so===null?so=[l]:so.push(l)}var p6=d.ReactCurrentBatchConfig;function cu(l,i){if(no(l,i))return!0;if(typeof l!="object"||l===null||typeof i!="object"||i===null)return!1;var p=Object.keys(l),v=Object.keys(i);if(p.length!==v.length)return!1;for(v=0;v<p.length;v++){var y=p[v];if(!t6.call(i,y)||!no(l[y],i[y]))return!1}return!0}function g6(l){switch(l.tag){case 5:return bi(l.type);case 16:return bi("Lazy");case 13:return bi("Suspense");case 19:return bi("SuspenseList");case 0:case 2:case 15:return l=ch(l.type,!1),l;case 11:return l=ch(l.type.render,!1),l;case 1:return l=ch(l.type,!0),l;default:return""}}function oo(l,i){if(l&&l.defaultProps){i=a({},i),l=l.defaultProps;for(var p in l)i[p]===void 0&&(i[p]=l[p]);return i}return i}var uu=jr(null),du=null,pl=null,Sh=null;function wh(){Sh=pl=du=null}function u1(l,i,p){le?(Vt(uu,i._currentValue),i._currentValue=p):(Vt(uu,i._currentValue2),i._currentValue2=p)}function kh(l){var i=uu.current;Wt(uu),le?l._currentValue=i:l._currentValue2=i}function Ih(l,i,p){for(;l!==null;){var v=l.alternate;if((l.childLanes&i)!==i?(l.childLanes|=i,v!==null&&(v.childLanes|=i)):v!==null&&(v.childLanes&i)!==i&&(v.childLanes|=i),l===p)break;l=l.return}}function gl(l,i){du=l,Sh=pl=null,l=l.dependencies,l!==null&&l.firstContext!==null&&(l.lanes&i&&(es=!0),l.firstContext=null)}function Ls(l){var i=le?l._currentValue:l._currentValue2;if(Sh!==l)if(l={context:l,memoizedValue:i,next:null},pl===null){if(du===null)throw Error(c(308));pl=l,du.dependencies={lanes:0,firstContext:l}}else pl=pl.next=l;return i}var xa=null;function Mh(l){xa===null?xa=[l]:xa.push(l)}function d1(l,i,p,v){var y=i.interleaved;return y===null?(p.next=p,Mh(i)):(p.next=y.next,y.next=p),i.interleaved=p,bo(l,v)}function bo(l,i){l.lanes|=i;var p=l.alternate;for(p!==null&&(p.lanes|=i),p=l,l=l.return;l!==null;)l.childLanes|=i,p=l.alternate,p!==null&&(p.childLanes|=i),p=l,l=l.return;return p.tag===3?p.stateNode:null}var wr=!1;function Ah(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function f1(l,i){l=l.updateQueue,i.updateQueue===l&&(i.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function er(l,i){return{eventTime:l,lane:i,tag:0,payload:null,callback:null,next:null}}function kr(l,i,p){var v=l.updateQueue;if(v===null)return null;if(v=v.shared,ft&2){var y=v.pending;return y===null?i.next=i:(i.next=y.next,y.next=i),v.pending=i,bo(l,p)}return y=v.interleaved,y===null?(i.next=i,Mh(v)):(i.next=y.next,y.next=i),v.interleaved=i,bo(l,p)}function fu(l,i,p){if(i=i.updateQueue,i!==null&&(i=i.shared,(p&4194240)!==0)){var v=i.lanes;v&=l.pendingLanes,p|=v,i.lanes=p,hh(l,p)}}function h1(l,i){var p=l.updateQueue,v=l.alternate;if(v!==null&&(v=v.updateQueue,p===v)){var y=null,w=null;if(p=p.firstBaseUpdate,p!==null){do{var _={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};w===null?y=w=_:w=w.next=_,p=p.next}while(p!==null);w===null?y=w=i:w=w.next=i}else y=w=i;p={baseState:v.baseState,firstBaseUpdate:y,lastBaseUpdate:w,shared:v.shared,effects:v.effects},l.updateQueue=p;return}l=p.lastBaseUpdate,l===null?p.firstBaseUpdate=i:l.next=i,p.lastBaseUpdate=i}function hu(l,i,p,v){var y=l.updateQueue;wr=!1;var w=y.firstBaseUpdate,_=y.lastBaseUpdate,U=y.shared.pending;if(U!==null){y.shared.pending=null;var ae=U,Me=ae.next;ae.next=null,_===null?w=Me:_.next=Me,_=ae;var We=l.alternate;We!==null&&(We=We.updateQueue,U=We.lastBaseUpdate,U!==_&&(U===null?We.firstBaseUpdate=Me:U.next=Me,We.lastBaseUpdate=ae))}if(w!==null){var rt=y.baseState;_=0,We=Me=ae=null,U=w;do{var _e=U.lane,Gt=U.eventTime;if((v&_e)===_e){We!==null&&(We=We.next={eventTime:Gt,lane:0,tag:U.tag,payload:U.payload,callback:U.callback,next:null});e:{var Tt=l,ss=U;switch(_e=i,Gt=p,ss.tag){case 1:if(Tt=ss.payload,typeof Tt=="function"){rt=Tt.call(Gt,rt,_e);break e}rt=Tt;break e;case 3:Tt.flags=Tt.flags&-65537|128;case 0:if(Tt=ss.payload,_e=typeof Tt=="function"?Tt.call(Gt,rt,_e):Tt,_e==null)break e;rt=a({},rt,_e);break e;case 2:wr=!0}}U.callback!==null&&U.lane!==0&&(l.flags|=64,_e=y.effects,_e===null?y.effects=[U]:_e.push(U))}else Gt={eventTime:Gt,lane:_e,tag:U.tag,payload:U.payload,callback:U.callback,next:null},We===null?(Me=We=Gt,ae=rt):We=We.next=Gt,_|=_e;if(U=U.next,U===null){if(U=y.shared.pending,U===null)break;_e=U,U=_e.next,_e.next=null,y.lastBaseUpdate=_e,y.shared.pending=null}}while(!0);if(We===null&&(ae=rt),y.baseState=ae,y.firstBaseUpdate=Me,y.lastBaseUpdate=We,i=y.shared.interleaved,i!==null){y=i;do _|=y.lane,y=y.next;while(y!==i)}else w===null&&(y.shared.lanes=0);Ca|=_,l.lanes=_,l.memoizedState=rt}}function m1(l,i,p){if(l=i.effects,i.effects=null,l!==null)for(i=0;i<l.length;i++){var v=l[i],y=v.callback;if(y!==null){if(v.callback=null,v=p,typeof y!="function")throw Error(c(191,y));y.call(v)}}}var p1=new o.Component().refs;function Ph(l,i,p,v){i=l.memoizedState,p=p(v,i),p=p==null?i:a({},i,p),l.memoizedState=p,l.lanes===0&&(l.updateQueue.baseState=p)}var mu={isMounted:function(l){return(l=l._reactInternals)?G(l)===l:!1},enqueueSetState:function(l,i,p){l=l._reactInternals;var v=Vn(),y=Ar(l),w=er(v,y);w.payload=i,p!=null&&(w.callback=p),i=kr(l,w,y),i!==null&&(Bs(i,l,y,v),fu(i,l,y))},enqueueReplaceState:function(l,i,p){l=l._reactInternals;var v=Vn(),y=Ar(l),w=er(v,y);w.tag=1,w.payload=i,p!=null&&(w.callback=p),i=kr(l,w,y),i!==null&&(Bs(i,l,y,v),fu(i,l,y))},enqueueForceUpdate:function(l,i){l=l._reactInternals;var p=Vn(),v=Ar(l),y=er(p,v);y.tag=2,i!=null&&(y.callback=i),i=kr(l,y,v),i!==null&&(Bs(i,l,v,p),fu(i,l,v))}};function g1(l,i,p,v,y,w,_){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(v,w,_):i.prototype&&i.prototype.isPureReactComponent?!cu(p,v)||!cu(y,w):!0}function x1(l,i,p){var v=!1,y=Sr,w=i.contextType;return typeof w=="object"&&w!==null?w=Ls(w):(y=Jn(i)?ma:Nn.current,v=i.contextTypes,w=(v=v!=null)?dl(l,y):Sr),i=new i(p,w),l.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=mu,l.stateNode=i,i._reactInternals=l,v&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=y,l.__reactInternalMemoizedMaskedChildContext=w),i}function v1(l,i,p,v){l=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(p,v),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(p,v),i.state!==l&&mu.enqueueReplaceState(i,i.state,null)}function Dh(l,i,p,v){var y=l.stateNode;y.props=p,y.state=l.memoizedState,y.refs=p1,Ah(l);var w=i.contextType;typeof w=="object"&&w!==null?y.context=Ls(w):(w=Jn(i)?ma:Nn.current,y.context=dl(l,w)),y.state=l.memoizedState,w=i.getDerivedStateFromProps,typeof w=="function"&&(Ph(l,i,w,p),y.state=l.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(i=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),i!==y.state&&mu.enqueueReplaceState(y,y.state,null),hu(l,p,y,v),y.state=l.memoizedState),typeof y.componentDidMount=="function"&&(l.flags|=4194308)}function ki(l,i,p){if(l=p.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(c(309));var v=p.stateNode}if(!v)throw Error(c(147,l));var y=v,w=""+l;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===w?i.ref:(i=function(_){var U=y.refs;U===p1&&(U=y.refs={}),_===null?delete U[w]:U[w]=_},i._stringRef=w,i)}if(typeof l!="string")throw Error(c(284));if(!p._owner)throw Error(c(290,l))}return l}function pu(l,i){throw l=Object.prototype.toString.call(i),Error(c(31,l==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":l))}function C1(l){var i=l._init;return i(l._payload)}function y1(l){function i(se,K){if(l){var ie=se.deletions;ie===null?(se.deletions=[K],se.flags|=16):ie.push(K)}}function p(se,K){if(!l)return null;for(;K!==null;)i(se,K),K=K.sibling;return null}function v(se,K){for(se=new Map;K!==null;)K.key!==null?se.set(K.key,K):se.set(K.index,K),K=K.sibling;return se}function y(se,K){return se=Dr(se,K),se.index=0,se.sibling=null,se}function w(se,K,ie){return se.index=ie,l?(ie=se.alternate,ie!==null?(ie=ie.index,ie<K?(se.flags|=2,K):ie):(se.flags|=2,K)):(se.flags|=1048576,K)}function _(se){return l&&se.alternate===null&&(se.flags|=2),se}function U(se,K,ie,Le){return K===null||K.tag!==6?(K=xm(ie,se.mode,Le),K.return=se,K):(K=y(K,ie),K.return=se,K)}function ae(se,K,ie,Le){var Xe=ie.type;return Xe===h?We(se,K,ie.props.children,Le,ie.key):K!==null&&(K.elementType===Xe||typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===D&&C1(Xe)===K.type)?(Le=y(K,ie.props),Le.ref=ki(se,K,ie),Le.return=se,Le):(Le=Vu(ie.type,ie.key,ie.props,null,se.mode,Le),Le.ref=ki(se,K,ie),Le.return=se,Le)}function Me(se,K,ie,Le){return K===null||K.tag!==4||K.stateNode.containerInfo!==ie.containerInfo||K.stateNode.implementation!==ie.implementation?(K=vm(ie,se.mode,Le),K.return=se,K):(K=y(K,ie.children||[]),K.return=se,K)}function We(se,K,ie,Le,Xe){return K===null||K.tag!==7?(K=Sa(ie,se.mode,Le,Xe),K.return=se,K):(K=y(K,ie),K.return=se,K)}function rt(se,K,ie){if(typeof K=="string"&&K!==""||typeof K=="number")return K=xm(""+K,se.mode,ie),K.return=se,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case f:return ie=Vu(K.type,K.key,K.props,null,se.mode,ie),ie.ref=ki(se,null,K),ie.return=se,ie;case m:return K=vm(K,se.mode,ie),K.return=se,K;case D:var Le=K._init;return rt(se,Le(K._payload),ie)}if(H(K)||A(K))return K=Sa(K,se.mode,ie,null),K.return=se,K;pu(se,K)}return null}function _e(se,K,ie,Le){var Xe=K!==null?K.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number")return Xe!==null?null:U(se,K,""+ie,Le);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case f:return ie.key===Xe?ae(se,K,ie,Le):null;case m:return ie.key===Xe?Me(se,K,ie,Le):null;case D:return Xe=ie._init,_e(se,K,Xe(ie._payload),Le)}if(H(ie)||A(ie))return Xe!==null?null:We(se,K,ie,Le,null);pu(se,ie)}return null}function Gt(se,K,ie,Le,Xe){if(typeof Le=="string"&&Le!==""||typeof Le=="number")return se=se.get(ie)||null,U(K,se,""+Le,Xe);if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case f:return se=se.get(Le.key===null?ie:Le.key)||null,ae(K,se,Le,Xe);case m:return se=se.get(Le.key===null?ie:Le.key)||null,Me(K,se,Le,Xe);case D:var ct=Le._init;return Gt(se,K,ie,ct(Le._payload),Xe)}if(H(Le)||A(Le))return se=se.get(ie)||null,We(K,se,Le,Xe,null);pu(K,Le)}return null}function Tt(se,K,ie,Le){for(var Xe=null,ct=null,at=K,It=K=0,Mn=null;at!==null&&It<ie.length;It++){at.index>It?(Mn=at,at=null):Mn=at.sibling;var Mt=_e(se,at,ie[It],Le);if(Mt===null){at===null&&(at=Mn);break}l&&at&&Mt.alternate===null&&i(se,at),K=w(Mt,K,It),ct===null?Xe=Mt:ct.sibling=Mt,ct=Mt,at=Mn}if(It===ie.length)return p(se,at),qt&&ga(se,It),Xe;if(at===null){for(;It<ie.length;It++)at=rt(se,ie[It],Le),at!==null&&(K=w(at,K,It),ct===null?Xe=at:ct.sibling=at,ct=at);return qt&&ga(se,It),Xe}for(at=v(se,at);It<ie.length;It++)Mn=Gt(at,se,It,ie[It],Le),Mn!==null&&(l&&Mn.alternate!==null&&at.delete(Mn.key===null?It:Mn.key),K=w(Mn,K,It),ct===null?Xe=Mn:ct.sibling=Mn,ct=Mn);return l&&at.forEach(function(Er){return i(se,Er)}),qt&&ga(se,It),Xe}function ss(se,K,ie,Le){var Xe=A(ie);if(typeof Xe!="function")throw Error(c(150));if(ie=Xe.call(ie),ie==null)throw Error(c(151));for(var ct=Xe=null,at=K,It=K=0,Mn=null,Mt=ie.next();at!==null&&!Mt.done;It++,Mt=ie.next()){at.index>It?(Mn=at,at=null):Mn=at.sibling;var Er=_e(se,at,Mt.value,Le);if(Er===null){at===null&&(at=Mn);break}l&&at&&Er.alternate===null&&i(se,at),K=w(Er,K,It),ct===null?Xe=Er:ct.sibling=Er,ct=Er,at=Mn}if(Mt.done)return p(se,at),qt&&ga(se,It),Xe;if(at===null){for(;!Mt.done;It++,Mt=ie.next())Mt=rt(se,Mt.value,Le),Mt!==null&&(K=w(Mt,K,It),ct===null?Xe=Mt:ct.sibling=Mt,ct=Mt);return qt&&ga(se,It),Xe}for(at=v(se,at);!Mt.done;It++,Mt=ie.next())Mt=Gt(at,se,It,Mt.value,Le),Mt!==null&&(l&&Mt.alternate!==null&&at.delete(Mt.key===null?It:Mt.key),K=w(Mt,K,It),ct===null?Xe=Mt:ct.sibling=Mt,ct=Mt);return l&&at.forEach(function(U6){return i(se,U6)}),qt&&ga(se,It),Xe}function sr(se,K,ie,Le){if(typeof ie=="object"&&ie!==null&&ie.type===h&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case f:e:{for(var Xe=ie.key,ct=K;ct!==null;){if(ct.key===Xe){if(Xe=ie.type,Xe===h){if(ct.tag===7){p(se,ct.sibling),K=y(ct,ie.props.children),K.return=se,se=K;break e}}else if(ct.elementType===Xe||typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===D&&C1(Xe)===ct.type){p(se,ct.sibling),K=y(ct,ie.props),K.ref=ki(se,ct,ie),K.return=se,se=K;break e}p(se,ct);break}else i(se,ct);ct=ct.sibling}ie.type===h?(K=Sa(ie.props.children,se.mode,Le,ie.key),K.return=se,se=K):(Le=Vu(ie.type,ie.key,ie.props,null,se.mode,Le),Le.ref=ki(se,K,ie),Le.return=se,se=Le)}return _(se);case m:e:{for(ct=ie.key;K!==null;){if(K.key===ct)if(K.tag===4&&K.stateNode.containerInfo===ie.containerInfo&&K.stateNode.implementation===ie.implementation){p(se,K.sibling),K=y(K,ie.children||[]),K.return=se,se=K;break e}else{p(se,K);break}else i(se,K);K=K.sibling}K=vm(ie,se.mode,Le),K.return=se,se=K}return _(se);case D:return ct=ie._init,sr(se,K,ct(ie._payload),Le)}if(H(ie))return Tt(se,K,ie,Le);if(A(ie))return ss(se,K,ie,Le);pu(se,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"?(ie=""+ie,K!==null&&K.tag===6?(p(se,K.sibling),K=y(K,ie),K.return=se,se=K):(p(se,K),K=xm(ie,se.mode,Le),K.return=se,se=K),_(se)):p(se,K)}return sr}var xl=y1(!0),b1=y1(!1),Ii={},Ts=jr(Ii),Mi=jr(Ii),vl=jr(Ii);function jo(l){if(l===Ii)throw Error(c(174));return l}function Eh(l,i){Vt(vl,i),Vt(Mi,l),Vt(Ts,Ii),l=Ie(i),Wt(Ts),Vt(Ts,l)}function Cl(){Wt(Ts),Wt(Mi),Wt(vl)}function j1(l){var i=jo(vl.current),p=jo(Ts.current);i=ye(p,l.type,i),p!==i&&(Vt(Mi,l),Vt(Ts,i))}function _h(l){Mi.current===l&&(Wt(Ts),Wt(Mi))}var Xt=jr(0);function gu(l){for(var i=l;i!==null;){if(i.tag===13){var p=i.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||Y0(p)||ah(p)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===l)break;for(;i.sibling===null;){if(i.return===null||i.return===l)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Lh=[];function Th(){for(var l=0;l<Lh.length;l++){var i=Lh[l];le?i._workInProgressVersionPrimary=null:i._workInProgressVersionSecondary=null}Lh.length=0}var xu=d.ReactCurrentDispatcher,Rh=d.ReactCurrentBatchConfig,va=0,Jt=null,vn=null,kn=null,vu=!1,Ai=!1,Pi=0,x6=0;function zn(){throw Error(c(321))}function Bh(l,i){if(i===null)return!1;for(var p=0;p<i.length&&p<l.length;p++)if(!no(l[p],i[p]))return!1;return!0}function Nh(l,i,p,v,y,w){if(va=w,Jt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,xu.current=l===null||l.memoizedState===null?b6:j6,l=p(v,y),Ai){w=0;do{if(Ai=!1,Pi=0,25<=w)throw Error(c(301));w+=1,kn=vn=null,i.updateQueue=null,xu.current=S6,l=p(v,y)}while(Ai)}if(xu.current=bu,i=vn!==null&&vn.next!==null,va=0,kn=vn=Jt=null,vu=!1,i)throw Error(c(300));return l}function zh(){var l=Pi!==0;return Pi=0,l}function So(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kn===null?Jt.memoizedState=kn=l:kn=kn.next=l,kn}function Rs(){if(vn===null){var l=Jt.alternate;l=l!==null?l.memoizedState:null}else l=vn.next;var i=kn===null?Jt.memoizedState:kn.next;if(i!==null)kn=i,vn=l;else{if(l===null)throw Error(c(310));vn=l,l={memoizedState:vn.memoizedState,baseState:vn.baseState,baseQueue:vn.baseQueue,queue:vn.queue,next:null},kn===null?Jt.memoizedState=kn=l:kn=kn.next=l}return kn}function Di(l,i){return typeof i=="function"?i(l):i}function Oh(l){var i=Rs(),p=i.queue;if(p===null)throw Error(c(311));p.lastRenderedReducer=l;var v=vn,y=v.baseQueue,w=p.pending;if(w!==null){if(y!==null){var _=y.next;y.next=w.next,w.next=_}v.baseQueue=y=w,p.pending=null}if(y!==null){w=y.next,v=v.baseState;var U=_=null,ae=null,Me=w;do{var We=Me.lane;if((va&We)===We)ae!==null&&(ae=ae.next={lane:0,action:Me.action,hasEagerState:Me.hasEagerState,eagerState:Me.eagerState,next:null}),v=Me.hasEagerState?Me.eagerState:l(v,Me.action);else{var rt={lane:We,action:Me.action,hasEagerState:Me.hasEagerState,eagerState:Me.eagerState,next:null};ae===null?(U=ae=rt,_=v):ae=ae.next=rt,Jt.lanes|=We,Ca|=We}Me=Me.next}while(Me!==null&&Me!==w);ae===null?_=v:ae.next=U,no(v,i.memoizedState)||(es=!0),i.memoizedState=v,i.baseState=_,i.baseQueue=ae,p.lastRenderedState=v}if(l=p.interleaved,l!==null){y=l;do w=y.lane,Jt.lanes|=w,Ca|=w,y=y.next;while(y!==l)}else y===null&&(p.lanes=0);return[i.memoizedState,p.dispatch]}function Fh(l){var i=Rs(),p=i.queue;if(p===null)throw Error(c(311));p.lastRenderedReducer=l;var v=p.dispatch,y=p.pending,w=i.memoizedState;if(y!==null){p.pending=null;var _=y=y.next;do w=l(w,_.action),_=_.next;while(_!==y);no(w,i.memoizedState)||(es=!0),i.memoizedState=w,i.baseQueue===null&&(i.baseState=w),p.lastRenderedState=w}return[w,v]}function S1(){}function w1(l,i){var p=Jt,v=Rs(),y=i(),w=!no(v.memoizedState,y);if(w&&(v.memoizedState=y,es=!0),v=v.queue,Vh(M1.bind(null,p,v,l),[l]),v.getSnapshot!==i||w||kn!==null&&kn.memoizedState.tag&1){if(p.flags|=2048,Ei(9,I1.bind(null,p,v,y,i),void 0,null),In===null)throw Error(c(349));va&30||k1(p,i,y)}return y}function k1(l,i,p){l.flags|=16384,l={getSnapshot:i,value:p},i=Jt.updateQueue,i===null?(i={lastEffect:null,stores:null},Jt.updateQueue=i,i.stores=[l]):(p=i.stores,p===null?i.stores=[l]:p.push(l))}function I1(l,i,p,v){i.value=p,i.getSnapshot=v,A1(i)&&P1(l)}function M1(l,i,p){return p(function(){A1(i)&&P1(l)})}function A1(l){var i=l.getSnapshot;l=l.value;try{var p=i();return!no(l,p)}catch{return!0}}function P1(l){var i=bo(l,1);i!==null&&Bs(i,l,1,-1)}function D1(l){var i=So();return typeof l=="function"&&(l=l()),i.memoizedState=i.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Di,lastRenderedState:l},i.queue=l,l=l.dispatch=y6.bind(null,Jt,l),[i.memoizedState,l]}function Ei(l,i,p,v){return l={tag:l,create:i,destroy:p,deps:v,next:null},i=Jt.updateQueue,i===null?(i={lastEffect:null,stores:null},Jt.updateQueue=i,i.lastEffect=l.next=l):(p=i.lastEffect,p===null?i.lastEffect=l.next=l:(v=p.next,p.next=l,l.next=v,i.lastEffect=l)),l}function E1(){return Rs().memoizedState}function Cu(l,i,p,v){var y=So();Jt.flags|=l,y.memoizedState=Ei(1|i,p,void 0,v===void 0?null:v)}function yu(l,i,p,v){var y=Rs();v=v===void 0?null:v;var w=void 0;if(vn!==null){var _=vn.memoizedState;if(w=_.destroy,v!==null&&Bh(v,_.deps)){y.memoizedState=Ei(i,p,w,v);return}}Jt.flags|=l,y.memoizedState=Ei(1|i,p,w,v)}function _1(l,i){return Cu(8390656,8,l,i)}function Vh(l,i){return yu(2048,8,l,i)}function L1(l,i){return yu(4,2,l,i)}function T1(l,i){return yu(4,4,l,i)}function R1(l,i){if(typeof i=="function")return l=l(),i(l),function(){i(null)};if(i!=null)return l=l(),i.current=l,function(){i.current=null}}function B1(l,i,p){return p=p!=null?p.concat([l]):null,yu(4,4,R1.bind(null,i,l),p)}function Hh(){}function N1(l,i){var p=Rs();i=i===void 0?null:i;var v=p.memoizedState;return v!==null&&i!==null&&Bh(i,v[1])?v[0]:(p.memoizedState=[l,i],l)}function z1(l,i){var p=Rs();i=i===void 0?null:i;var v=p.memoizedState;return v!==null&&i!==null&&Bh(i,v[1])?v[0]:(l=l(),p.memoizedState=[l,i],l)}function O1(l,i,p){return va&21?(no(p,i)||(p=t1(),Jt.lanes|=p,Ca|=p,l.baseState=!0),i):(l.baseState&&(l.baseState=!1,es=!0),l.memoizedState=p)}function v6(l,i){var p=kt;kt=p!==0&&4>p?p:4,l(!0);var v=Rh.transition;Rh.transition={};try{l(!1),i()}finally{kt=p,Rh.transition=v}}function F1(){return Rs().memoizedState}function C6(l,i,p){var v=Ar(l);if(p={lane:v,action:p,hasEagerState:!1,eagerState:null,next:null},V1(l))H1(i,p);else if(p=d1(l,i,p,v),p!==null){var y=Vn();Bs(p,l,v,y),$1(p,i,v)}}function y6(l,i,p){var v=Ar(l),y={lane:v,action:p,hasEagerState:!1,eagerState:null,next:null};if(V1(l))H1(i,y);else{var w=l.alternate;if(l.lanes===0&&(w===null||w.lanes===0)&&(w=i.lastRenderedReducer,w!==null))try{var _=i.lastRenderedState,U=w(_,p);if(y.hasEagerState=!0,y.eagerState=U,no(U,_)){var ae=i.interleaved;ae===null?(y.next=y,Mh(i)):(y.next=ae.next,ae.next=y),i.interleaved=y;return}}catch{}finally{}p=d1(l,i,y,v),p!==null&&(y=Vn(),Bs(p,l,v,y),$1(p,i,v))}}function V1(l){var i=l.alternate;return l===Jt||i!==null&&i===Jt}function H1(l,i){Ai=vu=!0;var p=l.pending;p===null?i.next=i:(i.next=p.next,p.next=i),l.pending=i}function $1(l,i,p){if(p&4194240){var v=i.lanes;v&=l.pendingLanes,p|=v,i.lanes=p,hh(l,p)}}var bu={readContext:Ls,useCallback:zn,useContext:zn,useEffect:zn,useImperativeHandle:zn,useInsertionEffect:zn,useLayoutEffect:zn,useMemo:zn,useReducer:zn,useRef:zn,useState:zn,useDebugValue:zn,useDeferredValue:zn,useTransition:zn,useMutableSource:zn,useSyncExternalStore:zn,useId:zn,unstable_isNewReconciler:!1},b6={readContext:Ls,useCallback:function(l,i){return So().memoizedState=[l,i===void 0?null:i],l},useContext:Ls,useEffect:_1,useImperativeHandle:function(l,i,p){return p=p!=null?p.concat([l]):null,Cu(4194308,4,R1.bind(null,i,l),p)},useLayoutEffect:function(l,i){return Cu(4194308,4,l,i)},useInsertionEffect:function(l,i){return Cu(4,2,l,i)},useMemo:function(l,i){var p=So();return i=i===void 0?null:i,l=l(),p.memoizedState=[l,i],l},useReducer:function(l,i,p){var v=So();return i=p!==void 0?p(i):i,v.memoizedState=v.baseState=i,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:i},v.queue=l,l=l.dispatch=C6.bind(null,Jt,l),[v.memoizedState,l]},useRef:function(l){var i=So();return l={current:l},i.memoizedState=l},useState:D1,useDebugValue:Hh,useDeferredValue:function(l){return So().memoizedState=l},useTransition:function(){var l=D1(!1),i=l[0];return l=v6.bind(null,l[1]),So().memoizedState=l,[i,l]},useMutableSource:function(){},useSyncExternalStore:function(l,i,p){var v=Jt,y=So();if(qt){if(p===void 0)throw Error(c(407));p=p()}else{if(p=i(),In===null)throw Error(c(349));va&30||k1(v,i,p)}y.memoizedState=p;var w={value:p,getSnapshot:i};return y.queue=w,_1(M1.bind(null,v,w,l),[l]),v.flags|=2048,Ei(9,I1.bind(null,v,w,p,i),void 0,null),p},useId:function(){var l=So(),i=In.identifierPrefix;if(qt){var p=Jo,v=Xo;p=(v&~(1<<32-to(v)-1)).toString(32)+p,i=":"+i+"R"+p,p=Pi++,0<p&&(i+="H"+p.toString(32)),i+=":"}else p=x6++,i=":"+i+"r"+p.toString(32)+":";return l.memoizedState=i},unstable_isNewReconciler:!1},j6={readContext:Ls,useCallback:N1,useContext:Ls,useEffect:Vh,useImperativeHandle:B1,useInsertionEffect:L1,useLayoutEffect:T1,useMemo:z1,useReducer:Oh,useRef:E1,useState:function(){return Oh(Di)},useDebugValue:Hh,useDeferredValue:function(l){var i=Rs();return O1(i,vn.memoizedState,l)},useTransition:function(){var l=Oh(Di)[0],i=Rs().memoizedState;return[l,i]},useMutableSource:S1,useSyncExternalStore:w1,useId:F1,unstable_isNewReconciler:!1},S6={readContext:Ls,useCallback:N1,useContext:Ls,useEffect:Vh,useImperativeHandle:B1,useInsertionEffect:L1,useLayoutEffect:T1,useMemo:z1,useReducer:Fh,useRef:E1,useState:function(){return Fh(Di)},useDebugValue:Hh,useDeferredValue:function(l){var i=Rs();return vn===null?i.memoizedState=l:O1(i,vn.memoizedState,l)},useTransition:function(){var l=Fh(Di)[0],i=Rs().memoizedState;return[l,i]},useMutableSource:S1,useSyncExternalStore:w1,useId:F1,unstable_isNewReconciler:!1};function yl(l,i){try{var p="",v=i;do p+=g6(v),v=v.return;while(v);var y=p}catch(w){y=`
Error generating stack: `+w.message+`
`+w.stack}return{value:l,source:i,stack:y,digest:null}}function $h(l,i,p){return{value:l,source:null,stack:p??null,digest:i??null}}function Wh(l,i){try{console.error(i.value)}catch(p){setTimeout(function(){throw p})}}var w6=typeof WeakMap=="function"?WeakMap:Map;function W1(l,i,p){p=er(-1,p),p.tag=3,p.payload={element:null};var v=i.value;return p.callback=function(){Ru||(Ru=!0,um=v),Wh(l,i)},p}function G1(l,i,p){p=er(-1,p),p.tag=3;var v=l.type.getDerivedStateFromError;if(typeof v=="function"){var y=i.value;p.payload=function(){return v(y)},p.callback=function(){Wh(l,i)}}var w=l.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(p.callback=function(){Wh(l,i),typeof v!="function"&&(Ir===null?Ir=new Set([this]):Ir.add(this));var _=i.stack;this.componentDidCatch(i.value,{componentStack:_!==null?_:""})}),p}function U1(l,i,p){var v=l.pingCache;if(v===null){v=l.pingCache=new w6;var y=new Set;v.set(i,y)}else y=v.get(i),y===void 0&&(y=new Set,v.set(i,y));y.has(p)||(y.add(p),l=z6.bind(null,l,i,p),i.then(l,l))}function Z1(l){do{var i;if((i=l.tag===13)&&(i=l.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return l;l=l.return}while(l!==null);return null}function q1(l,i,p,v,y){return l.mode&1?(l.flags|=65536,l.lanes=y,l):(l===i?l.flags|=65536:(l.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(i=er(-1,1),i.tag=2,kr(p,i,1))),p.lanes|=1),l)}var k6=d.ReactCurrentOwner,es=!1;function Gn(l,i,p,v){i.child=l===null?b1(i,null,p,v):xl(i,l.child,p,v)}function Q1(l,i,p,v,y){p=p.render;var w=i.ref;return gl(i,y),v=Nh(l,i,p,v,w,y),p=zh(),l!==null&&!es?(i.updateQueue=l.updateQueue,i.flags&=-2053,l.lanes&=~y,tr(l,i,y)):(qt&&p&&vh(i),i.flags|=1,Gn(l,i,v,y),i.child)}function K1(l,i,p,v,y){if(l===null){var w=p.type;return typeof w=="function"&&!gm(w)&&w.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(i.tag=15,i.type=w,Y1(l,i,w,v,y)):(l=Vu(p.type,null,v,i,i.mode,y),l.ref=i.ref,l.return=i,i.child=l)}if(w=l.child,!(l.lanes&y)){var _=w.memoizedProps;if(p=p.compare,p=p!==null?p:cu,p(_,v)&&l.ref===i.ref)return tr(l,i,y)}return i.flags|=1,l=Dr(w,v),l.ref=i.ref,l.return=i,i.child=l}function Y1(l,i,p,v,y){if(l!==null){var w=l.memoizedProps;if(cu(w,v)&&l.ref===i.ref)if(es=!1,i.pendingProps=v=w,(l.lanes&y)!==0)l.flags&131072&&(es=!0);else return i.lanes=l.lanes,tr(l,i,y)}return Gh(l,i,p,v,y)}function X1(l,i,p){var v=i.pendingProps,y=v.children,w=l!==null?l.memoizedState:null;if(v.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vt(jl,fs),fs|=p;else{if(!(p&1073741824))return l=w!==null?w.baseLanes|p:p,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:l,cachePool:null,transitions:null},i.updateQueue=null,Vt(jl,fs),fs|=l,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=w!==null?w.baseLanes:p,Vt(jl,fs),fs|=v}else w!==null?(v=w.baseLanes|p,i.memoizedState=null):v=p,Vt(jl,fs),fs|=v;return Gn(l,i,y,p),i.child}function J1(l,i){var p=i.ref;(l===null&&p!==null||l!==null&&l.ref!==p)&&(i.flags|=512,i.flags|=2097152)}function Gh(l,i,p,v,y){var w=Jn(p)?ma:Nn.current;return w=dl(i,w),gl(i,y),p=Nh(l,i,p,v,w,y),v=zh(),l!==null&&!es?(i.updateQueue=l.updateQueue,i.flags&=-2053,l.lanes&=~y,tr(l,i,y)):(qt&&v&&vh(i),i.flags|=1,Gn(l,i,p,y),i.child)}function ex(l,i,p,v,y){if(Jn(p)){var w=!0;eu(i)}else w=!1;if(gl(i,y),i.stateNode===null)Su(l,i),x1(i,p,v),Dh(i,p,v,y),v=!0;else if(l===null){var _=i.stateNode,U=i.memoizedProps;_.props=U;var ae=_.context,Me=p.contextType;typeof Me=="object"&&Me!==null?Me=Ls(Me):(Me=Jn(p)?ma:Nn.current,Me=dl(i,Me));var We=p.getDerivedStateFromProps,rt=typeof We=="function"||typeof _.getSnapshotBeforeUpdate=="function";rt||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(U!==v||ae!==Me)&&v1(i,_,v,Me),wr=!1;var _e=i.memoizedState;_.state=_e,hu(i,v,_,y),ae=i.memoizedState,U!==v||_e!==ae||Xn.current||wr?(typeof We=="function"&&(Ph(i,p,We,v),ae=i.memoizedState),(U=wr||g1(i,p,U,v,_e,ae,Me))?(rt||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(i.flags|=4194308)):(typeof _.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=v,i.memoizedState=ae),_.props=v,_.state=ae,_.context=Me,v=U):(typeof _.componentDidMount=="function"&&(i.flags|=4194308),v=!1)}else{_=i.stateNode,f1(l,i),U=i.memoizedProps,Me=i.type===i.elementType?U:oo(i.type,U),_.props=Me,rt=i.pendingProps,_e=_.context,ae=p.contextType,typeof ae=="object"&&ae!==null?ae=Ls(ae):(ae=Jn(p)?ma:Nn.current,ae=dl(i,ae));var Gt=p.getDerivedStateFromProps;(We=typeof Gt=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(U!==rt||_e!==ae)&&v1(i,_,v,ae),wr=!1,_e=i.memoizedState,_.state=_e,hu(i,v,_,y);var Tt=i.memoizedState;U!==rt||_e!==Tt||Xn.current||wr?(typeof Gt=="function"&&(Ph(i,p,Gt,v),Tt=i.memoizedState),(Me=wr||g1(i,p,Me,v,_e,Tt,ae)||!1)?(We||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(v,Tt,ae),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(v,Tt,ae)),typeof _.componentDidUpdate=="function"&&(i.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof _.componentDidUpdate!="function"||U===l.memoizedProps&&_e===l.memoizedState||(i.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||U===l.memoizedProps&&_e===l.memoizedState||(i.flags|=1024),i.memoizedProps=v,i.memoizedState=Tt),_.props=v,_.state=Tt,_.context=ae,v=Me):(typeof _.componentDidUpdate!="function"||U===l.memoizedProps&&_e===l.memoizedState||(i.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||U===l.memoizedProps&&_e===l.memoizedState||(i.flags|=1024),v=!1)}return Uh(l,i,p,v,w,y)}function Uh(l,i,p,v,y,w){J1(l,i);var _=(i.flags&128)!==0;if(!v&&!_)return y&&e1(i,p,!1),tr(l,i,w);v=i.stateNode,k6.current=i;var U=_&&typeof p.getDerivedStateFromError!="function"?null:v.render();return i.flags|=1,l!==null&&_?(i.child=xl(i,l.child,null,w),i.child=xl(i,null,U,w)):Gn(l,i,U,w),i.memoizedState=v.state,y&&e1(i,p,!0),i.child}function tx(l){var i=l.stateNode;i.pendingContext?X0(l,i.pendingContext,i.pendingContext!==i.context):i.context&&X0(l,i.context,!1),Eh(l,i.containerInfo)}function nx(l,i,p,v,y){return ml(),jh(y),i.flags|=256,Gn(l,i,p,v),i.child}var Zh={dehydrated:null,treeContext:null,retryLane:0};function qh(l){return{baseLanes:l,cachePool:null,transitions:null}}function sx(l,i,p){var v=i.pendingProps,y=Xt.current,w=!1,_=(i.flags&128)!==0,U;if((U=_)||(U=l!==null&&l.memoizedState===null?!1:(y&2)!==0),U?(w=!0,i.flags&=-129):(l===null||l.memoizedState!==null)&&(y|=1),Vt(Xt,y&1),l===null)return bh(i),l=i.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?(i.mode&1?ah(l)?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(_=v.children,l=v.fallback,w?(v=i.mode,w=i.child,_={mode:"hidden",children:_},!(v&1)&&w!==null?(w.childLanes=0,w.pendingProps=_):w=Hu(_,v,0,null),l=Sa(l,v,p,null),w.return=i,l.return=i,w.sibling=l,i.child=w,i.child.memoizedState=qh(p),i.memoizedState=Zh,l):Qh(i,_));if(y=l.memoizedState,y!==null&&(U=y.dehydrated,U!==null))return I6(l,i,_,v,U,y,p);if(w){w=v.fallback,_=i.mode,y=l.child,U=y.sibling;var ae={mode:"hidden",children:v.children};return!(_&1)&&i.child!==y?(v=i.child,v.childLanes=0,v.pendingProps=ae,i.deletions=null):(v=Dr(y,ae),v.subtreeFlags=y.subtreeFlags&14680064),U!==null?w=Dr(U,w):(w=Sa(w,_,p,null),w.flags|=2),w.return=i,v.return=i,v.sibling=w,i.child=v,v=w,w=i.child,_=l.child.memoizedState,_=_===null?qh(p):{baseLanes:_.baseLanes|p,cachePool:null,transitions:_.transitions},w.memoizedState=_,w.childLanes=l.childLanes&~p,i.memoizedState=Zh,v}return w=l.child,l=w.sibling,v=Dr(w,{mode:"visible",children:v.children}),!(i.mode&1)&&(v.lanes=p),v.return=i,v.sibling=null,l!==null&&(p=i.deletions,p===null?(i.deletions=[l],i.flags|=16):p.push(l)),i.child=v,i.memoizedState=null,v}function Qh(l,i){return i=Hu({mode:"visible",children:i},l.mode,0,null),i.return=l,l.child=i}function ju(l,i,p,v){return v!==null&&jh(v),xl(i,l.child,null,p),l=Qh(i,i.pendingProps.children),l.flags|=2,i.memoizedState=null,l}function I6(l,i,p,v,y,w,_){if(p)return i.flags&256?(i.flags&=-257,v=$h(Error(c(422))),ju(l,i,_,v)):i.memoizedState!==null?(i.child=l.child,i.flags|=128,null):(w=v.fallback,y=i.mode,v=Hu({mode:"visible",children:v.children},y,0,null),w=Sa(w,y,_,null),w.flags|=2,v.return=i,w.return=i,v.sibling=w,i.child=v,i.mode&1&&xl(i,l.child,null,_),i.child.memoizedState=qh(_),i.memoizedState=Zh,w);if(!(i.mode&1))return ju(l,i,_,null);if(ah(y))return v=O4(y).digest,w=Error(c(419)),v=$h(w,v,void 0),ju(l,i,_,v);if(p=(_&l.childLanes)!==0,es||p){if(v=In,v!==null){switch(_&-_){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=y&(v.suspendedLanes|_)?0:y,y!==0&&y!==w.retryLane&&(w.retryLane=y,bo(l,y),Bs(v,l,y,-1))}return pm(),v=$h(Error(c(421))),ju(l,i,_,v)}return Y0(y)?(i.flags|=128,i.child=l.child,i=O6.bind(null,l),F4(y,i),null):(l=w.treeContext,ke&&(_s=$4(y),ds=i,qt=!0,so=null,wi=!1,l!==null&&(Ds[Es++]=Xo,Ds[Es++]=Jo,Ds[Es++]=pa,Xo=l.id,Jo=l.overflow,pa=i)),i=Qh(i,v.children),i.flags|=4096,i)}function ox(l,i,p){l.lanes|=i;var v=l.alternate;v!==null&&(v.lanes|=i),Ih(l.return,i,p)}function Kh(l,i,p,v,y){var w=l.memoizedState;w===null?l.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:v,tail:p,tailMode:y}:(w.isBackwards=i,w.rendering=null,w.renderingStartTime=0,w.last=v,w.tail=p,w.tailMode=y)}function rx(l,i,p){var v=i.pendingProps,y=v.revealOrder,w=v.tail;if(Gn(l,i,v.children,p),v=Xt.current,v&2)v=v&1|2,i.flags|=128;else{if(l!==null&&l.flags&128)e:for(l=i.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&ox(l,p,i);else if(l.tag===19)ox(l,p,i);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break e;for(;l.sibling===null;){if(l.return===null||l.return===i)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}v&=1}if(Vt(Xt,v),!(i.mode&1))i.memoizedState=null;else switch(y){case"forwards":for(p=i.child,y=null;p!==null;)l=p.alternate,l!==null&&gu(l)===null&&(y=p),p=p.sibling;p=y,p===null?(y=i.child,i.child=null):(y=p.sibling,p.sibling=null),Kh(i,!1,y,p,w);break;case"backwards":for(p=null,y=i.child,i.child=null;y!==null;){if(l=y.alternate,l!==null&&gu(l)===null){i.child=y;break}l=y.sibling,y.sibling=p,p=y,y=l}Kh(i,!0,p,null,w);break;case"together":Kh(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Su(l,i){!(i.mode&1)&&l!==null&&(l.alternate=null,i.alternate=null,i.flags|=2)}function tr(l,i,p){if(l!==null&&(i.dependencies=l.dependencies),Ca|=i.lanes,!(p&i.childLanes))return null;if(l!==null&&i.child!==l.child)throw Error(c(153));if(i.child!==null){for(l=i.child,p=Dr(l,l.pendingProps),i.child=p,p.return=i;l.sibling!==null;)l=l.sibling,p=p.sibling=Dr(l,l.pendingProps),p.return=i;p.sibling=null}return i.child}function M6(l,i,p){switch(i.tag){case 3:tx(i),ml();break;case 5:j1(i);break;case 1:Jn(i.type)&&eu(i);break;case 4:Eh(i,i.stateNode.containerInfo);break;case 10:u1(i,i.type._context,i.memoizedProps.value);break;case 13:var v=i.memoizedState;if(v!==null)return v.dehydrated!==null?(Vt(Xt,Xt.current&1),i.flags|=128,null):p&i.child.childLanes?sx(l,i,p):(Vt(Xt,Xt.current&1),l=tr(l,i,p),l!==null?l.sibling:null);Vt(Xt,Xt.current&1);break;case 19:if(v=(p&i.childLanes)!==0,l.flags&128){if(v)return rx(l,i,p);i.flags|=128}var y=i.memoizedState;if(y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),Vt(Xt,Xt.current),v)break;return null;case 22:case 23:return i.lanes=0,X1(l,i,p)}return tr(l,i,p)}function wo(l){l.flags|=4}function ax(l,i){if(l!==null&&l.child===i.child)return!0;if(i.flags&16)return!1;for(l=i.child;l!==null;){if(l.flags&12854||l.subtreeFlags&12854)return!1;l=l.sibling}return!0}var _i,Li,wu,ku;if(fe)_i=function(l,i){for(var p=i.child;p!==null;){if(p.tag===5||p.tag===6)ce(l,p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===i)break;for(;p.sibling===null;){if(p.return===null||p.return===i)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},Li=function(){},wu=function(l,i,p,v,y){if(l=l.memoizedProps,l!==v){var w=i.stateNode,_=jo(Ts.current);p=je(w,p,l,v,y,_),(i.updateQueue=p)&&wo(i)}},ku=function(l,i,p,v){p!==v&&wo(i)};else if(he){_i=function(l,i,p,v){for(var y=i.child;y!==null;){if(y.tag===5){var w=y.stateNode;p&&v&&(w=Q0(w,y.type,y.memoizedProps,y)),ce(l,w)}else if(y.tag===6)w=y.stateNode,p&&v&&(w=K0(w,y.memoizedProps,y)),ce(l,w);else if(y.tag!==4){if(y.tag===22&&y.memoizedState!==null)w=y.child,w!==null&&(w.return=y),_i(l,y,!0,!0);else if(y.child!==null){y.child.return=y,y=y.child;continue}}if(y===i)break;for(;y.sibling===null;){if(y.return===null||y.return===i)return;y=y.return}y.sibling.return=y.return,y=y.sibling}};var lx=function(l,i,p,v){for(var y=i.child;y!==null;){if(y.tag===5){var w=y.stateNode;p&&v&&(w=Q0(w,y.type,y.memoizedProps,y)),q0(l,w)}else if(y.tag===6)w=y.stateNode,p&&v&&(w=K0(w,y.memoizedProps,y)),q0(l,w);else if(y.tag!==4){if(y.tag===22&&y.memoizedState!==null)w=y.child,w!==null&&(w.return=y),lx(l,y,!0,!0);else if(y.child!==null){y.child.return=y,y=y.child;continue}}if(y===i)break;for(;y.sibling===null;){if(y.return===null||y.return===i)return;y=y.return}y.sibling.return=y.return,y=y.sibling}};Li=function(l,i){var p=i.stateNode;if(!ax(l,i)){l=p.containerInfo;var v=Z0(l);lx(v,i,!1,!1),p.pendingChildren=v,wo(i),R4(l,v)}},wu=function(l,i,p,v,y){var w=l.stateNode,_=l.memoizedProps;if((l=ax(l,i))&&_===v)i.stateNode=w;else{var U=i.stateNode,ae=jo(Ts.current),Me=null;_!==v&&(Me=je(U,p,_,v,y,ae)),l&&Me===null?i.stateNode=w:(w=T4(w,Me,p,_,v,i,l,U),ue(w,p,v,y,ae)&&wo(i),i.stateNode=w,l?wo(i):_i(w,i,!1,!1))}},ku=function(l,i,p,v){p!==v?(l=jo(vl.current),p=jo(Ts.current),i.stateNode=ee(v,l,p,i),wo(i)):i.stateNode=l.stateNode}}else Li=function(){},wu=function(){},ku=function(){};function Ti(l,i){if(!qt)switch(l.tailMode){case"hidden":i=l.tail;for(var p=null;i!==null;)i.alternate!==null&&(p=i),i=i.sibling;p===null?l.tail=null:p.sibling=null;break;case"collapsed":p=l.tail;for(var v=null;p!==null;)p.alternate!==null&&(v=p),p=p.sibling;v===null?i||l.tail===null?l.tail=null:l.tail.sibling=null:v.sibling=null}}function On(l){var i=l.alternate!==null&&l.alternate.child===l.child,p=0,v=0;if(i)for(var y=l.child;y!==null;)p|=y.lanes|y.childLanes,v|=y.subtreeFlags&14680064,v|=y.flags&14680064,y.return=l,y=y.sibling;else for(y=l.child;y!==null;)p|=y.lanes|y.childLanes,v|=y.subtreeFlags,v|=y.flags,y.return=l,y=y.sibling;return l.subtreeFlags|=v,l.childLanes=p,i}function A6(l,i,p){var v=i.pendingProps;switch(Ch(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return On(i),null;case 1:return Jn(i.type)&&Jc(),On(i),null;case 3:return p=i.stateNode,Cl(),Wt(Xn),Wt(Nn),Th(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(l===null||l.child===null)&&(iu(i)?wo(i):l===null||l.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,so!==null&&(hm(so),so=null))),Li(l,i),On(i),null;case 5:_h(i),p=jo(vl.current);var y=i.type;if(l!==null&&i.stateNode!=null)wu(l,i,y,v,p),l.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!v){if(i.stateNode===null)throw Error(c(166));return On(i),null}if(l=jo(Ts.current),iu(i)){if(!ke)throw Error(c(175));l=W4(i.stateNode,i.type,i.memoizedProps,p,l,i,!wi),i.updateQueue=l,l!==null&&wo(i)}else{var w=Be(y,v,p,l,i);_i(w,i,!1,!1),i.stateNode=w,ue(w,y,v,p,l)&&wo(i)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return On(i),null;case 6:if(l&&i.stateNode!=null)ku(l,i,l.memoizedProps,v);else{if(typeof v!="string"&&i.stateNode===null)throw Error(c(166));if(l=jo(vl.current),p=jo(Ts.current),iu(i)){if(!ke)throw Error(c(176));if(l=i.stateNode,p=i.memoizedProps,(v=G4(l,p,i,!wi))&&(y=ds,y!==null))switch(y.tag){case 3:J4(y.stateNode.containerInfo,l,p,(y.mode&1)!==0);break;case 5:e6(y.type,y.memoizedProps,y.stateNode,l,p,(y.mode&1)!==0)}v&&wo(i)}else i.stateNode=ee(v,l,p,i)}return On(i),null;case 13:if(Wt(Xt),v=i.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(qt&&_s!==null&&i.mode&1&&!(i.flags&128))c1(),ml(),i.flags|=98560,y=!1;else if(y=iu(i),v!==null&&v.dehydrated!==null){if(l===null){if(!y)throw Error(c(318));if(!ke)throw Error(c(344));if(y=i.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(c(317));U4(y,i)}else ml(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;On(i),y=!1}else so!==null&&(hm(so),so=null),y=!0;if(!y)return i.flags&65536?i:null}return i.flags&128?(i.lanes=p,i):(p=v!==null,p!==(l!==null&&l.memoizedState!==null)&&p&&(i.child.flags|=8192,i.mode&1&&(l===null||Xt.current&1?Cn===0&&(Cn=3):pm())),i.updateQueue!==null&&(i.flags|=4),On(i),null);case 4:return Cl(),Li(l,i),l===null&&$e(i.stateNode.containerInfo),On(i),null;case 10:return kh(i.type._context),On(i),null;case 17:return Jn(i.type)&&Jc(),On(i),null;case 19:if(Wt(Xt),y=i.memoizedState,y===null)return On(i),null;if(v=(i.flags&128)!==0,w=y.rendering,w===null)if(v)Ti(y,!1);else{if(Cn!==0||l!==null&&l.flags&128)for(l=i.child;l!==null;){if(w=gu(l),w!==null){for(i.flags|=128,Ti(y,!1),l=w.updateQueue,l!==null&&(i.updateQueue=l,i.flags|=4),i.subtreeFlags=0,l=p,p=i.child;p!==null;)v=p,y=l,v.flags&=14680066,w=v.alternate,w===null?(v.childLanes=0,v.lanes=y,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=w.childLanes,v.lanes=w.lanes,v.child=w.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=w.memoizedProps,v.memoizedState=w.memoizedState,v.updateQueue=w.updateQueue,v.type=w.type,y=w.dependencies,v.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext}),p=p.sibling;return Vt(Xt,Xt.current&1|2),i.child}l=l.sibling}y.tail!==null&&wn()>cm&&(i.flags|=128,v=!0,Ti(y,!1),i.lanes=4194304)}else{if(!v)if(l=gu(w),l!==null){if(i.flags|=128,v=!0,l=l.updateQueue,l!==null&&(i.updateQueue=l,i.flags|=4),Ti(y,!0),y.tail===null&&y.tailMode==="hidden"&&!w.alternate&&!qt)return On(i),null}else 2*wn()-y.renderingStartTime>cm&&p!==1073741824&&(i.flags|=128,v=!0,Ti(y,!1),i.lanes=4194304);y.isBackwards?(w.sibling=i.child,i.child=w):(l=y.last,l!==null?l.sibling=w:i.child=w,y.last=w)}return y.tail!==null?(i=y.tail,y.rendering=i,y.tail=i.sibling,y.renderingStartTime=wn(),i.sibling=null,l=Xt.current,Vt(Xt,v?l&1|2:l&1),i):(On(i),null);case 22:case 23:return mm(),p=i.memoizedState!==null,l!==null&&l.memoizedState!==null!==p&&(i.flags|=8192),p&&i.mode&1?fs&1073741824&&(On(i),fe&&i.subtreeFlags&6&&(i.flags|=8192)):On(i),null;case 24:return null;case 25:return null}throw Error(c(156,i.tag))}function P6(l,i){switch(Ch(i),i.tag){case 1:return Jn(i.type)&&Jc(),l=i.flags,l&65536?(i.flags=l&-65537|128,i):null;case 3:return Cl(),Wt(Xn),Wt(Nn),Th(),l=i.flags,l&65536&&!(l&128)?(i.flags=l&-65537|128,i):null;case 5:return _h(i),null;case 13:if(Wt(Xt),l=i.memoizedState,l!==null&&l.dehydrated!==null){if(i.alternate===null)throw Error(c(340));ml()}return l=i.flags,l&65536?(i.flags=l&-65537|128,i):null;case 19:return Wt(Xt),null;case 4:return Cl(),null;case 10:return kh(i.type._context),null;case 22:case 23:return mm(),null;case 24:return null;default:return null}}var Iu=!1,Fn=!1,D6=typeof WeakSet=="function"?WeakSet:Set,Oe=null;function bl(l,i){var p=l.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(v){Qt(l,i,v)}else p.current=null}function Yh(l,i,p){try{p()}catch(v){Qt(l,i,v)}}var ix=!1;function E6(l,i){for(de(l.containerInfo),Oe=i;Oe!==null;)if(l=Oe,i=l.child,(l.subtreeFlags&1028)!==0&&i!==null)i.return=l,Oe=i;else for(;Oe!==null;){l=Oe;try{var p=l.alternate;if(l.flags&1024)switch(l.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var v=p.memoizedProps,y=p.memoizedState,w=l.stateNode,_=w.getSnapshotBeforeUpdate(l.elementType===l.type?v:oo(l.type,v),y);w.__reactInternalSnapshotBeforeUpdate=_}break;case 3:fe&&Yc(l.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(c(163))}}catch(U){Qt(l,l.return,U)}if(i=l.sibling,i!==null){i.return=l.return,Oe=i;break}Oe=l.return}return p=ix,ix=!1,p}function Ri(l,i,p){var v=i.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var y=v=v.next;do{if((y.tag&l)===l){var w=y.destroy;y.destroy=void 0,w!==void 0&&Yh(i,p,w)}y=y.next}while(y!==v)}}function Mu(l,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var p=i=i.next;do{if((p.tag&l)===l){var v=p.create;p.destroy=v()}p=p.next}while(p!==i)}}function Xh(l){var i=l.ref;if(i!==null){var p=l.stateNode;switch(l.tag){case 5:l=me(p);break;default:l=p}typeof i=="function"?i(l):i.current=l}}function cx(l){var i=l.alternate;i!==null&&(l.alternate=null,cx(i)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(i=l.stateNode,i!==null&&gt(i)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function ux(l){return l.tag===5||l.tag===3||l.tag===4}function dx(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||ux(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Jh(l,i,p){var v=l.tag;if(v===5||v===6)l=l.stateNode,i?Yn(p,l,i):Zt(p,l);else if(v!==4&&(l=l.child,l!==null))for(Jh(l,i,p),l=l.sibling;l!==null;)Jh(l,i,p),l=l.sibling}function em(l,i,p){var v=l.tag;if(v===5||v===6)l=l.stateNode,i?xn(p,l,i):wt(p,l);else if(v!==4&&(l=l.child,l!==null))for(em(l,i,p),l=l.sibling;l!==null;)em(l,i,p),l=l.sibling}var _n=null,ro=!1;function ko(l,i,p){for(p=p.child;p!==null;)tm(l,i,p),p=p.sibling}function tm(l,i,p){if(Co&&typeof Co.onCommitFiberUnmount=="function")try{Co.onCommitFiberUnmount(ou,p)}catch{}switch(p.tag){case 5:Fn||bl(p,i);case 6:if(fe){var v=_n,y=ro;_n=null,ko(l,i,p),_n=v,ro=y,_n!==null&&(ro?Ps(_n,p.stateNode):Bn(_n,p.stateNode))}else ko(l,i,p);break;case 18:fe&&_n!==null&&(ro?Y4(_n,p.stateNode):K4(_n,p.stateNode));break;case 4:fe?(v=_n,y=ro,_n=p.stateNode.containerInfo,ro=!0,ko(l,i,p),_n=v,ro=y):(he&&(v=p.stateNode.containerInfo,y=Z0(v),rh(v,y)),ko(l,i,p));break;case 0:case 11:case 14:case 15:if(!Fn&&(v=p.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){y=v=v.next;do{var w=y,_=w.destroy;w=w.tag,_!==void 0&&(w&2||w&4)&&Yh(p,i,_),y=y.next}while(y!==v)}ko(l,i,p);break;case 1:if(!Fn&&(bl(p,i),v=p.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=p.memoizedProps,v.state=p.memoizedState,v.componentWillUnmount()}catch(U){Qt(p,i,U)}ko(l,i,p);break;case 21:ko(l,i,p);break;case 22:p.mode&1?(Fn=(v=Fn)||p.memoizedState!==null,ko(l,i,p),Fn=v):ko(l,i,p);break;default:ko(l,i,p)}}function fx(l){var i=l.updateQueue;if(i!==null){l.updateQueue=null;var p=l.stateNode;p===null&&(p=l.stateNode=new D6),i.forEach(function(v){var y=F6.bind(null,l,v);p.has(v)||(p.add(v),v.then(y,y))})}}function ao(l,i){var p=i.deletions;if(p!==null)for(var v=0;v<p.length;v++){var y=p[v];try{var w=l,_=i;if(fe){var U=_;e:for(;U!==null;){switch(U.tag){case 5:_n=U.stateNode,ro=!1;break e;case 3:_n=U.stateNode.containerInfo,ro=!0;break e;case 4:_n=U.stateNode.containerInfo,ro=!0;break e}U=U.return}if(_n===null)throw Error(c(160));tm(w,_,y),_n=null,ro=!1}else tm(w,_,y);var ae=y.alternate;ae!==null&&(ae.return=null),y.return=null}catch(Me){Qt(y,i,Me)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)hx(i,l),i=i.sibling}function hx(l,i){var p=l.alternate,v=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(ao(i,l),Io(l),v&4){try{Ri(3,l,l.return),Mu(3,l)}catch(_e){Qt(l,l.return,_e)}try{Ri(5,l,l.return)}catch(_e){Qt(l,l.return,_e)}}break;case 1:ao(i,l),Io(l),v&512&&p!==null&&bl(p,p.return);break;case 5:if(ao(i,l),Io(l),v&512&&p!==null&&bl(p,p.return),fe){if(l.flags&32){var y=l.stateNode;try{cs(y)}catch(_e){Qt(l,l.return,_e)}}if(v&4&&(y=l.stateNode,y!=null)){var w=l.memoizedProps;if(p=p!==null?p.memoizedProps:w,v=l.type,i=l.updateQueue,l.updateQueue=null,i!==null)try{is(y,i,v,p,w,l)}catch(_e){Qt(l,l.return,_e)}}}break;case 6:if(ao(i,l),Io(l),v&4&&fe){if(l.stateNode===null)throw Error(c(162));y=l.stateNode,w=l.memoizedProps,p=p!==null?p.memoizedProps:w;try{Ft(y,p,w)}catch(_e){Qt(l,l.return,_e)}}break;case 3:if(ao(i,l),Io(l),v&4){if(fe&&ke&&p!==null&&p.memoizedState.isDehydrated)try{q4(i.containerInfo)}catch(_e){Qt(l,l.return,_e)}if(he){y=i.containerInfo,w=i.pendingChildren;try{rh(y,w)}catch(_e){Qt(l,l.return,_e)}}}break;case 4:if(ao(i,l),Io(l),v&4&&he){w=l.stateNode,y=w.containerInfo,w=w.pendingChildren;try{rh(y,w)}catch(_e){Qt(l,l.return,_e)}}break;case 13:ao(i,l),Io(l),y=l.child,y.flags&8192&&(w=y.memoizedState!==null,y.stateNode.isHidden=w,!w||y.alternate!==null&&y.alternate.memoizedState!==null||(im=wn())),v&4&&fx(l);break;case 22:var _=p!==null&&p.memoizedState!==null;if(l.mode&1?(Fn=(p=Fn)||_,ao(i,l),Fn=p):ao(i,l),Io(l),v&8192){if(p=l.memoizedState!==null,(l.stateNode.isHidden=p)&&!_&&l.mode&1)for(Oe=l,v=l.child;v!==null;){for(i=Oe=v;Oe!==null;){_=Oe;var U=_.child;switch(_.tag){case 0:case 11:case 14:case 15:Ri(4,_,_.return);break;case 1:bl(_,_.return);var ae=_.stateNode;if(typeof ae.componentWillUnmount=="function"){var Me=_,We=_.return;try{var rt=Me;ae.props=rt.memoizedProps,ae.state=rt.memoizedState,ae.componentWillUnmount()}catch(_e){Qt(Me,We,_e)}}break;case 5:bl(_,_.return);break;case 22:if(_.memoizedState!==null){gx(i);continue}}U!==null?(U.return=_,Oe=U):gx(i)}v=v.sibling}if(fe){e:if(v=null,fe)for(i=l;;){if(i.tag===5){if(v===null){v=i;try{y=i.stateNode,p?us(y):br(i.stateNode,i.memoizedProps)}catch(_e){Qt(l,l.return,_e)}}}else if(i.tag===6){if(v===null)try{w=i.stateNode,p?eo(w):Kc(w,i.memoizedProps)}catch(_e){Qt(l,l.return,_e)}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===l)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===l)break e;for(;i.sibling===null;){if(i.return===null||i.return===l)break e;v===i&&(v=null),i=i.return}v===i&&(v=null),i.sibling.return=i.return,i=i.sibling}}}break;case 19:ao(i,l),Io(l),v&4&&fx(l);break;case 21:break;default:ao(i,l),Io(l)}}function Io(l){var i=l.flags;if(i&2){try{if(fe){e:{for(var p=l.return;p!==null;){if(ux(p)){var v=p;break e}p=p.return}throw Error(c(160))}switch(v.tag){case 5:var y=v.stateNode;v.flags&32&&(cs(y),v.flags&=-33);var w=dx(l);em(l,w,y);break;case 3:case 4:var _=v.stateNode.containerInfo,U=dx(l);Jh(l,U,_);break;default:throw Error(c(161))}}}catch(ae){Qt(l,l.return,ae)}l.flags&=-3}i&4096&&(l.flags&=-4097)}function _6(l,i,p){Oe=l,mx(l)}function mx(l,i,p){for(var v=(l.mode&1)!==0;Oe!==null;){var y=Oe,w=y.child;if(y.tag===22&&v){var _=y.memoizedState!==null||Iu;if(!_){var U=y.alternate,ae=U!==null&&U.memoizedState!==null||Fn;U=Iu;var Me=Fn;if(Iu=_,(Fn=ae)&&!Me)for(Oe=y;Oe!==null;)_=Oe,ae=_.child,_.tag===22&&_.memoizedState!==null?xx(y):ae!==null?(ae.return=_,Oe=ae):xx(y);for(;w!==null;)Oe=w,mx(w),w=w.sibling;Oe=y,Iu=U,Fn=Me}px(l)}else y.subtreeFlags&8772&&w!==null?(w.return=y,Oe=w):px(l)}}function px(l){for(;Oe!==null;){var i=Oe;if(i.flags&8772){var p=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:Fn||Mu(5,i);break;case 1:var v=i.stateNode;if(i.flags&4&&!Fn)if(p===null)v.componentDidMount();else{var y=i.elementType===i.type?p.memoizedProps:oo(i.type,p.memoizedProps);v.componentDidUpdate(y,p.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var w=i.updateQueue;w!==null&&m1(i,w,v);break;case 3:var _=i.updateQueue;if(_!==null){if(p=null,i.child!==null)switch(i.child.tag){case 5:p=me(i.child.stateNode);break;case 1:p=i.child.stateNode}m1(i,_,p)}break;case 5:var U=i.stateNode;p===null&&i.flags&4&&on(U,i.type,i.memoizedProps,i);break;case 6:break;case 4:break;case 12:break;case 13:if(ke&&i.memoizedState===null){var ae=i.alternate;if(ae!==null){var Me=ae.memoizedState;if(Me!==null){var We=Me.dehydrated;We!==null&&Q4(We)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(c(163))}Fn||i.flags&512&&Xh(i)}catch(rt){Qt(i,i.return,rt)}}if(i===l){Oe=null;break}if(p=i.sibling,p!==null){p.return=i.return,Oe=p;break}Oe=i.return}}function gx(l){for(;Oe!==null;){var i=Oe;if(i===l){Oe=null;break}var p=i.sibling;if(p!==null){p.return=i.return,Oe=p;break}Oe=i.return}}function xx(l){for(;Oe!==null;){var i=Oe;try{switch(i.tag){case 0:case 11:case 15:var p=i.return;try{Mu(4,i)}catch(ae){Qt(i,p,ae)}break;case 1:var v=i.stateNode;if(typeof v.componentDidMount=="function"){var y=i.return;try{v.componentDidMount()}catch(ae){Qt(i,y,ae)}}var w=i.return;try{Xh(i)}catch(ae){Qt(i,w,ae)}break;case 5:var _=i.return;try{Xh(i)}catch(ae){Qt(i,_,ae)}}}catch(ae){Qt(i,i.return,ae)}if(i===l){Oe=null;break}var U=i.sibling;if(U!==null){U.return=i.return,Oe=U;break}Oe=i.return}}var Au=0,Pu=1,Du=2,Eu=3,_u=4;if(typeof Symbol=="function"&&Symbol.for){var Bi=Symbol.for;Au=Bi("selector.component"),Pu=Bi("selector.has_pseudo_class"),Du=Bi("selector.role"),Eu=Bi("selector.test_id"),_u=Bi("selector.text")}function nm(l){var i=ze(l);if(i!=null){if(typeof i.memoizedProps["data-testname"]!="string")throw Error(c(364));return i}if(l=ge(l),l===null)throw Error(c(362));return l.stateNode.current}function sm(l,i){switch(i.$$typeof){case Au:if(l.type===i.value)return!0;break;case Pu:e:{i=i.value,l=[l,0];for(var p=0;p<l.length;){var v=l[p++],y=l[p++],w=i[y];if(v.tag!==5||!te(v)){for(;w!=null&&sm(v,w);)y++,w=i[y];if(y===i.length){i=!0;break e}else for(v=v.child;v!==null;)l.push(v,y),v=v.sibling}}i=!1}return i;case Du:if(l.tag===5&&Ce(l.stateNode,i.value))return!0;break;case _u:if((l.tag===5||l.tag===6)&&(l=pe(l),l!==null&&0<=l.indexOf(i.value)))return!0;break;case Eu:if(l.tag===5&&(l=l.memoizedProps["data-testname"],typeof l=="string"&&l.toLowerCase()===i.value.toLowerCase()))return!0;break;default:throw Error(c(365))}return!1}function om(l){switch(l.$$typeof){case Au:return"<"+(N(l.value)||"Unknown")+">";case Pu:return":has("+(om(l)||"")+")";case Du:return'[role="'+l.value+'"]';case _u:return'"'+l.value+'"';case Eu:return'[data-testname="'+l.value+'"]';default:throw Error(c(365))}}function vx(l,i){var p=[];l=[l,0];for(var v=0;v<l.length;){var y=l[v++],w=l[v++],_=i[w];if(y.tag!==5||!te(y)){for(;_!=null&&sm(y,_);)w++,_=i[w];if(w===i.length)p.push(y);else for(y=y.child;y!==null;)l.push(y,w),y=y.sibling}}return p}function rm(l,i){if(!ne)throw Error(c(363));l=nm(l),l=vx(l,i),i=[],l=Array.from(l);for(var p=0;p<l.length;){var v=l[p++];if(v.tag===5)te(v)||i.push(v.stateNode);else for(v=v.child;v!==null;)l.push(v),v=v.sibling}return i}var L6=Math.ceil,Lu=d.ReactCurrentDispatcher,am=d.ReactCurrentOwner,un=d.ReactCurrentBatchConfig,ft=0,In=null,hn=null,Ln=0,fs=0,jl=jr(0),Cn=0,Ni=null,Ca=0,Tu=0,lm=0,zi=null,ts=null,im=0,cm=1/0,nr=null;function Sl(){cm=wn()+500}var Ru=!1,um=null,Ir=null,Bu=!1,Mr=null,Nu=0,Oi=0,dm=null,zu=-1,Ou=0;function Vn(){return ft&6?wn():zu!==-1?zu:zu=wn()}function Ar(l){return l.mode&1?ft&2&&Ln!==0?Ln&-Ln:p6.transition!==null?(Ou===0&&(Ou=t1()),Ou):(l=kt,l!==0?l:Je()):1}function Bs(l,i,p,v){if(50<Oi)throw Oi=0,dm=null,Error(c(185));Si(l,p,v),(!(ft&2)||l!==In)&&(l===In&&(!(ft&2)&&(Tu|=p),Cn===4&&Pr(l,Ln)),ns(l,v),p===1&&ft===0&&!(i.mode&1)&&(Sl(),ru&&yo()))}function ns(l,i){var p=l.callbackNode;a6(l,i);var v=su(l,l===In?Ln:0);if(v===0)p!==null&&s1(p),l.callbackNode=null,l.callbackPriority=0;else if(i=v&-v,l.callbackPriority!==i){if(p!=null&&s1(p),i===1)l.tag===0?m6(yx.bind(null,l)):o1(yx.bind(null,l)),R?Z(function(){!(ft&6)&&yo()}):mh(ph,yo),p=null;else{switch(n1(v)){case 1:p=ph;break;case 4:p=u6;break;case 16:p=gh;break;case 536870912:p=d6;break;default:p=gh}p=Px(p,Cx.bind(null,l))}l.callbackPriority=i,l.callbackNode=p}}function Cx(l,i){if(zu=-1,Ou=0,ft&6)throw Error(c(327));var p=l.callbackNode;if(ja()&&l.callbackNode!==p)return null;var v=su(l,l===In?Ln:0);if(v===0)return null;if(v&30||v&l.expiredLanes||i)i=Fu(l,v);else{i=v;var y=ft;ft|=2;var w=Sx();(In!==l||Ln!==i)&&(nr=null,Sl(),ya(l,i));do try{B6();break}catch(U){jx(l,U)}while(!0);wh(),Lu.current=w,ft=y,hn!==null?i=0:(In=null,Ln=0,i=Cn)}if(i!==0){if(i===2&&(y=dh(l),y!==0&&(v=y,i=fm(l,y))),i===1)throw p=Ni,ya(l,0),Pr(l,v),ns(l,wn()),p;if(i===6)Pr(l,v);else{if(y=l.current.alternate,!(v&30)&&!T6(y)&&(i=Fu(l,v),i===2&&(w=dh(l),w!==0&&(v=w,i=fm(l,w))),i===1))throw p=Ni,ya(l,0),Pr(l,v),ns(l,wn()),p;switch(l.finishedWork=y,l.finishedLanes=v,i){case 0:case 1:throw Error(c(345));case 2:ba(l,ts,nr);break;case 3:if(Pr(l,v),(v&130023424)===v&&(i=im+500-wn(),10<i)){if(su(l,0)!==0)break;if(y=l.suspendedLanes,(y&v)!==v){Vn(),l.pingedLanes|=l.suspendedLanes&y;break}l.timeoutHandle=J(ba.bind(null,l,ts,nr),i);break}ba(l,ts,nr);break;case 4:if(Pr(l,v),(v&4194240)===v)break;for(i=l.eventTimes,y=-1;0<v;){var _=31-to(v);w=1<<_,_=i[_],_>y&&(y=_),v&=~w}if(v=y,v=wn()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*L6(v/1960))-v,10<v){l.timeoutHandle=J(ba.bind(null,l,ts,nr),v);break}ba(l,ts,nr);break;case 5:ba(l,ts,nr);break;default:throw Error(c(329))}}}return ns(l,wn()),l.callbackNode===p?Cx.bind(null,l):null}function fm(l,i){var p=zi;return l.current.memoizedState.isDehydrated&&(ya(l,i).flags|=256),l=Fu(l,i),l!==2&&(i=ts,ts=p,i!==null&&hm(i)),l}function hm(l){ts===null?ts=l:ts.push.apply(ts,l)}function T6(l){for(var i=l;;){if(i.flags&16384){var p=i.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var v=0;v<p.length;v++){var y=p[v],w=y.getSnapshot;y=y.value;try{if(!no(w(),y))return!1}catch{return!1}}}if(p=i.child,i.subtreeFlags&16384&&p!==null)p.return=i,i=p;else{if(i===l)break;for(;i.sibling===null;){if(i.return===null||i.return===l)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Pr(l,i){for(i&=~lm,i&=~Tu,l.suspendedLanes|=i,l.pingedLanes&=~i,l=l.expirationTimes;0<i;){var p=31-to(i),v=1<<p;l[p]=-1,i&=~v}}function yx(l){if(ft&6)throw Error(c(327));ja();var i=su(l,0);if(!(i&1))return ns(l,wn()),null;var p=Fu(l,i);if(l.tag!==0&&p===2){var v=dh(l);v!==0&&(i=v,p=fm(l,v))}if(p===1)throw p=Ni,ya(l,0),Pr(l,i),ns(l,wn()),p;if(p===6)throw Error(c(345));return l.finishedWork=l.current.alternate,l.finishedLanes=i,ba(l,ts,nr),ns(l,wn()),null}function bx(l){Mr!==null&&Mr.tag===0&&!(ft&6)&&ja();var i=ft;ft|=1;var p=un.transition,v=kt;try{if(un.transition=null,kt=1,l)return l()}finally{kt=v,un.transition=p,ft=i,!(ft&6)&&yo()}}function mm(){fs=jl.current,Wt(jl)}function ya(l,i){l.finishedWork=null,l.finishedLanes=0;var p=l.timeoutHandle;if(p!==oe&&(l.timeoutHandle=oe,F(p)),hn!==null)for(p=hn.return;p!==null;){var v=p;switch(Ch(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&Jc();break;case 3:Cl(),Wt(Xn),Wt(Nn),Th();break;case 5:_h(v);break;case 4:Cl();break;case 13:Wt(Xt);break;case 19:Wt(Xt);break;case 10:kh(v.type._context);break;case 22:case 23:mm()}p=p.return}if(In=l,hn=l=Dr(l.current,null),Ln=fs=i,Cn=0,Ni=null,lm=Tu=Ca=0,ts=zi=null,xa!==null){for(i=0;i<xa.length;i++)if(p=xa[i],v=p.interleaved,v!==null){p.interleaved=null;var y=v.next,w=p.pending;if(w!==null){var _=w.next;w.next=y,v.next=_}p.pending=v}xa=null}return l}function jx(l,i){do{var p=hn;try{if(wh(),xu.current=bu,vu){for(var v=Jt.memoizedState;v!==null;){var y=v.queue;y!==null&&(y.pending=null),v=v.next}vu=!1}if(va=0,kn=vn=Jt=null,Ai=!1,Pi=0,am.current=null,p===null||p.return===null){Cn=1,Ni=i,hn=null;break}e:{var w=l,_=p.return,U=p,ae=i;if(i=Ln,U.flags|=32768,ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var Me=ae,We=U,rt=We.tag;if(!(We.mode&1)&&(rt===0||rt===11||rt===15)){var _e=We.alternate;_e?(We.updateQueue=_e.updateQueue,We.memoizedState=_e.memoizedState,We.lanes=_e.lanes):(We.updateQueue=null,We.memoizedState=null)}var Gt=Z1(_);if(Gt!==null){Gt.flags&=-257,q1(Gt,_,U,w,i),Gt.mode&1&&U1(w,Me,i),i=Gt,ae=Me;var Tt=i.updateQueue;if(Tt===null){var ss=new Set;ss.add(ae),i.updateQueue=ss}else Tt.add(ae);break e}else{if(!(i&1)){U1(w,Me,i),pm();break e}ae=Error(c(426))}}else if(qt&&U.mode&1){var sr=Z1(_);if(sr!==null){!(sr.flags&65536)&&(sr.flags|=256),q1(sr,_,U,w,i),jh(yl(ae,U));break e}}w=ae=yl(ae,U),Cn!==4&&(Cn=2),zi===null?zi=[w]:zi.push(w),w=_;do{switch(w.tag){case 3:w.flags|=65536,i&=-i,w.lanes|=i;var se=W1(w,ae,i);h1(w,se);break e;case 1:U=ae;var K=w.type,ie=w.stateNode;if(!(w.flags&128)&&(typeof K.getDerivedStateFromError=="function"||ie!==null&&typeof ie.componentDidCatch=="function"&&(Ir===null||!Ir.has(ie)))){w.flags|=65536,i&=-i,w.lanes|=i;var Le=G1(w,U,i);h1(w,Le);break e}}w=w.return}while(w!==null)}kx(p)}catch(Xe){i=Xe,hn===p&&p!==null&&(hn=p=p.return);continue}break}while(!0)}function Sx(){var l=Lu.current;return Lu.current=bu,l===null?bu:l}function pm(){(Cn===0||Cn===3||Cn===2)&&(Cn=4),In===null||!(Ca&268435455)&&!(Tu&268435455)||Pr(In,Ln)}function Fu(l,i){var p=ft;ft|=2;var v=Sx();(In!==l||Ln!==i)&&(nr=null,ya(l,i));do try{R6();break}catch(y){jx(l,y)}while(!0);if(wh(),ft=p,Lu.current=v,hn!==null)throw Error(c(261));return In=null,Ln=0,Cn}function R6(){for(;hn!==null;)wx(hn)}function B6(){for(;hn!==null&&!i6();)wx(hn)}function wx(l){var i=Ax(l.alternate,l,fs);l.memoizedProps=l.pendingProps,i===null?kx(l):hn=i,am.current=null}function kx(l){var i=l;do{var p=i.alternate;if(l=i.return,i.flags&32768){if(p=P6(p,i),p!==null){p.flags&=32767,hn=p;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{Cn=6,hn=null;return}}else if(p=A6(p,i,fs),p!==null){hn=p;return}if(i=i.sibling,i!==null){hn=i;return}hn=i=l}while(i!==null);Cn===0&&(Cn=5)}function ba(l,i,p){var v=kt,y=un.transition;try{un.transition=null,kt=1,N6(l,i,p,v)}finally{un.transition=y,kt=v}return null}function N6(l,i,p,v){do ja();while(Mr!==null);if(ft&6)throw Error(c(327));p=l.finishedWork;var y=l.finishedLanes;if(p===null)return null;if(l.finishedWork=null,l.finishedLanes=0,p===l.current)throw Error(c(177));l.callbackNode=null,l.callbackPriority=0;var w=p.lanes|p.childLanes;if(l6(l,w),l===In&&(hn=In=null,Ln=0),!(p.subtreeFlags&2064)&&!(p.flags&2064)||Bu||(Bu=!0,Px(gh,function(){return ja(),null})),w=(p.flags&15990)!==0,p.subtreeFlags&15990||w){w=un.transition,un.transition=null;var _=kt;kt=1;var U=ft;ft|=4,am.current=null,E6(l,p),hx(p,l),He(l.containerInfo),l.current=p,_6(p),c6(),ft=U,kt=_,un.transition=w}else l.current=p;if(Bu&&(Bu=!1,Mr=l,Nu=y),w=l.pendingLanes,w===0&&(Ir=null),f6(p.stateNode),ns(l,wn()),i!==null)for(v=l.onRecoverableError,p=0;p<i.length;p++)y=i[p],v(y.value,{componentStack:y.stack,digest:y.digest});if(Ru)throw Ru=!1,l=um,um=null,l;return Nu&1&&l.tag!==0&&ja(),w=l.pendingLanes,w&1?l===dm?Oi++:(Oi=0,dm=l):Oi=0,yo(),null}function ja(){if(Mr!==null){var l=n1(Nu),i=un.transition,p=kt;try{if(un.transition=null,kt=16>l?16:l,Mr===null)var v=!1;else{if(l=Mr,Mr=null,Nu=0,ft&6)throw Error(c(331));var y=ft;for(ft|=4,Oe=l.current;Oe!==null;){var w=Oe,_=w.child;if(Oe.flags&16){var U=w.deletions;if(U!==null){for(var ae=0;ae<U.length;ae++){var Me=U[ae];for(Oe=Me;Oe!==null;){var We=Oe;switch(We.tag){case 0:case 11:case 15:Ri(8,We,w)}var rt=We.child;if(rt!==null)rt.return=We,Oe=rt;else for(;Oe!==null;){We=Oe;var _e=We.sibling,Gt=We.return;if(cx(We),We===Me){Oe=null;break}if(_e!==null){_e.return=Gt,Oe=_e;break}Oe=Gt}}}var Tt=w.alternate;if(Tt!==null){var ss=Tt.child;if(ss!==null){Tt.child=null;do{var sr=ss.sibling;ss.sibling=null,ss=sr}while(ss!==null)}}Oe=w}}if(w.subtreeFlags&2064&&_!==null)_.return=w,Oe=_;else e:for(;Oe!==null;){if(w=Oe,w.flags&2048)switch(w.tag){case 0:case 11:case 15:Ri(9,w,w.return)}var se=w.sibling;if(se!==null){se.return=w.return,Oe=se;break e}Oe=w.return}}var K=l.current;for(Oe=K;Oe!==null;){_=Oe;var ie=_.child;if(_.subtreeFlags&2064&&ie!==null)ie.return=_,Oe=ie;else e:for(_=K;Oe!==null;){if(U=Oe,U.flags&2048)try{switch(U.tag){case 0:case 11:case 15:Mu(9,U)}}catch(Xe){Qt(U,U.return,Xe)}if(U===_){Oe=null;break e}var Le=U.sibling;if(Le!==null){Le.return=U.return,Oe=Le;break e}Oe=U.return}}if(ft=y,yo(),Co&&typeof Co.onPostCommitFiberRoot=="function")try{Co.onPostCommitFiberRoot(ou,l)}catch{}v=!0}return v}finally{kt=p,un.transition=i}}return!1}function Ix(l,i,p){i=yl(p,i),i=W1(l,i,1),l=kr(l,i,1),i=Vn(),l!==null&&(Si(l,1,i),ns(l,i))}function Qt(l,i,p){if(l.tag===3)Ix(l,l,p);else for(;i!==null;){if(i.tag===3){Ix(i,l,p);break}else if(i.tag===1){var v=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Ir===null||!Ir.has(v))){l=yl(p,l),l=G1(i,l,1),i=kr(i,l,1),l=Vn(),i!==null&&(Si(i,1,l),ns(i,l));break}}i=i.return}}function z6(l,i,p){var v=l.pingCache;v!==null&&v.delete(i),i=Vn(),l.pingedLanes|=l.suspendedLanes&p,In===l&&(Ln&p)===p&&(Cn===4||Cn===3&&(Ln&130023424)===Ln&&500>wn()-im?ya(l,0):lm|=p),ns(l,i)}function Mx(l,i){i===0&&(l.mode&1?(i=nu,nu<<=1,!(nu&130023424)&&(nu=4194304)):i=1);var p=Vn();l=bo(l,i),l!==null&&(Si(l,i,p),ns(l,p))}function O6(l){var i=l.memoizedState,p=0;i!==null&&(p=i.retryLane),Mx(l,p)}function F6(l,i){var p=0;switch(l.tag){case 13:var v=l.stateNode,y=l.memoizedState;y!==null&&(p=y.retryLane);break;case 19:v=l.stateNode;break;default:throw Error(c(314))}v!==null&&v.delete(i),Mx(l,p)}var Ax;Ax=function(l,i,p){if(l!==null)if(l.memoizedProps!==i.pendingProps||Xn.current)es=!0;else{if(!(l.lanes&p)&&!(i.flags&128))return es=!1,M6(l,i,p);es=!!(l.flags&131072)}else es=!1,qt&&i.flags&1048576&&r1(i,lu,i.index);switch(i.lanes=0,i.tag){case 2:var v=i.type;Su(l,i),l=i.pendingProps;var y=dl(i,Nn.current);gl(i,p),y=Nh(null,i,v,l,y,p);var w=zh();return i.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Jn(v)?(w=!0,eu(i)):w=!1,i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,Ah(i),y.updater=mu,i.stateNode=y,y._reactInternals=i,Dh(i,v,l,p),i=Uh(null,i,v,!0,w,p)):(i.tag=0,qt&&w&&vh(i),Gn(null,i,y,p),i=i.child),i;case 16:v=i.elementType;e:{switch(Su(l,i),l=i.pendingProps,y=v._init,v=y(v._payload),i.type=v,y=i.tag=H6(v),l=oo(v,l),y){case 0:i=Gh(null,i,v,l,p);break e;case 1:i=ex(null,i,v,l,p);break e;case 11:i=Q1(null,i,v,l,p);break e;case 14:i=K1(null,i,v,oo(v.type,l),p);break e}throw Error(c(306,v,""))}return i;case 0:return v=i.type,y=i.pendingProps,y=i.elementType===v?y:oo(v,y),Gh(l,i,v,y,p);case 1:return v=i.type,y=i.pendingProps,y=i.elementType===v?y:oo(v,y),ex(l,i,v,y,p);case 3:e:{if(tx(i),l===null)throw Error(c(387));v=i.pendingProps,w=i.memoizedState,y=w.element,f1(l,i),hu(i,v,null,p);var _=i.memoizedState;if(v=_.element,ke&&w.isDehydrated)if(w={element:v,isDehydrated:!1,cache:_.cache,pendingSuspenseBoundaries:_.pendingSuspenseBoundaries,transitions:_.transitions},i.updateQueue.baseState=w,i.memoizedState=w,i.flags&256){y=yl(Error(c(423)),i),i=nx(l,i,v,p,y);break e}else if(v!==y){y=yl(Error(c(424)),i),i=nx(l,i,v,p,y);break e}else for(ke&&(_s=H4(i.stateNode.containerInfo),ds=i,qt=!0,so=null,wi=!1),p=b1(i,null,v,p),i.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(ml(),v===y){i=tr(l,i,p);break e}Gn(l,i,v,p)}i=i.child}return i;case 5:return j1(i),l===null&&bh(i),v=i.type,y=i.pendingProps,w=l!==null?l.memoizedProps:null,_=y.children,be(v,y)?_=null:w!==null&&be(v,w)&&(i.flags|=32),J1(l,i),Gn(l,i,_,p),i.child;case 6:return l===null&&bh(i),null;case 13:return sx(l,i,p);case 4:return Eh(i,i.stateNode.containerInfo),v=i.pendingProps,l===null?i.child=xl(i,null,v,p):Gn(l,i,v,p),i.child;case 11:return v=i.type,y=i.pendingProps,y=i.elementType===v?y:oo(v,y),Q1(l,i,v,y,p);case 7:return Gn(l,i,i.pendingProps,p),i.child;case 8:return Gn(l,i,i.pendingProps.children,p),i.child;case 12:return Gn(l,i,i.pendingProps.children,p),i.child;case 10:e:{if(v=i.type._context,y=i.pendingProps,w=i.memoizedProps,_=y.value,u1(i,v,_),w!==null)if(no(w.value,_)){if(w.children===y.children&&!Xn.current){i=tr(l,i,p);break e}}else for(w=i.child,w!==null&&(w.return=i);w!==null;){var U=w.dependencies;if(U!==null){_=w.child;for(var ae=U.firstContext;ae!==null;){if(ae.context===v){if(w.tag===1){ae=er(-1,p&-p),ae.tag=2;var Me=w.updateQueue;if(Me!==null){Me=Me.shared;var We=Me.pending;We===null?ae.next=ae:(ae.next=We.next,We.next=ae),Me.pending=ae}}w.lanes|=p,ae=w.alternate,ae!==null&&(ae.lanes|=p),Ih(w.return,p,i),U.lanes|=p;break}ae=ae.next}}else if(w.tag===10)_=w.type===i.type?null:w.child;else if(w.tag===18){if(_=w.return,_===null)throw Error(c(341));_.lanes|=p,U=_.alternate,U!==null&&(U.lanes|=p),Ih(_,p,i),_=w.sibling}else _=w.child;if(_!==null)_.return=w;else for(_=w;_!==null;){if(_===i){_=null;break}if(w=_.sibling,w!==null){w.return=_.return,_=w;break}_=_.return}w=_}Gn(l,i,y.children,p),i=i.child}return i;case 9:return y=i.type,v=i.pendingProps.children,gl(i,p),y=Ls(y),v=v(y),i.flags|=1,Gn(l,i,v,p),i.child;case 14:return v=i.type,y=oo(v,i.pendingProps),y=oo(v.type,y),K1(l,i,v,y,p);case 15:return Y1(l,i,i.type,i.pendingProps,p);case 17:return v=i.type,y=i.pendingProps,y=i.elementType===v?y:oo(v,y),Su(l,i),i.tag=1,Jn(v)?(l=!0,eu(i)):l=!1,gl(i,p),x1(i,v,y),Dh(i,v,y,p),Uh(null,i,v,!0,l,p);case 19:return rx(l,i,p);case 22:return X1(l,i,p)}throw Error(c(156,i.tag))};function Px(l,i){return mh(l,i)}function V6(l,i,p,v){this.tag=l,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ns(l,i,p,v){return new V6(l,i,p,v)}function gm(l){return l=l.prototype,!(!l||!l.isReactComponent)}function H6(l){if(typeof l=="function")return gm(l)?1:0;if(l!=null){if(l=l.$$typeof,l===S)return 11;if(l===k)return 14}return 2}function Dr(l,i){var p=l.alternate;return p===null?(p=Ns(l.tag,i,l.key,l.mode),p.elementType=l.elementType,p.type=l.type,p.stateNode=l.stateNode,p.alternate=l,l.alternate=p):(p.pendingProps=i,p.type=l.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=l.flags&14680064,p.childLanes=l.childLanes,p.lanes=l.lanes,p.child=l.child,p.memoizedProps=l.memoizedProps,p.memoizedState=l.memoizedState,p.updateQueue=l.updateQueue,i=l.dependencies,p.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},p.sibling=l.sibling,p.index=l.index,p.ref=l.ref,p}function Vu(l,i,p,v,y,w){var _=2;if(v=l,typeof l=="function")gm(l)&&(_=1);else if(typeof l=="string")_=5;else e:switch(l){case h:return Sa(p.children,y,w,i);case g:_=8,y|=8;break;case x:return l=Ns(12,p,i,y|2),l.elementType=x,l.lanes=w,l;case M:return l=Ns(13,p,i,y),l.elementType=M,l.lanes=w,l;case I:return l=Ns(19,p,i,y),l.elementType=I,l.lanes=w,l;case T:return Hu(p,y,w,i);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case C:_=10;break e;case j:_=9;break e;case S:_=11;break e;case k:_=14;break e;case D:_=16,v=null;break e}throw Error(c(130,l==null?l:typeof l,""))}return i=Ns(_,p,i,y),i.elementType=l,i.type=v,i.lanes=w,i}function Sa(l,i,p,v){return l=Ns(7,l,v,i),l.lanes=p,l}function Hu(l,i,p,v){return l=Ns(22,l,v,i),l.elementType=T,l.lanes=p,l.stateNode={isHidden:!1},l}function xm(l,i,p){return l=Ns(6,l,null,i),l.lanes=p,l}function vm(l,i,p){return i=Ns(4,l.children!==null?l.children:[],l.key,i),i.lanes=p,i.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},i}function $6(l,i,p,v,y){this.tag=i,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=oe,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=fh(0),this.expirationTimes=fh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fh(0),this.identifierPrefix=v,this.onRecoverableError=y,ke&&(this.mutableSourceEagerHydrationData=null)}function Dx(l,i,p,v,y,w,_,U,ae){return l=new $6(l,i,p,U,ae),i===1?(i=1,w===!0&&(i|=8)):i=0,w=Ns(3,null,null,i),l.current=w,w.stateNode=l,w.memoizedState={element:v,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ah(w),l}function Ex(l){if(!l)return Sr;l=l._reactInternals;e:{if(G(l)!==l||l.tag!==1)throw Error(c(170));var i=l;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Jn(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(c(171))}if(l.tag===1){var p=l.type;if(Jn(p))return J0(l,p,i)}return i}function _x(l){var i=l._reactInternals;if(i===void 0)throw typeof l.render=="function"?Error(c(188)):(l=Object.keys(l).join(","),Error(c(268,l)));return l=B(i),l===null?null:l.stateNode}function Lx(l,i){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var p=l.retryLane;l.retryLane=p!==0&&p<i?p:i}}function $u(l,i){Lx(l,i),(l=l.alternate)&&Lx(l,i)}function W6(l){return l=B(l),l===null?null:l.stateNode}function G6(){return null}return n.attemptContinuousHydration=function(l){if(l.tag===13){var i=bo(l,134217728);if(i!==null){var p=Vn();Bs(i,l,134217728,p)}$u(l,134217728)}},n.attemptDiscreteHydration=function(l){if(l.tag===13){var i=bo(l,1);if(i!==null){var p=Vn();Bs(i,l,1,p)}$u(l,1)}},n.attemptHydrationAtCurrentPriority=function(l){if(l.tag===13){var i=Ar(l),p=bo(l,i);if(p!==null){var v=Vn();Bs(p,l,i,v)}$u(l,i)}},n.attemptSynchronousHydration=function(l){switch(l.tag){case 3:var i=l.stateNode;if(i.current.memoizedState.isDehydrated){var p=ji(i.pendingLanes);p!==0&&(hh(i,p|1),ns(i,wn()),!(ft&6)&&(Sl(),yo()))}break;case 13:bx(function(){var v=bo(l,1);if(v!==null){var y=Vn();Bs(v,l,1,y)}}),$u(l,1)}},n.batchedUpdates=function(l,i){var p=ft;ft|=1;try{return l(i)}finally{ft=p,ft===0&&(Sl(),ru&&yo())}},n.createComponentSelector=function(l){return{$$typeof:Au,value:l}},n.createContainer=function(l,i,p,v,y,w,_){return Dx(l,i,!1,null,p,v,y,w,_)},n.createHasPseudoClassSelector=function(l){return{$$typeof:Pu,value:l}},n.createHydrationContainer=function(l,i,p,v,y,w,_,U,ae){return l=Dx(p,v,!0,l,y,w,_,U,ae),l.context=Ex(null),p=l.current,v=Vn(),y=Ar(p),w=er(v,y),w.callback=i??null,kr(p,w,y),l.current.lanes=y,Si(l,y,v),ns(l,v),l},n.createPortal=function(l,i,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:m,key:v==null?null:""+v,children:l,containerInfo:i,implementation:p}},n.createRoleSelector=function(l){return{$$typeof:Du,value:l}},n.createTestNameSelector=function(l){return{$$typeof:Eu,value:l}},n.createTextSelector=function(l){return{$$typeof:_u,value:l}},n.deferredUpdates=function(l){var i=kt,p=un.transition;try{return un.transition=null,kt=16,l()}finally{kt=i,un.transition=p}},n.discreteUpdates=function(l,i,p,v,y){var w=kt,_=un.transition;try{return un.transition=null,kt=1,l(i,p,v,y)}finally{kt=w,un.transition=_,ft===0&&Sl()}},n.findAllNodes=rm,n.findBoundingRects=function(l,i){if(!ne)throw Error(c(363));i=rm(l,i),l=[];for(var p=0;p<i.length;p++)l.push(xe(i[p]));for(i=l.length-1;0<i;i--){p=l[i];for(var v=p.x,y=v+p.width,w=p.y,_=w+p.height,U=i-1;0<=U;U--)if(i!==U){var ae=l[U],Me=ae.x,We=Me+ae.width,rt=ae.y,_e=rt+ae.height;if(v>=Me&&w>=rt&&y<=We&&_<=_e){l.splice(i,1);break}else if(v!==Me||p.width!==ae.width||_e<w||rt>_){if(!(w!==rt||p.height!==ae.height||We<v||Me>y)){Me>v&&(ae.width+=Me-v,ae.x=v),We<y&&(ae.width=y-Me),l.splice(i,1);break}}else{rt>w&&(ae.height+=rt-w,ae.y=w),_e<_&&(ae.height=_-rt),l.splice(i,1);break}}}return l},n.findHostInstance=_x,n.findHostInstanceWithNoPortals=function(l){return l=X(l),l=l!==null?V(l):null,l===null?null:l.stateNode},n.findHostInstanceWithWarning=function(l){return _x(l)},n.flushControlled=function(l){var i=ft;ft|=1;var p=un.transition,v=kt;try{un.transition=null,kt=1,l()}finally{kt=v,un.transition=p,ft=i,ft===0&&(Sl(),yo())}},n.flushPassiveEffects=ja,n.flushSync=bx,n.focusWithin=function(l,i){if(!ne)throw Error(c(363));for(l=nm(l),i=vx(l,i),i=Array.from(i),l=0;l<i.length;){var p=i[l++];if(!te(p)){if(p.tag===5&&Ue(p.stateNode))return!0;for(p=p.child;p!==null;)i.push(p),p=p.sibling}}return!1},n.getCurrentUpdatePriority=function(){return kt},n.getFindAllNodesFailureDescription=function(l,i){if(!ne)throw Error(c(363));var p=0,v=[];l=[nm(l),0];for(var y=0;y<l.length;){var w=l[y++],_=l[y++],U=i[_];if((w.tag!==5||!te(w))&&(sm(w,U)&&(v.push(om(U)),_++,_>p&&(p=_)),_<i.length))for(w=w.child;w!==null;)l.push(w,_),w=w.sibling}if(p<i.length){for(l=[];p<i.length;p++)l.push(om(i[p]));return`findAllNodes was able to match part of the selector:
  `+(v.join(" > ")+`

No matching component was found for:
  `)+l.join(" > ")}return null},n.getPublicRootInstance=function(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return me(l.child.stateNode);default:return l.child.stateNode}},n.injectIntoDevTools=function(l){if(l={bundleType:l.bundleType,version:l.version,rendererPackageName:l.rendererPackageName,rendererConfig:l.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:d.ReactCurrentDispatcher,findHostInstanceByFiber:W6,findFiberByHostInstance:l.findFiberByHostInstance||G6,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")l=!1;else{var i=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(i.isDisabled||!i.supportsFiber)l=!0;else{try{ou=i.inject(l),Co=i}catch{}l=!!i.checkDCE}}return l},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(l,i,p,v){if(!ne)throw Error(c(363));l=rm(l,i);var y=tt(l,p,v).disconnect;return{disconnect:function(){y()}}},n.registerMutableSourceForHydration=function(l,i){var p=i._getVersion;p=p(i._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[i,p]:l.mutableSourceEagerHydrationData.push(i,p)},n.runWithPriority=function(l,i){var p=kt;try{return kt=l,i()}finally{kt=p}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(l,i,p,v){var y=i.current,w=Vn(),_=Ar(y);return p=Ex(p),i.context===null?i.context=p:i.pendingContext=p,i=er(w,_),i.payload={element:l},v=v===void 0?null:v,v!==null&&(i.callback=v),l=kr(y,i,_),l!==null&&(Bs(l,y,_,w),fu(l,y,_)),_},n};S4.exports=RK;var BK=S4.exports;const NK=Xd(BK);var w4={exports:{}},cl={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */cl.ConcurrentRoot=1;cl.ContinuousEventPriority=4;cl.DefaultEventPriority=16;cl.DiscreteEventPriority=1;cl.IdleEventPriority=536870912;cl.LegacyRoot=0;w4.exports=cl;var k4=w4.exports;const aC={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let lC=!1,iC=!1;const G0=".react-konva-event",zK=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,OK=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,FK={};function oh(e,t,n=FK){if(!lC&&"zIndex"in t&&(console.warn(OK),lC=!0),!iC&&t.draggable){var o=t.x!==void 0||t.y!==void 0,r=t.onDragEnd||t.onDragMove;o&&!r&&(console.warn(zK),iC=!0)}for(var a in n)if(!aC[a]){var c=a.slice(0,2)==="on",d=n[a]!==t[a];if(c&&d){var f=a.substr(2).toLowerCase();f.substr(0,7)==="content"&&(f="content"+f.substr(7,1).toUpperCase()+f.substr(8)),e.off(f,n[a])}var m=!t.hasOwnProperty(a);m&&e.setAttr(a,void 0)}var h=t._useStrictMode,g={},x=!1;const C={};for(var a in t)if(!aC[a]){var c=a.slice(0,2)==="on",j=n[a]!==t[a];if(c&&j){var f=a.substr(2).toLowerCase();f.substr(0,7)==="content"&&(f="content"+f.substr(7,1).toUpperCase()+f.substr(8)),t[a]&&(C[f]=t[a])}!c&&(t[a]!==n[a]||h&&t[a]!==e.getAttr(a))&&(x=!0,g[a]=t[a])}x&&(e.setAttrs(g),ha(e));for(var f in C)e.on(f+G0,C[f])}function ha(e){if(!l9.Konva.autoDrawEnabled){var t=e.getLayer()||e.getStage();t&&t.batchDraw()}}const I4={},VK={};bc.Node.prototype._applyProps=oh;function HK(e,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}e.add(t),ha(e)}function $K(e,t,n){let o=bc[e];o||(console.error(`Konva has no node with the type ${e}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${e}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),o=bc.Group);const r={},a={};for(var c in t){var d=c.slice(0,2)==="on";d?a[c]=t[c]:r[c]=t[c]}const f=new o(r);return oh(f,a),f}function WK(e,t,n){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${e}"`)}function GK(e,t,n){return!1}function UK(e){return e}function ZK(){return null}function qK(){return null}function QK(e,t,n,o){return VK}function KK(){}function YK(e){}function XK(e,t){return!1}function JK(){return I4}function eY(){return I4}const tY=setTimeout,nY=clearTimeout,sY=-1;function oY(e,t){return!1}const rY=!1,aY=!0,lY=!0;function iY(e,t){t.parent===e?t.moveToTop():e.add(t),ha(e)}function cY(e,t){t.parent===e?t.moveToTop():e.add(t),ha(e)}function M4(e,t,n){t._remove(),e.add(t),t.setZIndex(n.getZIndex()),ha(e)}function uY(e,t,n){M4(e,t,n)}function dY(e,t){t.destroy(),t.off(G0),ha(e)}function fY(e,t){t.destroy(),t.off(G0),ha(e)}function hY(e,t,n){console.error(`Text components are not yet supported in ReactKonva. You text is: "${n}"`)}function mY(e,t,n){}function pY(e,t,n,o,r){oh(e,r,o)}function gY(e){e.hide(),ha(e)}function xY(e){}function vY(e,t){(t.visible==null||t.visible)&&e.show()}function CY(e,t){}function yY(e){}function bY(){}const jY=()=>k4.DefaultEventPriority,SY=Object.freeze(Object.defineProperty({__proto__:null,appendChild:iY,appendChildToContainer:cY,appendInitialChild:HK,cancelTimeout:nY,clearContainer:yY,commitMount:mY,commitTextUpdate:hY,commitUpdate:pY,createInstance:$K,createTextInstance:WK,detachDeletedInstance:bY,finalizeInitialChildren:GK,getChildHostContext:eY,getCurrentEventPriority:jY,getPublicInstance:UK,getRootHostContext:JK,hideInstance:gY,hideTextInstance:xY,idlePriority:md.unstable_IdlePriority,insertBefore:M4,insertInContainerBefore:uY,isPrimaryRenderer:rY,noTimeout:sY,now:md.unstable_now,prepareForCommit:ZK,preparePortalMount:qK,prepareUpdate:QK,removeChild:dY,removeChildFromContainer:fY,resetAfterCommit:KK,resetTextContent:YK,run:md.unstable_runWithPriority,scheduleTimeout:tY,shouldDeprioritizeSubtree:XK,shouldSetTextContent:oY,supportsMutation:lY,unhideInstance:vY,unhideTextInstance:CY,warnsIfNotActing:aY},Symbol.toStringTag,{value:"Module"}));var wY=Object.defineProperty,kY=Object.defineProperties,IY=Object.getOwnPropertyDescriptors,cC=Object.getOwnPropertySymbols,MY=Object.prototype.hasOwnProperty,AY=Object.prototype.propertyIsEnumerable,uC=(e,t,n)=>t in e?wY(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,dC=(e,t)=>{for(var n in t||(t={}))MY.call(t,n)&&uC(e,n,t[n]);if(cC)for(var n of cC(t))AY.call(t,n)&&uC(e,n,t[n]);return e},PY=(e,t)=>kY(e,IY(t));function A4(e,t,n){if(!e)return;if(n(e)===!0)return e;let o=t?e.return:e.child;for(;o;){const r=A4(o,t,n);if(r)return r;o=t?null:o.sibling}}function P4(e){try{return Object.defineProperties(e,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return e}}const U0=P4(u.createContext(null));class D4 extends u.Component{render(){return u.createElement(U0.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:fC,ReactCurrentDispatcher:hC}=u.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function DY(){const e=u.useContext(U0);if(e===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=u.useId();return u.useMemo(()=>{for(const o of[fC==null?void 0:fC.current,e,e==null?void 0:e.alternate]){if(!o)continue;const r=A4(o,!1,a=>{let c=a.memoizedState;for(;c;){if(c.memoizedState===t)return!0;c=c.next}});if(r)return r}},[e,t])}function EY(){var e;const t=DY(),[n]=u.useState(()=>new Map);n.clear();let o=t;for(;o;){if(o.type&&typeof o.type=="object"){const a=o.type._context===void 0&&o.type.Provider===o.type?o.type:o.type._context;a&&a!==U0&&!n.has(a)&&n.set(a,(e=hC==null?void 0:hC.current)==null?void 0:e.readContext(P4(a)))}o=o.return}return n}function _Y(){const e=EY();return u.useMemo(()=>Array.from(e.keys()).reduce((t,n)=>o=>u.createElement(t,null,u.createElement(n.Provider,PY(dC({},o),{value:e.get(n)}))),t=>u.createElement(D4,dC({},t))),[e])}function LY(e){const t=q.useRef({});return q.useLayoutEffect(()=>{t.current=e}),q.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const TY=e=>{const t=q.useRef(),n=q.useRef(),o=q.useRef(),r=LY(e),a=_Y(),c=d=>{const{forwardedRef:f}=e;f&&(typeof f=="function"?f(d):f.current=d)};return q.useLayoutEffect(()=>(n.current=new bc.Stage({width:e.width,height:e.height,container:t.current}),c(n.current),o.current=Xi.createContainer(n.current,k4.LegacyRoot,!1,null),Xi.updateContainer(q.createElement(a,{},e.children),o.current),()=>{bc.isBrowser&&(c(null),Xi.updateContainer(null,o.current,null),n.current.destroy())}),[]),q.useLayoutEffect(()=>{c(n.current),oh(n.current,e,r),Xi.updateContainer(q.createElement(a,{},e.children),o.current,null)}),q.createElement("div",{ref:t,id:e.id,accessKey:e.accessKey,className:e.className,role:e.role,style:e.style,tabIndex:e.tabIndex,title:e.title})},Ui="Layer",Vo="Group",Ho="Rect",Pa="Circle",Yd="Line",E4="Image",RY="Text",BY="Transformer",Xi=NK(SY);Xi.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:q.version,rendererPackageName:"react-konva"});const NY=q.forwardRef((e,t)=>q.createElement(D4,{},q.createElement(TY,{...e,forwardedRef:t}))),zY=Ve(js,e=>{const{boundingBoxCoordinates:t,boundingBoxDimensions:n,stageDimensions:o,stageCoordinates:r}=e;return{boundingBoxCoordinates:t,boundingBoxDimensions:n,stageCoordinates:r,stageDimensions:o}}),OY=()=>{const{boundingBoxCoordinates:e,boundingBoxDimensions:t,stageCoordinates:n,stageDimensions:o}=b(zY),r=b(c=>c.canvas.shouldDarkenOutsideBoundingBox),a=b(c=>c.canvas.stageScale);return s.jsxs(Vo,{listening:!1,children:[s.jsx(Ho,{offsetX:n.x/a,offsetY:n.y/a,height:o.height/a,width:o.width/a,fill:"rgba(0,0,0,0.4)",listening:!1,visible:r}),s.jsx(Ho,{x:e.x,y:e.y,width:t.width,height:t.height,fill:"rgb(255,255,255)",listening:!1,visible:r,globalCompositeOperation:"destination-out"})]})},FY=u.memo(OY),VY=Ve(js,e=>({stageCoordinates:e.stageCoordinates,stageDimensions:e.stageDimensions})),mC=lb(27),pC=lb(18),HY=()=>{const{stageCoordinates:e,stageDimensions:t}=b(VY),n=b(c=>c.canvas.stageScale),o=u.useMemo(()=>n>=2?8:n>=1&&n<2?16:n>=.5&&n<1?32:64,[n]),r=u.useCallback(c=>c/n,[n]),a=u.useMemo(()=>{const{width:c,height:d}=t,{x:f,y:m}=e,h={x1:0,y1:0,x2:c,y2:d,offset:{x:r(f),y:r(m)}},g={x:Math.ceil(r(f)/o)*o,y:Math.ceil(r(m)/o)*o},x={x1:-g.x,y1:-g.y,x2:r(c)-g.x+o,y2:r(d)-g.y+o},C={x1:Math.min(h.x1,x.x1),y1:Math.min(h.y1,x.y1),x2:Math.max(h.x2,x.x2),y2:Math.max(h.y2,x.y2)},j=C.x2-C.x1,S=C.y2-C.y1,M=Math.round(j/o)+1,I=Math.round(S/o)+1,k=r(1),D=new Array(M+I);let T=0,E=0;for(let A=0;A<M;A++)T=C.x1+A*o,D.push(s.jsx(Yd,{x:T,y:C.y1,points:[0,0,0,S],stroke:T%64?pC:mC,strokeWidth:k,listening:!1},`x_${A}`));for(let A=0;A<I;A++)E=C.y1+A*o,D.push(s.jsx(Yd,{x:C.x1,y:E,points:[0,0,j,0],stroke:E%64?pC:mC,strokeWidth:k,listening:!1},`y_${A}`));return D},[t,e,r,o]);return s.jsx(Vo,{listening:!1,children:a})},$Y=u.memo(HY),WY=Ve([ni,js],(e,t)=>{const{denoiseProgress:n}=e,{batchIds:o}=t;return{progressImage:n&&o.includes(n.batch_id)?n.progress_image:void 0,boundingBox:t.layerState.stagingArea.boundingBox}}),GY=()=>{const{progressImage:e,boundingBox:t}=b(WY),[n,o]=u.useState(null);return u.useEffect(()=>{if(!e)return;const r=new Image;r.onload=()=>{o(r)},r.src=e.dataURL},[e]),!(e&&t)||!n?null:s.jsx(E4,{x:t.x,y:t.y,width:t.width,height:t.height,image:n,listening:!1})},UY=u.memo(GY),Wl=e=>{const{r:t,g:n,b:o,a:r}=e;return`rgba(${t}, ${n}, ${o}, ${r})`},gC=e=>`data:image/svg+xml;utf8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
  <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
  <svg width="60px" height="60px" viewBox="0 0 30 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;">
  <g transform="matrix(0.5,0,0,0.5,0,0)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,2.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,7.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,10)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,12.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,15)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,17.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,20)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,22.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,25)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,27.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,30)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-2.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-7.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-10)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-12.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-15)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-17.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-20)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-22.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-25)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-27.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-30)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
</svg>`.replaceAll("black",e),ZY=Ve(js,e=>({stageCoordinates:e.stageCoordinates,stageDimensions:e.stageDimensions})),qY=e=>{const{...t}=e,{stageCoordinates:n,stageDimensions:o}=b(ZY),r=b(C=>C.canvas.stageScale),a=b(C=>Wl(C.canvas.maskColor)),[c,d]=u.useState(null),[f,m]=u.useState(0),h=u.useRef(null),g=u.useCallback(()=>{m(f+1),setTimeout(g,500)},[f]);u.useEffect(()=>{if(c)return;const C=new Image;C.onload=()=>{d(C)},C.src=gC(a)},[c,a]),u.useEffect(()=>{c&&(c.src=gC(a))},[c,a]),u.useEffect(()=>{const C=setInterval(()=>m(j=>(j+1)%5),50);return()=>clearInterval(C)},[]);const x=u.useMemo(()=>({x:1/r,y:1/r}),[r]);return!c||!kl(n.x)||!kl(n.y)||!kl(r)||!kl(o.width)||!kl(o.height)?null:s.jsx(Ho,{ref:h,offsetX:n.x/r,offsetY:n.y/r,height:o.height/r,width:o.width/r,fillPatternImage:c,fillPatternOffsetY:kl(f)?f:0,fillPatternRepeat:"repeat",fillPatternScale:x,listening:!0,globalCompositeOperation:"source-in",...t})},QY=u.memo(qY),KY=e=>{const t=b(n=>n.canvas.layerState.objects);return s.jsx(Vo,{listening:!1,...e,children:t.filter(i9).map((n,o)=>s.jsx(Yd,{points:n.points,stroke:"rgb(0,0,0)",strokeWidth:n.strokeWidth*2,tension:0,lineCap:"round",lineJoin:"round",shadowForStrokeEnabled:!1,listening:!1,globalCompositeOperation:n.tool==="brush"?"source-over":"destination-out"},o))})},YY=u.memo(KY);var Da=u,XY=function(t,n,o){const r=Da.useRef("loading"),a=Da.useRef(),[c,d]=Da.useState(0),f=Da.useRef(),m=Da.useRef(),h=Da.useRef();return(f.current!==t||m.current!==n||h.current!==o)&&(r.current="loading",a.current=void 0,f.current=t,m.current=n,h.current=o),Da.useLayoutEffect(function(){if(!t)return;var g=document.createElement("img");function x(){r.current="loaded",a.current=g,d(Math.random())}function C(){r.current="failed",a.current=void 0,d(Math.random())}return g.addEventListener("load",x),g.addEventListener("error",C),n&&(g.crossOrigin=n),o&&(g.referrerPolicy=o),g.src=t,function(){g.removeEventListener("load",x),g.removeEventListener("error",C)}},[t,n,o]),[a.current,r.current]};const JY=Xd(XY),eX=({canvasImage:e})=>{const[t,n]=pf("colors",["base.500","base.900"]),{t:o}=L();return s.jsxs(Vo,{listening:!1,children:[s.jsx(Ho,{x:e.x,y:e.y,width:e.width,height:e.height,fill:t,listening:!1}),s.jsx(RY,{x:e.x,y:e.y,width:e.width,height:e.height,align:"center",verticalAlign:"middle",fontFamily:'"Inter Variable", sans-serif',fontSize:e.width/16,fontStyle:"600",text:o("common.imageFailedToLoad"),fill:n,listening:!1})]})},tX=u.memo(eX),nX=e=>{const{x:t,y:n,imageName:o}=e.canvasImage,{currentData:r,isError:a}=Gs(o??Ot),[c,d]=JY((r==null?void 0:r.image_url)??"",rg.get()?"use-credentials":"anonymous");return a||d==="failed"?s.jsx(tX,{canvasImage:e.canvasImage}):s.jsx(E4,{x:t,y:n,image:c,listening:!1})},_4=u.memo(nX),sX=()=>{const e=b(t=>t.canvas.layerState.objects);return s.jsx(Vo,{name:"outpainting-objects",listening:!1,children:e.map((t,n)=>{if(c9(t))return s.jsx(_4,{canvasImage:t},n);if(u9(t)){const o=s.jsx(Yd,{points:t.points,stroke:t.color?Wl(t.color):"rgb(0,0,0)",strokeWidth:t.strokeWidth*2,tension:0,lineCap:"round",lineJoin:"round",shadowForStrokeEnabled:!1,listening:!1,globalCompositeOperation:t.tool==="brush"?"source-over":"destination-out"},n);return t.clip?s.jsx(Vo,{clipX:t.clip.x,clipY:t.clip.y,clipWidth:t.clip.width,clipHeight:t.clip.height,listening:!1,children:o},n):o}else{if(d9(t))return s.jsx(Ho,{x:t.x,y:t.y,width:t.width,height:t.height,fill:Wl(t.color),listening:!1},n);if(f9(t))return s.jsx(Ho,{x:t.x,y:t.y,width:t.width,height:t.height,fill:"rgb(255, 255, 255)",globalCompositeOperation:"destination-out",listening:!1},n)}})})},oX=u.memo(sX),rX=[4,4],aX=Ve(js,e=>{const{layerState:t,shouldShowStagingImage:n,shouldShowStagingOutline:o,boundingBoxCoordinates:r,boundingBoxDimensions:a}=e,{selectedImageIndex:c,images:d,boundingBox:f}=t.stagingArea;return{currentStagingAreaImage:d.length>0&&c!==void 0?d[c]:void 0,isOnFirstImage:c===0,isOnLastImage:c===d.length-1,shouldShowStagingImage:n,shouldShowStagingOutline:o,x:(f==null?void 0:f.x)??r.x,y:(f==null?void 0:f.y)??r.y,width:(f==null?void 0:f.width)??a.width,height:(f==null?void 0:f.height)??a.height}}),lX=e=>{const{currentStagingAreaImage:t,shouldShowStagingImage:n,shouldShowStagingOutline:o,x:r,y:a,width:c,height:d}=b(aX);return s.jsxs(Vo,{...e,children:[n&&t&&s.jsx(_4,{canvasImage:t}),o&&s.jsxs(Vo,{listening:!1,children:[s.jsx(Ho,{x:r,y:a,width:c,height:d,strokeWidth:1,stroke:"white",strokeScaleEnabled:!1,listening:!1}),s.jsx(Ho,{x:r,y:a,width:c,height:d,dash:rX,strokeWidth:1,stroke:"black",strokeScaleEnabled:!1,listening:!1})]})]})},iX=u.memo(lX),cX=Ve(js,e=>{const{layerState:{stagingArea:{images:t,selectedImageIndex:n}},shouldShowStagingOutline:o,shouldShowStagingImage:r}=e;return{currentIndex:n,total:t.length,currentStagingAreaImage:t.length>0?t[n]:void 0,shouldShowStagingImage:r,shouldShowStagingOutline:o}}),uX=()=>{const e=O(),{t}=L(),n=u.useCallback(()=>{e(ib())},[e]),o=u.useCallback(()=>{e(v9())},[e]);return s.jsxs(s.Fragment,{children:[s.jsx(ve,{tooltip:`${t("unifiedCanvas.discardCurrent")}`,"aria-label":t("unifiedCanvas.discardCurrent"),icon:s.jsx($n,{}),onClick:o,colorScheme:"invokeBlue",fontSize:16}),s.jsx(ve,{tooltip:`${t("unifiedCanvas.discardAll")} (Esc)`,"aria-label":t("unifiedCanvas.discardAll"),icon:s.jsx(Xs,{}),onClick:n,colorScheme:"error",fontSize:16})]})},dX=()=>{const e=O(),{currentStagingAreaImage:t,shouldShowStagingImage:n,currentIndex:o,total:r}=b(cX),{t:a}=L(),c=u.useCallback(()=>{e(n2(!0))},[e]),d=u.useCallback(()=>{e(n2(!1))},[e]),f=u.useCallback(()=>e(h9()),[e]),m=u.useCallback(()=>e(m9()),[e]),h=u.useCallback(()=>e(p9()),[e]);Re(["left"],f,{enabled:()=>!0,preventDefault:!0}),Re(["right"],m,{enabled:()=>!0,preventDefault:!0}),Re(["enter"],h,{enabled:()=>!0,preventDefault:!0}),Re(["esc"],()=>{j()},{preventDefault:!0});const{data:g}=Gs((t==null?void 0:t.imageName)??Ot),x=u.useCallback(()=>{e(g9(!n))},[e,n]),C=u.useCallback(()=>{g&&e(x9({imageDTO:g}))},[e,g]);Re(["shift+s"],()=>{n&&C()},{preventDefault:!0},[n,C]);const j=u.useCallback(()=>{e(ib())},[e]);return t?s.jsxs(P,{pos:"absolute",bottom:4,gap:2,w:"100%",align:"center",justify:"center",onMouseEnter:c,onMouseLeave:d,children:[s.jsxs(Nt,{borderRadius:"base",shadow:"dark-lg",children:[s.jsx(ve,{tooltip:`${a("unifiedCanvas.previous")} (Left)`,"aria-label":`${a("unifiedCanvas.previous")} (Left)`,icon:s.jsx(fD,{}),onClick:f,colorScheme:"invokeBlue",isDisabled:!n}),s.jsx(qe,{colorScheme:"base",pointerEvents:"none",isDisabled:!n,minW:20,children:`${o+1}/${r}`}),s.jsx(ve,{tooltip:`${a("unifiedCanvas.next")} (Right)`,"aria-label":`${a("unifiedCanvas.next")} (Right)`,icon:s.jsx(hD,{}),onClick:m,colorScheme:"invokeBlue",isDisabled:!n})]}),s.jsxs(Nt,{borderRadius:"base",shadow:"dark-lg",children:[s.jsx(ve,{tooltip:`${a("unifiedCanvas.accept")} (Enter)`,"aria-label":`${a("unifiedCanvas.accept")} (Enter)`,icon:s.jsx(_c,{}),onClick:h,colorScheme:"invokeBlue"}),s.jsx(ve,{tooltip:a(n?"unifiedCanvas.showResultsOn":"unifiedCanvas.showResultsOff"),"aria-label":a(n?"unifiedCanvas.showResultsOn":"unifiedCanvas.showResultsOff"),"data-alert":!n,icon:n?s.jsx(Wb,{}):s.jsx(wD,{}),onClick:x,colorScheme:"invokeBlue"}),s.jsx(ve,{tooltip:`${a("unifiedCanvas.saveToGallery")} (Shift+S)`,"aria-label":a("unifiedCanvas.saveToGallery"),isDisabled:!g||!g.is_intermediate,icon:s.jsx(Tc,{}),onClick:C,colorScheme:"invokeBlue"}),s.jsx(uX,{})]})]}):null},fX=u.memo(dX),Bl=e=>Math.round(e*100)/100,hX=()=>{const e=b(d=>d.canvas.layerState),t=b(d=>d.canvas.boundingBoxCoordinates),n=b(d=>d.canvas.boundingBoxDimensions),o=b(d=>d.canvas.isMaskEnabled),r=b(d=>d.canvas.shouldPreserveMaskedArea),[a,c]=u.useState();return u.useEffect(()=>{c(void 0)},[e,t,n,o,r]),pH(async()=>{const d=await C9(e,t,n,o,r);if(!d)return;const{baseImageData:f,maskImageData:m}=d,h=y9(f,m);c(h)},1e3,[e,t,n,o,r]),a},mX=()=>{const e=hX(),{t}=L(),n=u.useMemo(()=>({txt2img:t("common.txt2img"),img2img:t("common.img2img"),inpaint:t("common.inpaint"),outpaint:t("common.outpaint")}),[t]);return s.jsxs(Ae,{children:[t("accessibility.mode"),": ",e?n[e]:"..."]})},pX=u.memo(mX),gX=()=>{const{t:e}=L(),t=yt(jg),n=u.useMemo(()=>{const o=(t==null?void 0:t.x)??-1,r=(t==null?void 0:t.y)??-1;return`(${Bl(o)}, ${Bl(r)})`},[t==null?void 0:t.x,t==null?void 0:t.y]);return s.jsx(Ae,{children:`${e("unifiedCanvas.cursorPosition")}: ${n}`})},xX=u.memo(gX),Wp="var(--invoke-colors-warning-500)",vX=Ve(js,e=>{const{stageDimensions:{width:t,height:n},stageCoordinates:{x:o,y:r},boundingBoxDimensions:{width:a,height:c},scaledBoundingBoxDimensions:{width:d,height:f},boundingBoxCoordinates:{x:m,y:h},stageScale:g,shouldShowCanvasDebugInfo:x,layer:C,boundingBoxScaleMethod:j,shouldPreserveMaskedArea:S}=e;let M="inherit";return(j==="none"&&(a<512||c<512)||j==="manual"&&d*f<512*512)&&(M=Wp),{activeLayerColor:C==="mask"?Wp:"inherit",layer:C,boundingBoxColor:M,boundingBoxCoordinatesString:`(${Bl(m)}, ${Bl(h)})`,boundingBoxDimensionsString:`${a}×${c}`,scaledBoundingBoxDimensionsString:`${d}×${f}`,canvasCoordinatesString:`${Bl(o)}×${Bl(r)}`,canvasDimensionsString:`${t}×${n}`,canvasScaleString:Math.round(g*100),shouldShowCanvasDebugInfo:x,shouldShowBoundingBox:j!=="auto",shouldShowScaledBoundingBox:j!=="none",shouldPreserveMaskedArea:S}}),CX=()=>{const{activeLayerColor:e,layer:t,boundingBoxColor:n,boundingBoxCoordinatesString:o,boundingBoxDimensionsString:r,scaledBoundingBoxDimensionsString:a,shouldShowScaledBoundingBox:c,canvasCoordinatesString:d,canvasDimensionsString:f,canvasScaleString:m,shouldShowCanvasDebugInfo:h,shouldShowBoundingBox:g,shouldPreserveMaskedArea:x}=b(vX),{t:C}=L();return s.jsxs(P,{flexDirection:"column",position:"absolute",top:0,insetInlineStart:0,opacity:.65,display:"flex",fontSize:"sm",padding:1,px:2,minWidth:48,margin:1,borderRadius:"base",pointerEvents:"none",bg:"base.800",children:[s.jsx(pX,{}),s.jsx(Ae,{color:e,children:`${C("unifiedCanvas.activeLayer")}: ${C(`unifiedCanvas.${t}`)}`}),s.jsx(Ae,{children:`${C("unifiedCanvas.canvasScale")}: ${m}%`}),x&&s.jsxs(Ae,{color:Wp,children:[C("unifiedCanvas.preserveMaskedArea"),": ",C("common.on")]}),g&&s.jsx(Ae,{color:n,children:`${C("unifiedCanvas.boundingBox")}: ${r}`}),c&&s.jsx(Ae,{color:n,children:`${C("unifiedCanvas.scaledBoundingBox")}: ${a}`}),h&&s.jsxs(s.Fragment,{children:[s.jsx(Ae,{children:`${C("unifiedCanvas.boundingBoxPosition")}: ${o}`}),s.jsx(Ae,{children:`${C("unifiedCanvas.canvasDimensions")}: ${f}`}),s.jsx(Ae,{children:`${C("unifiedCanvas.canvasPosition")}: ${d}`}),s.jsx(xX,{})]})]})},yX=u.memo(CX),bX=[4,4],jX=e=>{const{...t}=e,n=O(),o=b(ye=>ye.canvas.boundingBoxCoordinates),r=b(ye=>ye.canvas.boundingBoxDimensions),a=b(ye=>ye.canvas.stageScale),c=b(ye=>ye.canvas.shouldSnapToGrid),d=b(ye=>20/ye.canvas.stageScale),f=b(ye=>ye.canvas.aspectRatio),m=b(ls),h=u.useRef(null),g=u.useRef(null),x=fg(),C=yt(dn),j=yt(cc),S=yt(Fr),M=yt(El),I=yt(Hi);u.useEffect(()=>{var ye;!h.current||!g.current||(h.current.nodes([g.current]),(ye=h.current.getLayer())==null||ye.batchDraw())},[]);const k=u.useMemo(()=>x?b9:j9,[x]),D=u.useMemo(()=>k*a,[k,a]);Re("N",()=>{n(Id(!c))},[c]);const T=u.useCallback(ye=>{if(!c){n(ym({x:Math.floor(ye.target.x()),y:Math.floor(ye.target.y())}));return}const de=ye.target.x(),He=ye.target.y(),Be=kd(de,k),ce=kd(He,k);ye.target.x(Be),ye.target.y(ce),n(ym({x:Be,y:ce}))},[n,k,c]),E=u.useCallback(ye=>{if(!g.current)return;const de=g.current,He=de.scaleX(),Be=de.scaleY(),ce=Math.round(de.width()*He),ue=Math.round(de.height()*Be),je=Math.round(de.x()),be=Math.round(de.y());if(f.isLocked){const ee=Ji(f.value,ce*ue);n(lc({width:Qu(ee.width,k),height:Qu(ee.height,k)},m))}else n(lc({width:Qu(ce,k),height:Qu(ue,k)},m)),n(Wy({isLocked:!1,id:"Free",value:ce/ue}));n(ym({x:c?Ku(je,k):je,y:c?Ku(be,k):be})),de.scaleX(1),de.scaleY(1)},[f.isLocked,f.value,n,c,k,m]),A=u.useCallback((ye,de,He)=>{const Be=ye.x%D,ce=ye.y%D;return{x:Ku(de.x,D)+Be,y:Ku(de.y,D)+ce}},[D]),N=u.useCallback(()=>{El.set(!0)},[]),W=u.useCallback(()=>{El.set(!1),Fr.set(!1),Qi.set(!1),Hi.set(!1)},[]),G=u.useCallback(()=>{Fr.set(!0)},[]),z=u.useCallback(()=>{El.set(!1),Fr.set(!1),Qi.set(!1),Hi.set(!1)},[]),X=u.useCallback(()=>{Hi.set(!0)},[]),B=u.useCallback(()=>{!M&&!S&&Hi.set(!1)},[S,M]),Q=u.useCallback(()=>{Qi.set(!0)},[]),V=u.useCallback(()=>{Qi.set(!1)},[]),H=u.useMemo(()=>I||S||M?"rgba(255,255,255,0.5)":"white",[I,S,M]),me=u.useMemo(()=>I||S||M?6/a:1/a,[I,S,M,a]),Ie=u.useMemo(()=>{if(C!=="move")return wX;if(f.isLocked)return["bottom-right"]},[f.isLocked,C]);return s.jsxs(Vo,{...t,children:[s.jsx(Ho,{height:r.height,width:r.width,x:o.x,y:o.y,onMouseEnter:Q,onMouseOver:Q,onMouseLeave:V,onMouseOut:V}),s.jsx(Ho,{draggable:!0,fillEnabled:!1,height:r.height,hitStrokeWidth:d,listening:!j&&C==="move",onDragStart:G,onDragEnd:z,onDragMove:T,onMouseDown:G,onMouseOut:B,onMouseOver:X,onMouseEnter:X,onMouseUp:z,onTransform:E,onTransformEnd:W,ref:g,stroke:H,strokeWidth:me,width:r.width,x:o.x,y:o.y}),s.jsx(BY,{anchorCornerRadius:3,anchorDragBoundFunc:A,anchorFill:"rgba(212,216,234,1)",anchorSize:15,anchorStroke:"rgb(42,42,42)",borderDash:bX,borderEnabled:!0,borderStroke:"black",draggable:!1,enabledAnchors:Ie,flipEnabled:!1,ignoreStroke:!0,keepRatio:!1,listening:!j&&C==="move",onDragStart:G,onDragEnd:z,onMouseDown:N,onMouseUp:W,onTransformEnd:W,ref:h,rotateEnabled:!1,shiftBehavior:"none"})]})},SX=u.memo(jX),wX=[],kX=Ve(js,e=>{const{stageDimensions:t,boundingBoxCoordinates:n,boundingBoxDimensions:o,shouldRestrictStrokesToBox:r}=e;return{clip:r?{clipX:n.x,clipY:n.y,clipWidth:o.width,clipHeight:o.height}:{},stageDimensions:t}}),IX=e=>{const t=b(D=>D.canvas.brushSize/2),n=b(D=>Wl({...D.canvas.maskColor,a:.5})),o=yt(dn),r=b(D=>D.canvas.layer),a=b(D=>1.5/D.canvas.stageScale),c=b(D=>1.5/D.canvas.stageScale),d=b(D=>Wl(D.canvas.brushColor)),f=b(D=>Wl(D.canvas.colorPickerColor)),m=b(D=>(s2-bm+1)/D.canvas.stageScale),h=b(D=>s2/D.canvas.stageScale),{clip:g,stageDimensions:x}=b(kX),C=yt(jg),j=yt(Fr),S=yt(El),M=u.useMemo(()=>C?C.x:x.width/2,[C,x]),I=u.useMemo(()=>C?C.y:x.height/2,[C,x]);return u.useMemo(()=>!(j||S||!C),[C,j,S])?s.jsxs(Vo,{listening:!1,...g,...e,children:[o==="colorPicker"?s.jsxs(s.Fragment,{children:[s.jsx(Pa,{x:M,y:I,radius:h,stroke:d,strokeWidth:bm,strokeScaleEnabled:!1,listening:!1}),s.jsx(Pa,{x:M,y:I,radius:m,stroke:f,strokeWidth:bm,strokeScaleEnabled:!1,listening:!1})]}):s.jsxs(s.Fragment,{children:[s.jsx(Pa,{x:M,y:I,radius:t,fill:r==="mask"?n:d,globalCompositeOperation:o==="eraser"?"destination-out":"source-out",listening:!1}),s.jsx(Pa,{x:M,y:I,radius:t,stroke:"rgba(255,255,255,0.4)",strokeWidth:c*2,strokeEnabled:!0,listening:!1}),s.jsx(Pa,{x:M,y:I,radius:t,stroke:"rgba(0,0,0,1)",strokeWidth:c,strokeEnabled:!0,listening:!1})]}),s.jsx(Pa,{x:M,y:I,radius:a*2,fill:"rgba(255,255,255,0.4)",listening:!1}),s.jsx(Pa,{x:M,y:I,radius:a,fill:"rgba(0,0,0,1)",listening:!1})]}):null},MX=u.memo(IX),AX=Ve(js,e=>({stageCoordinates:e.stageCoordinates,stageDimensions:e.stageDimensions})),PX=hg(NY,{shouldForwardProp:e=>!["sx"].includes(e)}),DX=()=>{const e=b(ws),t=b(de=>de.canvas.isMaskEnabled),n=b(de=>de.canvas.shouldShowBoundingBox),o=b(de=>de.canvas.shouldShowGrid),r=b(de=>de.canvas.stageScale),a=b(de=>de.canvas.shouldShowIntermediates),c=b(de=>de.canvas.shouldAntialias),d=b(de=>de.canvas.shouldRestrictStrokesToBox),{stageCoordinates:f,stageDimensions:m}=b(AX),h=O(),g=u.useRef(null),x=u.useRef(null),C=u.useRef(null),j=yt(S9),S=yt(ic),M=yt(El),I=yt(Qi),k=yt(dn);AK();const D=u.useCallback(de=>{Md.set(de),x.current=de},[]),T=u.useMemo(()=>k==="move"||e?S?"grabbing":"grab":M?void 0:d&&!I?"default":"none",[I,S,e,M,d,k]),E=u.useCallback(de=>{bg.set(de),C.current=de},[]),A=u.useRef({x:0,y:0}),N=u.useRef(!1),W=LK(x),G=PK(x),z=_K(x,N),X=DK(x,N,A),{handleDragStart:B,handleDragMove:Q,handleDragEnd:V}=IK(),H=EK(),me=u.useCallback(de=>de.evt.preventDefault(),[]);u.useEffect(()=>{if(!g.current)return;const de=new ResizeObserver(()=>{if(!g.current)return;const{width:ce,height:ue}=g.current.getBoundingClientRect();h(o2({width:ce,height:ue}))});de.observe(g.current);const{width:He,height:Be}=g.current.getBoundingClientRect();return h(o2({width:He,height:Be})),()=>{de.disconnect()}},[h]);const Ie=u.useMemo(()=>({outline:"none",overflow:"hidden",cursor:T||void 0,canvas:{outline:"none"}}),[T]),ye=u.useMemo(()=>({x:r,y:r}),[r]);return s.jsxs(P,{id:"canvas-container",ref:g,position:"relative",height:"100%",width:"100%",borderRadius:"base",children:[s.jsx(Ae,{position:"absolute",children:s.jsxs(PX,{tabIndex:-1,ref:D,sx:Ie,x:f.x,y:f.y,width:m.width,height:m.height,scale:ye,onTouchStart:G,onTouchMove:X,onTouchEnd:z,onMouseDown:G,onMouseLeave:H,onMouseMove:X,onMouseUp:z,onDragStart:B,onDragMove:Q,onDragEnd:V,onContextMenu:me,onWheel:W,draggable:(k==="move"||e)&&!j,children:[s.jsx(Ui,{id:"grid",visible:o,listening:!1,children:s.jsx($Y,{})}),s.jsx(Ui,{id:"base",ref:E,listening:!1,imageSmoothingEnabled:c,children:s.jsx(oX,{})}),s.jsxs(Ui,{id:"mask",visible:t&&!e,listening:!1,children:[s.jsx(YY,{visible:!0,listening:!1}),s.jsx(QY,{listening:!1})]}),s.jsx(Ui,{listening:!1,children:s.jsx(FY,{})}),s.jsxs(Ui,{id:"preview",imageSmoothingEnabled:c,children:[!e&&s.jsx(MX,{visible:k!=="move",listening:!1}),s.jsx(iX,{listening:!1,visible:e}),a&&s.jsx(UY,{}),s.jsx(SX,{visible:n&&!e})]})]})}),s.jsx(yX,{}),s.jsx(fX,{})]})},EX=u.memo(DX);function _X({onSingleClick:e,onDoubleClick:t,latency:n=250}){const[o,r]=u.useState(0);return u.useEffect(()=>{const c=setTimeout(()=>{o===1&&e(),r(0)},n);return o===2&&t(),()=>clearTimeout(c)},[o,t,n,e]),u.useCallback(()=>r(c=>c+1),[])}const tp={width:6,height:6,borderColor:"base.100"},LX={".react-colorful__hue-pointer":tp,".react-colorful__saturation-pointer":tp,".react-colorful__alpha-pointer":tp,gap:5,flexDir:"column"},TX={width:"100%"},ud="4.2rem",RX=e=>{const{color:t,onChange:n,withNumberInput:o,...r}=e,{t:a}=L(),c=u.useCallback(h=>n({...t,r:h}),[t,n]),d=u.useCallback(h=>n({...t,g:h}),[t,n]),f=u.useCallback(h=>n({...t,b:h}),[t,n]),m=u.useCallback(h=>n({...t,a:h}),[t,n]);return s.jsxs(P,{sx:LX,children:[s.jsx(_w,{color:t,onChange:n,style:TX,...r}),o&&s.jsxs(P,{gap:5,children:[s.jsxs($,{gap:0,children:[s.jsx(Y,{children:a("common.red")}),s.jsx(Ee,{value:t.r,onChange:c,min:0,max:255,step:1,w:ud,defaultValue:90})]}),s.jsxs($,{gap:0,children:[s.jsx(Y,{children:a("common.green")}),s.jsx(Ee,{value:t.g,onChange:d,min:0,max:255,step:1,w:ud,defaultValue:90})]}),s.jsxs($,{gap:0,children:[s.jsx(Y,{children:a("common.blue")}),s.jsx(Ee,{value:t.b,onChange:f,min:0,max:255,step:1,w:ud,defaultValue:255})]}),s.jsxs($,{gap:0,children:[s.jsx(Y,{children:a("common.alpha")}),s.jsx(Ee,{value:t.a,onChange:m,step:.1,min:0,max:1,w:ud,defaultValue:1})]})]})]})},L4=u.memo(RX),BX={flexGrow:1},NX=()=>{const e=O(),{t}=L(),n=b(C=>C.canvas.layer),o=b(C=>C.canvas.maskColor),r=b(C=>C.canvas.isMaskEnabled),a=b(C=>C.canvas.shouldPreserveMaskedArea),c=b(ws);Re(["q"],()=>{d()},{enabled:()=>!c,preventDefault:!0},[n]),Re(["shift+c"],()=>{f()},{enabled:()=>!c,preventDefault:!0},[]),Re(["h"],()=>{m()},{enabled:()=>!c,preventDefault:!0},[r]);const d=u.useCallback(()=>{e(cb(n==="mask"?"base":"mask"))},[e,n]),f=u.useCallback(()=>{e(rb())},[e]),m=u.useCallback(()=>{e(yg(!r))},[e,r]),h=u.useCallback(async()=>{e(w9())},[e]),g=u.useCallback(C=>{e(k9(C.target.checked))},[e]),x=u.useCallback(C=>{e(I9(C))},[e]);return s.jsxs(oa,{isLazy:!0,children:[s.jsx(oi,{children:s.jsx(ve,{"aria-label":t("unifiedCanvas.maskingOptions"),tooltip:t("unifiedCanvas.maskingOptions"),icon:s.jsx($b,{}),isChecked:n==="mask",isDisabled:c})}),s.jsx(ra,{children:s.jsx(aa,{children:s.jsxs(P,{direction:"column",gap:2,children:[s.jsxs(En,{formLabelProps:BX,children:[s.jsxs($,{children:[s.jsx(Y,{children:`${t("unifiedCanvas.enableMask")} (H)`}),s.jsx(bn,{isChecked:r,onChange:m})]}),s.jsxs($,{children:[s.jsx(Y,{children:t("unifiedCanvas.preserveMaskedArea")}),s.jsx(bn,{isChecked:a,onChange:g})]})]}),s.jsx(Ae,{pt:2,pb:2,children:s.jsx(L4,{color:o,onChange:x})}),s.jsxs(Nt,{isAttached:!1,children:[s.jsx(qe,{size:"sm",leftIcon:s.jsx(QD,{}),onClick:h,children:t("unifiedCanvas.saveMask")}),s.jsx(qe,{size:"sm",leftIcon:s.jsx(Bc,{}),onClick:f,children:t("unifiedCanvas.clearMask")})]})]})})})]})},zX=u.memo(NX),OX=()=>{const e=O(),t=b(a=>a.canvas.futureLayerStates.length>0),n=b(ys),{t:o}=L(),r=u.useCallback(()=>{e(M9())},[e]);return Re(["meta+shift+z","ctrl+shift+z","control+y","meta+y"],()=>{r()},{enabled:()=>t,preventDefault:!0},[n,t]),s.jsx(ve,{"aria-label":`${o("unifiedCanvas.redo")} (Ctrl+Shift+Z)`,tooltip:`${o("unifiedCanvas.redo")} (Ctrl+Shift+Z)`,icon:s.jsx(dD,{}),onClick:r,isDisabled:!t})},FX=u.memo(OX),VX=()=>{const e=b(ws),t=O(),{t:n}=L(),{isOpen:o,onOpen:r,onClose:a}=fn(),c=u.useCallback(()=>t(A9()),[t]);return s.jsxs(s.Fragment,{children:[s.jsx(qe,{onClick:r,size:"sm",leftIcon:s.jsx(Bc,{}),isDisabled:e,children:n("unifiedCanvas.clearCanvasHistory")}),s.jsxs(sa,{isOpen:o,onClose:a,title:n("unifiedCanvas.clearCanvasHistory"),acceptCallback:c,acceptButtonText:n("unifiedCanvas.clearHistory"),children:[s.jsx("p",{children:n("unifiedCanvas.clearCanvasHistoryMessage")}),s.jsx("br",{}),s.jsx("p",{children:n("unifiedCanvas.clearCanvasHistoryConfirm")})]})]})},HX=u.memo(VX),$X={flexGrow:1},WX=()=>{const e=O(),{t}=L(),n=b(A=>A.canvas.shouldAutoSave),o=b(A=>A.canvas.shouldCropToBoundingBoxOnSave),r=b(A=>A.canvas.shouldDarkenOutsideBoundingBox),a=b(A=>A.canvas.shouldInvertBrushSizeScrollDirection),c=b(A=>A.canvas.shouldShowCanvasDebugInfo),d=b(A=>A.canvas.shouldShowGrid),f=b(A=>A.canvas.shouldShowIntermediates),m=b(A=>A.canvas.shouldSnapToGrid),h=b(A=>A.canvas.shouldRestrictStrokesToBox),g=b(A=>A.canvas.shouldAntialias);Re(["n"],()=>{e(Id(!m))},{enabled:!0,preventDefault:!0},[m]);const x=u.useCallback(A=>e(Id(A.target.checked)),[e]),C=u.useCallback(A=>e(P9(A.target.checked)),[e]),j=u.useCallback(A=>e(D9(A.target.checked)),[e]),S=u.useCallback(A=>e(E9(A.target.checked)),[e]),M=u.useCallback(A=>e(_9(A.target.checked)),[e]),I=u.useCallback(A=>e(L9(A.target.checked)),[e]),k=u.useCallback(A=>e(T9(A.target.checked)),[e]),D=u.useCallback(A=>e(R9(A.target.checked)),[e]),T=u.useCallback(A=>e(B9(A.target.checked)),[e]),E=u.useCallback(A=>e(N9(A.target.checked)),[e]);return s.jsxs(oa,{children:[s.jsx(oi,{children:s.jsx(ve,{tooltip:t("unifiedCanvas.canvasSettings"),"aria-label":t("unifiedCanvas.canvasSettings"),icon:s.jsx(qb,{})})}),s.jsx(ra,{children:s.jsx(aa,{children:s.jsxs(P,{direction:"column",gap:2,children:[s.jsxs(En,{formLabelProps:$X,children:[s.jsxs($,{children:[s.jsx(Y,{children:t("unifiedCanvas.showIntermediates")}),s.jsx(bn,{isChecked:f,onChange:C})]}),s.jsxs($,{children:[s.jsx(Y,{children:t("unifiedCanvas.showGrid")}),s.jsx(bn,{isChecked:d,onChange:j})]}),s.jsxs($,{children:[s.jsx(Y,{children:t("unifiedCanvas.snapToGrid")}),s.jsx(bn,{isChecked:m,onChange:x})]}),s.jsxs($,{children:[s.jsx(Y,{children:t("unifiedCanvas.darkenOutsideSelection")}),s.jsx(bn,{isChecked:r,onChange:S})]}),s.jsxs($,{children:[s.jsx(Y,{children:t("unifiedCanvas.autoSaveToGallery")}),s.jsx(bn,{isChecked:n,onChange:I})]}),s.jsxs($,{children:[s.jsx(Y,{children:t("unifiedCanvas.saveBoxRegionOnly")}),s.jsx(bn,{isChecked:o,onChange:k})]}),s.jsxs($,{children:[s.jsx(Y,{children:t("unifiedCanvas.limitStrokesToBox")}),s.jsx(bn,{isChecked:h,onChange:D})]}),s.jsxs($,{children:[s.jsx(Y,{children:t("unifiedCanvas.invertBrushSizeScrollDirection")}),s.jsx(bn,{isChecked:a,onChange:M})]}),s.jsxs($,{children:[s.jsx(Y,{children:t("unifiedCanvas.showCanvasDebugInfo")}),s.jsx(bn,{isChecked:c,onChange:T})]}),s.jsxs($,{children:[s.jsx(Y,{children:t("unifiedCanvas.antialiasing")}),s.jsx(bn,{isChecked:g,onChange:E})]})]}),s.jsx(HX,{})]})})})]})},GX=u.memo(WX),UX=[1,25,50,75,100],ZX=()=>{const e=O(),t=yt(dn),n=b(C=>C.canvas.brushColor),o=b(C=>C.canvas.brushSize),r=b(ws),{t:a}=L();Re(["b"],()=>{c()},{enabled:()=>!r,preventDefault:!0},[]),Re(["e"],()=>{d()},{enabled:()=>!r,preventDefault:!0},[t]),Re(["c"],()=>{f()},{enabled:()=>!r,preventDefault:!0},[t]),Re(["shift+f"],()=>{m()},{enabled:()=>!r,preventDefault:!0}),Re(["delete","backspace"],()=>{h()},{enabled:()=>!r,preventDefault:!0}),Re(["BracketLeft"],()=>{o-5<=5?e(qi(Math.max(o-1,1))):e(qi(Math.max(o-5,1)))},{enabled:()=>!r,preventDefault:!0},[o]),Re(["BracketRight"],()=>{e(qi(Math.min(o+5,500)))},{enabled:()=>!r,preventDefault:!0},[o]),Re(["Shift+BracketLeft"],()=>{e(jm({...n,a:fr(n.a-.05,.05,1)}))},{enabled:()=>!r,preventDefault:!0},[n]),Re(["Shift+BracketRight"],()=>{e(jm({...n,a:fr(n.a+.05,.05,1)}))},{enabled:()=>!r,preventDefault:!0},[n]);const c=u.useCallback(()=>{dn.set("brush"),hd()},[]),d=u.useCallback(()=>{dn.set("eraser"),hd()},[]),f=u.useCallback(()=>{dn.set("colorPicker"),hd()},[]),m=u.useCallback(()=>{e(z9())},[e]),h=u.useCallback(()=>{e(O9())},[e]),g=u.useCallback(C=>{e(qi(C))},[e]),x=u.useCallback(C=>{e(jm(C))},[e]);return s.jsxs(Nt,{children:[s.jsx(ve,{"aria-label":`${a("unifiedCanvas.brush")} (B)`,tooltip:`${a("unifiedCanvas.brush")} (B)`,icon:s.jsx($D,{}),isChecked:t==="brush"&&!r,onClick:c,isDisabled:r}),s.jsx(ve,{"aria-label":`${a("unifiedCanvas.eraser")} (E)`,tooltip:`${a("unifiedCanvas.eraser")} (E)`,icon:s.jsx(SD,{}),isChecked:t==="eraser"&&!r,isDisabled:r,onClick:d}),s.jsx(ve,{"aria-label":`${a("unifiedCanvas.fillBoundingBox")} (Shift+F)`,tooltip:`${a("unifiedCanvas.fillBoundingBox")} (Shift+F)`,icon:s.jsx(WD,{}),isDisabled:r,onClick:m}),s.jsx(ve,{"aria-label":`${a("unifiedCanvas.eraseBoundingBox")} (Del/Backspace)`,tooltip:`${a("unifiedCanvas.eraseBoundingBox")} (Del/Backspace)`,icon:s.jsx($n,{}),isDisabled:r,onClick:h}),s.jsx(ve,{"aria-label":`${a("unifiedCanvas.colorPicker")} (C)`,tooltip:`${a("unifiedCanvas.colorPicker")} (C)`,icon:s.jsx(kD,{}),isChecked:t==="colorPicker"&&!r,isDisabled:r,onClick:f}),s.jsxs(oa,{children:[s.jsx(oi,{children:s.jsx(ve,{"aria-label":a("unifiedCanvas.brushOptions"),tooltip:a("unifiedCanvas.brushOptions"),icon:s.jsx(Yb,{})})}),s.jsx(ra,{children:s.jsx(aa,{children:s.jsxs(P,{minWidth:60,direction:"column",gap:4,width:"100%",children:[s.jsx(P,{gap:4,justifyContent:"space-between",children:s.jsxs($,{children:[s.jsx(Y,{children:a("unifiedCanvas.brushSize")}),s.jsx(Ne,{value:o,min:1,max:100,step:1,onChange:g,marks:UX,defaultValue:50}),s.jsx(Ee,{value:o,min:1,max:500,step:1,onChange:g,defaultValue:50})]})}),s.jsx(Ae,{w:"full",pt:2,pb:2,children:s.jsx(L4,{color:n,onChange:x,withNumberInput:!0})})]})})})]})]})},qX=u.memo(ZX),QX=()=>{const e=O(),{t}=L(),n=b(ys),o=b(a=>a.canvas.pastLayerStates.length>0),r=u.useCallback(()=>{e(F9())},[e]);return Re(["meta+z","ctrl+z"],()=>{r()},{enabled:()=>o,preventDefault:!0},[n,o]),s.jsx(ve,{"aria-label":`${t("unifiedCanvas.undo")} (Ctrl+Z)`,tooltip:`${t("unifiedCanvas.undo")} (Ctrl+Z)`,icon:s.jsx(ca,{}),onClick:r,isDisabled:!o})},KX=u.memo(QX),YX=()=>{const e=O(),t=b(E=>E.canvas.isMaskEnabled),n=b(E=>E.canvas.layer),o=yt(dn),r=b(ws),{t:a}=L(),{isClipboardAPIAvailable:c}=TS(),{getUploadButtonProps:d,getUploadInputProps:f}=h0({postUploadAction:{type:"SET_CANVAS_INITIAL_IMAGE"}});Re(["v"],()=>{m()},{enabled:()=>!r,preventDefault:!0},[]),Re(["r"],()=>{h()},{enabled:()=>!0,preventDefault:!0},[]),Re(["shift+m"],()=>{S()},{enabled:()=>!r,preventDefault:!0},[]),Re(["shift+s"],()=>{!r&&M()},{enabled:!0,preventDefault:!0},[r]),Re(["meta+c","ctrl+c"],()=>{I()},{enabled:()=>!r&&c,preventDefault:!0},[c]),Re(["shift+d"],()=>{k()},{enabled:()=>!r,preventDefault:!0},[]);const m=u.useCallback(()=>{dn.set("move")},[]),h=u.useCallback((E=!1)=>{const A=bg.get();if(!A)return;const N=A.getClientRect({skipTransform:!0});e(V9({contentRect:N,shouldScaleTo1:E}))},[e]),g=u.useCallback(()=>{h(!1)},[h]),x=u.useCallback(()=>{h(!0)},[h]),C=_X({onSingleClick:g,onDoubleClick:x}),j=u.useCallback(()=>{e(Dy())},[e]),S=u.useCallback(()=>{e(H9())},[e]),M=u.useCallback(()=>{e($9())},[e]),I=u.useCallback(()=>{c&&e(W9())},[e,c]),k=u.useCallback(()=>{e(G9())},[e]),D=u.useCallback(E=>{E&&(e(cb(E.value)),E.value==="mask"&&!t&&e(yg(!0)))},[e,t]),T=u.useMemo(()=>r2.filter(E=>E.value===n)[0],[n]);return s.jsxs(P,{alignItems:"center",gap:2,flexWrap:"wrap",children:[s.jsx(Dt,{label:`${a("unifiedCanvas.layer")} (Q)`,children:s.jsx($,{isDisabled:r,w:"5rem",children:s.jsx(ot,{value:T,options:r2,onChange:D})})}),s.jsx(zX,{}),s.jsx(qX,{}),s.jsxs(Nt,{children:[s.jsx(ve,{"aria-label":`${a("unifiedCanvas.move")} (V)`,tooltip:`${a("unifiedCanvas.move")} (V)`,icon:s.jsx(DD,{}),isChecked:o==="move"||r,onClick:m}),s.jsx(ve,{"aria-label":`${a("unifiedCanvas.resetView")} (R)`,tooltip:`${a("unifiedCanvas.resetView")} (R)`,icon:s.jsx(yD,{}),onClick:C})]}),s.jsxs(Nt,{children:[s.jsx(ve,{"aria-label":`${a("unifiedCanvas.mergeVisible")} (Shift+M)`,tooltip:`${a("unifiedCanvas.mergeVisible")} (Shift+M)`,icon:s.jsx(ZD,{}),onClick:S,isDisabled:r}),s.jsx(ve,{"aria-label":`${a("unifiedCanvas.saveToGallery")} (Shift+S)`,tooltip:`${a("unifiedCanvas.saveToGallery")} (Shift+S)`,icon:s.jsx(Tc,{}),onClick:M,isDisabled:r}),c&&s.jsx(ve,{"aria-label":`${a("unifiedCanvas.copyToClipboard")} (Cmd/Ctrl+C)`,tooltip:`${a("unifiedCanvas.copyToClipboard")} (Cmd/Ctrl+C)`,icon:s.jsx(nl,{}),onClick:I,isDisabled:r}),s.jsx(ve,{"aria-label":`${a("unifiedCanvas.downloadAsImage")} (Shift+D)`,tooltip:`${a("unifiedCanvas.downloadAsImage")} (Shift+D)`,icon:s.jsx(Lc,{}),onClick:k,isDisabled:r})]}),s.jsxs(Nt,{children:[s.jsx(KX,{}),s.jsx(FX,{})]}),s.jsxs(Nt,{children:[s.jsx(ve,{"aria-label":`${a("common.upload")}`,tooltip:`${a("common.upload")}`,icon:s.jsx(mi,{}),isDisabled:r,...d()}),s.jsx("input",{...f()}),s.jsx(ve,{"aria-label":`${a("unifiedCanvas.clearCanvas")}`,tooltip:`${a("unifiedCanvas.clearCanvas")}`,icon:s.jsx(Xs,{}),onClick:j,colorScheme:"error",isDisabled:r})]}),s.jsx(Nt,{children:s.jsx(GX,{})})]})},XX=u.memo(YX),xC={id:"canvas-intial-image",actionType:"SET_CANVAS_INITIAL_IMAGE"},JX=()=>{const{t:e}=L(),{isOver:t,setNodeRef:n,active:o}=Gj({id:"unifiedCanvas",data:xC});return s.jsxs(P,{layerStyle:"first",ref:n,flexDirection:"column",alignItems:"center",gap:4,p:2,borderRadius:"base",w:"full",h:"full","data-testid":U9,children:[s.jsx(XX,{}),s.jsx(EX,{}),Uj(xC,o)&&s.jsx(Zj,{isOver:t,label:e("toast.setCanvasInitialImage")})]})},eJ=u.memo(JX),tJ=[{id:"txt2img",translationKey:"common.txt2img",icon:s.jsx(j_,{}),content:s.jsx(Gk,{})},{id:"img2img",translationKey:"common.img2img",icon:s.jsx(M_,{}),content:s.jsx($G,{})},{id:"unifiedCanvas",translationKey:"common.unifiedCanvas",icon:s.jsx(b_,{}),content:s.jsx(eJ,{})},{id:"nodes",translationKey:"common.nodes",icon:s.jsx(Pg,{}),content:s.jsx(LQ,{})},{id:"modelManager",translationKey:"modelManager.modelManager",icon:s.jsx(A_,{}),content:s.jsx(gZ,{})},{id:"queue",translationKey:"queue.queue",icon:s.jsx($j,{}),content:s.jsx(kK,{})}],nJ=Ve(Qy,e=>tJ.filter(t=>!e.disabledTabs.includes(t.id))),sJ=["modelManager","queue"],oJ=["modelManager","queue"],rJ={height:"100%",width:"100%"},aJ=310,lJ=20,iJ=430,cJ=20,uJ="app-panel-group",dJ=()=>{const e=b(Z9),t=b(ys),n=b(nJ),{t:o}=L(),r=O(),a=yt(q9),c=u.useRef(null),d=u.useCallback(k=>{k.target instanceof HTMLElement&&k.target.blur()},[]),f=u.useMemo(()=>!oJ.includes(t),[t]),m=u.useMemo(()=>!sJ.includes(t),[t]),h=u.useMemo(()=>n.map(k=>s.jsx(Dt,{label:o(k.translationKey),placement:"end",children:s.jsx(pn,{as:ve,p:0,onClick:d,icon:k.icon,size:"md",fontSize:"24px",variant:"appTab","data-selected":t===k.id,"aria-label":o(k.translationKey),"data-testid":o(k.translationKey)})},k.id)),[n,o,d,t]),g=u.useMemo(()=>n.map(k=>s.jsx(Pn,{children:k.content},k.id)),[n]),x=u.useCallback(k=>{const D=n[k];D&&r(zs(D.id))},[r,n]),C=u.useMemo(()=>({unit:"pixels",minSize:iJ,fallbackMinSizePct:cJ,panelGroupRef:c,panelGroupDirection:"horizontal"}),[]),j=u.useMemo(()=>({unit:"pixels",minSize:aJ,fallbackMinSizePct:lJ,panelGroupRef:c,panelGroupDirection:"horizontal"}),[]),S=C0(),M=Mv(C),I=Mv(j);return Re("g",I.toggle,[I.toggle]),Re(["t","o"],M.toggle,[M.toggle]),Re("shift+r",()=>{M.reset(),I.reset()},[M.reset,I.reset]),Re("f",()=>{M.isCollapsed||I.isCollapsed?(M.expand(),I.expand()):(M.collapse(),I.collapse())},[M.isCollapsed,I.isCollapsed,M.expand,I.expand,M.collapse,I.collapse]),s.jsxs(Ja,{id:"invoke-app-tabs",variant:"appTabs",defaultIndex:e,index:e,onChange:x,w:"full",h:"full",gap:4,p:4,isLazy:!0,children:[s.jsxs(P,{flexDir:"column",alignItems:"center",pt:4,pb:2,gap:4,children:[s.jsx(tV,{}),s.jsx(el,{gap:4,pt:6,h:"full",flexDir:"column",children:h}),s.jsx(Tn,{}),s.jsx(CV,{}),a||s.jsx(xV,{})]}),s.jsxs(Qf,{ref:c,id:uJ,autoSaveId:"app",direction:"horizontal",style:rJ,storage:S,children:[f&&s.jsxs(s.Fragment,{children:[s.jsx(Ur,{id:"options-panel",ref:M.ref,order:0,defaultSize:M.minSize,minSize:M.minSize,onCollapse:M.onCollapse,onExpand:M.onExpand,collapsible:!0,children:t==="nodes"?s.jsx(XF,{}):s.jsx(QW,{})}),s.jsx(Gd,{id:"options-main-handle",onDoubleClick:M.onDoubleClickHandle,orientation:"vertical"})]}),s.jsx(Ur,{id:"main-panel",order:1,minSize:20,children:s.jsx(ii,{w:"full",h:"full",children:g})}),m&&s.jsxs(s.Fragment,{children:[s.jsx(Gd,{id:"main-gallery-handle",orientation:"vertical",onDoubleClick:I.onDoubleClickHandle}),s.jsx(Ur,{id:"gallery-panel",ref:I.ref,order:2,defaultSize:I.minSize,minSize:I.minSize,onCollapse:I.onCollapse,onExpand:I.onExpand,collapsible:!0,children:s.jsx(nN,{})})]})]}),f&&s.jsx(kV,{panelApi:M}),m&&s.jsx(bV,{panelApi:I})]})},fJ=u.memo(dJ),hJ=u.createContext(null),np={didCatch:!1,error:null};class mJ extends u.Component{constructor(t){super(t),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=np}static getDerivedStateFromError(t){return{didCatch:!0,error:t}}resetErrorBoundary(){const{error:t}=this.state;if(t!==null){for(var n,o,r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];(n=(o=this.props).onReset)===null||n===void 0||n.call(o,{args:a,reason:"imperative-api"}),this.setState(np)}}componentDidCatch(t,n){var o,r;(o=(r=this.props).onError)===null||o===void 0||o.call(r,t,n)}componentDidUpdate(t,n){const{didCatch:o}=this.state,{resetKeys:r}=this.props;if(o&&n.error!==null&&pJ(t.resetKeys,r)){var a,c;(a=(c=this.props).onReset)===null||a===void 0||a.call(c,{next:r,prev:t.resetKeys,reason:"keys"}),this.setState(np)}}render(){const{children:t,fallbackRender:n,FallbackComponent:o,fallback:r}=this.props,{didCatch:a,error:c}=this.state;let d=t;if(a){const f={error:c,resetErrorBoundary:this.resetErrorBoundary};if(typeof n=="function")d=n(f);else if(o)d=u.createElement(o,f);else if(r===null||u.isValidElement(r))d=r;else throw c}return u.createElement(hJ.Provider,{value:{didCatch:a,error:c,resetErrorBoundary:this.resetErrorBoundary}},d)}}function pJ(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e.length!==t.length||e.some((n,o)=>!Object.is(n,t[o]))}function gJ(e={}){let t;if(e.repoUrl)t=e.repoUrl;else if(e.user&&e.repo)t=`https://github.com/${e.user}/${e.repo}`;else throw new Error("You need to specify either the `repoUrl` option or both the `user` and `repo` options");const n=new URL(`${t}/issues/new`),o=["body","title","labels","template","milestone","assignee","projects"];for(const r of o){let a=e[r];if(a!==void 0){if(r==="labels"||r==="projects"){if(!Array.isArray(a))throw new TypeError(`The \`${r}\` option should be an array`);a=a.join(",")}n.searchParams.set(r,a)}}return n.toString()}const xJ=({error:e,resetErrorBoundary:t})=>{const n=na(),{t:o}=L(),r=u.useCallback(()=>{const c=JSON.stringify(Q9(e),null,2);navigator.clipboard.writeText(`\`\`\`
${c}
\`\`\``),n({title:"Error Copied"})},[e,n]),a=u.useMemo(()=>gJ({user:"invoke-ai",repo:"InvokeAI",template:"BUG_REPORT.yml",title:`[bug]: ${e.name}: ${e.message}`}),[e.message,e.name]);return s.jsx(P,{layerStyle:"body",w:"100vw",h:"100vh",alignItems:"center",justifyContent:"center",p:4,children:s.jsxs(P,{layerStyle:"first",flexDir:"column",borderRadius:"base",justifyContent:"center",gap:8,p:16,children:[s.jsx(sn,{children:o("common.somethingWentWrong")}),s.jsx(P,{layerStyle:"second",px:8,py:4,gap:4,borderRadius:"base",justifyContent:"space-between",alignItems:"center",children:s.jsxs(re,{fontWeight:"semibold",color:"error.400",children:[e.name,": ",e.message]})}),s.jsxs(P,{gap:4,children:[s.jsx(qe,{leftIcon:s.jsx(ca,{}),onClick:t,children:o("accessibility.resetUI")}),s.jsx(qe,{leftIcon:s.jsx(nl,{}),onClick:r,children:o("common.copyError")}),s.jsx(K9,{href:a,isExternal:!0,children:s.jsx(qe,{leftIcon:s.jsx(zb,{}),children:o("accessibility.createIssue")})})]})]})})},vJ=u.memo(xJ),CJ=e=>{const t=O(),n=b(ls),o=Uo(),{currentData:r}=Gs((e==null?void 0:e.imageName)??Ot),{currentData:a}=fy((e==null?void 0:e.imageName)??Ot),c=u.useCallback(()=>{r&&(t(hy(r,n)),t(zs("unifiedCanvas")),o({title:Te("toast.sentToUnifiedCanvas"),status:"info",duration:2500,isClosable:!0}))},[r,t,n,o]),d=u.useCallback(()=>{r&&t(ug(r))},[t,r]),f=u.useCallback(()=>{a&&Rp(a)},[a]);return u.useEffect(()=>{e&&e.action==="sendToCanvas"&&c()},[e,c]),u.useEffect(()=>{e&&e.action==="sendToImg2Img"&&d()},[e,d]),u.useEffect(()=>{e&&e.action==="useAllParameters"&&f()},[e,f]),{handleSendToCanvas:c,handleSendToImg2Img:d,handleUseAllMetadata:f}},yJ=e=>(CJ(e.selectedImage),null),bJ=u.memo(yJ),jJ={},SJ=({config:e=jJ,selectedImage:t})=>{const n=b(y_),o=hb("system"),r=O(),a=Cb();Y9(),X9(),QP();const{dropzone:c,isHandlingUpload:d,setIsHandlingUpload:f}=ZP(),m=u.useCallback(()=>(a(),location.reload(),!1),[a]);return u.useEffect(()=>{rn.changeLanguage(n)},[n]),u.useEffect(()=>{J9(e)&&(o.info({config:e},"Received config"),r(e7(e)))},[r,e,o]),u.useEffect(()=>{r(t7())},[r]),v_(),s.jsxs(mJ,{onReset:m,FallbackComponent:vJ,children:[s.jsxs(Ae,{id:"invoke-app-wrapper",w:"100vw",h:"100vh",position:"relative",overflow:"hidden",...c.getRootProps(),children:[s.jsx("input",{...c.getInputProps()}),s.jsx(fJ,{}),s.jsx(Ul,{children:c.isDragActive&&d&&s.jsx(W7,{dropzone:c,setIsHandlingUpload:f})})]}),s.jsx(nD,{}),s.jsx(XP,{}),s.jsx(Vj,{}),s.jsx(U7,{}),s.jsx(bJ,{selectedImage:t})]})},IJ=u.memo(SJ);export{IJ as default};
